var y4=Object.defineProperty;var Hk=s=>{throw TypeError(s)};var w4=(s,e,t)=>e in s?y4(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var re=(s,e,t)=>w4(s,typeof e!="symbol"?e+"":e,t),yE=(s,e,t)=>e.has(s)||Hk("Cannot "+t);var c=(s,e,t)=>(yE(s,e,"read from private field"),t?t.call(s):e.get(s)),T=(s,e,t)=>e.has(s)?Hk("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),x=(s,e,t,n)=>(yE(s,e,"write to private field"),n?n.call(s,t):e.set(s,t),t),I=(s,e,t)=>(yE(s,e,"access private method"),t);var Bn=(s,e,t,n)=>({set _(r){x(s,e,r,t)},get _(){return c(s,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();function v4(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var wE={exports:{}},ng={},vE={exports:{}},tt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wk;function A4(){if(Wk)return tt;Wk=1;var s=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),g=Symbol.iterator;function w(K){return K===null||typeof K!="object"?null:(K=g&&K[g]||K["@@iterator"],typeof K=="function"?K:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},F=Object.assign,C={};function S(K,Y,fe){this.props=K,this.context=Y,this.refs=C,this.updater=fe||A}S.prototype.isReactComponent={},S.prototype.setState=function(K,Y){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,Y,"setState")},S.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function P(){}P.prototype=S.prototype;function O(K,Y,fe){this.props=K,this.context=Y,this.refs=C,this.updater=fe||A}var N=O.prototype=new P;N.constructor=O,F(N,S.prototype),N.isPureReactComponent=!0;var V=Array.isArray,z=Object.prototype.hasOwnProperty,H={current:null},R={key:!0,ref:!0,__self:!0,__source:!0};function D(K,Y,fe){var De,ke={},Ne=null,Me=null;if(Y!=null)for(De in Y.ref!==void 0&&(Me=Y.ref),Y.key!==void 0&&(Ne=""+Y.key),Y)z.call(Y,De)&&!R.hasOwnProperty(De)&&(ke[De]=Y[De]);var et=arguments.length-2;if(et===1)ke.children=fe;else if(1<et){for(var dt=Array(et),Gt=0;Gt<et;Gt++)dt[Gt]=arguments[Gt+2];ke.children=dt}if(K&&K.defaultProps)for(De in et=K.defaultProps,et)ke[De]===void 0&&(ke[De]=et[De]);return{$$typeof:s,type:K,key:Ne,ref:Me,props:ke,_owner:H.current}}function L(K,Y){return{$$typeof:s,type:K.type,key:Y,ref:K.ref,props:K.props,_owner:K._owner}}function U(K){return typeof K=="object"&&K!==null&&K.$$typeof===s}function j(K){var Y={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(fe){return Y[fe]})}var G=/\/+/g;function $(K,Y){return typeof K=="object"&&K!==null&&K.key!=null?j(""+K.key):Y.toString(36)}function ge(K,Y,fe,De,ke){var Ne=typeof K;(Ne==="undefined"||Ne==="boolean")&&(K=null);var Me=!1;if(K===null)Me=!0;else switch(Ne){case"string":case"number":Me=!0;break;case"object":switch(K.$$typeof){case s:case e:Me=!0}}if(Me)return Me=K,ke=ke(Me),K=De===""?"."+$(Me,0):De,V(ke)?(fe="",K!=null&&(fe=K.replace(G,"$&/")+"/"),ge(ke,Y,fe,"",function(Gt){return Gt})):ke!=null&&(U(ke)&&(ke=L(ke,fe+(!ke.key||Me&&Me.key===ke.key?"":(""+ke.key).replace(G,"$&/")+"/")+K)),Y.push(ke)),1;if(Me=0,De=De===""?".":De+":",V(K))for(var et=0;et<K.length;et++){Ne=K[et];var dt=De+$(Ne,et);Me+=ge(Ne,Y,fe,dt,ke)}else if(dt=w(K),typeof dt=="function")for(K=dt.call(K),et=0;!(Ne=K.next()).done;)Ne=Ne.value,dt=De+$(Ne,et++),Me+=ge(Ne,Y,fe,dt,ke);else if(Ne==="object")throw Y=String(K),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.");return Me}function xe(K,Y,fe){if(K==null)return K;var De=[],ke=0;return ge(K,De,"","",function(Ne){return Y.call(fe,Ne,ke++)}),De}function ye(K){if(K._status===-1){var Y=K._result;Y=Y(),Y.then(function(fe){(K._status===0||K._status===-1)&&(K._status=1,K._result=fe)},function(fe){(K._status===0||K._status===-1)&&(K._status=2,K._result=fe)}),K._status===-1&&(K._status=0,K._result=Y)}if(K._status===1)return K._result.default;throw K._result}var pe={current:null},ie={transition:null},we={ReactCurrentDispatcher:pe,ReactCurrentBatchConfig:ie,ReactCurrentOwner:H};function de(){throw Error("act(...) is not supported in production builds of React.")}return tt.Children={map:xe,forEach:function(K,Y,fe){xe(K,function(){Y.apply(this,arguments)},fe)},count:function(K){var Y=0;return xe(K,function(){Y++}),Y},toArray:function(K){return xe(K,function(Y){return Y})||[]},only:function(K){if(!U(K))throw Error("React.Children.only expected to receive a single React element child.");return K}},tt.Component=S,tt.Fragment=t,tt.Profiler=r,tt.PureComponent=O,tt.StrictMode=n,tt.Suspense=d,tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=we,tt.act=de,tt.cloneElement=function(K,Y,fe){if(K==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+K+".");var De=F({},K.props),ke=K.key,Ne=K.ref,Me=K._owner;if(Y!=null){if(Y.ref!==void 0&&(Ne=Y.ref,Me=H.current),Y.key!==void 0&&(ke=""+Y.key),K.type&&K.type.defaultProps)var et=K.type.defaultProps;for(dt in Y)z.call(Y,dt)&&!R.hasOwnProperty(dt)&&(De[dt]=Y[dt]===void 0&&et!==void 0?et[dt]:Y[dt])}var dt=arguments.length-2;if(dt===1)De.children=fe;else if(1<dt){et=Array(dt);for(var Gt=0;Gt<dt;Gt++)et[Gt]=arguments[Gt+2];De.children=et}return{$$typeof:s,type:K.type,key:ke,ref:Ne,props:De,_owner:Me}},tt.createContext=function(K){return K={$$typeof:o,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},K.Provider={$$typeof:i,_context:K},K.Consumer=K},tt.createElement=D,tt.createFactory=function(K){var Y=D.bind(null,K);return Y.type=K,Y},tt.createRef=function(){return{current:null}},tt.forwardRef=function(K){return{$$typeof:u,render:K}},tt.isValidElement=U,tt.lazy=function(K){return{$$typeof:f,_payload:{_status:-1,_result:K},_init:ye}},tt.memo=function(K,Y){return{$$typeof:h,type:K,compare:Y===void 0?null:Y}},tt.startTransition=function(K){var Y=ie.transition;ie.transition={};try{K()}finally{ie.transition=Y}},tt.unstable_act=de,tt.useCallback=function(K,Y){return pe.current.useCallback(K,Y)},tt.useContext=function(K){return pe.current.useContext(K)},tt.useDebugValue=function(){},tt.useDeferredValue=function(K){return pe.current.useDeferredValue(K)},tt.useEffect=function(K,Y){return pe.current.useEffect(K,Y)},tt.useId=function(){return pe.current.useId()},tt.useImperativeHandle=function(K,Y,fe){return pe.current.useImperativeHandle(K,Y,fe)},tt.useInsertionEffect=function(K,Y){return pe.current.useInsertionEffect(K,Y)},tt.useLayoutEffect=function(K,Y){return pe.current.useLayoutEffect(K,Y)},tt.useMemo=function(K,Y){return pe.current.useMemo(K,Y)},tt.useReducer=function(K,Y,fe){return pe.current.useReducer(K,Y,fe)},tt.useRef=function(K){return pe.current.useRef(K)},tt.useState=function(K){return pe.current.useState(K)},tt.useSyncExternalStore=function(K,Y,fe){return pe.current.useSyncExternalStore(K,Y,fe)},tt.useTransition=function(){return pe.current.useTransition()},tt.version="18.3.1",tt}var Gk;function rF(){return Gk||(Gk=1,vE.exports=A4()),vE.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qk;function _4(){if(qk)return ng;qk=1;var s=rF(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,r=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(u,d,h){var f,g={},w=null,A=null;h!==void 0&&(w=""+h),d.key!==void 0&&(w=""+d.key),d.ref!==void 0&&(A=d.ref);for(f in d)n.call(d,f)&&!i.hasOwnProperty(f)&&(g[f]=d[f]);if(u&&u.defaultProps)for(f in d=u.defaultProps,d)g[f]===void 0&&(g[f]=d[f]);return{$$typeof:e,type:u,key:w,ref:A,props:g,_owner:r.current}}return ng.Fragment=t,ng.jsx=o,ng.jsxs=o,ng}var Qk;function x4(){return Qk||(Qk=1,wE.exports=_4()),wE.exports}var _=x4(),q=rF();const Wv=v4(q);var Gv={},AE={exports:{}},Zr={},_E={exports:{}},xE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kk;function E4(){return Kk||(Kk=1,(function(s){function e(ie,we){var de=ie.length;ie.push(we);e:for(;0<de;){var K=de-1>>>1,Y=ie[K];if(0<r(Y,we))ie[K]=we,ie[de]=Y,de=K;else break e}}function t(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var we=ie[0],de=ie.pop();if(de!==we){ie[0]=de;e:for(var K=0,Y=ie.length,fe=Y>>>1;K<fe;){var De=2*(K+1)-1,ke=ie[De],Ne=De+1,Me=ie[Ne];if(0>r(ke,de))Ne<Y&&0>r(Me,ke)?(ie[K]=Me,ie[Ne]=de,K=Ne):(ie[K]=ke,ie[De]=de,K=De);else if(Ne<Y&&0>r(Me,de))ie[K]=Me,ie[Ne]=de,K=Ne;else break e}}return we}function r(ie,we){var de=ie.sortIndex-we.sortIndex;return de!==0?de:ie.id-we.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;s.unstable_now=function(){return i.now()}}else{var o=Date,u=o.now();s.unstable_now=function(){return o.now()-u}}var d=[],h=[],f=1,g=null,w=3,A=!1,F=!1,C=!1,S=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(ie){for(var we=t(h);we!==null;){if(we.callback===null)n(h);else if(we.startTime<=ie)n(h),we.sortIndex=we.expirationTime,e(d,we);else break;we=t(h)}}function V(ie){if(C=!1,N(ie),!F)if(t(d)!==null)F=!0,ye(z);else{var we=t(h);we!==null&&pe(V,we.startTime-ie)}}function z(ie,we){F=!1,C&&(C=!1,P(D),D=-1),A=!0;var de=w;try{for(N(we),g=t(d);g!==null&&(!(g.expirationTime>we)||ie&&!j());){var K=g.callback;if(typeof K=="function"){g.callback=null,w=g.priorityLevel;var Y=K(g.expirationTime<=we);we=s.unstable_now(),typeof Y=="function"?g.callback=Y:g===t(d)&&n(d),N(we)}else n(d);g=t(d)}if(g!==null)var fe=!0;else{var De=t(h);De!==null&&pe(V,De.startTime-we),fe=!1}return fe}finally{g=null,w=de,A=!1}}var H=!1,R=null,D=-1,L=5,U=-1;function j(){return!(s.unstable_now()-U<L)}function G(){if(R!==null){var ie=s.unstable_now();U=ie;var we=!0;try{we=R(!0,ie)}finally{we?$():(H=!1,R=null)}}else H=!1}var $;if(typeof O=="function")$=function(){O(G)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,xe=ge.port2;ge.port1.onmessage=G,$=function(){xe.postMessage(null)}}else $=function(){S(G,0)};function ye(ie){R=ie,H||(H=!0,$())}function pe(ie,we){D=S(function(){ie(s.unstable_now())},we)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(ie){ie.callback=null},s.unstable_continueExecution=function(){F||A||(F=!0,ye(z))},s.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<ie?Math.floor(1e3/ie):5},s.unstable_getCurrentPriorityLevel=function(){return w},s.unstable_getFirstCallbackNode=function(){return t(d)},s.unstable_next=function(ie){switch(w){case 1:case 2:case 3:var we=3;break;default:we=w}var de=w;w=we;try{return ie()}finally{w=de}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(ie,we){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var de=w;w=ie;try{return we()}finally{w=de}},s.unstable_scheduleCallback=function(ie,we,de){var K=s.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?K+de:K):de=K,ie){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=de+Y,ie={id:f++,callback:we,priorityLevel:ie,startTime:de,expirationTime:Y,sortIndex:-1},de>K?(ie.sortIndex=de,e(h,ie),t(d)===null&&ie===t(h)&&(C?(P(D),D=-1):C=!0,pe(V,de-K))):(ie.sortIndex=Y,e(d,ie),F||A||(F=!0,ye(z))),ie},s.unstable_shouldYield=j,s.unstable_wrapCallback=function(ie){var we=w;return function(){var de=w;w=we;try{return ie.apply(this,arguments)}finally{w=de}}}})(xE)),xE}var Xk;function b4(){return Xk||(Xk=1,_E.exports=E4()),_E.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yk;function C4(){if(Yk)return Zr;Yk=1;var s=rF(),e=b4();function t(a){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+a,p=1;p<arguments.length;p++)l+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,r={};function i(a,l){o(a,l),o(a+"Capture",l)}function o(a,l){for(r[a]=l,a=0;a<l.length;a++)n.add(l[a])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},g={};function w(a){return d.call(g,a)?!0:d.call(f,a)?!1:h.test(a)?g[a]=!0:(f[a]=!0,!1)}function A(a,l,p,y){if(p!==null&&p.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return y?!1:p!==null?!p.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function F(a,l,p,y){if(l===null||typeof l>"u"||A(a,l,p,y))return!0;if(y)return!1;if(p!==null)switch(p.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function C(a,l,p,y,v,E,M){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=y,this.attributeNamespace=v,this.mustUseProperty=p,this.propertyName=a,this.type=l,this.sanitizeURL=E,this.removeEmptyString=M}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){S[a]=new C(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var l=a[0];S[l]=new C(l,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){S[a]=new C(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){S[a]=new C(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){S[a]=new C(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){S[a]=new C(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){S[a]=new C(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){S[a]=new C(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){S[a]=new C(a,5,!1,a.toLowerCase(),null,!1,!1)});var P=/[\-:]([a-z])/g;function O(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var l=a.replace(P,O);S[l]=new C(l,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var l=a.replace(P,O);S[l]=new C(l,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var l=a.replace(P,O);S[l]=new C(l,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){S[a]=new C(a,1,!1,a.toLowerCase(),null,!1,!1)}),S.xlinkHref=new C("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){S[a]=new C(a,1,!1,a.toLowerCase(),null,!0,!0)});function N(a,l,p,y){var v=S.hasOwnProperty(l)?S[l]:null;(v!==null?v.type!==0:y||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(F(l,p,v,y)&&(p=null),y||v===null?w(l)&&(p===null?a.removeAttribute(l):a.setAttribute(l,""+p)):v.mustUseProperty?a[v.propertyName]=p===null?v.type===3?!1:"":p:(l=v.attributeName,y=v.attributeNamespace,p===null?a.removeAttribute(l):(v=v.type,p=v===3||v===4&&p===!0?"":""+p,y?a.setAttributeNS(y,l,p):a.setAttribute(l,p))))}var V=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,z=Symbol.for("react.element"),H=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),U=Symbol.for("react.provider"),j=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),ge=Symbol.for("react.suspense_list"),xe=Symbol.for("react.memo"),ye=Symbol.for("react.lazy"),pe=Symbol.for("react.offscreen"),ie=Symbol.iterator;function we(a){return a===null||typeof a!="object"?null:(a=ie&&a[ie]||a["@@iterator"],typeof a=="function"?a:null)}var de=Object.assign,K;function Y(a){if(K===void 0)try{throw Error()}catch(p){var l=p.stack.trim().match(/\n( *(at )?)/);K=l&&l[1]||""}return`
`+K+a}var fe=!1;function De(a,l){if(!a||fe)return"";fe=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(te){var y=te}Reflect.construct(a,[],l)}else{try{l.call()}catch(te){y=te}a.call(l.prototype)}else{try{throw Error()}catch(te){y=te}a()}}catch(te){if(te&&y&&typeof te.stack=="string"){for(var v=te.stack.split(`
`),E=y.stack.split(`
`),M=v.length-1,W=E.length-1;1<=M&&0<=W&&v[M]!==E[W];)W--;for(;1<=M&&0<=W;M--,W--)if(v[M]!==E[W]){if(M!==1||W!==1)do if(M--,W--,0>W||v[M]!==E[W]){var Q=`
`+v[M].replace(" at new "," at ");return a.displayName&&Q.includes("<anonymous>")&&(Q=Q.replace("<anonymous>",a.displayName)),Q}while(1<=M&&0<=W);break}}}finally{fe=!1,Error.prepareStackTrace=p}return(a=a?a.displayName||a.name:"")?Y(a):""}function ke(a){switch(a.tag){case 5:return Y(a.type);case 16:return Y("Lazy");case 13:return Y("Suspense");case 19:return Y("SuspenseList");case 0:case 2:case 15:return a=De(a.type,!1),a;case 11:return a=De(a.type.render,!1),a;case 1:return a=De(a.type,!0),a;default:return""}}function Ne(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case R:return"Fragment";case H:return"Portal";case L:return"Profiler";case D:return"StrictMode";case $:return"Suspense";case ge:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case j:return(a.displayName||"Context")+".Consumer";case U:return(a._context.displayName||"Context")+".Provider";case G:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case xe:return l=a.displayName||null,l!==null?l:Ne(a.type)||"Memo";case ye:l=a._payload,a=a._init;try{return Ne(a(l))}catch{}}return null}function Me(a){var l=a.type;switch(a.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=l.render,a=a.displayName||a.name||"",l.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ne(l);case 8:return l===D?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function et(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function dt(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Gt(a){var l=dt(a)?"checked":"value",p=Object.getOwnPropertyDescriptor(a.constructor.prototype,l),y=""+a[l];if(!a.hasOwnProperty(l)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var v=p.get,E=p.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return v.call(this)},set:function(M){y=""+M,E.call(this,M)}}),Object.defineProperty(a,l,{enumerable:p.enumerable}),{getValue:function(){return y},setValue:function(M){y=""+M},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function vr(a){a._valueTracker||(a._valueTracker=Gt(a))}function ce(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var p=l.getValue(),y="";return a&&(y=dt(a)?a.checked?"true":"false":a.value),a=y,a!==p?(l.setValue(a),!0):!1}function Oe(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function Zt(a,l){var p=l.checked;return de({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??a._wrapperState.initialChecked})}function Bl(a,l){var p=l.defaultValue==null?"":l.defaultValue,y=l.checked!=null?l.checked:l.defaultChecked;p=et(l.value!=null?l.value:p),a._wrapperState={initialChecked:y,initialValue:p,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function ip(a,l){l=l.checked,l!=null&&N(a,"checked",l,!1)}function $u(a,l){ip(a,l);var p=et(l.value),y=l.type;if(p!=null)y==="number"?(p===0&&a.value===""||a.value!=p)&&(a.value=""+p):a.value!==""+p&&(a.value=""+p);else if(y==="submit"||y==="reset"){a.removeAttribute("value");return}l.hasOwnProperty("value")?Cn(a,l.type,p):l.hasOwnProperty("defaultValue")&&Cn(a,l.type,et(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(a.defaultChecked=!!l.defaultChecked)}function c2(a,l,p){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var y=l.type;if(!(y!=="submit"&&y!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+a._wrapperState.initialValue,p||l===a.value||(a.value=l),a.defaultValue=l}p=a.name,p!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,p!==""&&(a.name=p)}function Cn(a,l,p){(l!=="number"||Oe(a.ownerDocument)!==a)&&(p==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+p&&(a.defaultValue=""+p))}var wn=Array.isArray;function Si(a,l,p,y){if(a=a.options,l){l={};for(var v=0;v<p.length;v++)l["$"+p[v]]=!0;for(p=0;p<a.length;p++)v=l.hasOwnProperty("$"+a[p].value),a[p].selected!==v&&(a[p].selected=v),v&&y&&(a[p].defaultSelected=!0)}else{for(p=""+et(p),l=null,v=0;v<a.length;v++){if(a[v].value===p){a[v].selected=!0,y&&(a[v].defaultSelected=!0);return}l!==null||a[v].disabled||(l=a[v])}l!==null&&(l.selected=!0)}}function u2(a,l){if(l.dangerouslySetInnerHTML!=null)throw Error(t(91));return de({},l,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function d2(a,l){var p=l.value;if(p==null){if(p=l.children,l=l.defaultValue,p!=null){if(l!=null)throw Error(t(92));if(wn(p)){if(1<p.length)throw Error(t(93));p=p[0]}l=p}l==null&&(l=""),p=l}a._wrapperState={initialValue:et(p)}}function P0(a,l){var p=et(l.value),y=et(l.defaultValue);p!=null&&(p=""+p,p!==a.value&&(a.value=p),l.defaultValue==null&&a.defaultValue!==p&&(a.defaultValue=p)),y!=null&&(a.defaultValue=""+y)}function Vl(a){var l=a.textContent;l===a._wrapperState.initialValue&&l!==""&&l!==null&&(a.value=l)}function h2(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ap(a,l){return a==null||a==="http://www.w3.org/1999/xhtml"?h2(l):a==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Ul,R0=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,p,y,v){MSApp.execUnsafeLocalFunction(function(){return a(l,p,y,v)})}:a})(function(a,l){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=l;else{for(Ul=Ul||document.createElement("div"),Ul.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=Ul.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;l.firstChild;)a.appendChild(l.firstChild)}});function zu(a,l){if(l){var p=a.firstChild;if(p&&p===a.lastChild&&p.nodeType===3){p.nodeValue=l;return}}a.textContent=l}var jl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},D0=["Webkit","ms","Moz","O"];Object.keys(jl).forEach(function(a){D0.forEach(function(l){l=l+a.charAt(0).toUpperCase()+a.substring(1),jl[l]=jl[a]})});function $l(a,l,p){return l==null||typeof l=="boolean"||l===""?"":p||typeof l!="number"||l===0||jl.hasOwnProperty(a)&&jl[a]?(""+l).trim():l+"px"}function op(a,l){a=a.style;for(var p in l)if(l.hasOwnProperty(p)){var y=p.indexOf("--")===0,v=$l(p,l[p],y);p==="float"&&(p="cssFloat"),y?a.setProperty(p,v):a[p]=v}}var p2=de({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ti(a,l){if(l){if(p2[a]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(t(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(t(61))}if(l.style!=null&&typeof l.style!="object")throw Error(t(62))}}function lp(a,l){if(a.indexOf("-")===-1)return typeof l.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zl=null;function cp(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var yo=null,wo=null,ln=null;function f2(a){if(a=j2(a)){if(typeof yo!="function")throw Error(t(280));var l=a.stateNode;l&&(l=av(l),yo(a.stateNode,a.type,l))}}function Hl(a){wo?ln?ln.push(a):ln=[a]:wo=a}function Wl(){if(wo){var a=wo,l=ln;if(ln=wo=null,f2(a),l)for(a=0;a<l.length;a++)f2(l[a])}}function N0(a,l){return a(l)}function M0(){}var aa=!1;function L0(a,l,p){if(aa)return a(l,p);aa=!0;try{return N0(a,l,p)}finally{aa=!1,(wo!==null||ln!==null)&&(M0(),Wl())}}function Hu(a,l){var p=a.stateNode;if(p===null)return null;var y=av(p);if(y===null)return null;p=y[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(a=a.type,y=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!y;break e;default:a=!1}if(a)return null;if(p&&typeof p!="function")throw Error(t(231,l,typeof p));return p}var Gl=!1;if(u)try{var ql={};Object.defineProperty(ql,"passive",{get:function(){Gl=!0}}),window.addEventListener("test",ql,ql),window.removeEventListener("test",ql,ql)}catch{Gl=!1}function O0(a,l,p,y,v,E,M,W,Q){var te=Array.prototype.slice.call(arguments,3);try{l.apply(p,te)}catch(le){this.onError(le)}}var vo=!1,oa=null,up=!1,Ys=null,B0={onError:function(a){vo=!0,oa=a}};function V0(a,l,p,y,v,E,M,W,Q){vo=!1,oa=null,O0.apply(B0,arguments)}function m2(a,l,p,y,v,E,M,W,Q){if(V0.apply(this,arguments),vo){if(vo){var te=oa;vo=!1,oa=null}else throw Error(t(198));up||(up=!0,Ys=te)}}function ki(a){var l=a,p=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(p=l.return),a=l.return;while(a)}return l.tag===3?p:null}function g2(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function U0(a){if(ki(a)!==a)throw Error(t(188))}function j0(a){var l=a.alternate;if(!l){if(l=ki(a),l===null)throw Error(t(188));return l!==a?null:a}for(var p=a,y=l;;){var v=p.return;if(v===null)break;var E=v.alternate;if(E===null){if(y=v.return,y!==null){p=y;continue}break}if(v.child===E.child){for(E=v.child;E;){if(E===p)return U0(v),a;if(E===y)return U0(v),l;E=E.sibling}throw Error(t(188))}if(p.return!==y.return)p=v,y=E;else{for(var M=!1,W=v.child;W;){if(W===p){M=!0,p=v,y=E;break}if(W===y){M=!0,y=v,p=E;break}W=W.sibling}if(!M){for(W=E.child;W;){if(W===p){M=!0,p=E,y=v;break}if(W===y){M=!0,y=E,p=v;break}W=W.sibling}if(!M)throw Error(t(189))}}if(p.alternate!==y)throw Error(t(190))}if(p.tag!==3)throw Error(t(188));return p.stateNode.current===p?a:l}function $0(a){return a=j0(a),a!==null?Wu(a):null}function Wu(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var l=Wu(a);if(l!==null)return l;a=a.sibling}return null}var y2=e.unstable_scheduleCallback,dp=e.unstable_cancelCallback,Gu=e.unstable_shouldYield,Ao=e.unstable_requestPaint,jt=e.unstable_now,Qx=e.unstable_getCurrentPriorityLevel,hp=e.unstable_ImmediatePriority,w2=e.unstable_UserBlockingPriority,qu=e.unstable_NormalPriority,v2=e.unstable_LowPriority,pp=e.unstable_IdlePriority,Qu=null,ps=null;function z0(a){if(ps&&typeof ps.onCommitFiberRoot=="function")try{ps.onCommitFiberRoot(Qu,a,void 0,(a.current.flags&128)===128)}catch{}}var fs=Math.clz32?Math.clz32:Ku,la=Math.log,Js=Math.LN2;function Ku(a){return a>>>=0,a===0?32:31-(la(a)/Js|0)|0}var ca=64,Ql=4194304;function yt(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function _o(a,l){var p=a.pendingLanes;if(p===0)return 0;var y=0,v=a.suspendedLanes,E=a.pingedLanes,M=p&268435455;if(M!==0){var W=M&~v;W!==0?y=yt(W):(E&=M,E!==0&&(y=yt(E)))}else M=p&~v,M!==0?y=yt(M):E!==0&&(y=yt(E));if(y===0)return 0;if(l!==0&&l!==y&&(l&v)===0&&(v=y&-y,E=l&-l,v>=E||v===16&&(E&4194240)!==0))return l;if((y&4)!==0&&(y|=p&16),l=a.entangledLanes,l!==0)for(a=a.entanglements,l&=y;0<l;)p=31-fs(l),v=1<<p,y|=a[p],l&=~v;return y}function Xu(a,l){switch(a){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yu(a,l){for(var p=a.suspendedLanes,y=a.pingedLanes,v=a.expirationTimes,E=a.pendingLanes;0<E;){var M=31-fs(E),W=1<<M,Q=v[M];Q===-1?((W&p)===0||(W&y)!==0)&&(v[M]=Xu(W,l)):Q<=l&&(a.expiredLanes|=W),E&=~W}}function A2(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function _2(){var a=ca;return ca<<=1,(ca&4194240)===0&&(ca=64),a}function x2(a){for(var l=[],p=0;31>p;p++)l.push(a);return l}function Ju(a,l,p){a.pendingLanes|=l,l!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,l=31-fs(l),a[l]=p}function Kx(a,l){var p=a.pendingLanes&~l;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=l,a.mutableReadLanes&=l,a.entangledLanes&=l,l=a.entanglements;var y=a.eventTimes;for(a=a.expirationTimes;0<p;){var v=31-fs(p),E=1<<v;l[v]=0,y[v]=-1,a[v]=-1,p&=~E}}function E2(a,l){var p=a.entangledLanes|=l;for(a=a.entanglements;p;){var y=31-fs(p),v=1<<y;v&l|a[y]&l&&(a[y]|=l),p&=~v}}var ot=0;function ua(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var b2,fp,C2,F2,S2,da=!1,mp=[],ha=null,pa=null,nr=null,Zu=new Map,xo=new Map,ms=[],H0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Kl(a,l){switch(a){case"focusin":case"focusout":ha=null;break;case"dragenter":case"dragleave":pa=null;break;case"mouseover":case"mouseout":nr=null;break;case"pointerover":case"pointerout":Zu.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":xo.delete(l.pointerId)}}function Ii(a,l,p,y,v,E){return a===null||a.nativeEvent!==E?(a={blockedOn:l,domEventName:p,eventSystemFlags:y,nativeEvent:E,targetContainers:[v]},l!==null&&(l=j2(l),l!==null&&fp(l)),a):(a.eventSystemFlags|=y,l=a.targetContainers,v!==null&&l.indexOf(v)===-1&&l.push(v),a)}function W0(a,l,p,y,v){switch(l){case"focusin":return ha=Ii(ha,a,l,p,y,v),!0;case"dragenter":return pa=Ii(pa,a,l,p,y,v),!0;case"mouseover":return nr=Ii(nr,a,l,p,y,v),!0;case"pointerover":var E=v.pointerId;return Zu.set(E,Ii(Zu.get(E)||null,a,l,p,y,v)),!0;case"gotpointercapture":return E=v.pointerId,xo.set(E,Ii(xo.get(E)||null,a,l,p,y,v)),!0}return!1}function gp(a){var l=rd(a.target);if(l!==null){var p=ki(l);if(p!==null){if(l=p.tag,l===13){if(l=g2(p),l!==null){a.blockedOn=l,S2(a.priority,function(){C2(p)});return}}else if(l===3&&p.stateNode.current.memoizedState.isDehydrated){a.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Dt(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var p=yp(a.domEventName,a.eventSystemFlags,l[0],a.nativeEvent);if(p===null){p=a.nativeEvent;var y=new p.constructor(p.type,p);zl=y,p.target.dispatchEvent(y),zl=null}else return l=j2(p),l!==null&&fp(l),a.blockedOn=p,!1;l.shift()}return!0}function G0(a,l,p){Dt(a)&&p.delete(l)}function Xx(){da=!1,ha!==null&&Dt(ha)&&(ha=null),pa!==null&&Dt(pa)&&(pa=null),nr!==null&&Dt(nr)&&(nr=null),Zu.forEach(G0),xo.forEach(G0)}function Xl(a,l){a.blockedOn===l&&(a.blockedOn=null,da||(da=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Xx)))}function Yl(a){function l(v){return Xl(v,a)}if(0<mp.length){Xl(mp[0],a);for(var p=1;p<mp.length;p++){var y=mp[p];y.blockedOn===a&&(y.blockedOn=null)}}for(ha!==null&&Xl(ha,a),pa!==null&&Xl(pa,a),nr!==null&&Xl(nr,a),Zu.forEach(l),xo.forEach(l),p=0;p<ms.length;p++)y=ms[p],y.blockedOn===a&&(y.blockedOn=null);for(;0<ms.length&&(p=ms[0],p.blockedOn===null);)gp(p),p.blockedOn===null&&ms.shift()}var Eo=V.ReactCurrentBatchConfig,bo=!0;function fa(a,l,p,y){var v=ot,E=Eo.transition;Eo.transition=null;try{ot=1,T2(a,l,p,y)}finally{ot=v,Eo.transition=E}}function q0(a,l,p,y){var v=ot,E=Eo.transition;Eo.transition=null;try{ot=4,T2(a,l,p,y)}finally{ot=v,Eo.transition=E}}function T2(a,l,p,y){if(bo){var v=yp(a,l,p,y);if(v===null)o1(a,l,y,ma,p),Kl(a,y);else if(W0(v,a,l,p,y))y.stopPropagation();else if(Kl(a,y),l&4&&-1<H0.indexOf(a)){for(;v!==null;){var E=j2(v);if(E!==null&&b2(E),E=yp(a,l,p,y),E===null&&o1(a,l,y,ma,p),E===v)break;v=E}v!==null&&y.stopPropagation()}else o1(a,l,y,null,p)}}var ma=null;function yp(a,l,p,y){if(ma=null,a=cp(y),a=rd(a),a!==null)if(l=ki(a),l===null)a=null;else if(p=l.tag,p===13){if(a=g2(l),a!==null)return a;a=null}else if(p===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null);return ma=a,null}function wp(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qx()){case hp:return 1;case w2:return 4;case qu:case v2:return 16;case pp:return 536870912;default:return 16}default:return 16}}var gs=null,vp=null,Co=null;function Q0(){if(Co)return Co;var a,l=vp,p=l.length,y,v="value"in gs?gs.value:gs.textContent,E=v.length;for(a=0;a<p&&l[a]===v[a];a++);var M=p-a;for(y=1;y<=M&&l[p-y]===v[E-y];y++);return Co=v.slice(a,1<y?1-y:void 0)}function ed(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function ga(){return!0}function k2(){return!1}function Ar(a){function l(p,y,v,E,M){this._reactName=p,this._targetInst=v,this.type=y,this.nativeEvent=E,this.target=M,this.currentTarget=null;for(var W in a)a.hasOwnProperty(W)&&(p=a[W],this[W]=p?p(E):E[W]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?ga:k2,this.isPropagationStopped=k2,this}return de(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=ga)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=ga)},persist:function(){},isPersistent:ga}),l}var ya={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=Ar(ya),Jl=de({},ya,{view:0,detail:0}),Ap=Ar(Jl),_p,xp,ys,nd=de({},Jl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qe,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==ys&&(ys&&a.type==="mousemove"?(_p=a.screenX-ys.screenX,xp=a.screenY-ys.screenY):xp=_p=0,ys=a),_p)},movementY:function(a){return"movementY"in a?a.movementY:xp}}),I2=Ar(nd),K0=de({},nd,{dataTransfer:0}),X0=Ar(K0),Ep=de({},Jl,{relatedTarget:0}),rr=Ar(Ep),Y0=de({},ya,{animationName:0,elapsedTime:0,pseudoElement:0}),J0=Ar(Y0),Zl=de({},ya,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),m=Ar(Zl),b=de({},ya,{data:0}),k=Ar(b),B={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Z={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ne={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function me(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=ne[a])?!!l[a]:!1}function Qe(){return me}var vn=de({},Jl,{key:function(a){if(a.key){var l=B[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=ed(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Z[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qe,charCode:function(a){return a.type==="keypress"?ed(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?ed(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Et=Ar(vn),Fn=de({},nd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ws=Ar(Fn),Fo=de({},Jl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qe}),wa=Ar(Fo),va=de({},ya,{propertyName:0,elapsedTime:0,pseudoElement:0}),bp=Ar(va),P2=de({},nd,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),dO=Ar(P2),hO=[9,13,27,32],Yx=u&&"CompositionEvent"in window,R2=null;u&&"documentMode"in document&&(R2=document.documentMode);var pO=u&&"TextEvent"in window&&!R2,LS=u&&(!Yx||R2&&8<R2&&11>=R2),OS=" ",BS=!1;function VS(a,l){switch(a){case"keyup":return hO.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function US(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Cp=!1;function fO(a,l){switch(a){case"compositionend":return US(l);case"keypress":return l.which!==32?null:(BS=!0,OS);case"textInput":return a=l.data,a===OS&&BS?null:a;default:return null}}function mO(a,l){if(Cp)return a==="compositionend"||!Yx&&VS(a,l)?(a=Q0(),Co=vp=gs=null,Cp=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return LS&&l.locale!=="ko"?null:l.data;default:return null}}var gO={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jS(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!gO[a.type]:l==="textarea"}function $S(a,l,p,y){Hl(y),l=rv(l,"onChange"),0<l.length&&(p=new td("onChange","change",null,p,y),a.push({event:p,listeners:l}))}var D2=null,N2=null;function yO(a){aT(a,0)}function Z0(a){var l=Ip(a);if(ce(l))return a}function wO(a,l){if(a==="change")return l}var zS=!1;if(u){var Jx;if(u){var Zx="oninput"in document;if(!Zx){var HS=document.createElement("div");HS.setAttribute("oninput","return;"),Zx=typeof HS.oninput=="function"}Jx=Zx}else Jx=!1;zS=Jx&&(!document.documentMode||9<document.documentMode)}function WS(){D2&&(D2.detachEvent("onpropertychange",GS),N2=D2=null)}function GS(a){if(a.propertyName==="value"&&Z0(N2)){var l=[];$S(l,N2,a,cp(a)),L0(yO,l)}}function vO(a,l,p){a==="focusin"?(WS(),D2=l,N2=p,D2.attachEvent("onpropertychange",GS)):a==="focusout"&&WS()}function AO(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Z0(N2)}function _O(a,l){if(a==="click")return Z0(l)}function xO(a,l){if(a==="input"||a==="change")return Z0(l)}function EO(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var Pi=typeof Object.is=="function"?Object.is:EO;function M2(a,l){if(Pi(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var p=Object.keys(a),y=Object.keys(l);if(p.length!==y.length)return!1;for(y=0;y<p.length;y++){var v=p[y];if(!d.call(l,v)||!Pi(a[v],l[v]))return!1}return!0}function qS(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function QS(a,l){var p=qS(a);a=0;for(var y;p;){if(p.nodeType===3){if(y=a+p.textContent.length,a<=l&&y>=l)return{node:p,offset:l-a};a=y}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=qS(p)}}function KS(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?KS(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function XS(){for(var a=window,l=Oe();l instanceof a.HTMLIFrameElement;){try{var p=typeof l.contentWindow.location.href=="string"}catch{p=!1}if(p)a=l.contentWindow;else break;l=Oe(a.document)}return l}function e1(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}function bO(a){var l=XS(),p=a.focusedElem,y=a.selectionRange;if(l!==p&&p&&p.ownerDocument&&KS(p.ownerDocument.documentElement,p)){if(y!==null&&e1(p)){if(l=y.start,a=y.end,a===void 0&&(a=l),"selectionStart"in p)p.selectionStart=l,p.selectionEnd=Math.min(a,p.value.length);else if(a=(l=p.ownerDocument||document)&&l.defaultView||window,a.getSelection){a=a.getSelection();var v=p.textContent.length,E=Math.min(y.start,v);y=y.end===void 0?E:Math.min(y.end,v),!a.extend&&E>y&&(v=y,y=E,E=v),v=QS(p,E);var M=QS(p,y);v&&M&&(a.rangeCount!==1||a.anchorNode!==v.node||a.anchorOffset!==v.offset||a.focusNode!==M.node||a.focusOffset!==M.offset)&&(l=l.createRange(),l.setStart(v.node,v.offset),a.removeAllRanges(),E>y?(a.addRange(l),a.extend(M.node,M.offset)):(l.setEnd(M.node,M.offset),a.addRange(l)))}}for(l=[],a=p;a=a.parentNode;)a.nodeType===1&&l.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<l.length;p++)a=l[p],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var CO=u&&"documentMode"in document&&11>=document.documentMode,Fp=null,t1=null,L2=null,n1=!1;function YS(a,l,p){var y=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;n1||Fp==null||Fp!==Oe(y)||(y=Fp,"selectionStart"in y&&e1(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),L2&&M2(L2,y)||(L2=y,y=rv(t1,"onSelect"),0<y.length&&(l=new td("onSelect","select",null,l,p),a.push({event:l,listeners:y}),l.target=Fp)))}function ev(a,l){var p={};return p[a.toLowerCase()]=l.toLowerCase(),p["Webkit"+a]="webkit"+l,p["Moz"+a]="moz"+l,p}var Sp={animationend:ev("Animation","AnimationEnd"),animationiteration:ev("Animation","AnimationIteration"),animationstart:ev("Animation","AnimationStart"),transitionend:ev("Transition","TransitionEnd")},r1={},JS={};u&&(JS=document.createElement("div").style,"AnimationEvent"in window||(delete Sp.animationend.animation,delete Sp.animationiteration.animation,delete Sp.animationstart.animation),"TransitionEvent"in window||delete Sp.transitionend.transition);function tv(a){if(r1[a])return r1[a];if(!Sp[a])return a;var l=Sp[a],p;for(p in l)if(l.hasOwnProperty(p)&&p in JS)return r1[a]=l[p];return a}var ZS=tv("animationend"),eT=tv("animationiteration"),tT=tv("animationstart"),nT=tv("transitionend"),rT=new Map,sT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ec(a,l){rT.set(a,l),i(l,[a])}for(var s1=0;s1<sT.length;s1++){var i1=sT[s1],FO=i1.toLowerCase(),SO=i1[0].toUpperCase()+i1.slice(1);ec(FO,"on"+SO)}ec(ZS,"onAnimationEnd"),ec(eT,"onAnimationIteration"),ec(tT,"onAnimationStart"),ec("dblclick","onDoubleClick"),ec("focusin","onFocus"),ec("focusout","onBlur"),ec(nT,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var O2="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),TO=new Set("cancel close invalid load scroll toggle".split(" ").concat(O2));function iT(a,l,p){var y=a.type||"unknown-event";a.currentTarget=p,m2(y,l,void 0,a),a.currentTarget=null}function aT(a,l){l=(l&4)!==0;for(var p=0;p<a.length;p++){var y=a[p],v=y.event;y=y.listeners;e:{var E=void 0;if(l)for(var M=y.length-1;0<=M;M--){var W=y[M],Q=W.instance,te=W.currentTarget;if(W=W.listener,Q!==E&&v.isPropagationStopped())break e;iT(v,W,te),E=Q}else for(M=0;M<y.length;M++){if(W=y[M],Q=W.instance,te=W.currentTarget,W=W.listener,Q!==E&&v.isPropagationStopped())break e;iT(v,W,te),E=Q}}}if(up)throw a=Ys,up=!1,Ys=null,a}function $t(a,l){var p=l[p1];p===void 0&&(p=l[p1]=new Set);var y=a+"__bubble";p.has(y)||(oT(l,a,2,!1),p.add(y))}function a1(a,l,p){var y=0;l&&(y|=4),oT(p,a,y,l)}var nv="_reactListening"+Math.random().toString(36).slice(2);function B2(a){if(!a[nv]){a[nv]=!0,n.forEach(function(p){p!=="selectionchange"&&(TO.has(p)||a1(p,!1,a),a1(p,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[nv]||(l[nv]=!0,a1("selectionchange",!1,l))}}function oT(a,l,p,y){switch(wp(l)){case 1:var v=fa;break;case 4:v=q0;break;default:v=T2}p=v.bind(null,l,p,a),v=void 0,!Gl||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(v=!0),y?v!==void 0?a.addEventListener(l,p,{capture:!0,passive:v}):a.addEventListener(l,p,!0):v!==void 0?a.addEventListener(l,p,{passive:v}):a.addEventListener(l,p,!1)}function o1(a,l,p,y,v){var E=y;if((l&1)===0&&(l&2)===0&&y!==null)e:for(;;){if(y===null)return;var M=y.tag;if(M===3||M===4){var W=y.stateNode.containerInfo;if(W===v||W.nodeType===8&&W.parentNode===v)break;if(M===4)for(M=y.return;M!==null;){var Q=M.tag;if((Q===3||Q===4)&&(Q=M.stateNode.containerInfo,Q===v||Q.nodeType===8&&Q.parentNode===v))return;M=M.return}for(;W!==null;){if(M=rd(W),M===null)return;if(Q=M.tag,Q===5||Q===6){y=E=M;continue e}W=W.parentNode}}y=y.return}L0(function(){var te=E,le=cp(p),ue=[];e:{var oe=rT.get(a);if(oe!==void 0){var Ee=td,Te=a;switch(a){case"keypress":if(ed(p)===0)break e;case"keydown":case"keyup":Ee=Et;break;case"focusin":Te="focus",Ee=rr;break;case"focusout":Te="blur",Ee=rr;break;case"beforeblur":case"afterblur":Ee=rr;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ee=I2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ee=X0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ee=wa;break;case ZS:case eT:case tT:Ee=J0;break;case nT:Ee=bp;break;case"scroll":Ee=Ap;break;case"wheel":Ee=dO;break;case"copy":case"cut":case"paste":Ee=m;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ee=ws}var Ie=(l&4)!==0,An=!Ie&&a==="scroll",J=Ie?oe!==null?oe+"Capture":null:oe;Ie=[];for(var X=te,ee;X!==null;){ee=X;var he=ee.stateNode;if(ee.tag===5&&he!==null&&(ee=he,J!==null&&(he=Hu(X,J),he!=null&&Ie.push(V2(X,he,ee)))),An)break;X=X.return}0<Ie.length&&(oe=new Ee(oe,Te,null,p,le),ue.push({event:oe,listeners:Ie}))}}if((l&7)===0){e:{if(oe=a==="mouseover"||a==="pointerover",Ee=a==="mouseout"||a==="pointerout",oe&&p!==zl&&(Te=p.relatedTarget||p.fromElement)&&(rd(Te)||Te[So]))break e;if((Ee||oe)&&(oe=le.window===le?le:(oe=le.ownerDocument)?oe.defaultView||oe.parentWindow:window,Ee?(Te=p.relatedTarget||p.toElement,Ee=te,Te=Te?rd(Te):null,Te!==null&&(An=ki(Te),Te!==An||Te.tag!==5&&Te.tag!==6)&&(Te=null)):(Ee=null,Te=te),Ee!==Te)){if(Ie=I2,he="onMouseLeave",J="onMouseEnter",X="mouse",(a==="pointerout"||a==="pointerover")&&(Ie=ws,he="onPointerLeave",J="onPointerEnter",X="pointer"),An=Ee==null?oe:Ip(Ee),ee=Te==null?oe:Ip(Te),oe=new Ie(he,X+"leave",Ee,p,le),oe.target=An,oe.relatedTarget=ee,he=null,rd(le)===te&&(Ie=new Ie(J,X+"enter",Te,p,le),Ie.target=ee,Ie.relatedTarget=An,he=Ie),An=he,Ee&&Te)t:{for(Ie=Ee,J=Te,X=0,ee=Ie;ee;ee=Tp(ee))X++;for(ee=0,he=J;he;he=Tp(he))ee++;for(;0<X-ee;)Ie=Tp(Ie),X--;for(;0<ee-X;)J=Tp(J),ee--;for(;X--;){if(Ie===J||J!==null&&Ie===J.alternate)break t;Ie=Tp(Ie),J=Tp(J)}Ie=null}else Ie=null;Ee!==null&&lT(ue,oe,Ee,Ie,!1),Te!==null&&An!==null&&lT(ue,An,Te,Ie,!0)}}e:{if(oe=te?Ip(te):window,Ee=oe.nodeName&&oe.nodeName.toLowerCase(),Ee==="select"||Ee==="input"&&oe.type==="file")var Re=wO;else if(jS(oe))if(zS)Re=xO;else{Re=AO;var Be=vO}else(Ee=oe.nodeName)&&Ee.toLowerCase()==="input"&&(oe.type==="checkbox"||oe.type==="radio")&&(Re=_O);if(Re&&(Re=Re(a,te))){$S(ue,Re,p,le);break e}Be&&Be(a,oe,te),a==="focusout"&&(Be=oe._wrapperState)&&Be.controlled&&oe.type==="number"&&Cn(oe,"number",oe.value)}switch(Be=te?Ip(te):window,a){case"focusin":(jS(Be)||Be.contentEditable==="true")&&(Fp=Be,t1=te,L2=null);break;case"focusout":L2=t1=Fp=null;break;case"mousedown":n1=!0;break;case"contextmenu":case"mouseup":case"dragend":n1=!1,YS(ue,p,le);break;case"selectionchange":if(CO)break;case"keydown":case"keyup":YS(ue,p,le)}var Ve;if(Yx)e:{switch(a){case"compositionstart":var ze="onCompositionStart";break e;case"compositionend":ze="onCompositionEnd";break e;case"compositionupdate":ze="onCompositionUpdate";break e}ze=void 0}else Cp?VS(a,p)&&(ze="onCompositionEnd"):a==="keydown"&&p.keyCode===229&&(ze="onCompositionStart");ze&&(LS&&p.locale!=="ko"&&(Cp||ze!=="onCompositionStart"?ze==="onCompositionEnd"&&Cp&&(Ve=Q0()):(gs=le,vp="value"in gs?gs.value:gs.textContent,Cp=!0)),Be=rv(te,ze),0<Be.length&&(ze=new k(ze,a,null,p,le),ue.push({event:ze,listeners:Be}),Ve?ze.data=Ve:(Ve=US(p),Ve!==null&&(ze.data=Ve)))),(Ve=pO?fO(a,p):mO(a,p))&&(te=rv(te,"onBeforeInput"),0<te.length&&(le=new k("onBeforeInput","beforeinput",null,p,le),ue.push({event:le,listeners:te}),le.data=Ve))}aT(ue,l)})}function V2(a,l,p){return{instance:a,listener:l,currentTarget:p}}function rv(a,l){for(var p=l+"Capture",y=[];a!==null;){var v=a,E=v.stateNode;v.tag===5&&E!==null&&(v=E,E=Hu(a,p),E!=null&&y.unshift(V2(a,E,v)),E=Hu(a,l),E!=null&&y.push(V2(a,E,v))),a=a.return}return y}function Tp(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function lT(a,l,p,y,v){for(var E=l._reactName,M=[];p!==null&&p!==y;){var W=p,Q=W.alternate,te=W.stateNode;if(Q!==null&&Q===y)break;W.tag===5&&te!==null&&(W=te,v?(Q=Hu(p,E),Q!=null&&M.unshift(V2(p,Q,W))):v||(Q=Hu(p,E),Q!=null&&M.push(V2(p,Q,W)))),p=p.return}M.length!==0&&a.push({event:l,listeners:M})}var kO=/\r\n?/g,IO=/\u0000|\uFFFD/g;function cT(a){return(typeof a=="string"?a:""+a).replace(kO,`
`).replace(IO,"")}function sv(a,l,p){if(l=cT(l),cT(a)!==l&&p)throw Error(t(425))}function iv(){}var l1=null,c1=null;function u1(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var d1=typeof setTimeout=="function"?setTimeout:void 0,PO=typeof clearTimeout=="function"?clearTimeout:void 0,uT=typeof Promise=="function"?Promise:void 0,RO=typeof queueMicrotask=="function"?queueMicrotask:typeof uT<"u"?function(a){return uT.resolve(null).then(a).catch(DO)}:d1;function DO(a){setTimeout(function(){throw a})}function h1(a,l){var p=l,y=0;do{var v=p.nextSibling;if(a.removeChild(p),v&&v.nodeType===8)if(p=v.data,p==="/$"){if(y===0){a.removeChild(v),Yl(l);return}y--}else p!=="$"&&p!=="$?"&&p!=="$!"||y++;p=v}while(p);Yl(l)}function tc(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return a}function dT(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var p=a.data;if(p==="$"||p==="$!"||p==="$?"){if(l===0)return a;l--}else p==="/$"&&l++}a=a.previousSibling}return null}var kp=Math.random().toString(36).slice(2),Aa="__reactFiber$"+kp,U2="__reactProps$"+kp,So="__reactContainer$"+kp,p1="__reactEvents$"+kp,NO="__reactListeners$"+kp,MO="__reactHandles$"+kp;function rd(a){var l=a[Aa];if(l)return l;for(var p=a.parentNode;p;){if(l=p[So]||p[Aa]){if(p=l.alternate,l.child!==null||p!==null&&p.child!==null)for(a=dT(a);a!==null;){if(p=a[Aa])return p;a=dT(a)}return l}a=p,p=a.parentNode}return null}function j2(a){return a=a[Aa]||a[So],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function Ip(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function av(a){return a[U2]||null}var f1=[],Pp=-1;function nc(a){return{current:a}}function zt(a){0>Pp||(a.current=f1[Pp],f1[Pp]=null,Pp--)}function Lt(a,l){Pp++,f1[Pp]=a.current,a.current=l}var rc={},_r=nc(rc),Qr=nc(!1),sd=rc;function Rp(a,l){var p=a.type.contextTypes;if(!p)return rc;var y=a.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===l)return y.__reactInternalMemoizedMaskedChildContext;var v={},E;for(E in p)v[E]=l[E];return y&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=l,a.__reactInternalMemoizedMaskedChildContext=v),v}function Kr(a){return a=a.childContextTypes,a!=null}function ov(){zt(Qr),zt(_r)}function hT(a,l,p){if(_r.current!==rc)throw Error(t(168));Lt(_r,l),Lt(Qr,p)}function pT(a,l,p){var y=a.stateNode;if(l=l.childContextTypes,typeof y.getChildContext!="function")return p;y=y.getChildContext();for(var v in y)if(!(v in l))throw Error(t(108,Me(a)||"Unknown",v));return de({},p,y)}function lv(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||rc,sd=_r.current,Lt(_r,a),Lt(Qr,Qr.current),!0}function fT(a,l,p){var y=a.stateNode;if(!y)throw Error(t(169));p?(a=pT(a,l,sd),y.__reactInternalMemoizedMergedChildContext=a,zt(Qr),zt(_r),Lt(_r,a)):zt(Qr),Lt(Qr,p)}var To=null,cv=!1,m1=!1;function mT(a){To===null?To=[a]:To.push(a)}function LO(a){cv=!0,mT(a)}function sc(){if(!m1&&To!==null){m1=!0;var a=0,l=ot;try{var p=To;for(ot=1;a<p.length;a++){var y=p[a];do y=y(!0);while(y!==null)}To=null,cv=!1}catch(v){throw To!==null&&(To=To.slice(a+1)),y2(hp,sc),v}finally{ot=l,m1=!1}}return null}var Dp=[],Np=0,uv=null,dv=0,Zs=[],ei=0,id=null,ko=1,Io="";function ad(a,l){Dp[Np++]=dv,Dp[Np++]=uv,uv=a,dv=l}function gT(a,l,p){Zs[ei++]=ko,Zs[ei++]=Io,Zs[ei++]=id,id=a;var y=ko;a=Io;var v=32-fs(y)-1;y&=~(1<<v),p+=1;var E=32-fs(l)+v;if(30<E){var M=v-v%5;E=(y&(1<<M)-1).toString(32),y>>=M,v-=M,ko=1<<32-fs(l)+v|p<<v|y,Io=E+a}else ko=1<<E|p<<v|y,Io=a}function g1(a){a.return!==null&&(ad(a,1),gT(a,1,0))}function y1(a){for(;a===uv;)uv=Dp[--Np],Dp[Np]=null,dv=Dp[--Np],Dp[Np]=null;for(;a===id;)id=Zs[--ei],Zs[ei]=null,Io=Zs[--ei],Zs[ei]=null,ko=Zs[--ei],Zs[ei]=null}var vs=null,As=null,qt=!1,Ri=null;function yT(a,l){var p=si(5,null,null,0);p.elementType="DELETED",p.stateNode=l,p.return=a,l=a.deletions,l===null?(a.deletions=[p],a.flags|=16):l.push(p)}function wT(a,l){switch(a.tag){case 5:var p=a.type;return l=l.nodeType!==1||p.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(a.stateNode=l,vs=a,As=tc(l.firstChild),!0):!1;case 6:return l=a.pendingProps===""||l.nodeType!==3?null:l,l!==null?(a.stateNode=l,vs=a,As=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(p=id!==null?{id:ko,overflow:Io}:null,a.memoizedState={dehydrated:l,treeContext:p,retryLane:1073741824},p=si(18,null,null,0),p.stateNode=l,p.return=a,a.child=p,vs=a,As=null,!0):!1;default:return!1}}function w1(a){return(a.mode&1)!==0&&(a.flags&128)===0}function v1(a){if(qt){var l=As;if(l){var p=l;if(!wT(a,l)){if(w1(a))throw Error(t(418));l=tc(p.nextSibling);var y=vs;l&&wT(a,l)?yT(y,p):(a.flags=a.flags&-4097|2,qt=!1,vs=a)}}else{if(w1(a))throw Error(t(418));a.flags=a.flags&-4097|2,qt=!1,vs=a}}}function vT(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;vs=a}function hv(a){if(a!==vs)return!1;if(!qt)return vT(a),qt=!0,!1;var l;if((l=a.tag!==3)&&!(l=a.tag!==5)&&(l=a.type,l=l!=="head"&&l!=="body"&&!u1(a.type,a.memoizedProps)),l&&(l=As)){if(w1(a))throw AT(),Error(t(418));for(;l;)yT(a,l),l=tc(l.nextSibling)}if(vT(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,l=0;a;){if(a.nodeType===8){var p=a.data;if(p==="/$"){if(l===0){As=tc(a.nextSibling);break e}l--}else p!=="$"&&p!=="$!"&&p!=="$?"||l++}a=a.nextSibling}As=null}}else As=vs?tc(a.stateNode.nextSibling):null;return!0}function AT(){for(var a=As;a;)a=tc(a.nextSibling)}function Mp(){As=vs=null,qt=!1}function A1(a){Ri===null?Ri=[a]:Ri.push(a)}var OO=V.ReactCurrentBatchConfig;function $2(a,l,p){if(a=p.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(t(309));var y=p.stateNode}if(!y)throw Error(t(147,a));var v=y,E=""+a;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===E?l.ref:(l=function(M){var W=v.refs;M===null?delete W[E]:W[E]=M},l._stringRef=E,l)}if(typeof a!="string")throw Error(t(284));if(!p._owner)throw Error(t(290,a))}return a}function pv(a,l){throw a=Object.prototype.toString.call(l),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a))}function _T(a){var l=a._init;return l(a._payload)}function xT(a){function l(J,X){if(a){var ee=J.deletions;ee===null?(J.deletions=[X],J.flags|=16):ee.push(X)}}function p(J,X){if(!a)return null;for(;X!==null;)l(J,X),X=X.sibling;return null}function y(J,X){for(J=new Map;X!==null;)X.key!==null?J.set(X.key,X):J.set(X.index,X),X=X.sibling;return J}function v(J,X){return J=hc(J,X),J.index=0,J.sibling=null,J}function E(J,X,ee){return J.index=ee,a?(ee=J.alternate,ee!==null?(ee=ee.index,ee<X?(J.flags|=2,X):ee):(J.flags|=2,X)):(J.flags|=1048576,X)}function M(J){return a&&J.alternate===null&&(J.flags|=2),J}function W(J,X,ee,he){return X===null||X.tag!==6?(X=dE(ee,J.mode,he),X.return=J,X):(X=v(X,ee),X.return=J,X)}function Q(J,X,ee,he){var Re=ee.type;return Re===R?le(J,X,ee.props.children,he,ee.key):X!==null&&(X.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===ye&&_T(Re)===X.type)?(he=v(X,ee.props),he.ref=$2(J,X,ee),he.return=J,he):(he=Ov(ee.type,ee.key,ee.props,null,J.mode,he),he.ref=$2(J,X,ee),he.return=J,he)}function te(J,X,ee,he){return X===null||X.tag!==4||X.stateNode.containerInfo!==ee.containerInfo||X.stateNode.implementation!==ee.implementation?(X=hE(ee,J.mode,he),X.return=J,X):(X=v(X,ee.children||[]),X.return=J,X)}function le(J,X,ee,he,Re){return X===null||X.tag!==7?(X=fd(ee,J.mode,he,Re),X.return=J,X):(X=v(X,ee),X.return=J,X)}function ue(J,X,ee){if(typeof X=="string"&&X!==""||typeof X=="number")return X=dE(""+X,J.mode,ee),X.return=J,X;if(typeof X=="object"&&X!==null){switch(X.$$typeof){case z:return ee=Ov(X.type,X.key,X.props,null,J.mode,ee),ee.ref=$2(J,null,X),ee.return=J,ee;case H:return X=hE(X,J.mode,ee),X.return=J,X;case ye:var he=X._init;return ue(J,he(X._payload),ee)}if(wn(X)||we(X))return X=fd(X,J.mode,ee,null),X.return=J,X;pv(J,X)}return null}function oe(J,X,ee,he){var Re=X!==null?X.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number")return Re!==null?null:W(J,X,""+ee,he);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case z:return ee.key===Re?Q(J,X,ee,he):null;case H:return ee.key===Re?te(J,X,ee,he):null;case ye:return Re=ee._init,oe(J,X,Re(ee._payload),he)}if(wn(ee)||we(ee))return Re!==null?null:le(J,X,ee,he,null);pv(J,ee)}return null}function Ee(J,X,ee,he,Re){if(typeof he=="string"&&he!==""||typeof he=="number")return J=J.get(ee)||null,W(X,J,""+he,Re);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case z:return J=J.get(he.key===null?ee:he.key)||null,Q(X,J,he,Re);case H:return J=J.get(he.key===null?ee:he.key)||null,te(X,J,he,Re);case ye:var Be=he._init;return Ee(J,X,ee,Be(he._payload),Re)}if(wn(he)||we(he))return J=J.get(ee)||null,le(X,J,he,Re,null);pv(X,he)}return null}function Te(J,X,ee,he){for(var Re=null,Be=null,Ve=X,ze=X=0,qn=null;Ve!==null&&ze<ee.length;ze++){Ve.index>ze?(qn=Ve,Ve=null):qn=Ve.sibling;var mt=oe(J,Ve,ee[ze],he);if(mt===null){Ve===null&&(Ve=qn);break}a&&Ve&&mt.alternate===null&&l(J,Ve),X=E(mt,X,ze),Be===null?Re=mt:Be.sibling=mt,Be=mt,Ve=qn}if(ze===ee.length)return p(J,Ve),qt&&ad(J,ze),Re;if(Ve===null){for(;ze<ee.length;ze++)Ve=ue(J,ee[ze],he),Ve!==null&&(X=E(Ve,X,ze),Be===null?Re=Ve:Be.sibling=Ve,Be=Ve);return qt&&ad(J,ze),Re}for(Ve=y(J,Ve);ze<ee.length;ze++)qn=Ee(Ve,J,ze,ee[ze],he),qn!==null&&(a&&qn.alternate!==null&&Ve.delete(qn.key===null?ze:qn.key),X=E(qn,X,ze),Be===null?Re=qn:Be.sibling=qn,Be=qn);return a&&Ve.forEach(function(pc){return l(J,pc)}),qt&&ad(J,ze),Re}function Ie(J,X,ee,he){var Re=we(ee);if(typeof Re!="function")throw Error(t(150));if(ee=Re.call(ee),ee==null)throw Error(t(151));for(var Be=Re=null,Ve=X,ze=X=0,qn=null,mt=ee.next();Ve!==null&&!mt.done;ze++,mt=ee.next()){Ve.index>ze?(qn=Ve,Ve=null):qn=Ve.sibling;var pc=oe(J,Ve,mt.value,he);if(pc===null){Ve===null&&(Ve=qn);break}a&&Ve&&pc.alternate===null&&l(J,Ve),X=E(pc,X,ze),Be===null?Re=pc:Be.sibling=pc,Be=pc,Ve=qn}if(mt.done)return p(J,Ve),qt&&ad(J,ze),Re;if(Ve===null){for(;!mt.done;ze++,mt=ee.next())mt=ue(J,mt.value,he),mt!==null&&(X=E(mt,X,ze),Be===null?Re=mt:Be.sibling=mt,Be=mt);return qt&&ad(J,ze),Re}for(Ve=y(J,Ve);!mt.done;ze++,mt=ee.next())mt=Ee(Ve,J,ze,mt.value,he),mt!==null&&(a&&mt.alternate!==null&&Ve.delete(mt.key===null?ze:mt.key),X=E(mt,X,ze),Be===null?Re=mt:Be.sibling=mt,Be=mt);return a&&Ve.forEach(function(g4){return l(J,g4)}),qt&&ad(J,ze),Re}function An(J,X,ee,he){if(typeof ee=="object"&&ee!==null&&ee.type===R&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case z:e:{for(var Re=ee.key,Be=X;Be!==null;){if(Be.key===Re){if(Re=ee.type,Re===R){if(Be.tag===7){p(J,Be.sibling),X=v(Be,ee.props.children),X.return=J,J=X;break e}}else if(Be.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===ye&&_T(Re)===Be.type){p(J,Be.sibling),X=v(Be,ee.props),X.ref=$2(J,Be,ee),X.return=J,J=X;break e}p(J,Be);break}else l(J,Be);Be=Be.sibling}ee.type===R?(X=fd(ee.props.children,J.mode,he,ee.key),X.return=J,J=X):(he=Ov(ee.type,ee.key,ee.props,null,J.mode,he),he.ref=$2(J,X,ee),he.return=J,J=he)}return M(J);case H:e:{for(Be=ee.key;X!==null;){if(X.key===Be)if(X.tag===4&&X.stateNode.containerInfo===ee.containerInfo&&X.stateNode.implementation===ee.implementation){p(J,X.sibling),X=v(X,ee.children||[]),X.return=J,J=X;break e}else{p(J,X);break}else l(J,X);X=X.sibling}X=hE(ee,J.mode,he),X.return=J,J=X}return M(J);case ye:return Be=ee._init,An(J,X,Be(ee._payload),he)}if(wn(ee))return Te(J,X,ee,he);if(we(ee))return Ie(J,X,ee,he);pv(J,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"?(ee=""+ee,X!==null&&X.tag===6?(p(J,X.sibling),X=v(X,ee),X.return=J,J=X):(p(J,X),X=dE(ee,J.mode,he),X.return=J,J=X),M(J)):p(J,X)}return An}var Lp=xT(!0),ET=xT(!1),fv=nc(null),mv=null,Op=null,_1=null;function x1(){_1=Op=mv=null}function E1(a){var l=fv.current;zt(fv),a._currentValue=l}function b1(a,l,p){for(;a!==null;){var y=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,y!==null&&(y.childLanes|=l)):y!==null&&(y.childLanes&l)!==l&&(y.childLanes|=l),a===p)break;a=a.return}}function Bp(a,l){mv=a,_1=Op=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&l)!==0&&(Xr=!0),a.firstContext=null)}function ti(a){var l=a._currentValue;if(_1!==a)if(a={context:a,memoizedValue:l,next:null},Op===null){if(mv===null)throw Error(t(308));Op=a,mv.dependencies={lanes:0,firstContext:a}}else Op=Op.next=a;return l}var od=null;function C1(a){od===null?od=[a]:od.push(a)}function bT(a,l,p,y){var v=l.interleaved;return v===null?(p.next=p,C1(l)):(p.next=v.next,v.next=p),l.interleaved=p,Po(a,y)}function Po(a,l){a.lanes|=l;var p=a.alternate;for(p!==null&&(p.lanes|=l),p=a,a=a.return;a!==null;)a.childLanes|=l,p=a.alternate,p!==null&&(p.childLanes|=l),p=a,a=a.return;return p.tag===3?p.stateNode:null}var ic=!1;function F1(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function CT(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function Ro(a,l){return{eventTime:a,lane:l,tag:0,payload:null,callback:null,next:null}}function ac(a,l,p){var y=a.updateQueue;if(y===null)return null;if(y=y.shared,(ht&2)!==0){var v=y.pending;return v===null?l.next=l:(l.next=v.next,v.next=l),y.pending=l,Po(a,p)}return v=y.interleaved,v===null?(l.next=l,C1(y)):(l.next=v.next,v.next=l),y.interleaved=l,Po(a,p)}function gv(a,l,p){if(l=l.updateQueue,l!==null&&(l=l.shared,(p&4194240)!==0)){var y=l.lanes;y&=a.pendingLanes,p|=y,l.lanes=p,E2(a,p)}}function FT(a,l){var p=a.updateQueue,y=a.alternate;if(y!==null&&(y=y.updateQueue,p===y)){var v=null,E=null;if(p=p.firstBaseUpdate,p!==null){do{var M={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};E===null?v=E=M:E=E.next=M,p=p.next}while(p!==null);E===null?v=E=l:E=E.next=l}else v=E=l;p={baseState:y.baseState,firstBaseUpdate:v,lastBaseUpdate:E,shared:y.shared,effects:y.effects},a.updateQueue=p;return}a=p.lastBaseUpdate,a===null?p.firstBaseUpdate=l:a.next=l,p.lastBaseUpdate=l}function yv(a,l,p,y){var v=a.updateQueue;ic=!1;var E=v.firstBaseUpdate,M=v.lastBaseUpdate,W=v.shared.pending;if(W!==null){v.shared.pending=null;var Q=W,te=Q.next;Q.next=null,M===null?E=te:M.next=te,M=Q;var le=a.alternate;le!==null&&(le=le.updateQueue,W=le.lastBaseUpdate,W!==M&&(W===null?le.firstBaseUpdate=te:W.next=te,le.lastBaseUpdate=Q))}if(E!==null){var ue=v.baseState;M=0,le=te=Q=null,W=E;do{var oe=W.lane,Ee=W.eventTime;if((y&oe)===oe){le!==null&&(le=le.next={eventTime:Ee,lane:0,tag:W.tag,payload:W.payload,callback:W.callback,next:null});e:{var Te=a,Ie=W;switch(oe=l,Ee=p,Ie.tag){case 1:if(Te=Ie.payload,typeof Te=="function"){ue=Te.call(Ee,ue,oe);break e}ue=Te;break e;case 3:Te.flags=Te.flags&-65537|128;case 0:if(Te=Ie.payload,oe=typeof Te=="function"?Te.call(Ee,ue,oe):Te,oe==null)break e;ue=de({},ue,oe);break e;case 2:ic=!0}}W.callback!==null&&W.lane!==0&&(a.flags|=64,oe=v.effects,oe===null?v.effects=[W]:oe.push(W))}else Ee={eventTime:Ee,lane:oe,tag:W.tag,payload:W.payload,callback:W.callback,next:null},le===null?(te=le=Ee,Q=ue):le=le.next=Ee,M|=oe;if(W=W.next,W===null){if(W=v.shared.pending,W===null)break;oe=W,W=oe.next,oe.next=null,v.lastBaseUpdate=oe,v.shared.pending=null}}while(!0);if(le===null&&(Q=ue),v.baseState=Q,v.firstBaseUpdate=te,v.lastBaseUpdate=le,l=v.shared.interleaved,l!==null){v=l;do M|=v.lane,v=v.next;while(v!==l)}else E===null&&(v.shared.lanes=0);ud|=M,a.lanes=M,a.memoizedState=ue}}function ST(a,l,p){if(a=l.effects,l.effects=null,a!==null)for(l=0;l<a.length;l++){var y=a[l],v=y.callback;if(v!==null){if(y.callback=null,y=p,typeof v!="function")throw Error(t(191,v));v.call(y)}}}var z2={},_a=nc(z2),H2=nc(z2),W2=nc(z2);function ld(a){if(a===z2)throw Error(t(174));return a}function S1(a,l){switch(Lt(W2,l),Lt(H2,a),Lt(_a,z2),a=l.nodeType,a){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:ap(null,"");break;default:a=a===8?l.parentNode:l,l=a.namespaceURI||null,a=a.tagName,l=ap(l,a)}zt(_a),Lt(_a,l)}function Vp(){zt(_a),zt(H2),zt(W2)}function TT(a){ld(W2.current);var l=ld(_a.current),p=ap(l,a.type);l!==p&&(Lt(H2,a),Lt(_a,p))}function T1(a){H2.current===a&&(zt(_a),zt(H2))}var en=nc(0);function wv(a){for(var l=a;l!==null;){if(l.tag===13){var p=l.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var k1=[];function I1(){for(var a=0;a<k1.length;a++)k1[a]._workInProgressVersionPrimary=null;k1.length=0}var vv=V.ReactCurrentDispatcher,P1=V.ReactCurrentBatchConfig,cd=0,tn=null,Ln=null,Wn=null,Av=!1,G2=!1,q2=0,BO=0;function xr(){throw Error(t(321))}function R1(a,l){if(l===null)return!1;for(var p=0;p<l.length&&p<a.length;p++)if(!Pi(a[p],l[p]))return!1;return!0}function D1(a,l,p,y,v,E){if(cd=E,tn=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,vv.current=a===null||a.memoizedState===null?$O:zO,a=p(y,v),G2){E=0;do{if(G2=!1,q2=0,25<=E)throw Error(t(301));E+=1,Wn=Ln=null,l.updateQueue=null,vv.current=HO,a=p(y,v)}while(G2)}if(vv.current=Ev,l=Ln!==null&&Ln.next!==null,cd=0,Wn=Ln=tn=null,Av=!1,l)throw Error(t(300));return a}function N1(){var a=q2!==0;return q2=0,a}function xa(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wn===null?tn.memoizedState=Wn=a:Wn=Wn.next=a,Wn}function ni(){if(Ln===null){var a=tn.alternate;a=a!==null?a.memoizedState:null}else a=Ln.next;var l=Wn===null?tn.memoizedState:Wn.next;if(l!==null)Wn=l,Ln=a;else{if(a===null)throw Error(t(310));Ln=a,a={memoizedState:Ln.memoizedState,baseState:Ln.baseState,baseQueue:Ln.baseQueue,queue:Ln.queue,next:null},Wn===null?tn.memoizedState=Wn=a:Wn=Wn.next=a}return Wn}function Q2(a,l){return typeof l=="function"?l(a):l}function M1(a){var l=ni(),p=l.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=a;var y=Ln,v=y.baseQueue,E=p.pending;if(E!==null){if(v!==null){var M=v.next;v.next=E.next,E.next=M}y.baseQueue=v=E,p.pending=null}if(v!==null){E=v.next,y=y.baseState;var W=M=null,Q=null,te=E;do{var le=te.lane;if((cd&le)===le)Q!==null&&(Q=Q.next={lane:0,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null}),y=te.hasEagerState?te.eagerState:a(y,te.action);else{var ue={lane:le,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null};Q===null?(W=Q=ue,M=y):Q=Q.next=ue,tn.lanes|=le,ud|=le}te=te.next}while(te!==null&&te!==E);Q===null?M=y:Q.next=W,Pi(y,l.memoizedState)||(Xr=!0),l.memoizedState=y,l.baseState=M,l.baseQueue=Q,p.lastRenderedState=y}if(a=p.interleaved,a!==null){v=a;do E=v.lane,tn.lanes|=E,ud|=E,v=v.next;while(v!==a)}else v===null&&(p.lanes=0);return[l.memoizedState,p.dispatch]}function L1(a){var l=ni(),p=l.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=a;var y=p.dispatch,v=p.pending,E=l.memoizedState;if(v!==null){p.pending=null;var M=v=v.next;do E=a(E,M.action),M=M.next;while(M!==v);Pi(E,l.memoizedState)||(Xr=!0),l.memoizedState=E,l.baseQueue===null&&(l.baseState=E),p.lastRenderedState=E}return[E,y]}function kT(){}function IT(a,l){var p=tn,y=ni(),v=l(),E=!Pi(y.memoizedState,v);if(E&&(y.memoizedState=v,Xr=!0),y=y.queue,O1(DT.bind(null,p,y,a),[a]),y.getSnapshot!==l||E||Wn!==null&&Wn.memoizedState.tag&1){if(p.flags|=2048,K2(9,RT.bind(null,p,y,v,l),void 0,null),Gn===null)throw Error(t(349));(cd&30)!==0||PT(p,l,v)}return v}function PT(a,l,p){a.flags|=16384,a={getSnapshot:l,value:p},l=tn.updateQueue,l===null?(l={lastEffect:null,stores:null},tn.updateQueue=l,l.stores=[a]):(p=l.stores,p===null?l.stores=[a]:p.push(a))}function RT(a,l,p,y){l.value=p,l.getSnapshot=y,NT(l)&&MT(a)}function DT(a,l,p){return p(function(){NT(l)&&MT(a)})}function NT(a){var l=a.getSnapshot;a=a.value;try{var p=l();return!Pi(a,p)}catch{return!0}}function MT(a){var l=Po(a,1);l!==null&&Li(l,a,1,-1)}function LT(a){var l=xa();return typeof a=="function"&&(a=a()),l.memoizedState=l.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Q2,lastRenderedState:a},l.queue=a,a=a.dispatch=jO.bind(null,tn,a),[l.memoizedState,a]}function K2(a,l,p,y){return a={tag:a,create:l,destroy:p,deps:y,next:null},l=tn.updateQueue,l===null?(l={lastEffect:null,stores:null},tn.updateQueue=l,l.lastEffect=a.next=a):(p=l.lastEffect,p===null?l.lastEffect=a.next=a:(y=p.next,p.next=a,a.next=y,l.lastEffect=a)),a}function OT(){return ni().memoizedState}function _v(a,l,p,y){var v=xa();tn.flags|=a,v.memoizedState=K2(1|l,p,void 0,y===void 0?null:y)}function xv(a,l,p,y){var v=ni();y=y===void 0?null:y;var E=void 0;if(Ln!==null){var M=Ln.memoizedState;if(E=M.destroy,y!==null&&R1(y,M.deps)){v.memoizedState=K2(l,p,E,y);return}}tn.flags|=a,v.memoizedState=K2(1|l,p,E,y)}function BT(a,l){return _v(8390656,8,a,l)}function O1(a,l){return xv(2048,8,a,l)}function VT(a,l){return xv(4,2,a,l)}function UT(a,l){return xv(4,4,a,l)}function jT(a,l){if(typeof l=="function")return a=a(),l(a),function(){l(null)};if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function $T(a,l,p){return p=p!=null?p.concat([a]):null,xv(4,4,jT.bind(null,l,a),p)}function B1(){}function zT(a,l){var p=ni();l=l===void 0?null:l;var y=p.memoizedState;return y!==null&&l!==null&&R1(l,y[1])?y[0]:(p.memoizedState=[a,l],a)}function HT(a,l){var p=ni();l=l===void 0?null:l;var y=p.memoizedState;return y!==null&&l!==null&&R1(l,y[1])?y[0]:(a=a(),p.memoizedState=[a,l],a)}function WT(a,l,p){return(cd&21)===0?(a.baseState&&(a.baseState=!1,Xr=!0),a.memoizedState=p):(Pi(p,l)||(p=_2(),tn.lanes|=p,ud|=p,a.baseState=!0),l)}function VO(a,l){var p=ot;ot=p!==0&&4>p?p:4,a(!0);var y=P1.transition;P1.transition={};try{a(!1),l()}finally{ot=p,P1.transition=y}}function GT(){return ni().memoizedState}function UO(a,l,p){var y=uc(a);if(p={lane:y,action:p,hasEagerState:!1,eagerState:null,next:null},qT(a))QT(l,p);else if(p=bT(a,l,p,y),p!==null){var v=Or();Li(p,a,y,v),KT(p,l,y)}}function jO(a,l,p){var y=uc(a),v={lane:y,action:p,hasEagerState:!1,eagerState:null,next:null};if(qT(a))QT(l,v);else{var E=a.alternate;if(a.lanes===0&&(E===null||E.lanes===0)&&(E=l.lastRenderedReducer,E!==null))try{var M=l.lastRenderedState,W=E(M,p);if(v.hasEagerState=!0,v.eagerState=W,Pi(W,M)){var Q=l.interleaved;Q===null?(v.next=v,C1(l)):(v.next=Q.next,Q.next=v),l.interleaved=v;return}}catch{}finally{}p=bT(a,l,v,y),p!==null&&(v=Or(),Li(p,a,y,v),KT(p,l,y))}}function qT(a){var l=a.alternate;return a===tn||l!==null&&l===tn}function QT(a,l){G2=Av=!0;var p=a.pending;p===null?l.next=l:(l.next=p.next,p.next=l),a.pending=l}function KT(a,l,p){if((p&4194240)!==0){var y=l.lanes;y&=a.pendingLanes,p|=y,l.lanes=p,E2(a,p)}}var Ev={readContext:ti,useCallback:xr,useContext:xr,useEffect:xr,useImperativeHandle:xr,useInsertionEffect:xr,useLayoutEffect:xr,useMemo:xr,useReducer:xr,useRef:xr,useState:xr,useDebugValue:xr,useDeferredValue:xr,useTransition:xr,useMutableSource:xr,useSyncExternalStore:xr,useId:xr,unstable_isNewReconciler:!1},$O={readContext:ti,useCallback:function(a,l){return xa().memoizedState=[a,l===void 0?null:l],a},useContext:ti,useEffect:BT,useImperativeHandle:function(a,l,p){return p=p!=null?p.concat([a]):null,_v(4194308,4,jT.bind(null,l,a),p)},useLayoutEffect:function(a,l){return _v(4194308,4,a,l)},useInsertionEffect:function(a,l){return _v(4,2,a,l)},useMemo:function(a,l){var p=xa();return l=l===void 0?null:l,a=a(),p.memoizedState=[a,l],a},useReducer:function(a,l,p){var y=xa();return l=p!==void 0?p(l):l,y.memoizedState=y.baseState=l,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:l},y.queue=a,a=a.dispatch=UO.bind(null,tn,a),[y.memoizedState,a]},useRef:function(a){var l=xa();return a={current:a},l.memoizedState=a},useState:LT,useDebugValue:B1,useDeferredValue:function(a){return xa().memoizedState=a},useTransition:function(){var a=LT(!1),l=a[0];return a=VO.bind(null,a[1]),xa().memoizedState=a,[l,a]},useMutableSource:function(){},useSyncExternalStore:function(a,l,p){var y=tn,v=xa();if(qt){if(p===void 0)throw Error(t(407));p=p()}else{if(p=l(),Gn===null)throw Error(t(349));(cd&30)!==0||PT(y,l,p)}v.memoizedState=p;var E={value:p,getSnapshot:l};return v.queue=E,BT(DT.bind(null,y,E,a),[a]),y.flags|=2048,K2(9,RT.bind(null,y,E,p,l),void 0,null),p},useId:function(){var a=xa(),l=Gn.identifierPrefix;if(qt){var p=Io,y=ko;p=(y&~(1<<32-fs(y)-1)).toString(32)+p,l=":"+l+"R"+p,p=q2++,0<p&&(l+="H"+p.toString(32)),l+=":"}else p=BO++,l=":"+l+"r"+p.toString(32)+":";return a.memoizedState=l},unstable_isNewReconciler:!1},zO={readContext:ti,useCallback:zT,useContext:ti,useEffect:O1,useImperativeHandle:$T,useInsertionEffect:VT,useLayoutEffect:UT,useMemo:HT,useReducer:M1,useRef:OT,useState:function(){return M1(Q2)},useDebugValue:B1,useDeferredValue:function(a){var l=ni();return WT(l,Ln.memoizedState,a)},useTransition:function(){var a=M1(Q2)[0],l=ni().memoizedState;return[a,l]},useMutableSource:kT,useSyncExternalStore:IT,useId:GT,unstable_isNewReconciler:!1},HO={readContext:ti,useCallback:zT,useContext:ti,useEffect:O1,useImperativeHandle:$T,useInsertionEffect:VT,useLayoutEffect:UT,useMemo:HT,useReducer:L1,useRef:OT,useState:function(){return L1(Q2)},useDebugValue:B1,useDeferredValue:function(a){var l=ni();return Ln===null?l.memoizedState=a:WT(l,Ln.memoizedState,a)},useTransition:function(){var a=L1(Q2)[0],l=ni().memoizedState;return[a,l]},useMutableSource:kT,useSyncExternalStore:IT,useId:GT,unstable_isNewReconciler:!1};function Di(a,l){if(a&&a.defaultProps){l=de({},l),a=a.defaultProps;for(var p in a)l[p]===void 0&&(l[p]=a[p]);return l}return l}function V1(a,l,p,y){l=a.memoizedState,p=p(y,l),p=p==null?l:de({},l,p),a.memoizedState=p,a.lanes===0&&(a.updateQueue.baseState=p)}var bv={isMounted:function(a){return(a=a._reactInternals)?ki(a)===a:!1},enqueueSetState:function(a,l,p){a=a._reactInternals;var y=Or(),v=uc(a),E=Ro(y,v);E.payload=l,p!=null&&(E.callback=p),l=ac(a,E,v),l!==null&&(Li(l,a,v,y),gv(l,a,v))},enqueueReplaceState:function(a,l,p){a=a._reactInternals;var y=Or(),v=uc(a),E=Ro(y,v);E.tag=1,E.payload=l,p!=null&&(E.callback=p),l=ac(a,E,v),l!==null&&(Li(l,a,v,y),gv(l,a,v))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var p=Or(),y=uc(a),v=Ro(p,y);v.tag=2,l!=null&&(v.callback=l),l=ac(a,v,y),l!==null&&(Li(l,a,y,p),gv(l,a,y))}};function XT(a,l,p,y,v,E,M){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(y,E,M):l.prototype&&l.prototype.isPureReactComponent?!M2(p,y)||!M2(v,E):!0}function YT(a,l,p){var y=!1,v=rc,E=l.contextType;return typeof E=="object"&&E!==null?E=ti(E):(v=Kr(l)?sd:_r.current,y=l.contextTypes,E=(y=y!=null)?Rp(a,v):rc),l=new l(p,E),a.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=bv,a.stateNode=l,l._reactInternals=a,y&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=v,a.__reactInternalMemoizedMaskedChildContext=E),l}function JT(a,l,p,y){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(p,y),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(p,y),l.state!==a&&bv.enqueueReplaceState(l,l.state,null)}function U1(a,l,p,y){var v=a.stateNode;v.props=p,v.state=a.memoizedState,v.refs={},F1(a);var E=l.contextType;typeof E=="object"&&E!==null?v.context=ti(E):(E=Kr(l)?sd:_r.current,v.context=Rp(a,E)),v.state=a.memoizedState,E=l.getDerivedStateFromProps,typeof E=="function"&&(V1(a,l,E,p),v.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(l=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),l!==v.state&&bv.enqueueReplaceState(v,v.state,null),yv(a,p,v,y),v.state=a.memoizedState),typeof v.componentDidMount=="function"&&(a.flags|=4194308)}function Up(a,l){try{var p="",y=l;do p+=ke(y),y=y.return;while(y);var v=p}catch(E){v=`
Error generating stack: `+E.message+`
`+E.stack}return{value:a,source:l,stack:v,digest:null}}function j1(a,l,p){return{value:a,source:null,stack:p??null,digest:l??null}}function $1(a,l){try{console.error(l.value)}catch(p){setTimeout(function(){throw p})}}var WO=typeof WeakMap=="function"?WeakMap:Map;function ZT(a,l,p){p=Ro(-1,p),p.tag=3,p.payload={element:null};var y=l.value;return p.callback=function(){Pv||(Pv=!0,rE=y),$1(a,l)},p}function ek(a,l,p){p=Ro(-1,p),p.tag=3;var y=a.type.getDerivedStateFromError;if(typeof y=="function"){var v=l.value;p.payload=function(){return y(v)},p.callback=function(){$1(a,l)}}var E=a.stateNode;return E!==null&&typeof E.componentDidCatch=="function"&&(p.callback=function(){$1(a,l),typeof y!="function"&&(lc===null?lc=new Set([this]):lc.add(this));var M=l.stack;this.componentDidCatch(l.value,{componentStack:M!==null?M:""})}),p}function tk(a,l,p){var y=a.pingCache;if(y===null){y=a.pingCache=new WO;var v=new Set;y.set(l,v)}else v=y.get(l),v===void 0&&(v=new Set,y.set(l,v));v.has(p)||(v.add(p),a=i4.bind(null,a,l,p),l.then(a,a))}function nk(a){do{var l;if((l=a.tag===13)&&(l=a.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return a;a=a.return}while(a!==null);return null}function rk(a,l,p,y,v){return(a.mode&1)===0?(a===l?a.flags|=65536:(a.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(l=Ro(-1,1),l.tag=2,ac(p,l,1))),p.lanes|=1),a):(a.flags|=65536,a.lanes=v,a)}var GO=V.ReactCurrentOwner,Xr=!1;function Lr(a,l,p,y){l.child=a===null?ET(l,null,p,y):Lp(l,a.child,p,y)}function sk(a,l,p,y,v){p=p.render;var E=l.ref;return Bp(l,v),y=D1(a,l,p,y,E,v),p=N1(),a!==null&&!Xr?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~v,Do(a,l,v)):(qt&&p&&g1(l),l.flags|=1,Lr(a,l,y,v),l.child)}function ik(a,l,p,y,v){if(a===null){var E=p.type;return typeof E=="function"&&!uE(E)&&E.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(l.tag=15,l.type=E,ak(a,l,E,y,v)):(a=Ov(p.type,null,y,l,l.mode,v),a.ref=l.ref,a.return=l,l.child=a)}if(E=a.child,(a.lanes&v)===0){var M=E.memoizedProps;if(p=p.compare,p=p!==null?p:M2,p(M,y)&&a.ref===l.ref)return Do(a,l,v)}return l.flags|=1,a=hc(E,y),a.ref=l.ref,a.return=l,l.child=a}function ak(a,l,p,y,v){if(a!==null){var E=a.memoizedProps;if(M2(E,y)&&a.ref===l.ref)if(Xr=!1,l.pendingProps=y=E,(a.lanes&v)!==0)(a.flags&131072)!==0&&(Xr=!0);else return l.lanes=a.lanes,Do(a,l,v)}return z1(a,l,p,y,v)}function ok(a,l,p){var y=l.pendingProps,v=y.children,E=a!==null?a.memoizedState:null;if(y.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},Lt($p,_s),_s|=p;else{if((p&1073741824)===0)return a=E!==null?E.baseLanes|p:p,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:a,cachePool:null,transitions:null},l.updateQueue=null,Lt($p,_s),_s|=a,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=E!==null?E.baseLanes:p,Lt($p,_s),_s|=y}else E!==null?(y=E.baseLanes|p,l.memoizedState=null):y=p,Lt($p,_s),_s|=y;return Lr(a,l,v,p),l.child}function lk(a,l){var p=l.ref;(a===null&&p!==null||a!==null&&a.ref!==p)&&(l.flags|=512,l.flags|=2097152)}function z1(a,l,p,y,v){var E=Kr(p)?sd:_r.current;return E=Rp(l,E),Bp(l,v),p=D1(a,l,p,y,E,v),y=N1(),a!==null&&!Xr?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~v,Do(a,l,v)):(qt&&y&&g1(l),l.flags|=1,Lr(a,l,p,v),l.child)}function ck(a,l,p,y,v){if(Kr(p)){var E=!0;lv(l)}else E=!1;if(Bp(l,v),l.stateNode===null)Fv(a,l),YT(l,p,y),U1(l,p,y,v),y=!0;else if(a===null){var M=l.stateNode,W=l.memoizedProps;M.props=W;var Q=M.context,te=p.contextType;typeof te=="object"&&te!==null?te=ti(te):(te=Kr(p)?sd:_r.current,te=Rp(l,te));var le=p.getDerivedStateFromProps,ue=typeof le=="function"||typeof M.getSnapshotBeforeUpdate=="function";ue||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(W!==y||Q!==te)&&JT(l,M,y,te),ic=!1;var oe=l.memoizedState;M.state=oe,yv(l,y,M,v),Q=l.memoizedState,W!==y||oe!==Q||Qr.current||ic?(typeof le=="function"&&(V1(l,p,le,y),Q=l.memoizedState),(W=ic||XT(l,p,W,y,oe,Q,te))?(ue||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount=="function"&&(l.flags|=4194308)):(typeof M.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=y,l.memoizedState=Q),M.props=y,M.state=Q,M.context=te,y=W):(typeof M.componentDidMount=="function"&&(l.flags|=4194308),y=!1)}else{M=l.stateNode,CT(a,l),W=l.memoizedProps,te=l.type===l.elementType?W:Di(l.type,W),M.props=te,ue=l.pendingProps,oe=M.context,Q=p.contextType,typeof Q=="object"&&Q!==null?Q=ti(Q):(Q=Kr(p)?sd:_r.current,Q=Rp(l,Q));var Ee=p.getDerivedStateFromProps;(le=typeof Ee=="function"||typeof M.getSnapshotBeforeUpdate=="function")||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(W!==ue||oe!==Q)&&JT(l,M,y,Q),ic=!1,oe=l.memoizedState,M.state=oe,yv(l,y,M,v);var Te=l.memoizedState;W!==ue||oe!==Te||Qr.current||ic?(typeof Ee=="function"&&(V1(l,p,Ee,y),Te=l.memoizedState),(te=ic||XT(l,p,te,y,oe,Te,Q)||!1)?(le||typeof M.UNSAFE_componentWillUpdate!="function"&&typeof M.componentWillUpdate!="function"||(typeof M.componentWillUpdate=="function"&&M.componentWillUpdate(y,Te,Q),typeof M.UNSAFE_componentWillUpdate=="function"&&M.UNSAFE_componentWillUpdate(y,Te,Q)),typeof M.componentDidUpdate=="function"&&(l.flags|=4),typeof M.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof M.componentDidUpdate!="function"||W===a.memoizedProps&&oe===a.memoizedState||(l.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||W===a.memoizedProps&&oe===a.memoizedState||(l.flags|=1024),l.memoizedProps=y,l.memoizedState=Te),M.props=y,M.state=Te,M.context=Q,y=te):(typeof M.componentDidUpdate!="function"||W===a.memoizedProps&&oe===a.memoizedState||(l.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||W===a.memoizedProps&&oe===a.memoizedState||(l.flags|=1024),y=!1)}return H1(a,l,p,y,E,v)}function H1(a,l,p,y,v,E){lk(a,l);var M=(l.flags&128)!==0;if(!y&&!M)return v&&fT(l,p,!1),Do(a,l,E);y=l.stateNode,GO.current=l;var W=M&&typeof p.getDerivedStateFromError!="function"?null:y.render();return l.flags|=1,a!==null&&M?(l.child=Lp(l,a.child,null,E),l.child=Lp(l,null,W,E)):Lr(a,l,W,E),l.memoizedState=y.state,v&&fT(l,p,!0),l.child}function uk(a){var l=a.stateNode;l.pendingContext?hT(a,l.pendingContext,l.pendingContext!==l.context):l.context&&hT(a,l.context,!1),S1(a,l.containerInfo)}function dk(a,l,p,y,v){return Mp(),A1(v),l.flags|=256,Lr(a,l,p,y),l.child}var W1={dehydrated:null,treeContext:null,retryLane:0};function G1(a){return{baseLanes:a,cachePool:null,transitions:null}}function hk(a,l,p){var y=l.pendingProps,v=en.current,E=!1,M=(l.flags&128)!==0,W;if((W=M)||(W=a!==null&&a.memoizedState===null?!1:(v&2)!==0),W?(E=!0,l.flags&=-129):(a===null||a.memoizedState!==null)&&(v|=1),Lt(en,v&1),a===null)return v1(l),a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((l.mode&1)===0?l.lanes=1:a.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(M=y.children,a=y.fallback,E?(y=l.mode,E=l.child,M={mode:"hidden",children:M},(y&1)===0&&E!==null?(E.childLanes=0,E.pendingProps=M):E=Bv(M,y,0,null),a=fd(a,y,p,null),E.return=l,a.return=l,E.sibling=a,l.child=E,l.child.memoizedState=G1(p),l.memoizedState=W1,a):q1(l,M));if(v=a.memoizedState,v!==null&&(W=v.dehydrated,W!==null))return qO(a,l,M,y,W,v,p);if(E){E=y.fallback,M=l.mode,v=a.child,W=v.sibling;var Q={mode:"hidden",children:y.children};return(M&1)===0&&l.child!==v?(y=l.child,y.childLanes=0,y.pendingProps=Q,l.deletions=null):(y=hc(v,Q),y.subtreeFlags=v.subtreeFlags&14680064),W!==null?E=hc(W,E):(E=fd(E,M,p,null),E.flags|=2),E.return=l,y.return=l,y.sibling=E,l.child=y,y=E,E=l.child,M=a.child.memoizedState,M=M===null?G1(p):{baseLanes:M.baseLanes|p,cachePool:null,transitions:M.transitions},E.memoizedState=M,E.childLanes=a.childLanes&~p,l.memoizedState=W1,y}return E=a.child,a=E.sibling,y=hc(E,{mode:"visible",children:y.children}),(l.mode&1)===0&&(y.lanes=p),y.return=l,y.sibling=null,a!==null&&(p=l.deletions,p===null?(l.deletions=[a],l.flags|=16):p.push(a)),l.child=y,l.memoizedState=null,y}function q1(a,l){return l=Bv({mode:"visible",children:l},a.mode,0,null),l.return=a,a.child=l}function Cv(a,l,p,y){return y!==null&&A1(y),Lp(l,a.child,null,p),a=q1(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function qO(a,l,p,y,v,E,M){if(p)return l.flags&256?(l.flags&=-257,y=j1(Error(t(422))),Cv(a,l,M,y)):l.memoizedState!==null?(l.child=a.child,l.flags|=128,null):(E=y.fallback,v=l.mode,y=Bv({mode:"visible",children:y.children},v,0,null),E=fd(E,v,M,null),E.flags|=2,y.return=l,E.return=l,y.sibling=E,l.child=y,(l.mode&1)!==0&&Lp(l,a.child,null,M),l.child.memoizedState=G1(M),l.memoizedState=W1,E);if((l.mode&1)===0)return Cv(a,l,M,null);if(v.data==="$!"){if(y=v.nextSibling&&v.nextSibling.dataset,y)var W=y.dgst;return y=W,E=Error(t(419)),y=j1(E,y,void 0),Cv(a,l,M,y)}if(W=(M&a.childLanes)!==0,Xr||W){if(y=Gn,y!==null){switch(M&-M){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(y.suspendedLanes|M))!==0?0:v,v!==0&&v!==E.retryLane&&(E.retryLane=v,Po(a,v),Li(y,a,v,-1))}return cE(),y=j1(Error(t(421))),Cv(a,l,M,y)}return v.data==="$?"?(l.flags|=128,l.child=a.child,l=a4.bind(null,a),v._reactRetry=l,null):(a=E.treeContext,As=tc(v.nextSibling),vs=l,qt=!0,Ri=null,a!==null&&(Zs[ei++]=ko,Zs[ei++]=Io,Zs[ei++]=id,ko=a.id,Io=a.overflow,id=l),l=q1(l,y.children),l.flags|=4096,l)}function pk(a,l,p){a.lanes|=l;var y=a.alternate;y!==null&&(y.lanes|=l),b1(a.return,l,p)}function Q1(a,l,p,y,v){var E=a.memoizedState;E===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:y,tail:p,tailMode:v}:(E.isBackwards=l,E.rendering=null,E.renderingStartTime=0,E.last=y,E.tail=p,E.tailMode=v)}function fk(a,l,p){var y=l.pendingProps,v=y.revealOrder,E=y.tail;if(Lr(a,l,y.children,p),y=en.current,(y&2)!==0)y=y&1|2,l.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&pk(a,p,l);else if(a.tag===19)pk(a,p,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}y&=1}if(Lt(en,y),(l.mode&1)===0)l.memoizedState=null;else switch(v){case"forwards":for(p=l.child,v=null;p!==null;)a=p.alternate,a!==null&&wv(a)===null&&(v=p),p=p.sibling;p=v,p===null?(v=l.child,l.child=null):(v=p.sibling,p.sibling=null),Q1(l,!1,v,p,E);break;case"backwards":for(p=null,v=l.child,l.child=null;v!==null;){if(a=v.alternate,a!==null&&wv(a)===null){l.child=v;break}a=v.sibling,v.sibling=p,p=v,v=a}Q1(l,!0,p,null,E);break;case"together":Q1(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Fv(a,l){(l.mode&1)===0&&a!==null&&(a.alternate=null,l.alternate=null,l.flags|=2)}function Do(a,l,p){if(a!==null&&(l.dependencies=a.dependencies),ud|=l.lanes,(p&l.childLanes)===0)return null;if(a!==null&&l.child!==a.child)throw Error(t(153));if(l.child!==null){for(a=l.child,p=hc(a,a.pendingProps),l.child=p,p.return=l;a.sibling!==null;)a=a.sibling,p=p.sibling=hc(a,a.pendingProps),p.return=l;p.sibling=null}return l.child}function QO(a,l,p){switch(l.tag){case 3:uk(l),Mp();break;case 5:TT(l);break;case 1:Kr(l.type)&&lv(l);break;case 4:S1(l,l.stateNode.containerInfo);break;case 10:var y=l.type._context,v=l.memoizedProps.value;Lt(fv,y._currentValue),y._currentValue=v;break;case 13:if(y=l.memoizedState,y!==null)return y.dehydrated!==null?(Lt(en,en.current&1),l.flags|=128,null):(p&l.child.childLanes)!==0?hk(a,l,p):(Lt(en,en.current&1),a=Do(a,l,p),a!==null?a.sibling:null);Lt(en,en.current&1);break;case 19:if(y=(p&l.childLanes)!==0,(a.flags&128)!==0){if(y)return fk(a,l,p);l.flags|=128}if(v=l.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),Lt(en,en.current),y)break;return null;case 22:case 23:return l.lanes=0,ok(a,l,p)}return Do(a,l,p)}var mk,K1,gk,yk;mk=function(a,l){for(var p=l.child;p!==null;){if(p.tag===5||p.tag===6)a.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===l)break;for(;p.sibling===null;){if(p.return===null||p.return===l)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},K1=function(){},gk=function(a,l,p,y){var v=a.memoizedProps;if(v!==y){a=l.stateNode,ld(_a.current);var E=null;switch(p){case"input":v=Zt(a,v),y=Zt(a,y),E=[];break;case"select":v=de({},v,{value:void 0}),y=de({},y,{value:void 0}),E=[];break;case"textarea":v=u2(a,v),y=u2(a,y),E=[];break;default:typeof v.onClick!="function"&&typeof y.onClick=="function"&&(a.onclick=iv)}Ti(p,y);var M;p=null;for(te in v)if(!y.hasOwnProperty(te)&&v.hasOwnProperty(te)&&v[te]!=null)if(te==="style"){var W=v[te];for(M in W)W.hasOwnProperty(M)&&(p||(p={}),p[M]="")}else te!=="dangerouslySetInnerHTML"&&te!=="children"&&te!=="suppressContentEditableWarning"&&te!=="suppressHydrationWarning"&&te!=="autoFocus"&&(r.hasOwnProperty(te)?E||(E=[]):(E=E||[]).push(te,null));for(te in y){var Q=y[te];if(W=v!=null?v[te]:void 0,y.hasOwnProperty(te)&&Q!==W&&(Q!=null||W!=null))if(te==="style")if(W){for(M in W)!W.hasOwnProperty(M)||Q&&Q.hasOwnProperty(M)||(p||(p={}),p[M]="");for(M in Q)Q.hasOwnProperty(M)&&W[M]!==Q[M]&&(p||(p={}),p[M]=Q[M])}else p||(E||(E=[]),E.push(te,p)),p=Q;else te==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,W=W?W.__html:void 0,Q!=null&&W!==Q&&(E=E||[]).push(te,Q)):te==="children"?typeof Q!="string"&&typeof Q!="number"||(E=E||[]).push(te,""+Q):te!=="suppressContentEditableWarning"&&te!=="suppressHydrationWarning"&&(r.hasOwnProperty(te)?(Q!=null&&te==="onScroll"&&$t("scroll",a),E||W===Q||(E=[])):(E=E||[]).push(te,Q))}p&&(E=E||[]).push("style",p);var te=E;(l.updateQueue=te)&&(l.flags|=4)}},yk=function(a,l,p,y){p!==y&&(l.flags|=4)};function X2(a,l){if(!qt)switch(a.tailMode){case"hidden":l=a.tail;for(var p=null;l!==null;)l.alternate!==null&&(p=l),l=l.sibling;p===null?a.tail=null:p.sibling=null;break;case"collapsed":p=a.tail;for(var y=null;p!==null;)p.alternate!==null&&(y=p),p=p.sibling;y===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:y.sibling=null}}function Er(a){var l=a.alternate!==null&&a.alternate.child===a.child,p=0,y=0;if(l)for(var v=a.child;v!==null;)p|=v.lanes|v.childLanes,y|=v.subtreeFlags&14680064,y|=v.flags&14680064,v.return=a,v=v.sibling;else for(v=a.child;v!==null;)p|=v.lanes|v.childLanes,y|=v.subtreeFlags,y|=v.flags,v.return=a,v=v.sibling;return a.subtreeFlags|=y,a.childLanes=p,l}function KO(a,l,p){var y=l.pendingProps;switch(y1(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Er(l),null;case 1:return Kr(l.type)&&ov(),Er(l),null;case 3:return y=l.stateNode,Vp(),zt(Qr),zt(_r),I1(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(a===null||a.child===null)&&(hv(l)?l.flags|=4:a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Ri!==null&&(aE(Ri),Ri=null))),K1(a,l),Er(l),null;case 5:T1(l);var v=ld(W2.current);if(p=l.type,a!==null&&l.stateNode!=null)gk(a,l,p,y,v),a.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!y){if(l.stateNode===null)throw Error(t(166));return Er(l),null}if(a=ld(_a.current),hv(l)){y=l.stateNode,p=l.type;var E=l.memoizedProps;switch(y[Aa]=l,y[U2]=E,a=(l.mode&1)!==0,p){case"dialog":$t("cancel",y),$t("close",y);break;case"iframe":case"object":case"embed":$t("load",y);break;case"video":case"audio":for(v=0;v<O2.length;v++)$t(O2[v],y);break;case"source":$t("error",y);break;case"img":case"image":case"link":$t("error",y),$t("load",y);break;case"details":$t("toggle",y);break;case"input":Bl(y,E),$t("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!E.multiple},$t("invalid",y);break;case"textarea":d2(y,E),$t("invalid",y)}Ti(p,E),v=null;for(var M in E)if(E.hasOwnProperty(M)){var W=E[M];M==="children"?typeof W=="string"?y.textContent!==W&&(E.suppressHydrationWarning!==!0&&sv(y.textContent,W,a),v=["children",W]):typeof W=="number"&&y.textContent!==""+W&&(E.suppressHydrationWarning!==!0&&sv(y.textContent,W,a),v=["children",""+W]):r.hasOwnProperty(M)&&W!=null&&M==="onScroll"&&$t("scroll",y)}switch(p){case"input":vr(y),c2(y,E,!0);break;case"textarea":vr(y),Vl(y);break;case"select":case"option":break;default:typeof E.onClick=="function"&&(y.onclick=iv)}y=v,l.updateQueue=y,y!==null&&(l.flags|=4)}else{M=v.nodeType===9?v:v.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=h2(p)),a==="http://www.w3.org/1999/xhtml"?p==="script"?(a=M.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof y.is=="string"?a=M.createElement(p,{is:y.is}):(a=M.createElement(p),p==="select"&&(M=a,y.multiple?M.multiple=!0:y.size&&(M.size=y.size))):a=M.createElementNS(a,p),a[Aa]=l,a[U2]=y,mk(a,l,!1,!1),l.stateNode=a;e:{switch(M=lp(p,y),p){case"dialog":$t("cancel",a),$t("close",a),v=y;break;case"iframe":case"object":case"embed":$t("load",a),v=y;break;case"video":case"audio":for(v=0;v<O2.length;v++)$t(O2[v],a);v=y;break;case"source":$t("error",a),v=y;break;case"img":case"image":case"link":$t("error",a),$t("load",a),v=y;break;case"details":$t("toggle",a),v=y;break;case"input":Bl(a,y),v=Zt(a,y),$t("invalid",a);break;case"option":v=y;break;case"select":a._wrapperState={wasMultiple:!!y.multiple},v=de({},y,{value:void 0}),$t("invalid",a);break;case"textarea":d2(a,y),v=u2(a,y),$t("invalid",a);break;default:v=y}Ti(p,v),W=v;for(E in W)if(W.hasOwnProperty(E)){var Q=W[E];E==="style"?op(a,Q):E==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,Q!=null&&R0(a,Q)):E==="children"?typeof Q=="string"?(p!=="textarea"||Q!=="")&&zu(a,Q):typeof Q=="number"&&zu(a,""+Q):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(r.hasOwnProperty(E)?Q!=null&&E==="onScroll"&&$t("scroll",a):Q!=null&&N(a,E,Q,M))}switch(p){case"input":vr(a),c2(a,y,!1);break;case"textarea":vr(a),Vl(a);break;case"option":y.value!=null&&a.setAttribute("value",""+et(y.value));break;case"select":a.multiple=!!y.multiple,E=y.value,E!=null?Si(a,!!y.multiple,E,!1):y.defaultValue!=null&&Si(a,!!y.multiple,y.defaultValue,!0);break;default:typeof v.onClick=="function"&&(a.onclick=iv)}switch(p){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return Er(l),null;case 6:if(a&&l.stateNode!=null)yk(a,l,a.memoizedProps,y);else{if(typeof y!="string"&&l.stateNode===null)throw Error(t(166));if(p=ld(W2.current),ld(_a.current),hv(l)){if(y=l.stateNode,p=l.memoizedProps,y[Aa]=l,(E=y.nodeValue!==p)&&(a=vs,a!==null))switch(a.tag){case 3:sv(y.nodeValue,p,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&sv(y.nodeValue,p,(a.mode&1)!==0)}E&&(l.flags|=4)}else y=(p.nodeType===9?p:p.ownerDocument).createTextNode(y),y[Aa]=l,l.stateNode=y}return Er(l),null;case 13:if(zt(en),y=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(qt&&As!==null&&(l.mode&1)!==0&&(l.flags&128)===0)AT(),Mp(),l.flags|=98560,E=!1;else if(E=hv(l),y!==null&&y.dehydrated!==null){if(a===null){if(!E)throw Error(t(318));if(E=l.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(t(317));E[Aa]=l}else Mp(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Er(l),E=!1}else Ri!==null&&(aE(Ri),Ri=null),E=!0;if(!E)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=p,l):(y=y!==null,y!==(a!==null&&a.memoizedState!==null)&&y&&(l.child.flags|=8192,(l.mode&1)!==0&&(a===null||(en.current&1)!==0?On===0&&(On=3):cE())),l.updateQueue!==null&&(l.flags|=4),Er(l),null);case 4:return Vp(),K1(a,l),a===null&&B2(l.stateNode.containerInfo),Er(l),null;case 10:return E1(l.type._context),Er(l),null;case 17:return Kr(l.type)&&ov(),Er(l),null;case 19:if(zt(en),E=l.memoizedState,E===null)return Er(l),null;if(y=(l.flags&128)!==0,M=E.rendering,M===null)if(y)X2(E,!1);else{if(On!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(M=wv(a),M!==null){for(l.flags|=128,X2(E,!1),y=M.updateQueue,y!==null&&(l.updateQueue=y,l.flags|=4),l.subtreeFlags=0,y=p,p=l.child;p!==null;)E=p,a=y,E.flags&=14680066,M=E.alternate,M===null?(E.childLanes=0,E.lanes=a,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=M.childLanes,E.lanes=M.lanes,E.child=M.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=M.memoizedProps,E.memoizedState=M.memoizedState,E.updateQueue=M.updateQueue,E.type=M.type,a=M.dependencies,E.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),p=p.sibling;return Lt(en,en.current&1|2),l.child}a=a.sibling}E.tail!==null&&jt()>zp&&(l.flags|=128,y=!0,X2(E,!1),l.lanes=4194304)}else{if(!y)if(a=wv(M),a!==null){if(l.flags|=128,y=!0,p=a.updateQueue,p!==null&&(l.updateQueue=p,l.flags|=4),X2(E,!0),E.tail===null&&E.tailMode==="hidden"&&!M.alternate&&!qt)return Er(l),null}else 2*jt()-E.renderingStartTime>zp&&p!==1073741824&&(l.flags|=128,y=!0,X2(E,!1),l.lanes=4194304);E.isBackwards?(M.sibling=l.child,l.child=M):(p=E.last,p!==null?p.sibling=M:l.child=M,E.last=M)}return E.tail!==null?(l=E.tail,E.rendering=l,E.tail=l.sibling,E.renderingStartTime=jt(),l.sibling=null,p=en.current,Lt(en,y?p&1|2:p&1),l):(Er(l),null);case 22:case 23:return lE(),y=l.memoizedState!==null,a!==null&&a.memoizedState!==null!==y&&(l.flags|=8192),y&&(l.mode&1)!==0?(_s&1073741824)!==0&&(Er(l),l.subtreeFlags&6&&(l.flags|=8192)):Er(l),null;case 24:return null;case 25:return null}throw Error(t(156,l.tag))}function XO(a,l){switch(y1(l),l.tag){case 1:return Kr(l.type)&&ov(),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return Vp(),zt(Qr),zt(_r),I1(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 5:return T1(l),null;case 13:if(zt(en),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(t(340));Mp()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return zt(en),null;case 4:return Vp(),null;case 10:return E1(l.type._context),null;case 22:case 23:return lE(),null;case 24:return null;default:return null}}var Sv=!1,br=!1,YO=typeof WeakSet=="function"?WeakSet:Set,Se=null;function jp(a,l){var p=a.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(y){cn(a,l,y)}else p.current=null}function X1(a,l,p){try{p()}catch(y){cn(a,l,y)}}var wk=!1;function JO(a,l){if(l1=bo,a=XS(),e1(a)){if("selectionStart"in a)var p={start:a.selectionStart,end:a.selectionEnd};else e:{p=(p=a.ownerDocument)&&p.defaultView||window;var y=p.getSelection&&p.getSelection();if(y&&y.rangeCount!==0){p=y.anchorNode;var v=y.anchorOffset,E=y.focusNode;y=y.focusOffset;try{p.nodeType,E.nodeType}catch{p=null;break e}var M=0,W=-1,Q=-1,te=0,le=0,ue=a,oe=null;t:for(;;){for(var Ee;ue!==p||v!==0&&ue.nodeType!==3||(W=M+v),ue!==E||y!==0&&ue.nodeType!==3||(Q=M+y),ue.nodeType===3&&(M+=ue.nodeValue.length),(Ee=ue.firstChild)!==null;)oe=ue,ue=Ee;for(;;){if(ue===a)break t;if(oe===p&&++te===v&&(W=M),oe===E&&++le===y&&(Q=M),(Ee=ue.nextSibling)!==null)break;ue=oe,oe=ue.parentNode}ue=Ee}p=W===-1||Q===-1?null:{start:W,end:Q}}else p=null}p=p||{start:0,end:0}}else p=null;for(c1={focusedElem:a,selectionRange:p},bo=!1,Se=l;Se!==null;)if(l=Se,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,Se=a;else for(;Se!==null;){l=Se;try{var Te=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(Te!==null){var Ie=Te.memoizedProps,An=Te.memoizedState,J=l.stateNode,X=J.getSnapshotBeforeUpdate(l.elementType===l.type?Ie:Di(l.type,Ie),An);J.__reactInternalSnapshotBeforeUpdate=X}break;case 3:var ee=l.stateNode.containerInfo;ee.nodeType===1?ee.textContent="":ee.nodeType===9&&ee.documentElement&&ee.removeChild(ee.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(he){cn(l,l.return,he)}if(a=l.sibling,a!==null){a.return=l.return,Se=a;break}Se=l.return}return Te=wk,wk=!1,Te}function Y2(a,l,p){var y=l.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var v=y=y.next;do{if((v.tag&a)===a){var E=v.destroy;v.destroy=void 0,E!==void 0&&X1(l,p,E)}v=v.next}while(v!==y)}}function Tv(a,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var p=l=l.next;do{if((p.tag&a)===a){var y=p.create;p.destroy=y()}p=p.next}while(p!==l)}}function Y1(a){var l=a.ref;if(l!==null){var p=a.stateNode;switch(a.tag){case 5:a=p;break;default:a=p}typeof l=="function"?l(a):l.current=a}}function vk(a){var l=a.alternate;l!==null&&(a.alternate=null,vk(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&(delete l[Aa],delete l[U2],delete l[p1],delete l[NO],delete l[MO])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function Ak(a){return a.tag===5||a.tag===3||a.tag===4}function _k(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||Ak(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function J1(a,l,p){var y=a.tag;if(y===5||y===6)a=a.stateNode,l?p.nodeType===8?p.parentNode.insertBefore(a,l):p.insertBefore(a,l):(p.nodeType===8?(l=p.parentNode,l.insertBefore(a,p)):(l=p,l.appendChild(a)),p=p._reactRootContainer,p!=null||l.onclick!==null||(l.onclick=iv));else if(y!==4&&(a=a.child,a!==null))for(J1(a,l,p),a=a.sibling;a!==null;)J1(a,l,p),a=a.sibling}function Z1(a,l,p){var y=a.tag;if(y===5||y===6)a=a.stateNode,l?p.insertBefore(a,l):p.appendChild(a);else if(y!==4&&(a=a.child,a!==null))for(Z1(a,l,p),a=a.sibling;a!==null;)Z1(a,l,p),a=a.sibling}var sr=null,Ni=!1;function oc(a,l,p){for(p=p.child;p!==null;)xk(a,l,p),p=p.sibling}function xk(a,l,p){if(ps&&typeof ps.onCommitFiberUnmount=="function")try{ps.onCommitFiberUnmount(Qu,p)}catch{}switch(p.tag){case 5:br||jp(p,l);case 6:var y=sr,v=Ni;sr=null,oc(a,l,p),sr=y,Ni=v,sr!==null&&(Ni?(a=sr,p=p.stateNode,a.nodeType===8?a.parentNode.removeChild(p):a.removeChild(p)):sr.removeChild(p.stateNode));break;case 18:sr!==null&&(Ni?(a=sr,p=p.stateNode,a.nodeType===8?h1(a.parentNode,p):a.nodeType===1&&h1(a,p),Yl(a)):h1(sr,p.stateNode));break;case 4:y=sr,v=Ni,sr=p.stateNode.containerInfo,Ni=!0,oc(a,l,p),sr=y,Ni=v;break;case 0:case 11:case 14:case 15:if(!br&&(y=p.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){v=y=y.next;do{var E=v,M=E.destroy;E=E.tag,M!==void 0&&((E&2)!==0||(E&4)!==0)&&X1(p,l,M),v=v.next}while(v!==y)}oc(a,l,p);break;case 1:if(!br&&(jp(p,l),y=p.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=p.memoizedProps,y.state=p.memoizedState,y.componentWillUnmount()}catch(W){cn(p,l,W)}oc(a,l,p);break;case 21:oc(a,l,p);break;case 22:p.mode&1?(br=(y=br)||p.memoizedState!==null,oc(a,l,p),br=y):oc(a,l,p);break;default:oc(a,l,p)}}function Ek(a){var l=a.updateQueue;if(l!==null){a.updateQueue=null;var p=a.stateNode;p===null&&(p=a.stateNode=new YO),l.forEach(function(y){var v=o4.bind(null,a,y);p.has(y)||(p.add(y),y.then(v,v))})}}function Mi(a,l){var p=l.deletions;if(p!==null)for(var y=0;y<p.length;y++){var v=p[y];try{var E=a,M=l,W=M;e:for(;W!==null;){switch(W.tag){case 5:sr=W.stateNode,Ni=!1;break e;case 3:sr=W.stateNode.containerInfo,Ni=!0;break e;case 4:sr=W.stateNode.containerInfo,Ni=!0;break e}W=W.return}if(sr===null)throw Error(t(160));xk(E,M,v),sr=null,Ni=!1;var Q=v.alternate;Q!==null&&(Q.return=null),v.return=null}catch(te){cn(v,l,te)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)bk(l,a),l=l.sibling}function bk(a,l){var p=a.alternate,y=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(Mi(l,a),Ea(a),y&4){try{Y2(3,a,a.return),Tv(3,a)}catch(Ie){cn(a,a.return,Ie)}try{Y2(5,a,a.return)}catch(Ie){cn(a,a.return,Ie)}}break;case 1:Mi(l,a),Ea(a),y&512&&p!==null&&jp(p,p.return);break;case 5:if(Mi(l,a),Ea(a),y&512&&p!==null&&jp(p,p.return),a.flags&32){var v=a.stateNode;try{zu(v,"")}catch(Ie){cn(a,a.return,Ie)}}if(y&4&&(v=a.stateNode,v!=null)){var E=a.memoizedProps,M=p!==null?p.memoizedProps:E,W=a.type,Q=a.updateQueue;if(a.updateQueue=null,Q!==null)try{W==="input"&&E.type==="radio"&&E.name!=null&&ip(v,E),lp(W,M);var te=lp(W,E);for(M=0;M<Q.length;M+=2){var le=Q[M],ue=Q[M+1];le==="style"?op(v,ue):le==="dangerouslySetInnerHTML"?R0(v,ue):le==="children"?zu(v,ue):N(v,le,ue,te)}switch(W){case"input":$u(v,E);break;case"textarea":P0(v,E);break;case"select":var oe=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!E.multiple;var Ee=E.value;Ee!=null?Si(v,!!E.multiple,Ee,!1):oe!==!!E.multiple&&(E.defaultValue!=null?Si(v,!!E.multiple,E.defaultValue,!0):Si(v,!!E.multiple,E.multiple?[]:"",!1))}v[U2]=E}catch(Ie){cn(a,a.return,Ie)}}break;case 6:if(Mi(l,a),Ea(a),y&4){if(a.stateNode===null)throw Error(t(162));v=a.stateNode,E=a.memoizedProps;try{v.nodeValue=E}catch(Ie){cn(a,a.return,Ie)}}break;case 3:if(Mi(l,a),Ea(a),y&4&&p!==null&&p.memoizedState.isDehydrated)try{Yl(l.containerInfo)}catch(Ie){cn(a,a.return,Ie)}break;case 4:Mi(l,a),Ea(a);break;case 13:Mi(l,a),Ea(a),v=a.child,v.flags&8192&&(E=v.memoizedState!==null,v.stateNode.isHidden=E,!E||v.alternate!==null&&v.alternate.memoizedState!==null||(nE=jt())),y&4&&Ek(a);break;case 22:if(le=p!==null&&p.memoizedState!==null,a.mode&1?(br=(te=br)||le,Mi(l,a),br=te):Mi(l,a),Ea(a),y&8192){if(te=a.memoizedState!==null,(a.stateNode.isHidden=te)&&!le&&(a.mode&1)!==0)for(Se=a,le=a.child;le!==null;){for(ue=Se=le;Se!==null;){switch(oe=Se,Ee=oe.child,oe.tag){case 0:case 11:case 14:case 15:Y2(4,oe,oe.return);break;case 1:jp(oe,oe.return);var Te=oe.stateNode;if(typeof Te.componentWillUnmount=="function"){y=oe,p=oe.return;try{l=y,Te.props=l.memoizedProps,Te.state=l.memoizedState,Te.componentWillUnmount()}catch(Ie){cn(y,p,Ie)}}break;case 5:jp(oe,oe.return);break;case 22:if(oe.memoizedState!==null){Sk(ue);continue}}Ee!==null?(Ee.return=oe,Se=Ee):Sk(ue)}le=le.sibling}e:for(le=null,ue=a;;){if(ue.tag===5){if(le===null){le=ue;try{v=ue.stateNode,te?(E=v.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none"):(W=ue.stateNode,Q=ue.memoizedProps.style,M=Q!=null&&Q.hasOwnProperty("display")?Q.display:null,W.style.display=$l("display",M))}catch(Ie){cn(a,a.return,Ie)}}}else if(ue.tag===6){if(le===null)try{ue.stateNode.nodeValue=te?"":ue.memoizedProps}catch(Ie){cn(a,a.return,Ie)}}else if((ue.tag!==22&&ue.tag!==23||ue.memoizedState===null||ue===a)&&ue.child!==null){ue.child.return=ue,ue=ue.child;continue}if(ue===a)break e;for(;ue.sibling===null;){if(ue.return===null||ue.return===a)break e;le===ue&&(le=null),ue=ue.return}le===ue&&(le=null),ue.sibling.return=ue.return,ue=ue.sibling}}break;case 19:Mi(l,a),Ea(a),y&4&&Ek(a);break;case 21:break;default:Mi(l,a),Ea(a)}}function Ea(a){var l=a.flags;if(l&2){try{e:{for(var p=a.return;p!==null;){if(Ak(p)){var y=p;break e}p=p.return}throw Error(t(160))}switch(y.tag){case 5:var v=y.stateNode;y.flags&32&&(zu(v,""),y.flags&=-33);var E=_k(a);Z1(a,E,v);break;case 3:case 4:var M=y.stateNode.containerInfo,W=_k(a);J1(a,W,M);break;default:throw Error(t(161))}}catch(Q){cn(a,a.return,Q)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function ZO(a,l,p){Se=a,Ck(a)}function Ck(a,l,p){for(var y=(a.mode&1)!==0;Se!==null;){var v=Se,E=v.child;if(v.tag===22&&y){var M=v.memoizedState!==null||Sv;if(!M){var W=v.alternate,Q=W!==null&&W.memoizedState!==null||br;W=Sv;var te=br;if(Sv=M,(br=Q)&&!te)for(Se=v;Se!==null;)M=Se,Q=M.child,M.tag===22&&M.memoizedState!==null?Tk(v):Q!==null?(Q.return=M,Se=Q):Tk(v);for(;E!==null;)Se=E,Ck(E),E=E.sibling;Se=v,Sv=W,br=te}Fk(a)}else(v.subtreeFlags&8772)!==0&&E!==null?(E.return=v,Se=E):Fk(a)}}function Fk(a){for(;Se!==null;){var l=Se;if((l.flags&8772)!==0){var p=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:br||Tv(5,l);break;case 1:var y=l.stateNode;if(l.flags&4&&!br)if(p===null)y.componentDidMount();else{var v=l.elementType===l.type?p.memoizedProps:Di(l.type,p.memoizedProps);y.componentDidUpdate(v,p.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var E=l.updateQueue;E!==null&&ST(l,E,y);break;case 3:var M=l.updateQueue;if(M!==null){if(p=null,l.child!==null)switch(l.child.tag){case 5:p=l.child.stateNode;break;case 1:p=l.child.stateNode}ST(l,M,p)}break;case 5:var W=l.stateNode;if(p===null&&l.flags&4){p=W;var Q=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":Q.autoFocus&&p.focus();break;case"img":Q.src&&(p.src=Q.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var te=l.alternate;if(te!==null){var le=te.memoizedState;if(le!==null){var ue=le.dehydrated;ue!==null&&Yl(ue)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}br||l.flags&512&&Y1(l)}catch(oe){cn(l,l.return,oe)}}if(l===a){Se=null;break}if(p=l.sibling,p!==null){p.return=l.return,Se=p;break}Se=l.return}}function Sk(a){for(;Se!==null;){var l=Se;if(l===a){Se=null;break}var p=l.sibling;if(p!==null){p.return=l.return,Se=p;break}Se=l.return}}function Tk(a){for(;Se!==null;){var l=Se;try{switch(l.tag){case 0:case 11:case 15:var p=l.return;try{Tv(4,l)}catch(Q){cn(l,p,Q)}break;case 1:var y=l.stateNode;if(typeof y.componentDidMount=="function"){var v=l.return;try{y.componentDidMount()}catch(Q){cn(l,v,Q)}}var E=l.return;try{Y1(l)}catch(Q){cn(l,E,Q)}break;case 5:var M=l.return;try{Y1(l)}catch(Q){cn(l,M,Q)}}}catch(Q){cn(l,l.return,Q)}if(l===a){Se=null;break}var W=l.sibling;if(W!==null){W.return=l.return,Se=W;break}Se=l.return}}var e4=Math.ceil,kv=V.ReactCurrentDispatcher,eE=V.ReactCurrentOwner,ri=V.ReactCurrentBatchConfig,ht=0,Gn=null,Sn=null,ir=0,_s=0,$p=nc(0),On=0,J2=null,ud=0,Iv=0,tE=0,Z2=null,Yr=null,nE=0,zp=1/0,No=null,Pv=!1,rE=null,lc=null,Rv=!1,cc=null,Dv=0,eg=0,sE=null,Nv=-1,Mv=0;function Or(){return(ht&6)!==0?jt():Nv!==-1?Nv:Nv=jt()}function uc(a){return(a.mode&1)===0?1:(ht&2)!==0&&ir!==0?ir&-ir:OO.transition!==null?(Mv===0&&(Mv=_2()),Mv):(a=ot,a!==0||(a=window.event,a=a===void 0?16:wp(a.type)),a)}function Li(a,l,p,y){if(50<eg)throw eg=0,sE=null,Error(t(185));Ju(a,p,y),((ht&2)===0||a!==Gn)&&(a===Gn&&((ht&2)===0&&(Iv|=p),On===4&&dc(a,ir)),Jr(a,y),p===1&&ht===0&&(l.mode&1)===0&&(zp=jt()+500,cv&&sc()))}function Jr(a,l){var p=a.callbackNode;Yu(a,l);var y=_o(a,a===Gn?ir:0);if(y===0)p!==null&&dp(p),a.callbackNode=null,a.callbackPriority=0;else if(l=y&-y,a.callbackPriority!==l){if(p!=null&&dp(p),l===1)a.tag===0?LO(Ik.bind(null,a)):mT(Ik.bind(null,a)),RO(function(){(ht&6)===0&&sc()}),p=null;else{switch(ua(y)){case 1:p=hp;break;case 4:p=w2;break;case 16:p=qu;break;case 536870912:p=pp;break;default:p=qu}p=Bk(p,kk.bind(null,a))}a.callbackPriority=l,a.callbackNode=p}}function kk(a,l){if(Nv=-1,Mv=0,(ht&6)!==0)throw Error(t(327));var p=a.callbackNode;if(Hp()&&a.callbackNode!==p)return null;var y=_o(a,a===Gn?ir:0);if(y===0)return null;if((y&30)!==0||(y&a.expiredLanes)!==0||l)l=Lv(a,y);else{l=y;var v=ht;ht|=2;var E=Rk();(Gn!==a||ir!==l)&&(No=null,zp=jt()+500,hd(a,l));do try{r4();break}catch(W){Pk(a,W)}while(!0);x1(),kv.current=E,ht=v,Sn!==null?l=0:(Gn=null,ir=0,l=On)}if(l!==0){if(l===2&&(v=A2(a),v!==0&&(y=v,l=iE(a,v))),l===1)throw p=J2,hd(a,0),dc(a,y),Jr(a,jt()),p;if(l===6)dc(a,y);else{if(v=a.current.alternate,(y&30)===0&&!t4(v)&&(l=Lv(a,y),l===2&&(E=A2(a),E!==0&&(y=E,l=iE(a,E))),l===1))throw p=J2,hd(a,0),dc(a,y),Jr(a,jt()),p;switch(a.finishedWork=v,a.finishedLanes=y,l){case 0:case 1:throw Error(t(345));case 2:pd(a,Yr,No);break;case 3:if(dc(a,y),(y&130023424)===y&&(l=nE+500-jt(),10<l)){if(_o(a,0)!==0)break;if(v=a.suspendedLanes,(v&y)!==y){Or(),a.pingedLanes|=a.suspendedLanes&v;break}a.timeoutHandle=d1(pd.bind(null,a,Yr,No),l);break}pd(a,Yr,No);break;case 4:if(dc(a,y),(y&4194240)===y)break;for(l=a.eventTimes,v=-1;0<y;){var M=31-fs(y);E=1<<M,M=l[M],M>v&&(v=M),y&=~E}if(y=v,y=jt()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*e4(y/1960))-y,10<y){a.timeoutHandle=d1(pd.bind(null,a,Yr,No),y);break}pd(a,Yr,No);break;case 5:pd(a,Yr,No);break;default:throw Error(t(329))}}}return Jr(a,jt()),a.callbackNode===p?kk.bind(null,a):null}function iE(a,l){var p=Z2;return a.current.memoizedState.isDehydrated&&(hd(a,l).flags|=256),a=Lv(a,l),a!==2&&(l=Yr,Yr=p,l!==null&&aE(l)),a}function aE(a){Yr===null?Yr=a:Yr.push.apply(Yr,a)}function t4(a){for(var l=a;;){if(l.flags&16384){var p=l.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var y=0;y<p.length;y++){var v=p[y],E=v.getSnapshot;v=v.value;try{if(!Pi(E(),v))return!1}catch{return!1}}}if(p=l.child,l.subtreeFlags&16384&&p!==null)p.return=l,l=p;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function dc(a,l){for(l&=~tE,l&=~Iv,a.suspendedLanes|=l,a.pingedLanes&=~l,a=a.expirationTimes;0<l;){var p=31-fs(l),y=1<<p;a[p]=-1,l&=~y}}function Ik(a){if((ht&6)!==0)throw Error(t(327));Hp();var l=_o(a,0);if((l&1)===0)return Jr(a,jt()),null;var p=Lv(a,l);if(a.tag!==0&&p===2){var y=A2(a);y!==0&&(l=y,p=iE(a,y))}if(p===1)throw p=J2,hd(a,0),dc(a,l),Jr(a,jt()),p;if(p===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=l,pd(a,Yr,No),Jr(a,jt()),null}function oE(a,l){var p=ht;ht|=1;try{return a(l)}finally{ht=p,ht===0&&(zp=jt()+500,cv&&sc())}}function dd(a){cc!==null&&cc.tag===0&&(ht&6)===0&&Hp();var l=ht;ht|=1;var p=ri.transition,y=ot;try{if(ri.transition=null,ot=1,a)return a()}finally{ot=y,ri.transition=p,ht=l,(ht&6)===0&&sc()}}function lE(){_s=$p.current,zt($p)}function hd(a,l){a.finishedWork=null,a.finishedLanes=0;var p=a.timeoutHandle;if(p!==-1&&(a.timeoutHandle=-1,PO(p)),Sn!==null)for(p=Sn.return;p!==null;){var y=p;switch(y1(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&ov();break;case 3:Vp(),zt(Qr),zt(_r),I1();break;case 5:T1(y);break;case 4:Vp();break;case 13:zt(en);break;case 19:zt(en);break;case 10:E1(y.type._context);break;case 22:case 23:lE()}p=p.return}if(Gn=a,Sn=a=hc(a.current,null),ir=_s=l,On=0,J2=null,tE=Iv=ud=0,Yr=Z2=null,od!==null){for(l=0;l<od.length;l++)if(p=od[l],y=p.interleaved,y!==null){p.interleaved=null;var v=y.next,E=p.pending;if(E!==null){var M=E.next;E.next=v,y.next=M}p.pending=y}od=null}return a}function Pk(a,l){do{var p=Sn;try{if(x1(),vv.current=Ev,Av){for(var y=tn.memoizedState;y!==null;){var v=y.queue;v!==null&&(v.pending=null),y=y.next}Av=!1}if(cd=0,Wn=Ln=tn=null,G2=!1,q2=0,eE.current=null,p===null||p.return===null){On=1,J2=l,Sn=null;break}e:{var E=a,M=p.return,W=p,Q=l;if(l=ir,W.flags|=32768,Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var te=Q,le=W,ue=le.tag;if((le.mode&1)===0&&(ue===0||ue===11||ue===15)){var oe=le.alternate;oe?(le.updateQueue=oe.updateQueue,le.memoizedState=oe.memoizedState,le.lanes=oe.lanes):(le.updateQueue=null,le.memoizedState=null)}var Ee=nk(M);if(Ee!==null){Ee.flags&=-257,rk(Ee,M,W,E,l),Ee.mode&1&&tk(E,te,l),l=Ee,Q=te;var Te=l.updateQueue;if(Te===null){var Ie=new Set;Ie.add(Q),l.updateQueue=Ie}else Te.add(Q);break e}else{if((l&1)===0){tk(E,te,l),cE();break e}Q=Error(t(426))}}else if(qt&&W.mode&1){var An=nk(M);if(An!==null){(An.flags&65536)===0&&(An.flags|=256),rk(An,M,W,E,l),A1(Up(Q,W));break e}}E=Q=Up(Q,W),On!==4&&(On=2),Z2===null?Z2=[E]:Z2.push(E),E=M;do{switch(E.tag){case 3:E.flags|=65536,l&=-l,E.lanes|=l;var J=ZT(E,Q,l);FT(E,J);break e;case 1:W=Q;var X=E.type,ee=E.stateNode;if((E.flags&128)===0&&(typeof X.getDerivedStateFromError=="function"||ee!==null&&typeof ee.componentDidCatch=="function"&&(lc===null||!lc.has(ee)))){E.flags|=65536,l&=-l,E.lanes|=l;var he=ek(E,W,l);FT(E,he);break e}}E=E.return}while(E!==null)}Nk(p)}catch(Re){l=Re,Sn===p&&p!==null&&(Sn=p=p.return);continue}break}while(!0)}function Rk(){var a=kv.current;return kv.current=Ev,a===null?Ev:a}function cE(){(On===0||On===3||On===2)&&(On=4),Gn===null||(ud&268435455)===0&&(Iv&268435455)===0||dc(Gn,ir)}function Lv(a,l){var p=ht;ht|=2;var y=Rk();(Gn!==a||ir!==l)&&(No=null,hd(a,l));do try{n4();break}catch(v){Pk(a,v)}while(!0);if(x1(),ht=p,kv.current=y,Sn!==null)throw Error(t(261));return Gn=null,ir=0,On}function n4(){for(;Sn!==null;)Dk(Sn)}function r4(){for(;Sn!==null&&!Gu();)Dk(Sn)}function Dk(a){var l=Ok(a.alternate,a,_s);a.memoizedProps=a.pendingProps,l===null?Nk(a):Sn=l,eE.current=null}function Nk(a){var l=a;do{var p=l.alternate;if(a=l.return,(l.flags&32768)===0){if(p=KO(p,l,_s),p!==null){Sn=p;return}}else{if(p=XO(p,l),p!==null){p.flags&=32767,Sn=p;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{On=6,Sn=null;return}}if(l=l.sibling,l!==null){Sn=l;return}Sn=l=a}while(l!==null);On===0&&(On=5)}function pd(a,l,p){var y=ot,v=ri.transition;try{ri.transition=null,ot=1,s4(a,l,p,y)}finally{ri.transition=v,ot=y}return null}function s4(a,l,p,y){do Hp();while(cc!==null);if((ht&6)!==0)throw Error(t(327));p=a.finishedWork;var v=a.finishedLanes;if(p===null)return null;if(a.finishedWork=null,a.finishedLanes=0,p===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var E=p.lanes|p.childLanes;if(Kx(a,E),a===Gn&&(Sn=Gn=null,ir=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||Rv||(Rv=!0,Bk(qu,function(){return Hp(),null})),E=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||E){E=ri.transition,ri.transition=null;var M=ot;ot=1;var W=ht;ht|=4,eE.current=null,JO(a,p),bk(p,a),bO(c1),bo=!!l1,c1=l1=null,a.current=p,ZO(p),Ao(),ht=W,ot=M,ri.transition=E}else a.current=p;if(Rv&&(Rv=!1,cc=a,Dv=v),E=a.pendingLanes,E===0&&(lc=null),z0(p.stateNode),Jr(a,jt()),l!==null)for(y=a.onRecoverableError,p=0;p<l.length;p++)v=l[p],y(v.value,{componentStack:v.stack,digest:v.digest});if(Pv)throw Pv=!1,a=rE,rE=null,a;return(Dv&1)!==0&&a.tag!==0&&Hp(),E=a.pendingLanes,(E&1)!==0?a===sE?eg++:(eg=0,sE=a):eg=0,sc(),null}function Hp(){if(cc!==null){var a=ua(Dv),l=ri.transition,p=ot;try{if(ri.transition=null,ot=16>a?16:a,cc===null)var y=!1;else{if(a=cc,cc=null,Dv=0,(ht&6)!==0)throw Error(t(331));var v=ht;for(ht|=4,Se=a.current;Se!==null;){var E=Se,M=E.child;if((Se.flags&16)!==0){var W=E.deletions;if(W!==null){for(var Q=0;Q<W.length;Q++){var te=W[Q];for(Se=te;Se!==null;){var le=Se;switch(le.tag){case 0:case 11:case 15:Y2(8,le,E)}var ue=le.child;if(ue!==null)ue.return=le,Se=ue;else for(;Se!==null;){le=Se;var oe=le.sibling,Ee=le.return;if(vk(le),le===te){Se=null;break}if(oe!==null){oe.return=Ee,Se=oe;break}Se=Ee}}}var Te=E.alternate;if(Te!==null){var Ie=Te.child;if(Ie!==null){Te.child=null;do{var An=Ie.sibling;Ie.sibling=null,Ie=An}while(Ie!==null)}}Se=E}}if((E.subtreeFlags&2064)!==0&&M!==null)M.return=E,Se=M;else e:for(;Se!==null;){if(E=Se,(E.flags&2048)!==0)switch(E.tag){case 0:case 11:case 15:Y2(9,E,E.return)}var J=E.sibling;if(J!==null){J.return=E.return,Se=J;break e}Se=E.return}}var X=a.current;for(Se=X;Se!==null;){M=Se;var ee=M.child;if((M.subtreeFlags&2064)!==0&&ee!==null)ee.return=M,Se=ee;else e:for(M=X;Se!==null;){if(W=Se,(W.flags&2048)!==0)try{switch(W.tag){case 0:case 11:case 15:Tv(9,W)}}catch(Re){cn(W,W.return,Re)}if(W===M){Se=null;break e}var he=W.sibling;if(he!==null){he.return=W.return,Se=he;break e}Se=W.return}}if(ht=v,sc(),ps&&typeof ps.onPostCommitFiberRoot=="function")try{ps.onPostCommitFiberRoot(Qu,a)}catch{}y=!0}return y}finally{ot=p,ri.transition=l}}return!1}function Mk(a,l,p){l=Up(p,l),l=ZT(a,l,1),a=ac(a,l,1),l=Or(),a!==null&&(Ju(a,1,l),Jr(a,l))}function cn(a,l,p){if(a.tag===3)Mk(a,a,p);else for(;l!==null;){if(l.tag===3){Mk(l,a,p);break}else if(l.tag===1){var y=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(lc===null||!lc.has(y))){a=Up(p,a),a=ek(l,a,1),l=ac(l,a,1),a=Or(),l!==null&&(Ju(l,1,a),Jr(l,a));break}}l=l.return}}function i4(a,l,p){var y=a.pingCache;y!==null&&y.delete(l),l=Or(),a.pingedLanes|=a.suspendedLanes&p,Gn===a&&(ir&p)===p&&(On===4||On===3&&(ir&130023424)===ir&&500>jt()-nE?hd(a,0):tE|=p),Jr(a,l)}function Lk(a,l){l===0&&((a.mode&1)===0?l=1:(l=Ql,Ql<<=1,(Ql&130023424)===0&&(Ql=4194304)));var p=Or();a=Po(a,l),a!==null&&(Ju(a,l,p),Jr(a,p))}function a4(a){var l=a.memoizedState,p=0;l!==null&&(p=l.retryLane),Lk(a,p)}function o4(a,l){var p=0;switch(a.tag){case 13:var y=a.stateNode,v=a.memoizedState;v!==null&&(p=v.retryLane);break;case 19:y=a.stateNode;break;default:throw Error(t(314))}y!==null&&y.delete(l),Lk(a,p)}var Ok;Ok=function(a,l,p){if(a!==null)if(a.memoizedProps!==l.pendingProps||Qr.current)Xr=!0;else{if((a.lanes&p)===0&&(l.flags&128)===0)return Xr=!1,QO(a,l,p);Xr=(a.flags&131072)!==0}else Xr=!1,qt&&(l.flags&1048576)!==0&&gT(l,dv,l.index);switch(l.lanes=0,l.tag){case 2:var y=l.type;Fv(a,l),a=l.pendingProps;var v=Rp(l,_r.current);Bp(l,p),v=D1(null,l,y,a,v,p);var E=N1();return l.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,Kr(y)?(E=!0,lv(l)):E=!1,l.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,F1(l),v.updater=bv,l.stateNode=v,v._reactInternals=l,U1(l,y,a,p),l=H1(null,l,y,!0,E,p)):(l.tag=0,qt&&E&&g1(l),Lr(null,l,v,p),l=l.child),l;case 16:y=l.elementType;e:{switch(Fv(a,l),a=l.pendingProps,v=y._init,y=v(y._payload),l.type=y,v=l.tag=c4(y),a=Di(y,a),v){case 0:l=z1(null,l,y,a,p);break e;case 1:l=ck(null,l,y,a,p);break e;case 11:l=sk(null,l,y,a,p);break e;case 14:l=ik(null,l,y,Di(y.type,a),p);break e}throw Error(t(306,y,""))}return l;case 0:return y=l.type,v=l.pendingProps,v=l.elementType===y?v:Di(y,v),z1(a,l,y,v,p);case 1:return y=l.type,v=l.pendingProps,v=l.elementType===y?v:Di(y,v),ck(a,l,y,v,p);case 3:e:{if(uk(l),a===null)throw Error(t(387));y=l.pendingProps,E=l.memoizedState,v=E.element,CT(a,l),yv(l,y,null,p);var M=l.memoizedState;if(y=M.element,E.isDehydrated)if(E={element:y,isDehydrated:!1,cache:M.cache,pendingSuspenseBoundaries:M.pendingSuspenseBoundaries,transitions:M.transitions},l.updateQueue.baseState=E,l.memoizedState=E,l.flags&256){v=Up(Error(t(423)),l),l=dk(a,l,y,p,v);break e}else if(y!==v){v=Up(Error(t(424)),l),l=dk(a,l,y,p,v);break e}else for(As=tc(l.stateNode.containerInfo.firstChild),vs=l,qt=!0,Ri=null,p=ET(l,null,y,p),l.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Mp(),y===v){l=Do(a,l,p);break e}Lr(a,l,y,p)}l=l.child}return l;case 5:return TT(l),a===null&&v1(l),y=l.type,v=l.pendingProps,E=a!==null?a.memoizedProps:null,M=v.children,u1(y,v)?M=null:E!==null&&u1(y,E)&&(l.flags|=32),lk(a,l),Lr(a,l,M,p),l.child;case 6:return a===null&&v1(l),null;case 13:return hk(a,l,p);case 4:return S1(l,l.stateNode.containerInfo),y=l.pendingProps,a===null?l.child=Lp(l,null,y,p):Lr(a,l,y,p),l.child;case 11:return y=l.type,v=l.pendingProps,v=l.elementType===y?v:Di(y,v),sk(a,l,y,v,p);case 7:return Lr(a,l,l.pendingProps,p),l.child;case 8:return Lr(a,l,l.pendingProps.children,p),l.child;case 12:return Lr(a,l,l.pendingProps.children,p),l.child;case 10:e:{if(y=l.type._context,v=l.pendingProps,E=l.memoizedProps,M=v.value,Lt(fv,y._currentValue),y._currentValue=M,E!==null)if(Pi(E.value,M)){if(E.children===v.children&&!Qr.current){l=Do(a,l,p);break e}}else for(E=l.child,E!==null&&(E.return=l);E!==null;){var W=E.dependencies;if(W!==null){M=E.child;for(var Q=W.firstContext;Q!==null;){if(Q.context===y){if(E.tag===1){Q=Ro(-1,p&-p),Q.tag=2;var te=E.updateQueue;if(te!==null){te=te.shared;var le=te.pending;le===null?Q.next=Q:(Q.next=le.next,le.next=Q),te.pending=Q}}E.lanes|=p,Q=E.alternate,Q!==null&&(Q.lanes|=p),b1(E.return,p,l),W.lanes|=p;break}Q=Q.next}}else if(E.tag===10)M=E.type===l.type?null:E.child;else if(E.tag===18){if(M=E.return,M===null)throw Error(t(341));M.lanes|=p,W=M.alternate,W!==null&&(W.lanes|=p),b1(M,p,l),M=E.sibling}else M=E.child;if(M!==null)M.return=E;else for(M=E;M!==null;){if(M===l){M=null;break}if(E=M.sibling,E!==null){E.return=M.return,M=E;break}M=M.return}E=M}Lr(a,l,v.children,p),l=l.child}return l;case 9:return v=l.type,y=l.pendingProps.children,Bp(l,p),v=ti(v),y=y(v),l.flags|=1,Lr(a,l,y,p),l.child;case 14:return y=l.type,v=Di(y,l.pendingProps),v=Di(y.type,v),ik(a,l,y,v,p);case 15:return ak(a,l,l.type,l.pendingProps,p);case 17:return y=l.type,v=l.pendingProps,v=l.elementType===y?v:Di(y,v),Fv(a,l),l.tag=1,Kr(y)?(a=!0,lv(l)):a=!1,Bp(l,p),YT(l,y,v),U1(l,y,v,p),H1(null,l,y,!0,a,p);case 19:return fk(a,l,p);case 22:return ok(a,l,p)}throw Error(t(156,l.tag))};function Bk(a,l){return y2(a,l)}function l4(a,l,p,y){this.tag=a,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function si(a,l,p,y){return new l4(a,l,p,y)}function uE(a){return a=a.prototype,!(!a||!a.isReactComponent)}function c4(a){if(typeof a=="function")return uE(a)?1:0;if(a!=null){if(a=a.$$typeof,a===G)return 11;if(a===xe)return 14}return 2}function hc(a,l){var p=a.alternate;return p===null?(p=si(a.tag,l,a.key,a.mode),p.elementType=a.elementType,p.type=a.type,p.stateNode=a.stateNode,p.alternate=a,a.alternate=p):(p.pendingProps=l,p.type=a.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=a.flags&14680064,p.childLanes=a.childLanes,p.lanes=a.lanes,p.child=a.child,p.memoizedProps=a.memoizedProps,p.memoizedState=a.memoizedState,p.updateQueue=a.updateQueue,l=a.dependencies,p.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},p.sibling=a.sibling,p.index=a.index,p.ref=a.ref,p}function Ov(a,l,p,y,v,E){var M=2;if(y=a,typeof a=="function")uE(a)&&(M=1);else if(typeof a=="string")M=5;else e:switch(a){case R:return fd(p.children,v,E,l);case D:M=8,v|=8;break;case L:return a=si(12,p,l,v|2),a.elementType=L,a.lanes=E,a;case $:return a=si(13,p,l,v),a.elementType=$,a.lanes=E,a;case ge:return a=si(19,p,l,v),a.elementType=ge,a.lanes=E,a;case pe:return Bv(p,v,E,l);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case U:M=10;break e;case j:M=9;break e;case G:M=11;break e;case xe:M=14;break e;case ye:M=16,y=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return l=si(M,p,l,v),l.elementType=a,l.type=y,l.lanes=E,l}function fd(a,l,p,y){return a=si(7,a,y,l),a.lanes=p,a}function Bv(a,l,p,y){return a=si(22,a,y,l),a.elementType=pe,a.lanes=p,a.stateNode={isHidden:!1},a}function dE(a,l,p){return a=si(6,a,null,l),a.lanes=p,a}function hE(a,l,p){return l=si(4,a.children!==null?a.children:[],a.key,l),l.lanes=p,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}function u4(a,l,p,y,v){this.tag=l,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=x2(0),this.expirationTimes=x2(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=x2(0),this.identifierPrefix=y,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function pE(a,l,p,y,v,E,M,W,Q){return a=new u4(a,l,p,W,Q),l===1?(l=1,E===!0&&(l|=8)):l=0,E=si(3,null,null,l),a.current=E,E.stateNode=a,E.memoizedState={element:y,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},F1(E),a}function d4(a,l,p){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:H,key:y==null?null:""+y,children:a,containerInfo:l,implementation:p}}function Vk(a){if(!a)return rc;a=a._reactInternals;e:{if(ki(a)!==a||a.tag!==1)throw Error(t(170));var l=a;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(Kr(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(t(171))}if(a.tag===1){var p=a.type;if(Kr(p))return pT(a,p,l)}return l}function Uk(a,l,p,y,v,E,M,W,Q){return a=pE(p,y,!0,a,v,E,M,W,Q),a.context=Vk(null),p=a.current,y=Or(),v=uc(p),E=Ro(y,v),E.callback=l??null,ac(p,E,v),a.current.lanes=v,Ju(a,v,y),Jr(a,y),a}function Vv(a,l,p,y){var v=l.current,E=Or(),M=uc(v);return p=Vk(p),l.context===null?l.context=p:l.pendingContext=p,l=Ro(E,M),l.payload={element:a},y=y===void 0?null:y,y!==null&&(l.callback=y),a=ac(v,l,M),a!==null&&(Li(a,v,M,E),gv(a,v,M)),M}function Uv(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function jk(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var p=a.retryLane;a.retryLane=p!==0&&p<l?p:l}}function fE(a,l){jk(a,l),(a=a.alternate)&&jk(a,l)}function h4(){return null}var $k=typeof reportError=="function"?reportError:function(a){console.error(a)};function mE(a){this._internalRoot=a}jv.prototype.render=mE.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(t(409));Vv(a,l,null,null)},jv.prototype.unmount=mE.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;dd(function(){Vv(null,a,null,null)}),l[So]=null}};function jv(a){this._internalRoot=a}jv.prototype.unstable_scheduleHydration=function(a){if(a){var l=F2();a={blockedOn:null,target:a,priority:l};for(var p=0;p<ms.length&&l!==0&&l<ms[p].priority;p++);ms.splice(p,0,a),p===0&&gp(a)}};function gE(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function $v(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function zk(){}function p4(a,l,p,y,v){if(v){if(typeof y=="function"){var E=y;y=function(){var te=Uv(M);E.call(te)}}var M=Uk(l,y,a,0,null,!1,!1,"",zk);return a._reactRootContainer=M,a[So]=M.current,B2(a.nodeType===8?a.parentNode:a),dd(),M}for(;v=a.lastChild;)a.removeChild(v);if(typeof y=="function"){var W=y;y=function(){var te=Uv(Q);W.call(te)}}var Q=pE(a,0,!1,null,null,!1,!1,"",zk);return a._reactRootContainer=Q,a[So]=Q.current,B2(a.nodeType===8?a.parentNode:a),dd(function(){Vv(l,Q,p,y)}),Q}function zv(a,l,p,y,v){var E=p._reactRootContainer;if(E){var M=E;if(typeof v=="function"){var W=v;v=function(){var Q=Uv(M);W.call(Q)}}Vv(l,M,a,v)}else M=p4(p,l,a,v,y);return Uv(M)}b2=function(a){switch(a.tag){case 3:var l=a.stateNode;if(l.current.memoizedState.isDehydrated){var p=yt(l.pendingLanes);p!==0&&(E2(l,p|1),Jr(l,jt()),(ht&6)===0&&(zp=jt()+500,sc()))}break;case 13:dd(function(){var y=Po(a,1);if(y!==null){var v=Or();Li(y,a,1,v)}}),fE(a,1)}},fp=function(a){if(a.tag===13){var l=Po(a,134217728);if(l!==null){var p=Or();Li(l,a,134217728,p)}fE(a,134217728)}},C2=function(a){if(a.tag===13){var l=uc(a),p=Po(a,l);if(p!==null){var y=Or();Li(p,a,l,y)}fE(a,l)}},F2=function(){return ot},S2=function(a,l){var p=ot;try{return ot=a,l()}finally{ot=p}},yo=function(a,l,p){switch(l){case"input":if($u(a,p),l=p.name,p.type==="radio"&&l!=null){for(p=a;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<p.length;l++){var y=p[l];if(y!==a&&y.form===a.form){var v=av(y);if(!v)throw Error(t(90));ce(y),$u(y,v)}}}break;case"textarea":P0(a,p);break;case"select":l=p.value,l!=null&&Si(a,!!p.multiple,l,!1)}},N0=oE,M0=dd;var f4={usingClientEntryPoint:!1,Events:[j2,Ip,av,Hl,Wl,oE]},tg={findFiberByHostInstance:rd,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},m4={bundleType:tg.bundleType,version:tg.version,rendererPackageName:tg.rendererPackageName,rendererConfig:tg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:V.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=$0(a),a===null?null:a.stateNode},findFiberByHostInstance:tg.findFiberByHostInstance||h4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hv.isDisabled&&Hv.supportsFiber)try{Qu=Hv.inject(m4),ps=Hv}catch{}}return Zr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=f4,Zr.createPortal=function(a,l){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gE(l))throw Error(t(200));return d4(a,l,null,p)},Zr.createRoot=function(a,l){if(!gE(a))throw Error(t(299));var p=!1,y="",v=$k;return l!=null&&(l.unstable_strictMode===!0&&(p=!0),l.identifierPrefix!==void 0&&(y=l.identifierPrefix),l.onRecoverableError!==void 0&&(v=l.onRecoverableError)),l=pE(a,1,!1,null,null,p,!1,y,v),a[So]=l.current,B2(a.nodeType===8?a.parentNode:a),new mE(l)},Zr.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=$0(l),a=a===null?null:a.stateNode,a},Zr.flushSync=function(a){return dd(a)},Zr.hydrate=function(a,l,p){if(!$v(l))throw Error(t(200));return zv(null,a,l,!0,p)},Zr.hydrateRoot=function(a,l,p){if(!gE(a))throw Error(t(405));var y=p!=null&&p.hydratedSources||null,v=!1,E="",M=$k;if(p!=null&&(p.unstable_strictMode===!0&&(v=!0),p.identifierPrefix!==void 0&&(E=p.identifierPrefix),p.onRecoverableError!==void 0&&(M=p.onRecoverableError)),l=Uk(l,null,a,1,p??null,v,!1,E,M),a[So]=l.current,B2(a),y)for(a=0;a<y.length;a++)p=y[a],v=p._getVersion,v=v(p._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[p,v]:l.mutableSourceEagerHydrationData.push(p,v);return new jv(l)},Zr.render=function(a,l,p){if(!$v(l))throw Error(t(200));return zv(null,a,l,!1,p)},Zr.unmountComponentAtNode=function(a){if(!$v(a))throw Error(t(40));return a._reactRootContainer?(dd(function(){zv(null,null,a,!1,function(){a._reactRootContainer=null,a[So]=null})}),!0):!1},Zr.unstable_batchedUpdates=oE,Zr.unstable_renderSubtreeIntoContainer=function(a,l,p,y){if(!$v(p))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return zv(a,l,p,!1,y)},Zr.version="18.3.1-next-f1338f8080-20240426",Zr}var Jk;function F4(){if(Jk)return AE.exports;Jk=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),AE.exports=C4(),AE.exports}var Zk;function S4(){if(Zk)return Gv;Zk=1;var s=F4();return Gv.createRoot=s.createRoot,Gv.hydrateRoot=s.hydrateRoot,Gv}var T4=S4();/**
 * react-router v7.13.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var eI="popstate";function k4(s={}){function e(r,i){let{pathname:o="/",search:u="",hash:d=""}=Xh(r.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),YE("",{pathname:o,search:u,hash:d},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(r,i){let o=r.document.querySelector("base"),u="";if(o&&o.getAttribute("href")){let d=r.location.href,h=d.indexOf("#");u=h===-1?d:d.slice(0,h)}return u+"#"+(typeof i=="string"?i:Qg(i))}function n(r,i){Ci(r.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(i)})`)}return P4(e,t,n,s)}function Yt(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Ci(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function I4(){return Math.random().toString(36).substring(2,10)}function tI(s,e){return{usr:s.state,key:s.key,idx:e}}function YE(s,e,t=null,n){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?Xh(e):e,state:t,key:e&&e.key||n||I4()}}function Qg({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function Xh(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let n=s.indexOf("?");n>=0&&(e.search=s.substring(n),s=s.substring(0,n)),s&&(e.pathname=s)}return e}function P4(s,e,t,n={}){let{window:r=document.defaultView,v5Compat:i=!1}=n,o=r.history,u="POP",d=null,h=f();h==null&&(h=0,o.replaceState({...o.state,idx:h},""));function f(){return(o.state||{idx:null}).idx}function g(){u="POP";let S=f(),P=S==null?null:S-h;h=S,d&&d({action:u,location:C.location,delta:P})}function w(S,P){u="PUSH";let O=YE(C.location,S,P);t&&t(O,S),h=f()+1;let N=tI(O,h),V=C.createHref(O);try{o.pushState(N,"",V)}catch(z){if(z instanceof DOMException&&z.name==="DataCloneError")throw z;r.location.assign(V)}i&&d&&d({action:u,location:C.location,delta:1})}function A(S,P){u="REPLACE";let O=YE(C.location,S,P);t&&t(O,S),h=f();let N=tI(O,h),V=C.createHref(O);o.replaceState(N,"",V),i&&d&&d({action:u,location:C.location,delta:0})}function F(S){return R4(S)}let C={get action(){return u},get location(){return s(r,o)},listen(S){if(d)throw new Error("A history only accepts one active listener");return r.addEventListener(eI,g),d=S,()=>{r.removeEventListener(eI,g),d=null}},createHref(S){return e(r,S)},createURL:F,encodeLocation(S){let P=F(S);return{pathname:P.pathname,search:P.search,hash:P.hash}},push:w,replace:A,go(S){return o.go(S)}};return C}function R4(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Yt(t,"No window.location.(origin|href) available to create URL");let n=typeof s=="string"?s:Qg(s);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=t+n),new URL(n,t)}function IR(s,e,t="/"){return D4(s,e,t,!1)}function D4(s,e,t,n){let r=typeof e=="string"?Xh(e):e,i=kl(r.pathname||"/",t);if(i==null)return null;let o=PR(s);N4(o);let u=null;for(let d=0;u==null&&d<o.length;++d){let h=W4(i);u=z4(o[d],h,n)}return u}function PR(s,e=[],t=[],n="",r=!1){let i=(o,u,d=r,h)=>{let f={relativePath:h===void 0?o.path||"":h,caseSensitive:o.caseSensitive===!0,childrenIndex:u,route:o};if(f.relativePath.startsWith("/")){if(!f.relativePath.startsWith(n)&&d)return;Yt(f.relativePath.startsWith(n),`Absolute route path "${f.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(n.length)}let g=Cl([n,f.relativePath]),w=t.concat(f);o.children&&o.children.length>0&&(Yt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),PR(o.children,e,w,g,d)),!(o.path==null&&!o.index)&&e.push({path:g,score:j4(g,o.index),routesMeta:w})};return s.forEach((o,u)=>{var d;if(o.path===""||!((d=o.path)!=null&&d.includes("?")))i(o,u);else for(let h of RR(o.path))i(o,u,!0,h)}),e}function RR(s){let e=s.split("/");if(e.length===0)return[];let[t,...n]=e,r=t.endsWith("?"),i=t.replace(/\?$/,"");if(n.length===0)return r?[i,""]:[i];let o=RR(n.join("/")),u=[];return u.push(...o.map(d=>d===""?i:[i,d].join("/"))),r&&u.push(...o),u.map(d=>s.startsWith("/")&&d===""?"/":d)}function N4(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:$4(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var M4=/^:[\w-]+$/,L4=3,O4=2,B4=1,V4=10,U4=-2,nI=s=>s==="*";function j4(s,e){let t=s.split("/"),n=t.length;return t.some(nI)&&(n+=U4),e&&(n+=O4),t.filter(r=>!nI(r)).reduce((r,i)=>r+(M4.test(i)?L4:i===""?B4:V4),n)}function $4(s,e){return s.length===e.length&&s.slice(0,-1).every((n,r)=>n===e[r])?s[s.length-1]-e[e.length-1]:0}function z4(s,e,t=!1){let{routesMeta:n}=s,r={},i="/",o=[];for(let u=0;u<n.length;++u){let d=n[u],h=u===n.length-1,f=i==="/"?e:e.slice(i.length)||"/",g=a_({path:d.relativePath,caseSensitive:d.caseSensitive,end:h},f),w=d.route;if(!g&&h&&t&&!n[n.length-1].route.index&&(g=a_({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},f)),!g)return null;Object.assign(r,g.params),o.push({params:r,pathname:Cl([i,g.pathname]),pathnameBase:K4(Cl([i,g.pathnameBase])),route:w}),g.pathnameBase!=="/"&&(i=Cl([i,g.pathnameBase]))}return o}function a_(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,n]=H4(s.path,s.caseSensitive,s.end),r=e.match(t);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),u=r.slice(1);return{params:n.reduce((h,{paramName:f,isOptional:g},w)=>{if(f==="*"){let F=u[w]||"";o=i.slice(0,i.length-F.length).replace(/(.)\/+$/,"$1")}const A=u[w];return g&&!A?h[f]=void 0:h[f]=(A||"").replace(/%2F/g,"/"),h},{}),pathname:i,pathnameBase:o,pattern:s}}function H4(s,e=!1,t=!0){Ci(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let n=[],r="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,u,d)=>(n.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(n.push({paramName:"*"}),r+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":s!==""&&s!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),n]}function W4(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ci(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function kl(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=s.charAt(t);return n&&n!=="/"?null:s.slice(t)||"/"}var G4=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function q4(s,e="/"){let{pathname:t,search:n="",hash:r=""}=typeof s=="string"?Xh(s):s,i;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?i=rI(t.substring(1),"/"):i=rI(t,e)):i=e,{pathname:i,search:X4(n),hash:Y4(r)}}function rI(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function EE(s,e,t,n){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Q4(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function sF(s){let e=Q4(s);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function iF(s,e,t,n=!1){let r;typeof s=="string"?r=Xh(s):(r={...s},Yt(!r.pathname||!r.pathname.includes("?"),EE("?","pathname","search",r)),Yt(!r.pathname||!r.pathname.includes("#"),EE("#","pathname","hash",r)),Yt(!r.search||!r.search.includes("#"),EE("#","search","hash",r)));let i=s===""||r.pathname==="",o=i?"/":r.pathname,u;if(o==null)u=t;else{let g=e.length-1;if(!n&&o.startsWith("..")){let w=o.split("/");for(;w[0]==="..";)w.shift(),g-=1;r.pathname=w.join("/")}u=g>=0?e[g]:"/"}let d=q4(r,u),h=o&&o!=="/"&&o.endsWith("/"),f=(i||o===".")&&t.endsWith("/");return!d.pathname.endsWith("/")&&(h||f)&&(d.pathname+="/"),d}var Cl=s=>s.join("/").replace(/\/\/+/g,"/"),K4=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),X4=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,Y4=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,J4=class{constructor(s,e,t,n=!1){this.status=s,this.statusText=e||"",this.internal=n,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function Z4(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function e7(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var DR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function NR(s,e){let t=s;if(typeof t!="string"||!G4.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let n=t,r=!1;if(DR)try{let i=new URL(window.location.href),o=t.startsWith("//")?new URL(i.protocol+t):new URL(t),u=kl(o.pathname,e);o.origin===i.origin&&u!=null?t=u+o.search+o.hash:r=!0}catch{Ci(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:r,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var MR=["POST","PUT","PATCH","DELETE"];new Set(MR);var t7=["GET",...MR];new Set(t7);var Zm=q.createContext(null);Zm.displayName="DataRouter";var ix=q.createContext(null);ix.displayName="DataRouterState";var n7=q.createContext(!1),LR=q.createContext({isTransitioning:!1});LR.displayName="ViewTransition";var r7=q.createContext(new Map);r7.displayName="Fetchers";var s7=q.createContext(null);s7.displayName="Await";var Xs=q.createContext(null);Xs.displayName="Navigation";var a0=q.createContext(null);a0.displayName="Location";var mo=q.createContext({outlet:null,matches:[],isDataRoute:!1});mo.displayName="Route";var aF=q.createContext(null);aF.displayName="RouteError";var OR="REACT_ROUTER_ERROR",i7="REDIRECT",a7="ROUTE_ERROR_RESPONSE";function o7(s){if(s.startsWith(`${OR}:${i7}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function l7(s){if(s.startsWith(`${OR}:${a7}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new J4(e.status,e.statusText,e.data)}catch{}}function c7(s,{relative:e}={}){Yt(e2(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=q.useContext(Xs),{hash:r,pathname:i,search:o}=o0(s,{relative:e}),u=i;return t!=="/"&&(u=i==="/"?t:Cl([t,i])),n.createHref({pathname:u,search:o,hash:r})}function e2(){return q.useContext(a0)!=null}function Lu(){return Yt(e2(),"useLocation() may be used only in the context of a <Router> component."),q.useContext(a0).location}var BR="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function VR(s){q.useContext(Xs).static||q.useLayoutEffect(s)}function ax(){let{isDataRoute:s}=q.useContext(mo);return s?x7():u7()}function u7(){Yt(e2(),"useNavigate() may be used only in the context of a <Router> component.");let s=q.useContext(Zm),{basename:e,navigator:t}=q.useContext(Xs),{matches:n}=q.useContext(mo),{pathname:r}=Lu(),i=JSON.stringify(sF(n)),o=q.useRef(!1);return VR(()=>{o.current=!0}),q.useCallback((d,h={})=>{if(Ci(o.current,BR),!o.current)return;if(typeof d=="number"){t.go(d);return}let f=iF(d,JSON.parse(i),r,h.relative==="path");s==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:Cl([e,f.pathname])),(h.replace?t.replace:t.push)(f,h.state,h)},[e,t,i,r,s])}q.createContext(null);function o0(s,{relative:e}={}){let{matches:t}=q.useContext(mo),{pathname:n}=Lu(),r=JSON.stringify(sF(t));return q.useMemo(()=>iF(s,JSON.parse(r),n,e==="path"),[s,r,n,e])}function d7(s,e){return UR(s,e)}function UR(s,e,t,n,r){var O;Yt(e2(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=q.useContext(Xs),{matches:o}=q.useContext(mo),u=o[o.length-1],d=u?u.params:{},h=u?u.pathname:"/",f=u?u.pathnameBase:"/",g=u&&u.route;{let N=g&&g.path||"";$R(h,!g||N.endsWith("*")||N.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${N}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${N}"> to <Route path="${N==="/"?"*":`${N}/*`}">.`)}let w=Lu(),A;if(e){let N=typeof e=="string"?Xh(e):e;Yt(f==="/"||((O=N.pathname)==null?void 0:O.startsWith(f)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${N.pathname}" was given in the \`location\` prop.`),A=N}else A=w;let F=A.pathname||"/",C=F;if(f!=="/"){let N=f.replace(/^\//,"").split("/");C="/"+F.replace(/^\//,"").split("/").slice(N.length).join("/")}let S=IR(s,{pathname:C});Ci(g||S!=null,`No routes matched location "${A.pathname}${A.search}${A.hash}" `),Ci(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${A.pathname}${A.search}${A.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let P=g7(S&&S.map(N=>Object.assign({},N,{params:Object.assign({},d,N.params),pathname:Cl([f,i.encodeLocation?i.encodeLocation(N.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?f:Cl([f,i.encodeLocation?i.encodeLocation(N.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:N.pathnameBase])})),o,t,n,r);return e&&P?q.createElement(a0.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...A},navigationType:"POP"}},P):P}function h7(){let s=_7(),e=Z4(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,n="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",s),o=q.createElement(q.Fragment,null,q.createElement("p",null," Hey developer "),q.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",q.createElement("code",{style:i},"ErrorBoundary")," or"," ",q.createElement("code",{style:i},"errorElement")," prop on your route.")),q.createElement(q.Fragment,null,q.createElement("h2",null,"Unexpected Application Error!"),q.createElement("h3",{style:{fontStyle:"italic"}},e),t?q.createElement("pre",{style:r},t):null,o)}var p7=q.createElement(h7,null),jR=class extends q.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const t=l7(s.digest);t&&(s=t)}let e=s!==void 0?q.createElement(mo.Provider,{value:this.props.routeContext},q.createElement(aF.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?q.createElement(f7,{error:s},e):e}};jR.contextType=n7;var bE=new WeakMap;function f7({children:s,error:e}){let{basename:t}=q.useContext(Xs);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let n=o7(e.digest);if(n){let r=bE.get(e);if(r)throw r;let i=NR(n.location,t);if(DR&&!bE.get(e))if(i.isExternal||n.reloadDocument)window.location.href=i.absoluteURL||i.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(i.to,{replace:n.replace}));throw bE.set(e,o),o}return q.createElement("meta",{httpEquiv:"refresh",content:`0;url=${i.absoluteURL||i.to}`})}}return s}function m7({routeContext:s,match:e,children:t}){let n=q.useContext(Zm);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),q.createElement(mo.Provider,{value:s},t)}function g7(s,e=[],t=null,n=null,r=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let i=s,o=t==null?void 0:t.errors;if(o!=null){let f=i.findIndex(g=>g.route.id&&(o==null?void 0:o[g.route.id])!==void 0);Yt(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,f+1))}let u=!1,d=-1;if(t)for(let f=0;f<i.length;f++){let g=i[f];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(d=f),g.route.id){let{loaderData:w,errors:A}=t,F=g.route.loader&&!w.hasOwnProperty(g.route.id)&&(!A||A[g.route.id]===void 0);if(g.route.lazy||F){u=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}let h=t&&n?(f,g)=>{var w,A;n(f,{location:t.location,params:((A=(w=t.matches)==null?void 0:w[0])==null?void 0:A.params)??{},unstable_pattern:e7(t.matches),errorInfo:g})}:void 0;return i.reduceRight((f,g,w)=>{let A,F=!1,C=null,S=null;t&&(A=o&&g.route.id?o[g.route.id]:void 0,C=g.route.errorElement||p7,u&&(d<0&&w===0?($R("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),F=!0,S=null):d===w&&(F=!0,S=g.route.hydrateFallbackElement||null)));let P=e.concat(i.slice(0,w+1)),O=()=>{let N;return A?N=C:F?N=S:g.route.Component?N=q.createElement(g.route.Component,null):g.route.element?N=g.route.element:N=f,q.createElement(m7,{match:g,routeContext:{outlet:f,matches:P,isDataRoute:t!=null},children:N})};return t&&(g.route.ErrorBoundary||g.route.errorElement||w===0)?q.createElement(jR,{location:t.location,revalidation:t.revalidation,component:C,error:A,children:O(),routeContext:{outlet:null,matches:P,isDataRoute:!0},onError:h}):O()},null)}function oF(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function y7(s){let e=q.useContext(Zm);return Yt(e,oF(s)),e}function w7(s){let e=q.useContext(ix);return Yt(e,oF(s)),e}function v7(s){let e=q.useContext(mo);return Yt(e,oF(s)),e}function lF(s){let e=v7(s),t=e.matches[e.matches.length-1];return Yt(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function A7(){return lF("useRouteId")}function _7(){var n;let s=q.useContext(aF),e=w7("useRouteError"),t=lF("useRouteError");return s!==void 0?s:(n=e.errors)==null?void 0:n[t]}function x7(){let{router:s}=y7("useNavigate"),e=lF("useNavigate"),t=q.useRef(!1);return VR(()=>{t.current=!0}),q.useCallback(async(r,i={})=>{Ci(t.current,BR),t.current&&(typeof r=="number"?await s.navigate(r):await s.navigate(r,{fromRouteId:e,...i}))},[s,e])}var sI={};function $R(s,e,t){!e&&!sI[s]&&(sI[s]=!0,Ci(!1,t))}q.memo(E7);function E7({routes:s,future:e,state:t,onError:n}){return UR(s,void 0,t,n,e)}function JE({to:s,replace:e,state:t,relative:n}){Yt(e2(),"<Navigate> may be used only in the context of a <Router> component.");let{static:r}=q.useContext(Xs);Ci(!r,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=q.useContext(mo),{pathname:o}=Lu(),u=ax(),d=iF(s,sF(i),o,n==="path"),h=JSON.stringify(d);return q.useEffect(()=>{u(JSON.parse(h),{replace:e,state:t,relative:n})},[u,h,n,e,t]),null}function xs(s){Yt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function b7({basename:s="/",children:e=null,location:t,navigationType:n="POP",navigator:r,static:i=!1,unstable_useTransitions:o}){Yt(!e2(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=s.replace(/^\/*/,"/"),d=q.useMemo(()=>({basename:u,navigator:r,static:i,unstable_useTransitions:o,future:{}}),[u,r,i,o]);typeof t=="string"&&(t=Xh(t));let{pathname:h="/",search:f="",hash:g="",state:w=null,key:A="default"}=t,F=q.useMemo(()=>{let C=kl(h,u);return C==null?null:{location:{pathname:C,search:f,hash:g,state:w,key:A},navigationType:n}},[u,h,f,g,w,A,n]);return Ci(F!=null,`<Router basename="${u}"> is not able to match the URL "${h}${f}${g}" because it does not start with the basename, so the <Router> won't render anything.`),F==null?null:q.createElement(Xs.Provider,{value:d},q.createElement(a0.Provider,{children:e,value:F}))}function C7({children:s,location:e}){return d7(ZE(s),e)}function ZE(s,e=[]){let t=[];return q.Children.forEach(s,(n,r)=>{if(!q.isValidElement(n))return;let i=[...e,r];if(n.type===q.Fragment){t.push.apply(t,ZE(n.props.children,i));return}Yt(n.type===xs,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Yt(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=ZE(n.props.children,i)),t.push(o)}),t}var hA="get",pA="application/x-www-form-urlencoded";function ox(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function F7(s){return ox(s)&&s.tagName.toLowerCase()==="button"}function S7(s){return ox(s)&&s.tagName.toLowerCase()==="form"}function T7(s){return ox(s)&&s.tagName.toLowerCase()==="input"}function k7(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function I7(s,e){return s.button===0&&(!e||e==="_self")&&!k7(s)}var qv=null;function P7(){if(qv===null)try{new FormData(document.createElement("form"),0),qv=!1}catch{qv=!0}return qv}var R7=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function CE(s){return s!=null&&!R7.has(s)?(Ci(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${pA}"`),null):s}function D7(s,e){let t,n,r,i,o;if(S7(s)){let u=s.getAttribute("action");n=u?kl(u,e):null,t=s.getAttribute("method")||hA,r=CE(s.getAttribute("enctype"))||pA,i=new FormData(s)}else if(F7(s)||T7(s)&&(s.type==="submit"||s.type==="image")){let u=s.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=s.getAttribute("formaction")||u.getAttribute("action");if(n=d?kl(d,e):null,t=s.getAttribute("formmethod")||u.getAttribute("method")||hA,r=CE(s.getAttribute("formenctype"))||CE(u.getAttribute("enctype"))||pA,i=new FormData(u,s),!P7()){let{name:h,type:f,value:g}=s;if(f==="image"){let w=h?`${h}.`:"";i.append(`${w}x`,"0"),i.append(`${w}y`,"0")}else h&&i.append(h,g)}}else{if(ox(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=hA,n=null,r=pA,o=s}return i&&r==="text/plain"&&(o=i,i=void 0),{action:n,method:t.toLowerCase(),encType:r,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function cF(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function N7(s,e,t,n){let r=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return t?r.pathname.endsWith("/")?r.pathname=`${r.pathname}_.${n}`:r.pathname=`${r.pathname}.${n}`:r.pathname==="/"?r.pathname=`_root.${n}`:e&&kl(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function M7(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function L7(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function O7(s,e,t){let n=await Promise.all(s.map(async r=>{let i=e.routes[r.route.id];if(i){let o=await M7(i,t);return o.links?o.links():[]}return[]}));return j7(n.flat(1).filter(L7).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function iI(s,e,t,n,r,i){let o=(d,h)=>t[h]?d.route.id!==t[h].route.id:!0,u=(d,h)=>{var f;return t[h].pathname!==d.pathname||((f=t[h].route.path)==null?void 0:f.endsWith("*"))&&t[h].params["*"]!==d.params["*"]};return i==="assets"?e.filter((d,h)=>o(d,h)||u(d,h)):i==="data"?e.filter((d,h)=>{var g;let f=n.routes[d.route.id];if(!f||!f.hasLoader)return!1;if(o(d,h)||u(d,h))return!0;if(d.route.shouldRevalidate){let w=d.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((g=t[0])==null?void 0:g.params)||{},nextUrl:new URL(s,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof w=="boolean")return w}return!0}):[]}function B7(s,e,{includeHydrateFallback:t}={}){return V7(s.map(n=>{let r=e.routes[n.route.id];if(!r)return[];let i=[r.module];return r.clientActionModule&&(i=i.concat(r.clientActionModule)),r.clientLoaderModule&&(i=i.concat(r.clientLoaderModule)),t&&r.hydrateFallbackModule&&(i=i.concat(r.hydrateFallbackModule)),r.imports&&(i=i.concat(r.imports)),i}).flat(1))}function V7(s){return[...new Set(s)]}function U7(s){let e={},t=Object.keys(s).sort();for(let n of t)e[n]=s[n];return e}function j7(s,e){let t=new Set;return new Set(e),s.reduce((n,r)=>{let i=JSON.stringify(U7(r));return t.has(i)||(t.add(i),n.push({key:i,link:r})),n},[])}function zR(){let s=q.useContext(Zm);return cF(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function $7(){let s=q.useContext(ix);return cF(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var uF=q.createContext(void 0);uF.displayName="FrameworkContext";function HR(){let s=q.useContext(uF);return cF(s,"You must render this element inside a <HydratedRouter> element"),s}function z7(s,e){let t=q.useContext(uF),[n,r]=q.useState(!1),[i,o]=q.useState(!1),{onFocus:u,onBlur:d,onMouseEnter:h,onMouseLeave:f,onTouchStart:g}=e,w=q.useRef(null);q.useEffect(()=>{if(s==="render"&&o(!0),s==="viewport"){let C=P=>{P.forEach(O=>{o(O.isIntersecting)})},S=new IntersectionObserver(C,{threshold:.5});return w.current&&S.observe(w.current),()=>{S.disconnect()}}},[s]),q.useEffect(()=>{if(n){let C=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(C)}}},[n]);let A=()=>{r(!0)},F=()=>{r(!1),o(!1)};return t?s!=="intent"?[i,w,{}]:[i,w,{onFocus:rg(u,A),onBlur:rg(d,F),onMouseEnter:rg(h,A),onMouseLeave:rg(f,F),onTouchStart:rg(g,A)}]:[!1,w,{}]}function rg(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function H7({page:s,...e}){let{router:t}=zR(),n=q.useMemo(()=>IR(t.routes,s,t.basename),[t.routes,s,t.basename]);return n?q.createElement(G7,{page:s,matches:n,...e}):null}function W7(s){let{manifest:e,routeModules:t}=HR(),[n,r]=q.useState([]);return q.useEffect(()=>{let i=!1;return O7(s,e,t).then(o=>{i||r(o)}),()=>{i=!0}},[s,e,t]),n}function G7({page:s,matches:e,...t}){let n=Lu(),{future:r,manifest:i,routeModules:o}=HR(),{basename:u}=zR(),{loaderData:d,matches:h}=$7(),f=q.useMemo(()=>iI(s,e,h,i,n,"data"),[s,e,h,i,n]),g=q.useMemo(()=>iI(s,e,h,i,n,"assets"),[s,e,h,i,n]),w=q.useMemo(()=>{if(s===n.pathname+n.search+n.hash)return[];let C=new Set,S=!1;if(e.forEach(O=>{var V;let N=i.routes[O.route.id];!N||!N.hasLoader||(!f.some(z=>z.route.id===O.route.id)&&O.route.id in d&&((V=o[O.route.id])!=null&&V.shouldRevalidate)||N.hasClientLoader?S=!0:C.add(O.route.id))}),C.size===0)return[];let P=N7(s,u,r.unstable_trailingSlashAwareDataRequests,"data");return S&&C.size>0&&P.searchParams.set("_routes",e.filter(O=>C.has(O.route.id)).map(O=>O.route.id).join(",")),[P.pathname+P.search]},[u,r.unstable_trailingSlashAwareDataRequests,d,n,i,f,e,s,o]),A=q.useMemo(()=>B7(g,i),[g,i]),F=W7(g);return q.createElement(q.Fragment,null,w.map(C=>q.createElement("link",{key:C,rel:"prefetch",as:"fetch",href:C,...t})),A.map(C=>q.createElement("link",{key:C,rel:"modulepreload",href:C,...t})),F.map(({key:C,link:S})=>q.createElement("link",{key:C,nonce:t.nonce,...S,crossOrigin:S.crossOrigin??t.crossOrigin})))}function q7(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var Q7=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Q7&&(window.__reactRouterVersion="7.13.0")}catch{}function K7({basename:s,children:e,unstable_useTransitions:t,window:n}){let r=q.useRef();r.current==null&&(r.current=k4({window:n,v5Compat:!0}));let i=r.current,[o,u]=q.useState({action:i.action,location:i.location}),d=q.useCallback(h=>{t===!1?u(h):q.startTransition(()=>u(h))},[t]);return q.useLayoutEffect(()=>i.listen(d),[i,d]),q.createElement(b7,{basename:s,children:e,location:o.location,navigationType:o.action,navigator:i,unstable_useTransitions:t})}var WR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,o_=q.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:r,reloadDocument:i,replace:o,state:u,target:d,to:h,preventScrollReset:f,viewTransition:g,unstable_defaultShouldRevalidate:w,...A},F){let{basename:C,unstable_useTransitions:S}=q.useContext(Xs),P=typeof h=="string"&&WR.test(h),O=NR(h,C);h=O.to;let N=c7(h,{relative:r}),[V,z,H]=z7(n,A),R=J7(h,{replace:o,state:u,target:d,preventScrollReset:f,relative:r,viewTransition:g,unstable_defaultShouldRevalidate:w,unstable_useTransitions:S});function D(U){e&&e(U),U.defaultPrevented||R(U)}let L=q.createElement("a",{...A,...H,href:O.absoluteURL||N,onClick:O.isExternal||i?e:D,ref:q7(F,z),target:d,"data-discover":!P&&t==="render"?"true":void 0});return V&&!P?q.createElement(q.Fragment,null,L,q.createElement(H7,{page:N})):L});o_.displayName="Link";var GR=q.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:r=!1,style:i,to:o,viewTransition:u,children:d,...h},f){let g=o0(o,{relative:h.relative}),w=Lu(),A=q.useContext(ix),{navigator:F,basename:C}=q.useContext(Xs),S=A!=null&&rB(g)&&u===!0,P=F.encodeLocation?F.encodeLocation(g).pathname:g.pathname,O=w.pathname,N=A&&A.navigation&&A.navigation.location?A.navigation.location.pathname:null;t||(O=O.toLowerCase(),N=N?N.toLowerCase():null,P=P.toLowerCase()),N&&C&&(N=kl(N,C)||N);const V=P!=="/"&&P.endsWith("/")?P.length-1:P.length;let z=O===P||!r&&O.startsWith(P)&&O.charAt(V)==="/",H=N!=null&&(N===P||!r&&N.startsWith(P)&&N.charAt(P.length)==="/"),R={isActive:z,isPending:H,isTransitioning:S},D=z?e:void 0,L;typeof n=="function"?L=n(R):L=[n,z?"active":null,H?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let U=typeof i=="function"?i(R):i;return q.createElement(o_,{...h,"aria-current":D,className:L,ref:f,style:U,to:o,viewTransition:u},typeof d=="function"?d(R):d)});GR.displayName="NavLink";var X7=q.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:r,state:i,method:o=hA,action:u,onSubmit:d,relative:h,preventScrollReset:f,viewTransition:g,unstable_defaultShouldRevalidate:w,...A},F)=>{let{unstable_useTransitions:C}=q.useContext(Xs),S=tB(),P=nB(u,{relative:h}),O=o.toLowerCase()==="get"?"get":"post",N=typeof u=="string"&&WR.test(u),V=z=>{if(d&&d(z),z.defaultPrevented)return;z.preventDefault();let H=z.nativeEvent.submitter,R=(H==null?void 0:H.getAttribute("formmethod"))||o,D=()=>S(H||z.currentTarget,{fetcherKey:e,method:R,navigate:t,replace:r,state:i,relative:h,preventScrollReset:f,viewTransition:g,unstable_defaultShouldRevalidate:w});C&&t!==!1?q.startTransition(()=>D()):D()};return q.createElement("form",{ref:F,method:O,action:P,onSubmit:n?d:V,...A,"data-discover":!N&&s==="render"?"true":void 0})});X7.displayName="Form";function Y7(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function qR(s){let e=q.useContext(Zm);return Yt(e,Y7(s)),e}function J7(s,{target:e,replace:t,state:n,preventScrollReset:r,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:u,unstable_useTransitions:d}={}){let h=ax(),f=Lu(),g=o0(s,{relative:i});return q.useCallback(w=>{if(I7(w,e)){w.preventDefault();let A=t!==void 0?t:Qg(f)===Qg(g),F=()=>h(s,{replace:A,state:n,preventScrollReset:r,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:u});d?q.startTransition(()=>F()):F()}},[f,h,g,t,n,e,s,r,i,o,u,d])}var Z7=0,eB=()=>`__${String(++Z7)}__`;function tB(){let{router:s}=qR("useSubmit"),{basename:e}=q.useContext(Xs),t=A7(),n=s.fetch,r=s.navigate;return q.useCallback(async(i,o={})=>{let{action:u,method:d,encType:h,formData:f,body:g}=D7(i,e);if(o.navigate===!1){let w=o.fetcherKey||eB();await n(w,t,o.action||u,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:f,body:g,formMethod:o.method||d,formEncType:o.encType||h,flushSync:o.flushSync})}else await r(o.action||u,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:f,body:g,formMethod:o.method||d,formEncType:o.encType||h,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[n,r,e,t])}function nB(s,{relative:e}={}){let{basename:t}=q.useContext(Xs),n=q.useContext(mo);Yt(n,"useFormAction must be used inside a RouteContext");let[r]=n.matches.slice(-1),i={...o0(s||".",{relative:e})},o=Lu();if(s==null){i.search=o.search;let u=new URLSearchParams(i.search),d=u.getAll("index");if(d.some(f=>f==="")){u.delete("index"),d.filter(g=>g).forEach(g=>u.append("index",g));let f=u.toString();i.search=f?`?${f}`:""}}return(!s||s===".")&&r.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(i.pathname=i.pathname==="/"?t:Cl([t,i.pathname])),Qg(i)}function rB(s,{relative:e}={}){let t=q.useContext(LR);Yt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=qR("useViewTransitionState"),r=o0(s,{relative:e});if(!t.isTransitioning)return!1;let i=kl(t.currentLocation.pathname,n)||t.currentLocation.pathname,o=kl(t.nextLocation.pathname,n)||t.nextLocation.pathname;return a_(r.pathname,o)!=null||a_(r.pathname,i)!=null}/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),iB=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),aI=s=>{const e=iB(s);return e.charAt(0).toUpperCase()+e.slice(1)},QR=(...s)=>s.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim(),aB=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var oB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=q.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:r="",children:i,iconNode:o,...u},d)=>q.createElement("svg",{ref:d,...oB,width:e,height:e,stroke:s,strokeWidth:n?Number(t)*24/Number(e):t,className:QR("lucide",r),...!i&&!aB(u)&&{"aria-hidden":"true"},...u},[...o.map(([h,f])=>q.createElement(h,f)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=(s,e)=>{const t=q.forwardRef(({className:n,...r},i)=>q.createElement(lB,{ref:i,iconNode:e,className:QR(`lucide-${sB(aI(s))}`,`lucide-${s}`,n),...r}));return t.displayName=aI(s),t};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],uB=gt("arrow-right",cB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],hB=gt("award",dB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],fB=gt("bell",pB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],gB=gt("book-open",mB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yB=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],wB=gt("calendar",yB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]],KR=gt("chart-no-axes-column-increasing",vB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AB=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],_B=gt("check",AB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xB=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],EB=gt("circle-check-big",xB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],CB=gt("circle-x",bB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FB=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],SB=gt("dollar-sign",FB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TB=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],kB=gt("file-check",TB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IB=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],PB=gt("file-spreadsheet",IB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RB=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Hm=gt("file-text",RB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DB=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],NB=gt("graduation-cap",DB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MB=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],LB=gt("image",MB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OB=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],BB=gt("layout-dashboard",OB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VB=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],UB=gt("list",VB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jB=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],$B=gt("lock",jB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zB=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],HB=gt("log-out",zB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WB=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],XR=gt("mail",WB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GB=[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]],YR=gt("megaphone",GB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qB=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],dF=gt("pen",qB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QB=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],l0=gt("plus",QB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KB=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],oI=gt("save",KB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XB=[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10",key:"1xqip1"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6",key:"9d2mlk"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],eb=gt("school",XB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YB=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],lx=gt("search",YB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JB=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],c0=gt("trash-2",JB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZB=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],lI=gt("upload",ZB);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e6=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],JR=gt("user",e6);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t6=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],cI=gt("users",t6);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n6=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],r6=gt("video",n6);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s6=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],pg=gt("x",s6),i6=()=>{};var uI={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZR=function(s){const e=[];let t=0;for(let n=0;n<s.length;n++){let r=s.charCodeAt(n);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&n+1<s.length&&(s.charCodeAt(n+1)&64512)===56320?(r=65536+((r&1023)<<10)+(s.charCodeAt(++n)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},a6=function(s){const e=[];let t=0,n=0;for(;t<s.length;){const r=s[t++];if(r<128)e[n++]=String.fromCharCode(r);else if(r>191&&r<224){const i=s[t++];e[n++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=s[t++],o=s[t++],u=s[t++],d=((r&7)<<18|(i&63)<<12|(o&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{const i=s[t++],o=s[t++];e[n++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},eD={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let r=0;r<s.length;r+=3){const i=s[r],o=r+1<s.length,u=o?s[r+1]:0,d=r+2<s.length,h=d?s[r+2]:0,f=i>>2,g=(i&3)<<4|u>>4;let w=(u&15)<<2|h>>6,A=h&63;d||(A=64,o||(w=64)),n.push(t[f],t[g],t[w],t[A])}return n.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(ZR(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):a6(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let r=0;r<s.length;){const i=t[s.charAt(r++)],u=r<s.length?t[s.charAt(r)]:0;++r;const h=r<s.length?t[s.charAt(r)]:64;++r;const g=r<s.length?t[s.charAt(r)]:64;if(++r,i==null||u==null||h==null||g==null)throw new o6;const w=i<<2|u>>4;if(n.push(w),h!==64){const A=u<<4&240|h>>2;if(n.push(A),g!==64){const F=h<<6&192|g;n.push(F)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class o6 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const l6=function(s){const e=ZR(s);return eD.encodeByteArray(e,!0)},l_=function(s){return l6(s).replace(/\./g,"")},tD=function(s){try{return eD.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c6(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u6=()=>c6().__FIREBASE_DEFAULTS__,d6=()=>{if(typeof process>"u"||typeof uI>"u")return;const s=uI.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},h6=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&tD(s[1]);return e&&JSON.parse(e)},cx=()=>{try{return i6()||u6()||d6()||h6()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},nD=s=>{var e,t;return(t=(e=cx())==null?void 0:e.emulatorHosts)==null?void 0:t[s]},rD=s=>{const e=nD(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},sD=()=>{var s;return(s=cx())==null?void 0:s.config},iD=s=>{var e;return(e=cx())==null?void 0:e[`_${s}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ou(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function hF(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aD(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",r=s.iat||0,i=s.sub||s.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...s};return[l_(JSON.stringify(t)),l_(JSON.stringify(o)),""].join(".")}const jg={};function f6(){const s={prod:[],emulator:[]};for(const e of Object.keys(jg))jg[e]?s.emulator.push(e):s.prod.push(e);return s}function m6(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let dI=!1;function pF(s,e){if(typeof window>"u"||typeof document>"u"||!Ou(window.location.host)||jg[s]===e||jg[s]||dI)return;jg[s]=e;function t(w){return`__firebase__banner__${w}`}const n="__firebase__banner",i=f6().prod.length>0;function o(){const w=document.getElementById(n);w&&w.remove()}function u(w){w.style.display="flex",w.style.background="#7faaf0",w.style.position="fixed",w.style.bottom="5px",w.style.left="5px",w.style.padding=".5em",w.style.borderRadius="5px",w.style.alignItems="center"}function d(w,A){w.setAttribute("width","24"),w.setAttribute("id",A),w.setAttribute("height","24"),w.setAttribute("viewBox","0 0 24 24"),w.setAttribute("fill","none"),w.style.marginLeft="-6px"}function h(){const w=document.createElement("span");return w.style.cursor="pointer",w.style.marginLeft="16px",w.style.fontSize="24px",w.innerHTML=" &times;",w.onclick=()=>{dI=!0,o()},w}function f(w,A){w.setAttribute("id",A),w.innerText="Learn more",w.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",w.setAttribute("target","__blank"),w.style.paddingLeft="5px",w.style.textDecoration="underline"}function g(){const w=m6(n),A=t("text"),F=document.getElementById(A)||document.createElement("span"),C=t("learnmore"),S=document.getElementById(C)||document.createElement("a"),P=t("preprendIcon"),O=document.getElementById(P)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(w.created){const N=w.element;u(N),f(S,C);const V=h();d(O,P),N.append(O,F,S,V),document.body.appendChild(N)}i?(F.innerText="Preview backend disconnected.",O.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(O.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,F.innerText="Preview backend running in this workspace."),F.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function g6(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Mr())}function y6(){var e;const s=(e=cx())==null?void 0:e.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function w6(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function v6(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function A6(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function _6(){const s=Mr();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function x6(){return!y6()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function E6(){try{return typeof indexedDB=="object"}catch{return!1}}function b6(){return new Promise((s,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(n);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(n),s(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var i;e(((i=r.error)==null?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C6="FirebaseError";class go extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=C6,Object.setPrototypeOf(this,go.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,u0.prototype.create)}}class u0{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?F6(i,n):"Error",u=`${this.serviceName}: ${o} (${r}).`;return new go(r,u,n)}}function F6(s,e){return s.replace(S6,(t,n)=>{const r=e[n];return r!=null?String(r):`<${n}?>`})}const S6=/\{\$([^}]+)}/g;function T6(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function Oh(s,e){if(s===e)return!0;const t=Object.keys(s),n=Object.keys(e);for(const r of t){if(!n.includes(r))return!1;const i=s[r],o=e[r];if(hI(i)&&hI(o)){if(!Oh(i,o))return!1}else if(i!==o)return!1}for(const r of n)if(!t.includes(r))return!1;return!0}function hI(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d0(s){const e=[];for(const[t,n]of Object.entries(s))Array.isArray(n)?n.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function fg(s){const e={};return s.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[r,i]=n.split("=");e[decodeURIComponent(r)]=decodeURIComponent(i)}}),e}function mg(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function k6(s,e){const t=new I6(s,e);return t.subscribe.bind(t)}class I6{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");P6(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:n},r.next===void 0&&(r.next=FE),r.error===void 0&&(r.error=FE),r.complete===void 0&&(r.complete=FE);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function P6(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function FE(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mn(s){return s&&s._delegate?s._delegate:s}class bu{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const md="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R6{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new p6;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(n)return null;throw r}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(N6(e))try{this.getOrInitializeService({instanceIdentifier:md})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:r});n.resolve(i)}catch{}}}}clearInstance(e=md){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=md){return this.instances.has(e)}getOptions(e=md){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(i);n===u&&o.resolve(r)}return r}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);const i=this.instances.get(n);return i&&e(i,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:D6(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=md){return this.component?this.component.multipleInstances?e:md:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function D6(s){return s===md?void 0:s}function N6(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M6{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new R6(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var st;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(st||(st={}));const L6={debug:st.DEBUG,verbose:st.VERBOSE,info:st.INFO,warn:st.WARN,error:st.ERROR,silent:st.SILENT},O6=st.INFO,B6={[st.DEBUG]:"log",[st.VERBOSE]:"log",[st.INFO]:"info",[st.WARN]:"warn",[st.ERROR]:"error"},V6=(s,e,...t)=>{if(e<s.logLevel)return;const n=new Date().toISOString(),r=B6[e];if(r)console[r](`[${n}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class fF{constructor(e){this.name=e,this._logLevel=O6,this._logHandler=V6,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in st))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?L6[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,st.DEBUG,...e),this._logHandler(this,st.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,st.VERBOSE,...e),this._logHandler(this,st.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,st.INFO,...e),this._logHandler(this,st.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,st.WARN,...e),this._logHandler(this,st.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,st.ERROR,...e),this._logHandler(this,st.ERROR,...e)}}const U6=(s,e)=>e.some(t=>s instanceof t);let pI,fI;function j6(){return pI||(pI=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $6(){return fI||(fI=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const oD=new WeakMap,tb=new WeakMap,lD=new WeakMap,SE=new WeakMap,mF=new WeakMap;function z6(s){const e=new Promise((t,n)=>{const r=()=>{s.removeEventListener("success",i),s.removeEventListener("error",o)},i=()=>{t(wu(s.result)),r()},o=()=>{n(s.error),r()};s.addEventListener("success",i),s.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&oD.set(t,s)}).catch(()=>{}),mF.set(e,s),e}function H6(s){if(tb.has(s))return;const e=new Promise((t,n)=>{const r=()=>{s.removeEventListener("complete",i),s.removeEventListener("error",o),s.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(s.error||new DOMException("AbortError","AbortError")),r()};s.addEventListener("complete",i),s.addEventListener("error",o),s.addEventListener("abort",o)});tb.set(s,e)}let nb={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return tb.get(s);if(e==="objectStoreNames")return s.objectStoreNames||lD.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return wu(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function W6(s){nb=s(nb)}function G6(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=s.call(TE(this),e,...t);return lD.set(n,e.sort?e.sort():[e]),wu(n)}:$6().includes(s)?function(...e){return s.apply(TE(this),e),wu(oD.get(this))}:function(...e){return wu(s.apply(TE(this),e))}}function q6(s){return typeof s=="function"?G6(s):(s instanceof IDBTransaction&&H6(s),U6(s,j6())?new Proxy(s,nb):s)}function wu(s){if(s instanceof IDBRequest)return z6(s);if(SE.has(s))return SE.get(s);const e=q6(s);return e!==s&&(SE.set(s,e),mF.set(e,s)),e}const TE=s=>mF.get(s);function Q6(s,e,{blocked:t,upgrade:n,blocking:r,terminated:i}={}){const o=indexedDB.open(s,e),u=wu(o);return n&&o.addEventListener("upgradeneeded",d=>{n(wu(o.result),d.oldVersion,d.newVersion,wu(o.transaction),d)}),t&&o.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),u.then(d=>{i&&d.addEventListener("close",()=>i()),r&&d.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),u}const K6=["get","getKey","getAll","getAllKeys","count"],X6=["put","add","delete","clear"],kE=new Map;function mI(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(kE.get(e))return kE.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,r=X6.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(r||K6.includes(t)))return;const i=async function(o,...u){const d=this.transaction(o,r?"readwrite":"readonly");let h=d.store;return n&&(h=h.index(u.shift())),(await Promise.all([h[t](...u),r&&d.done]))[0]};return kE.set(e,i),i}W6(s=>({...s,get:(e,t,n)=>mI(e,t)||s.get(e,t,n),has:(e,t)=>!!mI(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y6{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(J6(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function J6(s){const e=s.getComponent();return(e==null?void 0:e.type)==="VERSION"}const rb="@firebase/app",gI="0.14.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Il=new fF("@firebase/app"),Z6="@firebase/app-compat",e5="@firebase/analytics-compat",t5="@firebase/analytics",n5="@firebase/app-check-compat",r5="@firebase/app-check",s5="@firebase/auth",i5="@firebase/auth-compat",a5="@firebase/database",o5="@firebase/data-connect",l5="@firebase/database-compat",c5="@firebase/functions",u5="@firebase/functions-compat",d5="@firebase/installations",h5="@firebase/installations-compat",p5="@firebase/messaging",f5="@firebase/messaging-compat",m5="@firebase/performance",g5="@firebase/performance-compat",y5="@firebase/remote-config",w5="@firebase/remote-config-compat",v5="@firebase/storage",A5="@firebase/storage-compat",_5="@firebase/firestore",x5="@firebase/ai",E5="@firebase/firestore-compat",b5="firebase",C5="12.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sb="[DEFAULT]",F5={[rb]:"fire-core",[Z6]:"fire-core-compat",[t5]:"fire-analytics",[e5]:"fire-analytics-compat",[r5]:"fire-app-check",[n5]:"fire-app-check-compat",[s5]:"fire-auth",[i5]:"fire-auth-compat",[a5]:"fire-rtdb",[o5]:"fire-data-connect",[l5]:"fire-rtdb-compat",[c5]:"fire-fn",[u5]:"fire-fn-compat",[d5]:"fire-iid",[h5]:"fire-iid-compat",[p5]:"fire-fcm",[f5]:"fire-fcm-compat",[m5]:"fire-perf",[g5]:"fire-perf-compat",[y5]:"fire-rc",[w5]:"fire-rc-compat",[v5]:"fire-gcs",[A5]:"fire-gcs-compat",[_5]:"fire-fst",[E5]:"fire-fst-compat",[x5]:"fire-vertex","fire-js":"fire-js",[b5]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c_=new Map,S5=new Map,ib=new Map;function yI(s,e){try{s.container.addComponent(e)}catch(t){Il.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function Bh(s){const e=s.name;if(ib.has(e))return Il.debug(`There were multiple attempts to register component ${e}.`),!1;ib.set(e,s);for(const t of c_.values())yI(t,s);for(const t of S5.values())yI(t,s);return!0}function ux(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function _i(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T5={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},vu=new u0("app","Firebase",T5);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k5{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new bu("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw vu.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yh=C5;function cD(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const n={name:sb,automaticDataCollectionEnabled:!0,...e},r=n.name;if(typeof r!="string"||!r)throw vu.create("bad-app-name",{appName:String(r)});if(t||(t=sD()),!t)throw vu.create("no-options");const i=c_.get(r);if(i){if(Oh(t,i.options)&&Oh(n,i.config))return i;throw vu.create("duplicate-app",{appName:r})}const o=new M6(r);for(const d of ib.values())o.addComponent(d);const u=new k5(t,n,o);return c_.set(r,u),u}function gF(s=sb){const e=c_.get(s);if(!e&&s===sb&&sD())return cD();if(!e)throw vu.create("no-app",{appName:s});return e}function eo(s,e,t){let n=F5[s]??s;t&&(n+=`-${t}`);const r=n.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const o=[`Unable to register library "${n}" with version "${e}":`];r&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),r&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Il.warn(o.join(" "));return}Bh(new bu(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I5="firebase-heartbeat-database",P5=1,Kg="firebase-heartbeat-store";let IE=null;function uD(){return IE||(IE=Q6(I5,P5,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(Kg)}catch(t){console.warn(t)}}}}).catch(s=>{throw vu.create("idb-open",{originalErrorMessage:s.message})})),IE}async function R5(s){try{const t=(await uD()).transaction(Kg),n=await t.objectStore(Kg).get(dD(s));return await t.done,n}catch(e){if(e instanceof go)Il.warn(e.message);else{const t=vu.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Il.warn(t.message)}}}async function wI(s,e){try{const n=(await uD()).transaction(Kg,"readwrite");await n.objectStore(Kg).put(e,dD(s)),await n.done}catch(t){if(t instanceof go)Il.warn(t.message);else{const n=vu.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Il.warn(n.message)}}}function dD(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D5=1024,N5=30;class M5{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new O5(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=vI();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats.length>N5){const o=B5(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Il.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=vI(),{heartbeatsToSend:n,unsentEntries:r}=L5(this._heartbeatsCache.heartbeats),i=l_(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return Il.warn(t),""}}}function vI(){return new Date().toISOString().substring(0,10)}function L5(s,e=D5){const t=[];let n=s.slice();for(const r of s){const i=t.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),AI(t)>e){i.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),AI(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class O5{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return E6()?b6().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await R5(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return wI(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return wI(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function AI(s){return l_(JSON.stringify({version:2,heartbeats:s})).length}function B5(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let n=1;n<s.length;n++)s[n].date<t&&(t=s[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V5(s){Bh(new bu("platform-logger",e=>new Y6(e),"PRIVATE")),Bh(new bu("heartbeat",e=>new M5(e),"PRIVATE")),eo(rb,gI,s),eo(rb,gI,"esm2020"),eo("fire-js","")}V5("");var U5="firebase",j5="12.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */eo(U5,j5,"app");function hD(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const $5=hD,pD=new u0("auth","Firebase",hD());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u_=new fF("@firebase/auth");function z5(s,...e){u_.logLevel<=st.WARN&&u_.warn(`Auth (${Yh}): ${s}`,...e)}function fA(s,...e){u_.logLevel<=st.ERROR&&u_.error(`Auth (${Yh}): ${s}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function na(s,...e){throw yF(s,...e)}function to(s,...e){return yF(s,...e)}function fD(s,e,t){const n={...$5(),[e]:t};return new u0("auth","Firebase",n).create(e,{appName:s.name})}function Au(s){return fD(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function yF(s,...e){if(typeof s!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=s.name),s._errorFactory.create(t,...n)}return pD.create(s,...e)}function je(s,e,...t){if(!s)throw yF(e,...t)}function El(s){const e="INTERNAL ASSERTION FAILED: "+s;throw fA(e),new Error(e)}function Pl(s,e){s||El(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ab(){var s;return typeof self<"u"&&((s=self.location)==null?void 0:s.href)||""}function H5(){return _I()==="http:"||_I()==="https:"}function _I(){var s;return typeof self<"u"&&((s=self.location)==null?void 0:s.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W5(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(H5()||v6()||"connection"in navigator)?navigator.onLine:!0}function G5(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h0{constructor(e,t){this.shortDelay=e,this.longDelay=t,Pl(t>e,"Short delay should be less than long delay!"),this.isMobile=g6()||A6()}get(){return W5()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wF(s,e){Pl(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mD{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;El("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;El("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;El("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q5={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q5=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],K5=new h0(3e4,6e4);function Jh(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function Bu(s,e,t,n,r={}){return gD(s,r,async()=>{let i={},o={};n&&(e==="GET"?o=n:i={body:JSON.stringify(n)});const u=d0({key:s.config.apiKey,...o}).slice(1),d=await s._getAdditionalHeaders();d["Content-Type"]="application/json",s.languageCode&&(d["X-Firebase-Locale"]=s.languageCode);const h={method:e,headers:d,...i};return w6()||(h.referrerPolicy="no-referrer"),s.emulatorConfig&&Ou(s.emulatorConfig.host)&&(h.credentials="include"),mD.fetch()(await yD(s,s.config.apiHost,t,u),h)})}async function gD(s,e,t){s._canInitEmulator=!1;const n={...q5,...e};try{const r=new Y5(s),i=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Qv(s,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const u=i.ok?o.errorMessage:o.error.message,[d,h]=u.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw Qv(s,"credential-already-in-use",o);if(d==="EMAIL_EXISTS")throw Qv(s,"email-already-in-use",o);if(d==="USER_DISABLED")throw Qv(s,"user-disabled",o);const f=n[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw fD(s,f,h);na(s,f)}}catch(r){if(r instanceof go)throw r;na(s,"network-request-failed",{message:String(r)})}}async function dx(s,e,t,n,r={}){const i=await Bu(s,e,t,n,r);return"mfaPendingCredential"in i&&na(s,"multi-factor-auth-required",{_serverResponse:i}),i}async function yD(s,e,t,n){const r=`${e}${t}?${n}`,i=s,o=i.config.emulator?wF(s.config,r):`${s.config.apiScheme}://${r}`;return Q5.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function X5(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Y5{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(to(this.auth,"network-request-failed")),K5.get())})}}function Qv(s,e,t){const n={appName:s.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const r=to(s,e,n);return r.customData._tokenResponse=t,r}function xI(s){return s!==void 0&&s.enterprise!==void 0}class J5{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return X5(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Z5(s,e){return Bu(s,"GET","/v2/recaptchaConfig",Jh(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eV(s,e){return Bu(s,"POST","/v1/accounts:delete",e)}async function d_(s,e){return Bu(s,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $g(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function tV(s,e=!1){const t=mn(s),n=await t.getIdToken(e),r=vF(n);je(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:r,token:n,authTime:$g(PE(r.auth_time)),issuedAtTime:$g(PE(r.iat)),expirationTime:$g(PE(r.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function PE(s){return Number(s)*1e3}function vF(s){const[e,t,n]=s.split(".");if(e===void 0||t===void 0||n===void 0)return fA("JWT malformed, contained fewer than 3 sections"),null;try{const r=tD(t);return r?JSON.parse(r):(fA("Failed to decode base64 JWT payload"),null)}catch(r){return fA("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function EI(s){const e=vF(s);return je(e,"internal-error"),je(typeof e.exp<"u","internal-error"),je(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xg(s,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof go&&nV(n)&&s.auth.currentUser===s&&await s.auth.signOut(),n}}function nV({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=$g(this.lastLoginAt),this.creationTime=$g(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h_(s){var g;const e=s.auth,t=await s.getIdToken(),n=await Xg(s,d_(e,{idToken:t}));je(n==null?void 0:n.users.length,e,"internal-error");const r=n.users[0];s._notifyReloadListener(r);const i=(g=r.providerUserInfo)!=null&&g.length?wD(r.providerUserInfo):[],o=iV(s.providerData,i),u=s.isAnonymous,d=!(s.email&&r.passwordHash)&&!(o!=null&&o.length),h=u?d:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new ob(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(s,f)}async function sV(s){const e=mn(s);await h_(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function iV(s,e){return[...s.filter(n=>!e.some(r=>r.providerId===n.providerId)),...e]}function wD(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aV(s,e){const t=await gD(s,{},async()=>{const n=d0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=s.config,o=await yD(s,r,"/v1/token",`key=${i}`),u=await s._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:u,body:n};return s.emulatorConfig&&Ou(s.emulatorConfig.host)&&(d.credentials="include"),mD.fetch()(o,d)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function oV(s,e){return Bu(s,"POST","/v2/accounts:revokeToken",Jh(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){je(e.idToken,"internal-error"),je(typeof e.idToken<"u","internal-error"),je(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):EI(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){je(e.length!==0,"internal-error");const t=EI(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(je(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await aV(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,o=new df;return n&&(je(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),r&&(je(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),i&&(je(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new df,this.toJSON())}_performRefresh(){return El("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fc(s,e){je(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class Yi{constructor({uid:e,auth:t,stsTokenManager:n,...r}){this.providerId="firebase",this.proactiveRefresh=new rV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new ob(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Xg(this,this.stsTokenManager.getToken(this.auth,e));return je(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return tV(this,e)}reload(){return sV(this)}_assign(e){this!==e&&(je(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Yi({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){je(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await h_(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(_i(this.auth.app))return Promise.reject(Au(this.auth));const e=await this.getIdToken();return await Xg(this,eV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,r=t.email??void 0,i=t.phoneNumber??void 0,o=t.photoURL??void 0,u=t.tenantId??void 0,d=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:g,emailVerified:w,isAnonymous:A,providerData:F,stsTokenManager:C}=t;je(g&&C,e,"internal-error");const S=df.fromJSON(this.name,C);je(typeof g=="string",e,"internal-error"),fc(n,e.name),fc(r,e.name),je(typeof w=="boolean",e,"internal-error"),je(typeof A=="boolean",e,"internal-error"),fc(i,e.name),fc(o,e.name),fc(u,e.name),fc(d,e.name),fc(h,e.name),fc(f,e.name);const P=new Yi({uid:g,auth:e,email:r,emailVerified:w,displayName:n,isAnonymous:A,photoURL:o,phoneNumber:i,tenantId:u,stsTokenManager:S,createdAt:h,lastLoginAt:f});return F&&Array.isArray(F)&&(P.providerData=F.map(O=>({...O}))),d&&(P._redirectEventId=d),P}static async _fromIdTokenResponse(e,t,n=!1){const r=new df;r.updateFromServerResponse(t);const i=new Yi({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await h_(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];je(r.localId!==void 0,"internal-error");const i=r.providerUserInfo!==void 0?wD(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(i!=null&&i.length),u=new df;u.updateFromIdToken(n);const d=new Yi({uid:r.localId,auth:e,stsTokenManager:u,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new ob(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(i!=null&&i.length)};return Object.assign(d,h),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bI=new Map;function bl(s){Pl(s instanceof Function,"Expected a class definition");let e=bI.get(s);return e?(Pl(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,bI.set(s,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}vD.type="NONE";const CI=vD;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mA(s,e,t){return`firebase:${s}:${e}:${t}`}class hf{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=mA(this.userKey,r.apiKey,i),this.fullPersistenceKey=mA("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await d_(this.auth,{idToken:e}).catch(()=>{});return t?Yi._fromGetAccountInfoResponse(this.auth,t,e):null}return Yi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new hf(bl(CI),e,n);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=r[0]||bl(CI);const o=mA(n,e.config.apiKey,e.name);let u=null;for(const h of t)try{const f=await h._get(o);if(f){let g;if(typeof f=="string"){const w=await d_(e,{idToken:f}).catch(()=>{});if(!w)break;g=await Yi._fromGetAccountInfoResponse(e,w,f)}else g=Yi._fromJSON(e,f);h!==i&&(u=g),i=h;break}}catch{}const d=r.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!d.length?new hf(i,e,n):(i=d[0],u&&await i._set(o,u.toJSON()),await Promise.all(t.map(async h=>{if(h!==i)try{await h._remove(o)}catch{}})),new hf(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FI(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ED(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(AD(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(CD(e))return"Blackberry";if(FD(e))return"Webos";if(_D(e))return"Safari";if((e.includes("chrome/")||xD(e))&&!e.includes("edge/"))return"Chrome";if(bD(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=s.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function AD(s=Mr()){return/firefox\//i.test(s)}function _D(s=Mr()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function xD(s=Mr()){return/crios\//i.test(s)}function ED(s=Mr()){return/iemobile/i.test(s)}function bD(s=Mr()){return/android/i.test(s)}function CD(s=Mr()){return/blackberry/i.test(s)}function FD(s=Mr()){return/webos/i.test(s)}function AF(s=Mr()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function lV(s=Mr()){var e;return AF(s)&&!!((e=window.navigator)!=null&&e.standalone)}function cV(){return _6()&&document.documentMode===10}function SD(s=Mr()){return AF(s)||bD(s)||FD(s)||CD(s)||/windows phone/i.test(s)||ED(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TD(s,e=[]){let t;switch(s){case"Browser":t=FI(Mr());break;case"Worker":t=`${FI(Mr())}-${s}`;break;default:t=s}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Yh}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=i=>new Promise((o,u)=>{try{const d=e(i);o(d)}catch(d){u(d)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dV(s,e={}){return Bu(s,"GET","/v2/passwordPolicy",Jh(s,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hV=6;class pV{constructor(e){var n;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??hV,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fV{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new SI(this),this.idTokenSubscription=new SI(this),this.beforeStateQueue=new uV(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=pD,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=bl(t)),this._initializationPromise=this.queue(async()=>{var n,r,i;if(!this._deleted&&(this.persistenceManager=await hf.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((r=this._popupRedirectResolver)!=null&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await d_(this,{idToken:e}),n=await Yi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(_i(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(u,u))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,u=n==null?void 0:n._redirectEventId,d=await this.tryRedirectSignIn(e);(!o||o===u)&&(d!=null&&d.user)&&(n=d.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return je(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await h_(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=G5()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(_i(this.app))return Promise.reject(Au(this));const t=e?mn(e):null;return t&&je(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&je(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return _i(this.app)?Promise.reject(Au(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return _i(this.app)?Promise.reject(Au(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(bl(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await dV(this),t=new pV(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new u0("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await oV(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&bl(e)||this._popupRedirectResolver;je(t,this,"argument-error"),this.redirectPersistenceManager=await hf.create(this,[bl(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(je(u,this,"internal-error"),u.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,n,r);return()=>{o=!0,d()}}else{const d=e.addObserver(t);return()=>{o=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return je(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=TD(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var r;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((r=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var t;if(_i(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&z5(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function t2(s){return mn(s)}class SI{constructor(e){this.auth=e,this.observer=null,this.addObserver=k6(t=>this.observer=t)}get next(){return je(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hx={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function mV(s){hx=s}function kD(s){return hx.loadJS(s)}function gV(){return hx.recaptchaEnterpriseScript}function yV(){return hx.gapiScript}function wV(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class vV{constructor(){this.enterprise=new AV}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class AV{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const _V="recaptcha-enterprise",ID="NO_RECAPTCHA";class xV{constructor(e){this.type=_V,this.auth=t2(e)}async verify(e="verify",t=!1){async function n(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,u)=>{Z5(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const h=new J5(d);return i.tenantId==null?i._agentRecaptchaConfig=h:i._tenantRecaptchaConfigs[i.tenantId]=h,o(h.siteKey)}}).catch(d=>{u(d)})})}function r(i,o,u){const d=window.grecaptcha;xI(d)?d.enterprise.ready(()=>{d.enterprise.execute(i,{action:e}).then(h=>{o(h)}).catch(()=>{o(ID)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new vV().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{n(this.auth).then(u=>{if(!t&&xI(window.grecaptcha))r(u,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let d=gV();d.length!==0&&(d+=u),kD(d).then(()=>{r(u,i,o)}).catch(h=>{o(h)})}}).catch(u=>{o(u)})})}}async function TI(s,e,t,n=!1,r=!1){const i=new xV(s);let o;if(r)o=ID;else try{o=await i.verify(t)}catch{o=await i.verify(t,!0)}const u={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const d=u.phoneEnrollmentInfo.phoneNumber,h=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:d,recaptchaToken:h,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const d=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return n?Object.assign(u,{captchaResp:o}):Object.assign(u,{captchaResponse:o}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function kI(s,e,t,n,r){var i;if((i=s._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await TI(s,e,t,t==="getOobCode");return n(s,o)}else return n(s,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await TI(s,e,t,t==="getOobCode");return n(s,u)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EV(s,e){const t=ux(s,"auth");if(t.isInitialized()){const r=t.getImmediate(),i=t.getOptions();if(Oh(i,e??{}))return r;na(r,"already-initialized")}return t.initialize({options:e})}function bV(s,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(bl);e!=null&&e.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function CV(s,e,t){const n=t2(s);je(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const r=!1,i=PD(e),{host:o,port:u}=FV(e),d=u===null?"":`:${u}`,h={url:`${i}//${o}${d}/`},f=Object.freeze({host:o,port:u,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!n._canInitEmulator){je(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),je(Oh(h,n.config.emulator)&&Oh(f,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=f,n.settings.appVerificationDisabledForTesting=!0,Ou(o)?(hF(`${i}//${o}${d}`),pF("Auth",!0)):SV()}function PD(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function FV(s){const e=PD(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(n);if(r){const i=r[1];return{host:i,port:II(n.substr(i.length+1))}}else{const[i,o]=n.split(":");return{host:i,port:II(o)}}}function II(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function SV(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _F{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return El("not implemented")}_getIdTokenResponse(e){return El("not implemented")}_linkToIdToken(e,t){return El("not implemented")}_getReauthenticationResolver(e){return El("not implemented")}}async function TV(s,e){return Bu(s,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kV(s,e){return dx(s,"POST","/v1/accounts:signInWithPassword",Jh(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IV(s,e){return dx(s,"POST","/v1/accounts:signInWithEmailLink",Jh(s,e))}async function PV(s,e){return dx(s,"POST","/v1/accounts:signInWithEmailLink",Jh(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yg extends _F{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Yg(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Yg(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return kI(e,t,"signInWithPassword",kV);case"emailLink":return IV(e,{email:this._email,oobCode:this._password});default:na(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return kI(e,n,"signUpPassword",TV);case"emailLink":return PV(e,{idToken:t,email:this._email,oobCode:this._password});default:na(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pf(s,e){return dx(s,"POST","/v1/accounts:signInWithIdp",Jh(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RV="http://localhost";class Vh extends _F{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Vh(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):na("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:r,...i}=t;if(!n||!r)return null;const o=new Vh(n,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return pf(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,pf(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,pf(e,t)}buildRequest(){const e={requestUri:RV,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=d0(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DV(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function NV(s){const e=fg(mg(s)).link,t=e?fg(mg(e)).deep_link_id:null,n=fg(mg(s)).deep_link_id;return(n?fg(mg(n)).link:null)||n||t||e||s}class xF{constructor(e){const t=fg(mg(e)),n=t.apiKey??null,r=t.oobCode??null,i=DV(t.mode??null);je(n&&r&&i,"argument-error"),this.apiKey=n,this.operation=i,this.code=r,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=NV(e);try{return new xF(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(){this.providerId=n2.PROVIDER_ID}static credential(e,t){return Yg._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=xF.parseLink(t);return je(n,"argument-error"),Yg._fromEmailAndCode(e,n.code,n.tenantId)}}n2.PROVIDER_ID="password";n2.EMAIL_PASSWORD_SIGN_IN_METHOD="password";n2.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0 extends RD{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc extends p0{constructor(){super("facebook.com")}static credential(e){return Vh._fromParams({providerId:gc.PROVIDER_ID,signInMethod:gc.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return gc.credentialFromTaggedObject(e)}static credentialFromError(e){return gc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return gc.credential(e.oauthAccessToken)}catch{return null}}}gc.FACEBOOK_SIGN_IN_METHOD="facebook.com";gc.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc extends p0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Vh._fromParams({providerId:yc.PROVIDER_ID,signInMethod:yc.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return yc.credentialFromTaggedObject(e)}static credentialFromError(e){return yc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return yc.credential(t,n)}catch{return null}}}yc.GOOGLE_SIGN_IN_METHOD="google.com";yc.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc extends p0{constructor(){super("github.com")}static credential(e){return Vh._fromParams({providerId:wc.PROVIDER_ID,signInMethod:wc.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wc.credentialFromTaggedObject(e)}static credentialFromError(e){return wc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wc.credential(e.oauthAccessToken)}catch{return null}}}wc.GITHUB_SIGN_IN_METHOD="github.com";wc.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc extends p0{constructor(){super("twitter.com")}static credential(e,t){return Vh._fromParams({providerId:vc.PROVIDER_ID,signInMethod:vc.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return vc.credentialFromTaggedObject(e)}static credentialFromError(e){return vc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return vc.credential(t,n)}catch{return null}}}vc.TWITTER_SIGN_IN_METHOD="twitter.com";vc.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await Yi._fromIdTokenResponse(e,n,r),o=PI(n);return new Wm({user:i,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=PI(n);return new Wm({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function PI(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_ extends go{constructor(e,t,n,r){super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,p_.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new p_(e,t,n,r)}}function DD(s,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?p_._fromErrorAndOperation(s,i,e,n):i})}async function MV(s,e,t=!1){const n=await Xg(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Wm._forOperation(s,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LV(s,e,t=!1){const{auth:n}=s;if(_i(n.app))return Promise.reject(Au(n));const r="reauthenticate";try{const i=await Xg(s,DD(n,r,e,s),t);je(i.idToken,n,"internal-error");const o=vF(i.idToken);je(o,n,"internal-error");const{sub:u}=o;return je(s.uid===u,n,"user-mismatch"),Wm._forOperation(s,r,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&na(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ND(s,e,t=!1){if(_i(s.app))return Promise.reject(Au(s));const n="signIn",r=await DD(s,n,e),i=await Wm._fromIdTokenResponse(s,n,r);return t||await s._updateCurrentUser(i.user),i}async function OV(s,e){return ND(t2(s),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BV(s){const e=t2(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function VV(s,e,t){return _i(s.app)?Promise.reject(Au(s)):OV(mn(s),n2.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&BV(s),n})}function UV(s,e,t,n){return mn(s).onIdTokenChanged(e,t,n)}function jV(s,e,t){return mn(s).beforeAuthStateChanged(e,t)}function $V(s,e,t,n){return mn(s).onAuthStateChanged(e,t,n)}const f_="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(f_,"1"),this.storage.removeItem(f_),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zV=1e3,HV=10;class LD extends MD{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=SD(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,u,d)=>{this.notifyListeners(o,d)});return}const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(n);!t&&this.localCache[n]===o||this.notifyListeners(n,o)},i=this.storage.getItem(n);cV()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,HV):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},zV)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}LD.type="LOCAL";const WV=LD;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD extends MD{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}OD.type="SESSION";const BD=OD;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GV(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class px{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const n=new px(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const u=Array.from(o).map(async h=>h(t.origin,i)),d=await GV(u);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}px.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EF(s="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return s+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qV{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise((u,d)=>{const h=EF("",20);r.port1.start();const f=setTimeout(()=>{d(new Error("unsupported_event"))},n);o={messageChannel:r,onMessage(g){const w=g;if(w.data.eventId===h)switch(w.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),u(w.data.response);break;default:clearTimeout(f),clearTimeout(i),d(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function no(){return window}function QV(s){no().location.href=s}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VD(){return typeof no().WorkerGlobalScope<"u"&&typeof no().importScripts=="function"}async function KV(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function XV(){var s;return((s=navigator==null?void 0:navigator.serviceWorker)==null?void 0:s.controller)||null}function YV(){return VD()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UD="firebaseLocalStorageDb",JV=1,m_="firebaseLocalStorage",jD="fbase_key";class f0{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function fx(s,e){return s.transaction([m_],e?"readwrite":"readonly").objectStore(m_)}function ZV(){const s=indexedDB.deleteDatabase(UD);return new f0(s).toPromise()}function lb(){const s=indexedDB.open(UD,JV);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const n=s.result;try{n.createObjectStore(m_,{keyPath:jD})}catch(r){t(r)}}),s.addEventListener("success",async()=>{const n=s.result;n.objectStoreNames.contains(m_)?e(n):(n.close(),await ZV(),e(await lb()))})})}async function RI(s,e,t){const n=fx(s,!0).put({[jD]:e,value:t});return new f0(n).toPromise()}async function eU(s,e){const t=fx(s,!1).get(e),n=await new f0(t).toPromise();return n===void 0?null:n.value}function DI(s,e){const t=fx(s,!0).delete(e);return new f0(t).toPromise()}const tU=800,nU=3;class $D{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await lb(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>nU)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return VD()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=px._getInstance(YV()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,n;if(this.activeServiceWorker=await KV(),!this.activeServiceWorker)return;this.sender=new qV(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||XV()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await lb();return await RI(e,f_,"1"),await DI(e,f_),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>RI(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>eU(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>DI(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=fx(r,!1).getAll();return new f0(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),tU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}$D.type="LOCAL";const rU=$D;new h0(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sU(s,e){return e?bl(e):(je(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bF extends _F{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return pf(e,this._buildIdpRequest())}_linkToIdToken(e,t){return pf(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return pf(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function iU(s){return ND(s.auth,new bF(s),s.bypassAuthState)}function aU(s){const{auth:e,user:t}=s;return je(t,e,"internal-error"),LV(t,new bF(s),s.bypassAuthState)}async function oU(s){const{auth:e,user:t}=s;return je(t,e,"internal-error"),MV(t,new bF(s),s.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:o,type:u}=e;if(o){this.reject(o);return}const d={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(d))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return iU;case"linkViaPopup":case"linkViaRedirect":return oU;case"reauthViaPopup":case"reauthViaRedirect":return aU;default:na(this.auth,"internal-error")}}resolve(e){Pl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Pl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lU=new h0(2e3,1e4);class rf extends zD{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,rf.currentPopupAction&&rf.currentPopupAction.cancel(),rf.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return je(e,this.auth,"internal-error"),e}async onExecution(){Pl(this.filter.length===1,"Popup operations only handle one event");const e=EF();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(to(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(to(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,rf.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if((n=(t=this.authWindow)==null?void 0:t.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(to(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,lU.get())};e()}}rf.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cU="pendingRedirect",gA=new Map;class uU extends zD{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=gA.get(this.auth._key());if(!e){try{const n=await dU(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}gA.set(this.auth._key(),e)}return this.bypassAuthState||gA.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function dU(s,e){const t=fU(e),n=pU(s);if(!await n._isAvailable())return!1;const r=await n._get(t)==="true";return await n._remove(t),r}function hU(s,e){gA.set(s._key(),e)}function pU(s){return bl(s._redirectPersistence)}function fU(s){return mA(cU,s.config.apiKey,s.name)}async function mU(s,e,t=!1){if(_i(s.app))return Promise.reject(Au(s));const n=t2(s),r=sU(n,e),o=await new uU(n,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gU=600*1e3;class yU{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!wU(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!HD(e)){const r=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";t.onError(to(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=gU&&this.cachedEventUids.clear(),this.cachedEventUids.has(NI(e))}saveEventToCache(e){this.cachedEventUids.add(NI(e)),this.lastProcessedEventTime=Date.now()}}function NI(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function HD({type:s,error:e}){return s==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function wU(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return HD(s);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vU(s,e={}){return Bu(s,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AU=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_U=/^https?/;async function xU(s){if(s.config.emulator)return;const{authorizedDomains:e}=await vU(s);for(const t of e)try{if(EU(t))return}catch{}na(s,"unauthorized-domain")}function EU(s){const e=ab(),{protocol:t,hostname:n}=new URL(e);if(s.startsWith("chrome-extension://")){const o=new URL(s);return o.hostname===""&&n===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===n}if(!_U.test(t))return!1;if(AU.test(s))return n===s;const r=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bU=new h0(3e4,6e4);function MI(){const s=no().___jsl;if(s!=null&&s.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function CU(s){return new Promise((e,t)=>{var r,i,o;function n(){MI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{MI(),t(to(s,"network-request-failed"))},timeout:bU.get()})}if((i=(r=no().gapi)==null?void 0:r.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=no().gapi)!=null&&o.load)n();else{const u=wV("iframefcb");return no()[u]=()=>{gapi.load?n():t(to(s,"network-request-failed"))},kD(`${yV()}?onload=${u}`).catch(d=>t(d))}}).catch(e=>{throw yA=null,e})}let yA=null;function FU(s){return yA=yA||CU(s),yA}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SU=new h0(5e3,15e3),TU="__/auth/iframe",kU="emulator/auth/iframe",IU={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},PU=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function RU(s){const e=s.config;je(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?wF(e,kU):`https://${s.config.authDomain}/${TU}`,n={apiKey:e.apiKey,appName:s.name,v:Yh},r=PU.get(s.config.apiHost);r&&(n.eid=r);const i=s._getFrameworks();return i.length&&(n.fw=i.join(",")),`${t}?${d0(n).slice(1)}`}async function DU(s){const e=await FU(s),t=no().gapi;return je(t,s,"internal-error"),e.open({where:document.body,url:RU(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:IU,dontclear:!0},n=>new Promise(async(r,i)=>{await n.restyle({setHideOnLeave:!1});const o=to(s,"network-request-failed"),u=no().setTimeout(()=>{i(o)},SU.get());function d(){no().clearTimeout(u),r(n)}n.ping(d).then(d,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NU={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},MU=500,LU=600,OU="_blank",BU="http://localhost";class LI{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function VU(s,e,t,n=MU,r=LU){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const d={...NU,width:n.toString(),height:r.toString(),top:i,left:o},h=Mr().toLowerCase();t&&(u=xD(h)?OU:t),AD(h)&&(e=e||BU,d.scrollbars="yes");const f=Object.entries(d).reduce((w,[A,F])=>`${w}${A}=${F},`,"");if(lV(h)&&u!=="_self")return UU(e||"",u),new LI(null);const g=window.open(e||"",u,f);je(g,s,"popup-blocked");try{g.focus()}catch{}return new LI(g)}function UU(s,e){const t=document.createElement("a");t.href=s,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jU="__/auth/handler",$U="emulator/auth/handler",zU=encodeURIComponent("fac");async function OI(s,e,t,n,r,i){je(s.config.authDomain,s,"auth-domain-config-required"),je(s.config.apiKey,s,"invalid-api-key");const o={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:n,v:Yh,eventId:r};if(e instanceof RD){e.setDefaultLanguage(s.languageCode),o.providerId=e.providerId||"",T6(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,g]of Object.entries({}))o[f]=g}if(e instanceof p0){const f=e.getScopes().filter(g=>g!=="");f.length>0&&(o.scopes=f.join(","))}s.tenantId&&(o.tid=s.tenantId);const u=o;for(const f of Object.keys(u))u[f]===void 0&&delete u[f];const d=await s._getAppCheckToken(),h=d?`#${zU}=${encodeURIComponent(d)}`:"";return`${HU(s)}?${d0(u).slice(1)}${h}`}function HU({config:s}){return s.emulator?wF(s,$U):`https://${s.authDomain}/${jU}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RE="webStorageSupport";class WU{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=BD,this._completeRedirectFn=mU,this._overrideRedirectResult=hU}async _openPopup(e,t,n,r){var o;Pl((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await OI(e,t,n,ab(),r);return VU(e,i,EF())}async _openRedirect(e,t,n,r){await this._originValidation(e);const i=await OI(e,t,n,ab(),r);return QV(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:i}=this.eventManagers[t];return r?Promise.resolve(r):(Pl(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await DU(e),n=new yU(e);return t.register("authEvent",r=>(je(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:n.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(RE,{type:RE},r=>{var o;const i=(o=r==null?void 0:r[0])==null?void 0:o[RE];i!==void 0&&t(!!i),na(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=xU(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return SD()||_D()||AF()}}const GU=WU;var BI="@firebase/auth",VI="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qU{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){je(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QU(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function KU(s){Bh(new bu("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:u}=n.options;je(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const d={apiKey:o,authDomain:u,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:TD(s)},h=new fV(n,r,i,d);return bV(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Bh(new bu("auth-internal",e=>{const t=t2(e.getProvider("auth").getImmediate());return(n=>new qU(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),eo(BI,VI,QU(s)),eo(BI,VI,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XU=300,YU=iD("authIdTokenMaxAge")||XU;let UI=null;const JU=s=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>YU)return;const r=t==null?void 0:t.token;UI!==r&&(UI=r,await fetch(s,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function ZU(s=gF()){const e=ux(s,"auth");if(e.isInitialized())return e.getImmediate();const t=EV(s,{popupRedirectResolver:GU,persistence:[rU,WV,BD]}),n=iD("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const o=JU(i.toString());jV(t,o,()=>o(t.currentUser)),UV(t,u=>o(u))}}const r=nD("auth");return r&&CV(t,`http://${r}`),t}function ej(){var s;return((s=document.getElementsByTagName("head"))==null?void 0:s[0])??document}mV({loadJS(s){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",s),n.onload=e,n.onerror=r=>{const i=to("internal-error");i.customData=r,t(i)},n.type="text/javascript",n.charset="UTF-8",ej().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});KU("Browser");var jI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _u,WD;(function(){var s;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(R,D){function L(){}L.prototype=D.prototype,R.F=D.prototype,R.prototype=new L,R.prototype.constructor=R,R.D=function(U,j,G){for(var $=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)$[ge-2]=arguments[ge];return D.prototype[j].apply(U,$)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(R,D,L){L||(L=0);const U=Array(16);if(typeof D=="string")for(var j=0;j<16;++j)U[j]=D.charCodeAt(L++)|D.charCodeAt(L++)<<8|D.charCodeAt(L++)<<16|D.charCodeAt(L++)<<24;else for(j=0;j<16;++j)U[j]=D[L++]|D[L++]<<8|D[L++]<<16|D[L++]<<24;D=R.g[0],L=R.g[1],j=R.g[2];let G=R.g[3],$;$=D+(G^L&(j^G))+U[0]+3614090360&4294967295,D=L+($<<7&4294967295|$>>>25),$=G+(j^D&(L^j))+U[1]+3905402710&4294967295,G=D+($<<12&4294967295|$>>>20),$=j+(L^G&(D^L))+U[2]+606105819&4294967295,j=G+($<<17&4294967295|$>>>15),$=L+(D^j&(G^D))+U[3]+3250441966&4294967295,L=j+($<<22&4294967295|$>>>10),$=D+(G^L&(j^G))+U[4]+4118548399&4294967295,D=L+($<<7&4294967295|$>>>25),$=G+(j^D&(L^j))+U[5]+1200080426&4294967295,G=D+($<<12&4294967295|$>>>20),$=j+(L^G&(D^L))+U[6]+2821735955&4294967295,j=G+($<<17&4294967295|$>>>15),$=L+(D^j&(G^D))+U[7]+4249261313&4294967295,L=j+($<<22&4294967295|$>>>10),$=D+(G^L&(j^G))+U[8]+1770035416&4294967295,D=L+($<<7&4294967295|$>>>25),$=G+(j^D&(L^j))+U[9]+2336552879&4294967295,G=D+($<<12&4294967295|$>>>20),$=j+(L^G&(D^L))+U[10]+4294925233&4294967295,j=G+($<<17&4294967295|$>>>15),$=L+(D^j&(G^D))+U[11]+2304563134&4294967295,L=j+($<<22&4294967295|$>>>10),$=D+(G^L&(j^G))+U[12]+1804603682&4294967295,D=L+($<<7&4294967295|$>>>25),$=G+(j^D&(L^j))+U[13]+4254626195&4294967295,G=D+($<<12&4294967295|$>>>20),$=j+(L^G&(D^L))+U[14]+2792965006&4294967295,j=G+($<<17&4294967295|$>>>15),$=L+(D^j&(G^D))+U[15]+1236535329&4294967295,L=j+($<<22&4294967295|$>>>10),$=D+(j^G&(L^j))+U[1]+4129170786&4294967295,D=L+($<<5&4294967295|$>>>27),$=G+(L^j&(D^L))+U[6]+3225465664&4294967295,G=D+($<<9&4294967295|$>>>23),$=j+(D^L&(G^D))+U[11]+643717713&4294967295,j=G+($<<14&4294967295|$>>>18),$=L+(G^D&(j^G))+U[0]+3921069994&4294967295,L=j+($<<20&4294967295|$>>>12),$=D+(j^G&(L^j))+U[5]+3593408605&4294967295,D=L+($<<5&4294967295|$>>>27),$=G+(L^j&(D^L))+U[10]+38016083&4294967295,G=D+($<<9&4294967295|$>>>23),$=j+(D^L&(G^D))+U[15]+3634488961&4294967295,j=G+($<<14&4294967295|$>>>18),$=L+(G^D&(j^G))+U[4]+3889429448&4294967295,L=j+($<<20&4294967295|$>>>12),$=D+(j^G&(L^j))+U[9]+568446438&4294967295,D=L+($<<5&4294967295|$>>>27),$=G+(L^j&(D^L))+U[14]+3275163606&4294967295,G=D+($<<9&4294967295|$>>>23),$=j+(D^L&(G^D))+U[3]+4107603335&4294967295,j=G+($<<14&4294967295|$>>>18),$=L+(G^D&(j^G))+U[8]+1163531501&4294967295,L=j+($<<20&4294967295|$>>>12),$=D+(j^G&(L^j))+U[13]+2850285829&4294967295,D=L+($<<5&4294967295|$>>>27),$=G+(L^j&(D^L))+U[2]+4243563512&4294967295,G=D+($<<9&4294967295|$>>>23),$=j+(D^L&(G^D))+U[7]+1735328473&4294967295,j=G+($<<14&4294967295|$>>>18),$=L+(G^D&(j^G))+U[12]+2368359562&4294967295,L=j+($<<20&4294967295|$>>>12),$=D+(L^j^G)+U[5]+4294588738&4294967295,D=L+($<<4&4294967295|$>>>28),$=G+(D^L^j)+U[8]+2272392833&4294967295,G=D+($<<11&4294967295|$>>>21),$=j+(G^D^L)+U[11]+1839030562&4294967295,j=G+($<<16&4294967295|$>>>16),$=L+(j^G^D)+U[14]+4259657740&4294967295,L=j+($<<23&4294967295|$>>>9),$=D+(L^j^G)+U[1]+2763975236&4294967295,D=L+($<<4&4294967295|$>>>28),$=G+(D^L^j)+U[4]+1272893353&4294967295,G=D+($<<11&4294967295|$>>>21),$=j+(G^D^L)+U[7]+4139469664&4294967295,j=G+($<<16&4294967295|$>>>16),$=L+(j^G^D)+U[10]+3200236656&4294967295,L=j+($<<23&4294967295|$>>>9),$=D+(L^j^G)+U[13]+681279174&4294967295,D=L+($<<4&4294967295|$>>>28),$=G+(D^L^j)+U[0]+3936430074&4294967295,G=D+($<<11&4294967295|$>>>21),$=j+(G^D^L)+U[3]+3572445317&4294967295,j=G+($<<16&4294967295|$>>>16),$=L+(j^G^D)+U[6]+76029189&4294967295,L=j+($<<23&4294967295|$>>>9),$=D+(L^j^G)+U[9]+3654602809&4294967295,D=L+($<<4&4294967295|$>>>28),$=G+(D^L^j)+U[12]+3873151461&4294967295,G=D+($<<11&4294967295|$>>>21),$=j+(G^D^L)+U[15]+530742520&4294967295,j=G+($<<16&4294967295|$>>>16),$=L+(j^G^D)+U[2]+3299628645&4294967295,L=j+($<<23&4294967295|$>>>9),$=D+(j^(L|~G))+U[0]+4096336452&4294967295,D=L+($<<6&4294967295|$>>>26),$=G+(L^(D|~j))+U[7]+1126891415&4294967295,G=D+($<<10&4294967295|$>>>22),$=j+(D^(G|~L))+U[14]+2878612391&4294967295,j=G+($<<15&4294967295|$>>>17),$=L+(G^(j|~D))+U[5]+4237533241&4294967295,L=j+($<<21&4294967295|$>>>11),$=D+(j^(L|~G))+U[12]+1700485571&4294967295,D=L+($<<6&4294967295|$>>>26),$=G+(L^(D|~j))+U[3]+2399980690&4294967295,G=D+($<<10&4294967295|$>>>22),$=j+(D^(G|~L))+U[10]+4293915773&4294967295,j=G+($<<15&4294967295|$>>>17),$=L+(G^(j|~D))+U[1]+2240044497&4294967295,L=j+($<<21&4294967295|$>>>11),$=D+(j^(L|~G))+U[8]+1873313359&4294967295,D=L+($<<6&4294967295|$>>>26),$=G+(L^(D|~j))+U[15]+4264355552&4294967295,G=D+($<<10&4294967295|$>>>22),$=j+(D^(G|~L))+U[6]+2734768916&4294967295,j=G+($<<15&4294967295|$>>>17),$=L+(G^(j|~D))+U[13]+1309151649&4294967295,L=j+($<<21&4294967295|$>>>11),$=D+(j^(L|~G))+U[4]+4149444226&4294967295,D=L+($<<6&4294967295|$>>>26),$=G+(L^(D|~j))+U[11]+3174756917&4294967295,G=D+($<<10&4294967295|$>>>22),$=j+(D^(G|~L))+U[2]+718787259&4294967295,j=G+($<<15&4294967295|$>>>17),$=L+(G^(j|~D))+U[9]+3951481745&4294967295,R.g[0]=R.g[0]+D&4294967295,R.g[1]=R.g[1]+(j+($<<21&4294967295|$>>>11))&4294967295,R.g[2]=R.g[2]+j&4294967295,R.g[3]=R.g[3]+G&4294967295}n.prototype.v=function(R,D){D===void 0&&(D=R.length);const L=D-this.blockSize,U=this.C;let j=this.h,G=0;for(;G<D;){if(j==0)for(;G<=L;)r(this,R,G),G+=this.blockSize;if(typeof R=="string"){for(;G<D;)if(U[j++]=R.charCodeAt(G++),j==this.blockSize){r(this,U),j=0;break}}else for(;G<D;)if(U[j++]=R[G++],j==this.blockSize){r(this,U),j=0;break}}this.h=j,this.o+=D},n.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var D=1;D<R.length-8;++D)R[D]=0;D=this.o*8;for(var L=R.length-8;L<R.length;++L)R[L]=D&255,D/=256;for(this.v(R),R=Array(16),D=0,L=0;L<4;++L)for(let U=0;U<32;U+=8)R[D++]=this.g[L]>>>U&255;return R};function i(R,D){var L=u;return Object.prototype.hasOwnProperty.call(L,R)?L[R]:L[R]=D(R)}function o(R,D){this.h=D;const L=[];let U=!0;for(let j=R.length-1;j>=0;j--){const G=R[j]|0;U&&G==D||(L[j]=G,U=!1)}this.g=L}var u={};function d(R){return-128<=R&&R<128?i(R,function(D){return new o([D|0],D<0?-1:0)}):new o([R|0],R<0?-1:0)}function h(R){if(isNaN(R)||!isFinite(R))return g;if(R<0)return S(h(-R));const D=[];let L=1;for(let U=0;R>=L;U++)D[U]=R/L|0,L*=4294967296;return new o(D,0)}function f(R,D){if(R.length==0)throw Error("number format error: empty string");if(D=D||10,D<2||36<D)throw Error("radix out of range: "+D);if(R.charAt(0)=="-")return S(f(R.substring(1),D));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const L=h(Math.pow(D,8));let U=g;for(let G=0;G<R.length;G+=8){var j=Math.min(8,R.length-G);const $=parseInt(R.substring(G,G+j),D);j<8?(j=h(Math.pow(D,j)),U=U.j(j).add(h($))):(U=U.j(L),U=U.add(h($)))}return U}var g=d(0),w=d(1),A=d(16777216);s=o.prototype,s.m=function(){if(C(this))return-S(this).m();let R=0,D=1;for(let L=0;L<this.g.length;L++){const U=this.i(L);R+=(U>=0?U:4294967296+U)*D,D*=4294967296}return R},s.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(F(this))return"0";if(C(this))return"-"+S(this).toString(R);const D=h(Math.pow(R,6));var L=this;let U="";for(;;){const j=V(L,D).g;L=P(L,j.j(D));let G=((L.g.length>0?L.g[0]:L.h)>>>0).toString(R);if(L=j,F(L))return G+U;for(;G.length<6;)G="0"+G;U=G+U}},s.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function F(R){if(R.h!=0)return!1;for(let D=0;D<R.g.length;D++)if(R.g[D]!=0)return!1;return!0}function C(R){return R.h==-1}s.l=function(R){return R=P(this,R),C(R)?-1:F(R)?0:1};function S(R){const D=R.g.length,L=[];for(let U=0;U<D;U++)L[U]=~R.g[U];return new o(L,~R.h).add(w)}s.abs=function(){return C(this)?S(this):this},s.add=function(R){const D=Math.max(this.g.length,R.g.length),L=[];let U=0;for(let j=0;j<=D;j++){let G=U+(this.i(j)&65535)+(R.i(j)&65535),$=(G>>>16)+(this.i(j)>>>16)+(R.i(j)>>>16);U=$>>>16,G&=65535,$&=65535,L[j]=$<<16|G}return new o(L,L[L.length-1]&-2147483648?-1:0)};function P(R,D){return R.add(S(D))}s.j=function(R){if(F(this)||F(R))return g;if(C(this))return C(R)?S(this).j(S(R)):S(S(this).j(R));if(C(R))return S(this.j(S(R)));if(this.l(A)<0&&R.l(A)<0)return h(this.m()*R.m());const D=this.g.length+R.g.length,L=[];for(var U=0;U<2*D;U++)L[U]=0;for(U=0;U<this.g.length;U++)for(let j=0;j<R.g.length;j++){const G=this.i(U)>>>16,$=this.i(U)&65535,ge=R.i(j)>>>16,xe=R.i(j)&65535;L[2*U+2*j]+=$*xe,O(L,2*U+2*j),L[2*U+2*j+1]+=G*xe,O(L,2*U+2*j+1),L[2*U+2*j+1]+=$*ge,O(L,2*U+2*j+1),L[2*U+2*j+2]+=G*ge,O(L,2*U+2*j+2)}for(R=0;R<D;R++)L[R]=L[2*R+1]<<16|L[2*R];for(R=D;R<2*D;R++)L[R]=0;return new o(L,0)};function O(R,D){for(;(R[D]&65535)!=R[D];)R[D+1]+=R[D]>>>16,R[D]&=65535,D++}function N(R,D){this.g=R,this.h=D}function V(R,D){if(F(D))throw Error("division by zero");if(F(R))return new N(g,g);if(C(R))return D=V(S(R),D),new N(S(D.g),S(D.h));if(C(D))return D=V(R,S(D)),new N(S(D.g),D.h);if(R.g.length>30){if(C(R)||C(D))throw Error("slowDivide_ only works with positive integers.");for(var L=w,U=D;U.l(R)<=0;)L=z(L),U=z(U);var j=H(L,1),G=H(U,1);for(U=H(U,2),L=H(L,2);!F(U);){var $=G.add(U);$.l(R)<=0&&(j=j.add(L),G=$),U=H(U,1),L=H(L,1)}return D=P(R,j.j(D)),new N(j,D)}for(j=g;R.l(D)>=0;){for(L=Math.max(1,Math.floor(R.m()/D.m())),U=Math.ceil(Math.log(L)/Math.LN2),U=U<=48?1:Math.pow(2,U-48),G=h(L),$=G.j(D);C($)||$.l(R)>0;)L-=U,G=h(L),$=G.j(D);F(G)&&(G=w),j=j.add(G),R=P(R,$)}return new N(j,R)}s.B=function(R){return V(this,R).h},s.and=function(R){const D=Math.max(this.g.length,R.g.length),L=[];for(let U=0;U<D;U++)L[U]=this.i(U)&R.i(U);return new o(L,this.h&R.h)},s.or=function(R){const D=Math.max(this.g.length,R.g.length),L=[];for(let U=0;U<D;U++)L[U]=this.i(U)|R.i(U);return new o(L,this.h|R.h)},s.xor=function(R){const D=Math.max(this.g.length,R.g.length),L=[];for(let U=0;U<D;U++)L[U]=this.i(U)^R.i(U);return new o(L,this.h^R.h)};function z(R){const D=R.g.length+1,L=[];for(let U=0;U<D;U++)L[U]=R.i(U)<<1|R.i(U-1)>>>31;return new o(L,R.h)}function H(R,D){const L=D>>5;D%=32;const U=R.g.length-L,j=[];for(let G=0;G<U;G++)j[G]=D>0?R.i(G+L)>>>D|R.i(G+L+1)<<32-D:R.i(G+L);return new o(j,R.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,WD=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,_u=o}).apply(typeof jI<"u"?jI:typeof self<"u"?self:typeof window<"u"?window:{});var Kv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var GD,gg,qD,wA,cb,QD,KD,XD;(function(){var s,e=Object.defineProperty;function t(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof Kv=="object"&&Kv];for(var b=0;b<m.length;++b){var k=m[b];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var n=t(this);function r(m,b){if(b)e:{var k=n;m=m.split(".");for(var B=0;B<m.length-1;B++){var Z=m[B];if(!(Z in k))break e;k=k[Z]}m=m[m.length-1],B=k[m],b=b(B),b!=B&&b!=null&&e(k,m,{configurable:!0,writable:!0,value:b})}}r("Symbol.dispose",function(m){return m||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(m){return m||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(m){return m||function(b){var k=[],B;for(B in b)Object.prototype.hasOwnProperty.call(b,B)&&k.push([B,b[B]]);return k}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function u(m){var b=typeof m;return b=="object"&&m!=null||b=="function"}function d(m,b,k){return m.call.apply(m.bind,arguments)}function h(m,b,k){return h=d,h.apply(null,arguments)}function f(m,b){var k=Array.prototype.slice.call(arguments,1);return function(){var B=k.slice();return B.push.apply(B,arguments),m.apply(this,B)}}function g(m,b){function k(){}k.prototype=b.prototype,m.Z=b.prototype,m.prototype=new k,m.prototype.constructor=m,m.Ob=function(B,Z,ne){for(var me=Array(arguments.length-2),Qe=2;Qe<arguments.length;Qe++)me[Qe-2]=arguments[Qe];return b.prototype[Z].apply(B,me)}}var w=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?m=>m&&AsyncContext.Snapshot.wrap(m):m=>m;function A(m){const b=m.length;if(b>0){const k=Array(b);for(let B=0;B<b;B++)k[B]=m[B];return k}return[]}function F(m,b){for(let B=1;B<arguments.length;B++){const Z=arguments[B];var k=typeof Z;if(k=k!="object"?k:Z?Array.isArray(Z)?"array":k:"null",k=="array"||k=="object"&&typeof Z.length=="number"){k=m.length||0;const ne=Z.length||0;m.length=k+ne;for(let me=0;me<ne;me++)m[k+me]=Z[me]}else m.push(Z)}}class C{constructor(b,k){this.i=b,this.j=k,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function S(m){o.setTimeout(()=>{throw m},0)}function P(){var m=R;let b=null;return m.g&&(b=m.g,m.g=m.g.next,m.g||(m.h=null),b.next=null),b}class O{constructor(){this.h=this.g=null}add(b,k){const B=N.get();B.set(b,k),this.h?this.h.next=B:this.g=B,this.h=B}}var N=new C(()=>new V,m=>m.reset());class V{constructor(){this.next=this.g=this.h=null}set(b,k){this.h=b,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let z,H=!1,R=new O,D=()=>{const m=Promise.resolve(void 0);z=()=>{m.then(L)}};function L(){for(var m;m=P();){try{m.h.call(m.g)}catch(k){S(k)}var b=N;b.j(m),b.h<100&&(b.h++,m.next=b.g,b.g=m)}H=!1}function U(){this.u=this.u,this.C=this.C}U.prototype.u=!1,U.prototype.dispose=function(){this.u||(this.u=!0,this.N())},U.prototype[Symbol.dispose]=function(){this.dispose()},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(m,b){this.type=m,this.g=this.target=b,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var G=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var m=!1,b=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const k=()=>{};o.addEventListener("test",k,b),o.removeEventListener("test",k,b)}catch{}return m})();function $(m){return/^[\s\xa0]*$/.test(m)}function ge(m,b){j.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m&&this.init(m,b)}g(ge,j),ge.prototype.init=function(m,b){const k=this.type=m.type,B=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;this.target=m.target||m.srcElement,this.g=b,b=m.relatedTarget,b||(k=="mouseover"?b=m.fromElement:k=="mouseout"&&(b=m.toElement)),this.relatedTarget=b,B?(this.clientX=B.clientX!==void 0?B.clientX:B.pageX,this.clientY=B.clientY!==void 0?B.clientY:B.pageY,this.screenX=B.screenX||0,this.screenY=B.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=m.pointerType,this.state=m.state,this.i=m,m.defaultPrevented&&ge.Z.h.call(this)},ge.prototype.h=function(){ge.Z.h.call(this);const m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var xe="closure_listenable_"+(Math.random()*1e6|0),ye=0;function pe(m,b,k,B,Z){this.listener=m,this.proxy=null,this.src=b,this.type=k,this.capture=!!B,this.ha=Z,this.key=++ye,this.da=this.fa=!1}function ie(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function we(m,b,k){for(const B in m)b.call(k,m[B],B,m)}function de(m,b){for(const k in m)b.call(void 0,m[k],k,m)}function K(m){const b={};for(const k in m)b[k]=m[k];return b}const Y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function fe(m,b){let k,B;for(let Z=1;Z<arguments.length;Z++){B=arguments[Z];for(k in B)m[k]=B[k];for(let ne=0;ne<Y.length;ne++)k=Y[ne],Object.prototype.hasOwnProperty.call(B,k)&&(m[k]=B[k])}}function De(m){this.src=m,this.g={},this.h=0}De.prototype.add=function(m,b,k,B,Z){const ne=m.toString();m=this.g[ne],m||(m=this.g[ne]=[],this.h++);const me=Ne(m,b,B,Z);return me>-1?(b=m[me],k||(b.fa=!1)):(b=new pe(b,this.src,ne,!!B,Z),b.fa=k,m.push(b)),b};function ke(m,b){const k=b.type;if(k in m.g){var B=m.g[k],Z=Array.prototype.indexOf.call(B,b,void 0),ne;(ne=Z>=0)&&Array.prototype.splice.call(B,Z,1),ne&&(ie(b),m.g[k].length==0&&(delete m.g[k],m.h--))}}function Ne(m,b,k,B){for(let Z=0;Z<m.length;++Z){const ne=m[Z];if(!ne.da&&ne.listener==b&&ne.capture==!!k&&ne.ha==B)return Z}return-1}var Me="closure_lm_"+(Math.random()*1e6|0),et={};function dt(m,b,k,B,Z){if(Array.isArray(b)){for(let ne=0;ne<b.length;ne++)dt(m,b[ne],k,B,Z);return null}return k=c2(k),m&&m[xe]?m.J(b,k,u(B)?!!B.capture:!1,Z):Gt(m,b,k,!1,B,Z)}function Gt(m,b,k,B,Z,ne){if(!b)throw Error("Invalid event type");const me=u(Z)?!!Z.capture:!!Z;let Qe=ip(m);if(Qe||(m[Me]=Qe=new De(m)),k=Qe.add(b,k,B,me,ne),k.proxy)return k;if(B=vr(),k.proxy=B,B.src=m,B.listener=k,m.addEventListener)G||(Z=me),Z===void 0&&(Z=!1),m.addEventListener(b.toString(),B,Z);else if(m.attachEvent)m.attachEvent(Zt(b.toString()),B);else if(m.addListener&&m.removeListener)m.addListener(B);else throw Error("addEventListener and attachEvent are unavailable.");return k}function vr(){function m(k){return b.call(m.src,m.listener,k)}const b=Bl;return m}function ce(m,b,k,B,Z){if(Array.isArray(b))for(var ne=0;ne<b.length;ne++)ce(m,b[ne],k,B,Z);else B=u(B)?!!B.capture:!!B,k=c2(k),m&&m[xe]?(m=m.i,ne=String(b).toString(),ne in m.g&&(b=m.g[ne],k=Ne(b,k,B,Z),k>-1&&(ie(b[k]),Array.prototype.splice.call(b,k,1),b.length==0&&(delete m.g[ne],m.h--)))):m&&(m=ip(m))&&(b=m.g[b.toString()],m=-1,b&&(m=Ne(b,k,B,Z)),(k=m>-1?b[m]:null)&&Oe(k))}function Oe(m){if(typeof m!="number"&&m&&!m.da){var b=m.src;if(b&&b[xe])ke(b.i,m);else{var k=m.type,B=m.proxy;b.removeEventListener?b.removeEventListener(k,B,m.capture):b.detachEvent?b.detachEvent(Zt(k),B):b.addListener&&b.removeListener&&b.removeListener(B),(k=ip(b))?(ke(k,m),k.h==0&&(k.src=null,b[Me]=null)):ie(m)}}}function Zt(m){return m in et?et[m]:et[m]="on"+m}function Bl(m,b){if(m.da)m=!0;else{b=new ge(b,this);const k=m.listener,B=m.ha||m.src;m.fa&&Oe(m),m=k.call(B,b)}return m}function ip(m){return m=m[Me],m instanceof De?m:null}var $u="__closure_events_fn_"+(Math.random()*1e9>>>0);function c2(m){return typeof m=="function"?m:(m[$u]||(m[$u]=function(b){return m.handleEvent(b)}),m[$u])}function Cn(){U.call(this),this.i=new De(this),this.M=this,this.G=null}g(Cn,U),Cn.prototype[xe]=!0,Cn.prototype.removeEventListener=function(m,b,k,B){ce(this,m,b,k,B)};function wn(m,b){var k,B=m.G;if(B)for(k=[];B;B=B.G)k.push(B);if(m=m.M,B=b.type||b,typeof b=="string")b=new j(b,m);else if(b instanceof j)b.target=b.target||m;else{var Z=b;b=new j(B,m),fe(b,Z)}Z=!0;let ne,me;if(k)for(me=k.length-1;me>=0;me--)ne=b.g=k[me],Z=Si(ne,B,!0,b)&&Z;if(ne=b.g=m,Z=Si(ne,B,!0,b)&&Z,Z=Si(ne,B,!1,b)&&Z,k)for(me=0;me<k.length;me++)ne=b.g=k[me],Z=Si(ne,B,!1,b)&&Z}Cn.prototype.N=function(){if(Cn.Z.N.call(this),this.i){var m=this.i;for(const b in m.g){const k=m.g[b];for(let B=0;B<k.length;B++)ie(k[B]);delete m.g[b],m.h--}}this.G=null},Cn.prototype.J=function(m,b,k,B){return this.i.add(String(m),b,!1,k,B)},Cn.prototype.K=function(m,b,k,B){return this.i.add(String(m),b,!0,k,B)};function Si(m,b,k,B){if(b=m.i.g[String(b)],!b)return!0;b=b.concat();let Z=!0;for(let ne=0;ne<b.length;++ne){const me=b[ne];if(me&&!me.da&&me.capture==k){const Qe=me.listener,vn=me.ha||me.src;me.fa&&ke(m.i,me),Z=Qe.call(vn,B)!==!1&&Z}}return Z&&!B.defaultPrevented}function u2(m,b){if(typeof m!="function")if(m&&typeof m.handleEvent=="function")m=h(m.handleEvent,m);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:o.setTimeout(m,b||0)}function d2(m){m.g=u2(()=>{m.g=null,m.i&&(m.i=!1,d2(m))},m.l);const b=m.h;m.h=null,m.m.apply(null,b)}class P0 extends U{constructor(b,k){super(),this.m=b,this.l=k,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:d2(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Vl(m){U.call(this),this.h=m,this.g={}}g(Vl,U);var h2=[];function ap(m){we(m.g,function(b,k){this.g.hasOwnProperty(k)&&Oe(b)},m),m.g={}}Vl.prototype.N=function(){Vl.Z.N.call(this),ap(this)},Vl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ul=o.JSON.stringify,R0=o.JSON.parse,zu=class{stringify(m){return o.JSON.stringify(m,void 0)}parse(m){return o.JSON.parse(m,void 0)}};function jl(){}function D0(){}var $l={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function op(){j.call(this,"d")}g(op,j);function p2(){j.call(this,"c")}g(p2,j);var Ti={},lp=null;function zl(){return lp=lp||new Cn}Ti.Ia="serverreachability";function cp(m){j.call(this,Ti.Ia,m)}g(cp,j);function yo(m){const b=zl();wn(b,new cp(b))}Ti.STAT_EVENT="statevent";function wo(m,b){j.call(this,Ti.STAT_EVENT,m),this.stat=b}g(wo,j);function ln(m){const b=zl();wn(b,new wo(b,m))}Ti.Ja="timingevent";function f2(m,b){j.call(this,Ti.Ja,m),this.size=b}g(f2,j);function Hl(m,b){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){m()},b)}function Wl(){this.g=!0}Wl.prototype.ua=function(){this.g=!1};function N0(m,b,k,B,Z,ne){m.info(function(){if(m.g)if(ne){var me="",Qe=ne.split("&");for(let Et=0;Et<Qe.length;Et++){var vn=Qe[Et].split("=");if(vn.length>1){const Fn=vn[0];vn=vn[1];const ws=Fn.split("_");me=ws.length>=2&&ws[1]=="type"?me+(Fn+"="+vn+"&"):me+(Fn+"=redacted&")}}}else me=null;else me=ne;return"XMLHTTP REQ ("+B+") [attempt "+Z+"]: "+b+`
`+k+`
`+me})}function M0(m,b,k,B,Z,ne,me){m.info(function(){return"XMLHTTP RESP ("+B+") [ attempt "+Z+"]: "+b+`
`+k+`
`+ne+" "+me})}function aa(m,b,k,B){m.info(function(){return"XMLHTTP TEXT ("+b+"): "+Hu(m,k)+(B?" "+B:"")})}function L0(m,b){m.info(function(){return"TIMEOUT: "+b})}Wl.prototype.info=function(){};function Hu(m,b){if(!m.g)return b;if(!b)return null;try{const ne=JSON.parse(b);if(ne){for(m=0;m<ne.length;m++)if(Array.isArray(ne[m])){var k=ne[m];if(!(k.length<2)){var B=k[1];if(Array.isArray(B)&&!(B.length<1)){var Z=B[0];if(Z!="noop"&&Z!="stop"&&Z!="close")for(let me=1;me<B.length;me++)B[me]=""}}}}return Ul(ne)}catch{return b}}var Gl={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ql={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},O0;function vo(){}g(vo,jl),vo.prototype.g=function(){return new XMLHttpRequest},O0=new vo;function oa(m){return encodeURIComponent(String(m))}function up(m){var b=1;m=m.split(":");const k=[];for(;b>0&&m.length;)k.push(m.shift()),b--;return m.length&&k.push(m.join(":")),k}function Ys(m,b,k,B){this.j=m,this.i=b,this.l=k,this.S=B||1,this.V=new Vl(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new B0}function B0(){this.i=null,this.g="",this.h=!1}var V0={},m2={};function ki(m,b,k){m.M=1,m.A=_o(Js(b)),m.u=k,m.R=!0,g2(m,null)}function g2(m,b){m.F=Date.now(),Wu(m),m.B=Js(m.A);var k=m.B,B=m.S;Array.isArray(B)||(B=[String(B)]),F2(k.i,"t",B),m.C=0,k=m.j.L,m.h=new B0,m.g=K0(m.j,k?b:null,!m.u),m.P>0&&(m.O=new P0(h(m.Y,m,m.g),m.P)),b=m.V,k=m.g,B=m.ba;var Z="readystatechange";Array.isArray(Z)||(Z&&(h2[0]=Z.toString()),Z=h2);for(let ne=0;ne<Z.length;ne++){const me=dt(k,Z[ne],B||b.handleEvent,!1,b.h||b);if(!me)break;b.g[me.key]=me}b=m.J?K(m.J):{},m.u?(m.v||(m.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.B,m.v,m.u,b)):(m.v="GET",m.g.ea(m.B,m.v,null,b)),yo(),N0(m.i,m.v,m.B,m.l,m.S,m.u)}Ys.prototype.ba=function(m){m=m.target;const b=this.O;b&&fa(m)==3?b.j():this.Y(m)},Ys.prototype.Y=function(m){try{if(m==this.g)e:{const Qe=fa(this.g),vn=this.g.ya(),Et=this.g.ca();if(!(Qe<3)&&(Qe!=3||this.g&&(this.h.h||this.g.la()||q0(this.g)))){this.K||Qe!=4||vn==7||(vn==8||Et<=0?yo(3):yo(2)),dp(this);var b=this.g.ca();this.X=b;var k=U0(this);if(this.o=b==200,M0(this.i,this.v,this.B,this.l,this.S,Qe,b),this.o){if(this.U&&!this.L){t:{if(this.g){var B,Z=this.g;if((B=Z.g?Z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$(B)){var ne=B;break t}}ne=null}if(m=ne)aa(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,jt(this,m);else{this.o=!1,this.m=3,ln(12),Ao(this),Gu(this);break e}}if(this.R){m=!0;let Fn;for(;!this.K&&this.C<k.length;)if(Fn=$0(this,k),Fn==m2){Qe==4&&(this.m=4,ln(14),m=!1),aa(this.i,this.l,null,"[Incomplete Response]");break}else if(Fn==V0){this.m=4,ln(15),aa(this.i,this.l,k,"[Invalid Chunk]"),m=!1;break}else aa(this.i,this.l,Fn,null),jt(this,Fn);if(j0(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Qe!=4||k.length!=0||this.h.h||(this.m=1,ln(16),m=!1),this.o=this.o&&m,!m)aa(this.i,this.l,k,"[Invalid Chunked Response]"),Ao(this),Gu(this);else if(k.length>0&&!this.W){this.W=!0;var me=this.j;me.g==this&&me.aa&&!me.P&&(me.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),td(me),me.P=!0,ln(11))}}else aa(this.i,this.l,k,null),jt(this,k);Qe==4&&Ao(this),this.o&&!this.K&&(Qe==4?_p(this.j,this):(this.o=!1,Wu(this)))}else T2(this.g),b==400&&k.indexOf("Unknown SID")>0?(this.m=3,ln(12)):(this.m=0,ln(13)),Ao(this),Gu(this)}}}catch{}finally{}};function U0(m){if(!j0(m))return m.g.la();const b=q0(m.g);if(b==="")return"";let k="";const B=b.length,Z=fa(m.g)==4;if(!m.h.i){if(typeof TextDecoder>"u")return Ao(m),Gu(m),"";m.h.i=new o.TextDecoder}for(let ne=0;ne<B;ne++)m.h.h=!0,k+=m.h.i.decode(b[ne],{stream:!(Z&&ne==B-1)});return b.length=0,m.h.g+=k,m.C=0,m.h.g}function j0(m){return m.g?m.v=="GET"&&m.M!=2&&m.j.Aa:!1}function $0(m,b){var k=m.C,B=b.indexOf(`
`,k);return B==-1?m2:(k=Number(b.substring(k,B)),isNaN(k)?V0:(B+=1,B+k>b.length?m2:(b=b.slice(B,B+k),m.C=B+k,b)))}Ys.prototype.cancel=function(){this.K=!0,Ao(this)};function Wu(m){m.T=Date.now()+m.H,y2(m,m.H)}function y2(m,b){if(m.D!=null)throw Error("WatchDog timer not null");m.D=Hl(h(m.aa,m),b)}function dp(m){m.D&&(o.clearTimeout(m.D),m.D=null)}Ys.prototype.aa=function(){this.D=null;const m=Date.now();m-this.T>=0?(L0(this.i,this.B),this.M!=2&&(yo(),ln(17)),Ao(this),this.m=2,Gu(this)):y2(this,this.T-m)};function Gu(m){m.j.I==0||m.K||_p(m.j,m)}function Ao(m){dp(m);var b=m.O;b&&typeof b.dispose=="function"&&b.dispose(),m.O=null,ap(m.V),m.g&&(b=m.g,m.g=null,b.abort(),b.dispose())}function jt(m,b){try{var k=m.j;if(k.I!=0&&(k.g==m||v2(k.h,m))){if(!m.L&&v2(k.h,m)&&k.I==3){try{var B=k.Ba.g.parse(b)}catch{B=null}if(Array.isArray(B)&&B.length==3){var Z=B;if(Z[0]==0){e:if(!k.v){if(k.g)if(k.g.F+3e3<m.F)Ap(k),gs(k);else break e;ya(k),ln(18)}}else k.xa=Z[1],0<k.xa-k.K&&Z[2]<37500&&k.F&&k.A==0&&!k.C&&(k.C=Hl(h(k.Va,k),6e3));qu(k.h)<=1&&k.ta&&(k.ta=void 0)}else ys(k,11)}else if((m.L||k.g==m)&&Ap(k),!$(b))for(Z=k.Ba.g.parse(b),b=0;b<Z.length;b++){let Et=Z[b];const Fn=Et[0];if(!(Fn<=k.K))if(k.K=Fn,Et=Et[1],k.I==2)if(Et[0]=="c"){k.M=Et[1],k.ba=Et[2];const ws=Et[3];ws!=null&&(k.ka=ws,k.j.info("VER="+k.ka));const Fo=Et[4];Fo!=null&&(k.za=Fo,k.j.info("SVER="+k.za));const wa=Et[5];wa!=null&&typeof wa=="number"&&wa>0&&(B=1.5*wa,k.O=B,k.j.info("backChannelRequestTimeoutMs_="+B)),B=k;const va=m.g;if(va){const bp=va.g?va.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(bp){var ne=B.h;ne.g||bp.indexOf("spdy")==-1&&bp.indexOf("quic")==-1&&bp.indexOf("h2")==-1||(ne.j=ne.l,ne.g=new Set,ne.h&&(pp(ne,ne.h),ne.h=null))}if(B.G){const P2=va.g?va.g.getResponseHeader("X-HTTP-Session-Id"):null;P2&&(B.wa=P2,yt(B.J,B.G,P2))}}k.I=3,k.l&&k.l.ra(),k.aa&&(k.T=Date.now()-m.F,k.j.info("Handshake RTT: "+k.T+"ms")),B=k;var me=m;if(B.na=I2(B,B.L?B.ba:null,B.W),me.L){Qu(B.h,me);var Qe=me,vn=B.O;vn&&(Qe.H=vn),Qe.D&&(dp(Qe),Wu(Qe)),B.g=me}else Ar(B);k.i.length>0&&Co(k)}else Et[0]!="stop"&&Et[0]!="close"||ys(k,7);else k.I==3&&(Et[0]=="stop"||Et[0]=="close"?Et[0]=="stop"?ys(k,7):wp(k):Et[0]!="noop"&&k.l&&k.l.qa(Et),k.A=0)}}yo(4)}catch{}}var Qx=class{constructor(m,b){this.g=m,this.map=b}};function hp(m){this.l=m||10,o.PerformanceNavigationTiming?(m=o.performance.getEntriesByType("navigation"),m=m.length>0&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function w2(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function qu(m){return m.h?1:m.g?m.g.size:0}function v2(m,b){return m.h?m.h==b:m.g?m.g.has(b):!1}function pp(m,b){m.g?m.g.add(b):m.h=b}function Qu(m,b){m.h&&m.h==b?m.h=null:m.g&&m.g.has(b)&&m.g.delete(b)}hp.prototype.cancel=function(){if(this.i=ps(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function ps(m){if(m.h!=null)return m.i.concat(m.h.G);if(m.g!=null&&m.g.size!==0){let b=m.i;for(const k of m.g.values())b=b.concat(k.G);return b}return A(m.i)}var z0=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function fs(m,b){if(m){m=m.split("&");for(let k=0;k<m.length;k++){const B=m[k].indexOf("=");let Z,ne=null;B>=0?(Z=m[k].substring(0,B),ne=m[k].substring(B+1)):Z=m[k],b(Z,ne?decodeURIComponent(ne.replace(/\+/g," ")):"")}}}function la(m){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;m instanceof la?(this.l=m.l,Ku(this,m.j),this.o=m.o,this.g=m.g,ca(this,m.u),this.h=m.h,Ql(this,S2(m.i)),this.m=m.m):m&&(b=String(m).match(z0))?(this.l=!1,Ku(this,b[1]||"",!0),this.o=Xu(b[2]||""),this.g=Xu(b[3]||"",!0),ca(this,b[4]),this.h=Xu(b[5]||"",!0),Ql(this,b[6]||"",!0),this.m=Xu(b[7]||"")):(this.l=!1,this.i=new ot(null,this.l))}la.prototype.toString=function(){const m=[];var b=this.j;b&&m.push(Yu(b,_2,!0),":");var k=this.g;return(k||b=="file")&&(m.push("//"),(b=this.o)&&m.push(Yu(b,_2,!0),"@"),m.push(oa(k).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.u,k!=null&&m.push(":",String(k))),(k=this.h)&&(this.g&&k.charAt(0)!="/"&&m.push("/"),m.push(Yu(k,k.charAt(0)=="/"?Ju:x2,!0))),(k=this.i.toString())&&m.push("?",k),(k=this.m)&&m.push("#",Yu(k,E2)),m.join("")},la.prototype.resolve=function(m){const b=Js(this);let k=!!m.j;k?Ku(b,m.j):k=!!m.o,k?b.o=m.o:k=!!m.g,k?b.g=m.g:k=m.u!=null;var B=m.h;if(k)ca(b,m.u);else if(k=!!m.h){if(B.charAt(0)!="/")if(this.g&&!this.h)B="/"+B;else{var Z=b.h.lastIndexOf("/");Z!=-1&&(B=b.h.slice(0,Z+1)+B)}if(Z=B,Z==".."||Z==".")B="";else if(Z.indexOf("./")!=-1||Z.indexOf("/.")!=-1){B=Z.lastIndexOf("/",0)==0,Z=Z.split("/");const ne=[];for(let me=0;me<Z.length;){const Qe=Z[me++];Qe=="."?B&&me==Z.length&&ne.push(""):Qe==".."?((ne.length>1||ne.length==1&&ne[0]!="")&&ne.pop(),B&&me==Z.length&&ne.push("")):(ne.push(Qe),B=!0)}B=ne.join("/")}else B=Z}return k?b.h=B:k=m.i.toString()!=="",k?Ql(b,S2(m.i)):k=!!m.m,k&&(b.m=m.m),b};function Js(m){return new la(m)}function Ku(m,b,k){m.j=k?Xu(b,!0):b,m.j&&(m.j=m.j.replace(/:$/,""))}function ca(m,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);m.u=b}else m.u=null}function Ql(m,b,k){b instanceof ot?(m.i=b,mp(m.i,m.l)):(k||(b=Yu(b,Kx)),m.i=new ot(b,m.l))}function yt(m,b,k){m.i.set(b,k)}function _o(m){return yt(m,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),m}function Xu(m,b){return m?b?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function Yu(m,b,k){return typeof m=="string"?(m=encodeURI(m).replace(b,A2),k&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function A2(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var _2=/[#\/\?@]/g,x2=/[#\?:]/g,Ju=/[#\?]/g,Kx=/[#\?@]/g,E2=/#/g;function ot(m,b){this.h=this.g=null,this.i=m||null,this.j=!!b}function ua(m){m.g||(m.g=new Map,m.h=0,m.i&&fs(m.i,function(b,k){m.add(decodeURIComponent(b.replace(/\+/g," ")),k)}))}s=ot.prototype,s.add=function(m,b){ua(this),this.i=null,m=da(this,m);let k=this.g.get(m);return k||this.g.set(m,k=[]),k.push(b),this.h+=1,this};function b2(m,b){ua(m),b=da(m,b),m.g.has(b)&&(m.i=null,m.h-=m.g.get(b).length,m.g.delete(b))}function fp(m,b){return ua(m),b=da(m,b),m.g.has(b)}s.forEach=function(m,b){ua(this),this.g.forEach(function(k,B){k.forEach(function(Z){m.call(b,Z,B,this)},this)},this)};function C2(m,b){ua(m);let k=[];if(typeof b=="string")fp(m,b)&&(k=k.concat(m.g.get(da(m,b))));else for(m=Array.from(m.g.values()),b=0;b<m.length;b++)k=k.concat(m[b]);return k}s.set=function(m,b){return ua(this),this.i=null,m=da(this,m),fp(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[b]),this.h+=1,this},s.get=function(m,b){return m?(m=C2(this,m),m.length>0?String(m[0]):b):b};function F2(m,b,k){b2(m,b),k.length>0&&(m.i=null,m.g.set(da(m,b),A(k)),m.h+=k.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],b=Array.from(this.g.keys());for(let B=0;B<b.length;B++){var k=b[B];const Z=oa(k);k=C2(this,k);for(let ne=0;ne<k.length;ne++){let me=Z;k[ne]!==""&&(me+="="+oa(k[ne])),m.push(me)}}return this.i=m.join("&")};function S2(m){const b=new ot;return b.i=m.i,m.g&&(b.g=new Map(m.g),b.h=m.h),b}function da(m,b){return b=String(b),m.j&&(b=b.toLowerCase()),b}function mp(m,b){b&&!m.j&&(ua(m),m.i=null,m.g.forEach(function(k,B){const Z=B.toLowerCase();B!=Z&&(b2(this,B),F2(this,Z,k))},m)),m.j=b}function ha(m,b){const k=new Wl;if(o.Image){const B=new Image;B.onload=f(nr,k,"TestLoadImage: loaded",!0,b,B),B.onerror=f(nr,k,"TestLoadImage: error",!1,b,B),B.onabort=f(nr,k,"TestLoadImage: abort",!1,b,B),B.ontimeout=f(nr,k,"TestLoadImage: timeout",!1,b,B),o.setTimeout(function(){B.ontimeout&&B.ontimeout()},1e4),B.src=m}else b(!1)}function pa(m,b){const k=new Wl,B=new AbortController,Z=setTimeout(()=>{B.abort(),nr(k,"TestPingServer: timeout",!1,b)},1e4);fetch(m,{signal:B.signal}).then(ne=>{clearTimeout(Z),ne.ok?nr(k,"TestPingServer: ok",!0,b):nr(k,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(Z),nr(k,"TestPingServer: error",!1,b)})}function nr(m,b,k,B,Z){try{Z&&(Z.onload=null,Z.onerror=null,Z.onabort=null,Z.ontimeout=null),B(k)}catch{}}function Zu(){this.g=new zu}function xo(m){this.i=m.Sb||null,this.h=m.ab||!1}g(xo,jl),xo.prototype.g=function(){return new ms(this.i,this.h)};function ms(m,b){Cn.call(this),this.H=m,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(ms,Cn),s=ms.prototype,s.open=function(m,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=m,this.D=b,this.readyState=1,Ii(this)},s.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};m&&(b.body=m),(this.H||o).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Kl(this)),this.readyState=0},s.Pa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,Ii(this)),this.g&&(this.readyState=3,Ii(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;H0(this)}else m.text().then(this.Oa.bind(this),this.ga.bind(this))};function H0(m){m.j.read().then(m.Ma.bind(m)).catch(m.ga.bind(m))}s.Ma=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var b=m.value?m.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!m.done}))&&(this.response=this.responseText+=b)}m.done?Kl(this):Ii(this),this.readyState==3&&H0(this)}},s.Oa=function(m){this.g&&(this.response=this.responseText=m,Kl(this))},s.Na=function(m){this.g&&(this.response=m,Kl(this))},s.ga=function(){this.g&&Kl(this)};function Kl(m){m.readyState=4,m.l=null,m.j=null,m.B=null,Ii(m)}s.setRequestHeader=function(m,b){this.A.append(m,b)},s.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],b=this.h.entries();for(var k=b.next();!k.done;)k=k.value,m.push(k[0]+": "+k[1]),k=b.next();return m.join(`\r
`)};function Ii(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(ms.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function W0(m){let b="";return we(m,function(k,B){b+=B,b+=":",b+=k,b+=`\r
`}),b}function gp(m,b,k){e:{for(B in k){var B=!1;break e}B=!0}B||(k=W0(k),typeof m=="string"?k!=null&&oa(k):yt(m,b,k))}function Dt(m){Cn.call(this),this.headers=new Map,this.L=m||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(Dt,Cn);var G0=/^https?$/i,Xx=["POST","PUT"];s=Dt.prototype,s.Fa=function(m){this.H=m},s.ea=function(m,b,k,B){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);b=b?b.toUpperCase():"GET",this.D=m,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():O0.g(),this.g.onreadystatechange=w(h(this.Ca,this));try{this.B=!0,this.g.open(b,String(m),!0),this.B=!1}catch(ne){Xl(this,ne);return}if(m=k||"",k=new Map(this.headers),B)if(Object.getPrototypeOf(B)===Object.prototype)for(var Z in B)k.set(Z,B[Z]);else if(typeof B.keys=="function"&&typeof B.get=="function")for(const ne of B.keys())k.set(ne,B.get(ne));else throw Error("Unknown input type for opt_headers: "+String(B));B=Array.from(k.keys()).find(ne=>ne.toLowerCase()=="content-type"),Z=o.FormData&&m instanceof o.FormData,!(Array.prototype.indexOf.call(Xx,b,void 0)>=0)||B||Z||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ne,me]of k)this.g.setRequestHeader(ne,me);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(m),this.v=!1}catch(ne){Xl(this,ne)}};function Xl(m,b){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=b,m.o=5,Yl(m),bo(m)}function Yl(m){m.A||(m.A=!0,wn(m,"complete"),wn(m,"error"))}s.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=m||7,wn(this,"complete"),wn(this,"abort"),bo(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),bo(this,!0)),Dt.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?Eo(this):this.Xa())},s.Xa=function(){Eo(this)};function Eo(m){if(m.h&&typeof i<"u"){if(m.v&&fa(m)==4)setTimeout(m.Ca.bind(m),0);else if(wn(m,"readystatechange"),fa(m)==4){m.h=!1;try{const ne=m.ca();e:switch(ne){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var k;if(!(k=b)){var B;if(B=ne===0){let me=String(m.D).match(z0)[1]||null;!me&&o.self&&o.self.location&&(me=o.self.location.protocol.slice(0,-1)),B=!G0.test(me?me.toLowerCase():"")}k=B}if(k)wn(m,"complete"),wn(m,"success");else{m.o=6;try{var Z=fa(m)>2?m.g.statusText:""}catch{Z=""}m.l=Z+" ["+m.ca()+"]",Yl(m)}}finally{bo(m)}}}}function bo(m,b){if(m.g){m.m&&(clearTimeout(m.m),m.m=null);const k=m.g;m.g=null,b||wn(m,"ready");try{k.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function fa(m){return m.g?m.g.readyState:0}s.ca=function(){try{return fa(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(m){if(this.g){var b=this.g.responseText;return m&&b.indexOf(m)==0&&(b=b.substring(m.length)),R0(b)}};function q0(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.F){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function T2(m){const b={};m=(m.g&&fa(m)>=2&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let B=0;B<m.length;B++){if($(m[B]))continue;var k=up(m[B]);const Z=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const ne=b[Z]||[];b[Z]=ne,ne.push(k)}de(b,function(B){return B.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ma(m,b,k){return k&&k.internalChannelParams&&k.internalChannelParams[m]||b}function yp(m){this.za=0,this.i=[],this.j=new Wl,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ma("failFast",!1,m),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ma("baseRetryDelayMs",5e3,m),this.Za=ma("retryDelaySeedMs",1e4,m),this.Ta=ma("forwardChannelMaxRetries",2,m),this.va=ma("forwardChannelRequestTimeoutMs",2e4,m),this.ma=m&&m.xmlHttpFactory||void 0,this.Ua=m&&m.Rb||void 0,this.Aa=m&&m.useFetchStreams||!1,this.O=void 0,this.L=m&&m.supportsCrossDomainXhr||!1,this.M="",this.h=new hp(m&&m.concurrentRequestLimit),this.Ba=new Zu,this.S=m&&m.fastHandshake||!1,this.R=m&&m.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=m&&m.Pb||!1,m&&m.ua&&this.j.ua(),m&&m.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&m&&m.detectBufferingProxy||!1,this.ia=void 0,m&&m.longPollingTimeout&&m.longPollingTimeout>0&&(this.ia=m.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=yp.prototype,s.ka=8,s.I=1,s.connect=function(m,b,k,B){ln(0),this.W=m,this.H=b||{},k&&B!==void 0&&(this.H.OSID=k,this.H.OAID=B),this.F=this.X,this.J=I2(this,null,this.W),Co(this)};function wp(m){if(vp(m),m.I==3){var b=m.V++,k=Js(m.J);if(yt(k,"SID",m.M),yt(k,"RID",b),yt(k,"TYPE","terminate"),ga(m,k),b=new Ys(m,m.j,b),b.M=2,b.A=_o(Js(k)),k=!1,o.navigator&&o.navigator.sendBeacon)try{k=o.navigator.sendBeacon(b.A.toString(),"")}catch{}!k&&o.Image&&(new Image().src=b.A,k=!0),k||(b.g=K0(b.j,null),b.g.ea(b.A)),b.F=Date.now(),Wu(b)}nd(m)}function gs(m){m.g&&(td(m),m.g.cancel(),m.g=null)}function vp(m){gs(m),m.v&&(o.clearTimeout(m.v),m.v=null),Ap(m),m.h.cancel(),m.m&&(typeof m.m=="number"&&o.clearTimeout(m.m),m.m=null)}function Co(m){if(!w2(m.h)&&!m.m){m.m=!0;var b=m.Ea;z||D(),H||(z(),H=!0),R.add(b,m),m.D=0}}function Q0(m,b){return qu(m.h)>=m.h.j-(m.m?1:0)?!1:m.m?(m.i=b.G.concat(m.i),!0):m.I==1||m.I==2||m.D>=(m.Sa?0:m.Ta)?!1:(m.m=Hl(h(m.Ea,m,b),xp(m,m.D)),m.D++,!0)}s.Ea=function(m){if(this.m)if(this.m=null,this.I==1){if(!m){this.V=Math.floor(Math.random()*1e5),m=this.V++;const Z=new Ys(this,this.j,m);let ne=this.o;if(this.U&&(ne?(ne=K(ne),fe(ne,this.U)):ne=this.U),this.u!==null||this.R||(Z.J=ne,ne=null),this.S)e:{for(var b=0,k=0;k<this.i.length;k++){t:{var B=this.i[k];if("__data__"in B.map&&(B=B.map.__data__,typeof B=="string")){B=B.length;break t}B=void 0}if(B===void 0)break;if(b+=B,b>4096){b=k;break e}if(b===4096||k===this.i.length-1){b=k+1;break e}}b=1e3}else b=1e3;b=k2(this,Z,b),k=Js(this.J),yt(k,"RID",m),yt(k,"CVER",22),this.G&&yt(k,"X-HTTP-Session-Id",this.G),ga(this,k),ne&&(this.R?b="headers="+oa(W0(ne))+"&"+b:this.u&&gp(k,this.u,ne)),pp(this.h,Z),this.Ra&&yt(k,"TYPE","init"),this.S?(yt(k,"$req",b),yt(k,"SID","null"),Z.U=!0,ki(Z,k,null)):ki(Z,k,b),this.I=2}}else this.I==3&&(m?ed(this,m):this.i.length==0||w2(this.h)||ed(this))};function ed(m,b){var k;b?k=b.l:k=m.V++;const B=Js(m.J);yt(B,"SID",m.M),yt(B,"RID",k),yt(B,"AID",m.K),ga(m,B),m.u&&m.o&&gp(B,m.u,m.o),k=new Ys(m,m.j,k,m.D+1),m.u===null&&(k.J=m.o),b&&(m.i=b.G.concat(m.i)),b=k2(m,k,1e3),k.H=Math.round(m.va*.5)+Math.round(m.va*.5*Math.random()),pp(m.h,k),ki(k,B,b)}function ga(m,b){m.H&&we(m.H,function(k,B){yt(b,B,k)}),m.l&&we({},function(k,B){yt(b,B,k)})}function k2(m,b,k){k=Math.min(m.i.length,k);const B=m.l?h(m.l.Ka,m.l,m):null;e:{var Z=m.i;let Qe=-1;for(;;){const vn=["count="+k];Qe==-1?k>0?(Qe=Z[0].g,vn.push("ofs="+Qe)):Qe=0:vn.push("ofs="+Qe);let Et=!0;for(let Fn=0;Fn<k;Fn++){var ne=Z[Fn].g;const ws=Z[Fn].map;if(ne-=Qe,ne<0)Qe=Math.max(0,Z[Fn].g-100),Et=!1;else try{ne="req"+ne+"_"||"";try{var me=ws instanceof Map?ws:Object.entries(ws);for(const[Fo,wa]of me){let va=wa;u(wa)&&(va=Ul(wa)),vn.push(ne+Fo+"="+encodeURIComponent(va))}}catch(Fo){throw vn.push(ne+"type="+encodeURIComponent("_badmap")),Fo}}catch{B&&B(ws)}}if(Et){me=vn.join("&");break e}}me=void 0}return m=m.i.splice(0,k),b.G=m,me}function Ar(m){if(!m.g&&!m.v){m.Y=1;var b=m.Da;z||D(),H||(z(),H=!0),R.add(b,m),m.A=0}}function ya(m){return m.g||m.v||m.A>=3?!1:(m.Y++,m.v=Hl(h(m.Da,m),xp(m,m.A)),m.A++,!0)}s.Da=function(){if(this.v=null,Jl(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var m=4*this.T;this.j.info("BP detection timer enabled: "+m),this.B=Hl(h(this.Wa,this),m)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ln(10),gs(this),Jl(this))};function td(m){m.B!=null&&(o.clearTimeout(m.B),m.B=null)}function Jl(m){m.g=new Ys(m,m.j,"rpc",m.Y),m.u===null&&(m.g.J=m.o),m.g.P=0;var b=Js(m.na);yt(b,"RID","rpc"),yt(b,"SID",m.M),yt(b,"AID",m.K),yt(b,"CI",m.F?"0":"1"),!m.F&&m.ia&&yt(b,"TO",m.ia),yt(b,"TYPE","xmlhttp"),ga(m,b),m.u&&m.o&&gp(b,m.u,m.o),m.O&&(m.g.H=m.O);var k=m.g;m=m.ba,k.M=1,k.A=_o(Js(b)),k.u=null,k.R=!0,g2(k,m)}s.Va=function(){this.C!=null&&(this.C=null,gs(this),ya(this),ln(19))};function Ap(m){m.C!=null&&(o.clearTimeout(m.C),m.C=null)}function _p(m,b){var k=null;if(m.g==b){Ap(m),td(m),m.g=null;var B=2}else if(v2(m.h,b))k=b.G,Qu(m.h,b),B=1;else return;if(m.I!=0){if(b.o)if(B==1){k=b.u?b.u.length:0,b=Date.now()-b.F;var Z=m.D;B=zl(),wn(B,new f2(B,k)),Co(m)}else Ar(m);else if(Z=b.m,Z==3||Z==0&&b.X>0||!(B==1&&Q0(m,b)||B==2&&ya(m)))switch(k&&k.length>0&&(b=m.h,b.i=b.i.concat(k)),Z){case 1:ys(m,5);break;case 4:ys(m,10);break;case 3:ys(m,6);break;default:ys(m,2)}}}function xp(m,b){let k=m.Qa+Math.floor(Math.random()*m.Za);return m.isActive()||(k*=2),k*b}function ys(m,b){if(m.j.info("Error code "+b),b==2){var k=h(m.bb,m),B=m.Ua;const Z=!B;B=new la(B||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Ku(B,"https"),_o(B),Z?ha(B.toString(),k):pa(B.toString(),k)}else ln(2);m.I=0,m.l&&m.l.pa(b),nd(m),vp(m)}s.bb=function(m){m?(this.j.info("Successfully pinged google.com"),ln(2)):(this.j.info("Failed to ping google.com"),ln(1))};function nd(m){if(m.I=0,m.ja=[],m.l){const b=ps(m.h);(b.length!=0||m.i.length!=0)&&(F(m.ja,b),F(m.ja,m.i),m.h.i.length=0,A(m.i),m.i.length=0),m.l.oa()}}function I2(m,b,k){var B=k instanceof la?Js(k):new la(k);if(B.g!="")b&&(B.g=b+"."+B.g),ca(B,B.u);else{var Z=o.location;B=Z.protocol,b=b?b+"."+Z.hostname:Z.hostname,Z=+Z.port;const ne=new la(null);B&&Ku(ne,B),b&&(ne.g=b),Z&&ca(ne,Z),k&&(ne.h=k),B=ne}return k=m.G,b=m.wa,k&&b&&yt(B,k,b),yt(B,"VER",m.ka),ga(m,B),B}function K0(m,b,k){if(b&&!m.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=m.Aa&&!m.ma?new Dt(new xo({ab:k})):new Dt(m.ma),b.Fa(m.L),b}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function X0(){}s=X0.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function Ep(){}Ep.prototype.g=function(m,b){return new rr(m,b)};function rr(m,b){Cn.call(this),this.g=new yp(b),this.l=m,this.h=b&&b.messageUrlParams||null,m=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(m?m["X-WebChannel-Content-Type"]=b.messageContentType:m={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(m?m["X-WebChannel-Client-Profile"]=b.sa:m={"X-WebChannel-Client-Profile":b.sa}),this.g.U=m,(m=b&&b.Qb)&&!$(m)&&(this.g.u=m),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!$(b)&&(this.g.G=b,m=this.h,m!==null&&b in m&&(m=this.h,b in m&&delete m[b])),this.j=new Zl(this)}g(rr,Cn),rr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},rr.prototype.close=function(){wp(this.g)},rr.prototype.o=function(m){var b=this.g;if(typeof m=="string"){var k={};k.__data__=m,m=k}else this.v&&(k={},k.__data__=Ul(m),m=k);b.i.push(new Qx(b.Ya++,m)),b.I==3&&Co(b)},rr.prototype.N=function(){this.g.l=null,delete this.j,wp(this.g),delete this.g,rr.Z.N.call(this)};function Y0(m){op.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var b=m.__sm__;if(b){e:{for(const k in b){m=k;break e}m=void 0}(this.i=m)&&(m=this.i,b=b!==null&&m in b?b[m]:void 0),this.data=b}else this.data=m}g(Y0,op);function J0(){p2.call(this),this.status=1}g(J0,p2);function Zl(m){this.g=m}g(Zl,X0),Zl.prototype.ra=function(){wn(this.g,"a")},Zl.prototype.qa=function(m){wn(this.g,new Y0(m))},Zl.prototype.pa=function(m){wn(this.g,new J0)},Zl.prototype.oa=function(){wn(this.g,"b")},Ep.prototype.createWebChannel=Ep.prototype.g,rr.prototype.send=rr.prototype.o,rr.prototype.open=rr.prototype.m,rr.prototype.close=rr.prototype.close,XD=function(){return new Ep},KD=function(){return zl()},QD=Ti,cb={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Gl.NO_ERROR=0,Gl.TIMEOUT=8,Gl.HTTP_ERROR=6,wA=Gl,ql.COMPLETE="complete",qD=ql,D0.EventType=$l,$l.OPEN="a",$l.CLOSE="b",$l.ERROR="c",$l.MESSAGE="d",Cn.prototype.listen=Cn.prototype.J,gg=D0,Dt.prototype.listenOnce=Dt.prototype.K,Dt.prototype.getLastError=Dt.prototype.Ha,Dt.prototype.getLastErrorCode=Dt.prototype.ya,Dt.prototype.getStatus=Dt.prototype.ca,Dt.prototype.getResponseJson=Dt.prototype.La,Dt.prototype.getResponseText=Dt.prototype.la,Dt.prototype.send=Dt.prototype.ea,Dt.prototype.setWithCredentials=Dt.prototype.Fa,GD=Dt}).apply(typeof Kv<"u"?Kv:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Dr.UNAUTHENTICATED=new Dr(null),Dr.GOOGLE_CREDENTIALS=new Dr("google-credentials-uid"),Dr.FIRST_PARTY=new Dr("first-party-uid"),Dr.MOCK_USER=new Dr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let r2="12.9.0";function tj(s){r2=s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uh=new fF("@firebase/firestore");function Gp(){return Uh.logLevel}function be(s,...e){if(Uh.logLevel<=st.DEBUG){const t=e.map(CF);Uh.debug(`Firestore (${r2}): ${s}`,...t)}}function Rl(s,...e){if(Uh.logLevel<=st.ERROR){const t=e.map(CF);Uh.error(`Firestore (${r2}): ${s}`,...t)}}function jh(s,...e){if(Uh.logLevel<=st.WARN){const t=e.map(CF);Uh.warn(`Firestore (${r2}): ${s}`,...t)}}function CF(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $e(s,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,YD(s,n,t)}function YD(s,e,t){let n=`FIRESTORE (${r2}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw Rl(n),new Error(n)}function _t(s,e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,s||YD(e,r,n)}function He(s,e){return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ae extends go{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class nj{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Dr.UNAUTHENTICATED)))}shutdown(){}}class rj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class sj{constructor(e){this.t=e,this.currentUser=Dr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){_t(this.o===void 0,42304);let n=this.i;const r=d=>this.i!==n?(n=this.i,t(d)):Promise.resolve();let i=new ro;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ro,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const d=i;e.enqueueRetryable((async()=>{await d.promise,await r(this.currentUser)}))},u=d=>{be("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((d=>u(d))),setTimeout((()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?u(d):(be("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ro)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((n=>this.i!==e?(be("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(_t(typeof n.accessToken=="string",31837,{l:n}),new JD(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return _t(e===null||typeof e=="string",2055,{h:e}),new Dr(e)}}class ij{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Dr.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class aj{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new ij(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Dr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class $I{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class oj{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,_i(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){_t(this.o===void 0,3512);const n=i=>{i.error!=null&&be("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,be("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>n(i)))};const r=i=>{be("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>r(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):be("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new $I(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(_t(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new $I(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lj(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<s;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FF{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const r=lj(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function it(s,e){return s<e?-1:s>e?1:0}function ub(s,e){const t=Math.min(s.length,e.length);for(let n=0;n<t;n++){const r=s.charAt(n),i=e.charAt(n);if(r!==i)return DE(r)===DE(i)?it(r,i):DE(r)?1:-1}return it(s.length,e.length)}const cj=55296,uj=57343;function DE(s){const e=s.charCodeAt(0);return e>=cj&&e<=uj}function Gm(s,e,t){return s.length===e.length&&s.every(((n,r)=>t(n,e[r])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zI="__name__";class ka{constructor(e,t,n){t===void 0?t=0:t>e.length&&$e(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&$e(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return ka.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ka?e.forEach((n=>{t.push(n)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const i=ka.compareSegments(e.get(r),t.get(r));if(i!==0)return i}return it(e.length,t.length)}static compareSegments(e,t){const n=ka.isNumericId(e),r=ka.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?ka.extractNumericId(e).compare(ka.extractNumericId(t)):ub(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return _u.fromString(e.substring(4,e.length-2))}}class Vt extends ka{construct(e,t,n){return new Vt(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ae(se.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((r=>r.length>0)))}return new Vt(t)}static emptyPath(){return new Vt([])}}const dj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gr extends ka{construct(e,t,n){return new gr(e,t,n)}static isValidIdentifier(e){return dj.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===zI}static keyField(){return new gr([zI])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(n.length===0)throw new Ae(se.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;r<e.length;){const u=e[r];if(u==="\\"){if(r+1===e.length)throw new Ae(se.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[r+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new Ae(se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=d,r+=2}else u==="`"?(o=!o,r++):u!=="."||o?(n+=u,r++):(i(),r++)}if(i(),o)throw new Ae(se.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new gr(t)}static emptyPath(){return new gr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{constructor(e){this.path=e}static fromPath(e){return new Le(Vt.fromString(e))}static fromName(e){return new Le(Vt.fromString(e).popFirst(5))}static empty(){return new Le(Vt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Vt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Vt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Le(new Vt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZD(s,e,t){if(!t)throw new Ae(se.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function hj(s,e,t,n){if(e===!0&&n===!0)throw new Ae(se.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function HI(s){if(!Le.isDocumentKey(s))throw new Ae(se.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function WI(s){if(Le.isDocumentKey(s))throw new Ae(se.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function e3(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function mx(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":$e(12329,{type:typeof s})}function oo(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new Ae(se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=mx(s);throw new Ae(se.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function pj(s,e){if(e<=0)throw new Ae(se.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dn(s,e){const t={typeString:s};return e&&(t.value=e),t}function m0(s,e){if(!e3(s))throw new Ae(se.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const r=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in s)){t=`JSON missing required field: '${n}'`;break}const o=s[n];if(r&&typeof o!==r){t=`JSON field '${n}' must be a ${r}.`;break}if(i!==void 0&&o!==i.value){t=`Expected '${n}' field to equal '${i.value}'`;break}}if(t)throw new Ae(se.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GI=-62135596800,qI=1e6;class Wt{static now(){return Wt.fromMillis(Date.now())}static fromDate(e){return Wt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*qI);return new Wt(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ae(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ae(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<GI)throw new Ae(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ae(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/qI}_compareTo(e){return this.seconds===e.seconds?it(this.nanoseconds,e.nanoseconds):it(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Wt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(m0(e,Wt._jsonSchema))return new Wt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-GI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Wt._jsonSchemaVersion="firestore/timestamp/1.0",Wt._jsonSchema={type:Dn("string",Wt._jsonSchemaVersion),seconds:Dn("number"),nanoseconds:Dn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{static fromTimestamp(e){return new We(e)}static min(){return new We(new Wt(0,0))}static max(){return new We(new Wt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jg=-1;function fj(s,e){const t=s.toTimestamp().seconds,n=s.toTimestamp().nanoseconds+1,r=We.fromTimestamp(n===1e9?new Wt(t+1,0):new Wt(t,n));return new Cu(r,Le.empty(),e)}function mj(s){return new Cu(s.readTime,s.key,Jg)}class Cu{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Cu(We.min(),Le.empty(),Jg)}static max(){return new Cu(We.max(),Le.empty(),Jg)}}function gj(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=Le.comparator(s.documentKey,e.documentKey),t!==0?t:it(s.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class wj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s2(s){if(s.code!==se.FAILED_PRECONDITION||s.message!==yj)throw s;be("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&$e(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ae(((n,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,r)},this.catchCallback=i=>{this.wrapFailure(t,i).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ae?t:ae.resolve(t)}catch(t){return ae.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.reject(t)}static resolve(e){return new ae(((t,n)=>{t(e)}))}static reject(e){return new ae(((t,n)=>{n(e)}))}static waitFor(e){return new ae(((t,n)=>{let r=0,i=0,o=!1;e.forEach((u=>{++r,u.next((()=>{++i,o&&i===r&&t()}),(d=>n(d)))})),o=!0,i===r&&t()}))}static or(e){let t=ae.resolve(!1);for(const n of e)t=t.next((r=>r?ae.resolve(r):n()));return t}static forEach(e,t){const n=[];return e.forEach(((r,i)=>{n.push(t.call(this,r,i))})),this.waitFor(n)}static mapArray(e,t){return new ae(((n,r)=>{const i=e.length,o=new Array(i);let u=0;for(let d=0;d<i;d++){const h=d;t(e[h]).next((f=>{o[h]=f,++u,u===i&&n(o)}),(f=>r(f)))}}))}static doWhile(e,t){return new ae(((n,r)=>{const i=()=>{e()===!0?t().next((()=>{i()}),r):n()};i()}))}}function vj(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function i2(s){return s.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}gx.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SF=-1;function yx(s){return s==null}function g_(s){return s===0&&1/s==-1/0}function Aj(s){return typeof s=="number"&&Number.isInteger(s)&&!g_(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t3="";function _j(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=QI(e)),e=xj(s.get(t),e);return QI(e)}function xj(s,e){let t=e;const n=s.length;for(let r=0;r<n;r++){const i=s.charAt(r);switch(i){case"\0":t+="";break;case t3:t+="";break;default:t+=i}}return t}function QI(s){return s+t3+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KI(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function Vu(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function Ej(s,e){const t=[];for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&t.push(e(s[n],n,s));return t}function n3(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e,t){this.comparator=e,this.root=t||pr.EMPTY}insert(e,t){return new on(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,pr.BLACK,null,null))}remove(e){return new on(this.comparator,this.root.remove(e,this.comparator).copy(null,null,pr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Xv(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Xv(this.root,e,this.comparator,!1)}getReverseIterator(){return new Xv(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Xv(this.root,e,this.comparator,!0)}}class Xv{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class pr{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=n??pr.RED,this.left=r??pr.EMPTY,this.right=i??pr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new pr(e??this.key,t??this.value,n??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return pr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return pr.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,pr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,pr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw $e(43730,{key:this.key,value:this.value});if(this.right.isRed())throw $e(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw $e(27949);return e+(this.isRed()?0:1)}}pr.EMPTY=null,pr.RED=!0,pr.BLACK=!1;pr.EMPTY=new class{constructor(){this.size=0}get key(){throw $e(57766)}get value(){throw $e(16141)}get color(){throw $e(16727)}get left(){throw $e(29726)}get right(){throw $e(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new pr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this.comparator=e,this.data=new on(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new XI(this.data.getIterator())}getIteratorFrom(e){return new XI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((n=>{t=t.add(n)})),t}isEqual(e){if(!(e instanceof zn)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=n.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new zn(this.comparator);return t.data=e,t}}class XI{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e){this.fields=e,e.sort(gr.comparator)}static empty(){return new Gs([])}unionWith(e){let t=new zn(gr.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Gs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Gm(this.fields,e.fields,((t,n)=>t.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r3 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new r3("Invalid base64 string: "+i):i}})(e);return new wr(t)}static fromUint8Array(e){const t=(function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i})(e);return new wr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return it(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}wr.EMPTY_BYTE_STRING=new wr("");const bj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fu(s){if(_t(!!s,39018),typeof s=="string"){let e=0;const t=bj.exec(s);if(_t(!!t,46558,{timestamp:s}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const n=new Date(s);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:bn(s.seconds),nanos:bn(s.nanos)}}function bn(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Su(s){return typeof s=="string"?wr.fromBase64String(s):wr.fromUint8Array(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s3="server_timestamp",i3="__type__",a3="__previous_value__",o3="__local_write_time__";function TF(s){var t,n;return((n=(((t=s==null?void 0:s.mapValue)==null?void 0:t.fields)||{})[i3])==null?void 0:n.stringValue)===s3}function wx(s){const e=s.mapValue.fields[a3];return TF(e)?wx(e):e}function Zg(s){const e=Fu(s.mapValue.fields[o3].timestampValue);return new Wt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cj{constructor(e,t,n,r,i,o,u,d,h,f,g){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=d,this.useFetchStreams=h,this.isUsingEmulator=f,this.apiKey=g}}const y_="(default)";class ey{constructor(e,t){this.projectId=e,this.database=t||y_}static empty(){return new ey("","")}get isDefaultDatabase(){return this.database===y_}isEqual(e){return e instanceof ey&&e.projectId===this.projectId&&e.database===this.database}}function Fj(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new Ae(se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ey(s.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l3="__type__",Sj="__max__",Yv={mapValue:{}},c3="__vector__",w_="value";function Tu(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?TF(s)?4:kj(s)?9007199254740991:Tj(s)?10:11:$e(28295,{value:s})}function lo(s,e){if(s===e)return!0;const t=Tu(s);if(t!==Tu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return Zg(s).isEqual(Zg(e));case 3:return(function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=Fu(r.timestampValue),u=Fu(i.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(r,i){return Su(r.bytesValue).isEqual(Su(i.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(r,i){return bn(r.geoPointValue.latitude)===bn(i.geoPointValue.latitude)&&bn(r.geoPointValue.longitude)===bn(i.geoPointValue.longitude)})(s,e);case 2:return(function(r,i){if("integerValue"in r&&"integerValue"in i)return bn(r.integerValue)===bn(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=bn(r.doubleValue),u=bn(i.doubleValue);return o===u?g_(o)===g_(u):isNaN(o)&&isNaN(u)}return!1})(s,e);case 9:return Gm(s.arrayValue.values||[],e.arrayValue.values||[],lo);case 10:case 11:return(function(r,i){const o=r.mapValue.fields||{},u=i.mapValue.fields||{};if(KI(o)!==KI(u))return!1;for(const d in o)if(o.hasOwnProperty(d)&&(u[d]===void 0||!lo(o[d],u[d])))return!1;return!0})(s,e);default:return $e(52216,{left:s})}}function ty(s,e){return(s.values||[]).find((t=>lo(t,e)))!==void 0}function qm(s,e){if(s===e)return 0;const t=Tu(s),n=Tu(e);if(t!==n)return it(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return it(s.booleanValue,e.booleanValue);case 2:return(function(i,o){const u=bn(i.integerValue||i.doubleValue),d=bn(o.integerValue||o.doubleValue);return u<d?-1:u>d?1:u===d?0:isNaN(u)?isNaN(d)?0:-1:1})(s,e);case 3:return YI(s.timestampValue,e.timestampValue);case 4:return YI(Zg(s),Zg(e));case 5:return ub(s.stringValue,e.stringValue);case 6:return(function(i,o){const u=Su(i),d=Su(o);return u.compareTo(d)})(s.bytesValue,e.bytesValue);case 7:return(function(i,o){const u=i.split("/"),d=o.split("/");for(let h=0;h<u.length&&h<d.length;h++){const f=it(u[h],d[h]);if(f!==0)return f}return it(u.length,d.length)})(s.referenceValue,e.referenceValue);case 8:return(function(i,o){const u=it(bn(i.latitude),bn(o.latitude));return u!==0?u:it(bn(i.longitude),bn(o.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return JI(s.arrayValue,e.arrayValue);case 10:return(function(i,o){var w,A,F,C;const u=i.fields||{},d=o.fields||{},h=(w=u[w_])==null?void 0:w.arrayValue,f=(A=d[w_])==null?void 0:A.arrayValue,g=it(((F=h==null?void 0:h.values)==null?void 0:F.length)||0,((C=f==null?void 0:f.values)==null?void 0:C.length)||0);return g!==0?g:JI(h,f)})(s.mapValue,e.mapValue);case 11:return(function(i,o){if(i===Yv.mapValue&&o===Yv.mapValue)return 0;if(i===Yv.mapValue)return 1;if(o===Yv.mapValue)return-1;const u=i.fields||{},d=Object.keys(u),h=o.fields||{},f=Object.keys(h);d.sort(),f.sort();for(let g=0;g<d.length&&g<f.length;++g){const w=ub(d[g],f[g]);if(w!==0)return w;const A=qm(u[d[g]],h[f[g]]);if(A!==0)return A}return it(d.length,f.length)})(s.mapValue,e.mapValue);default:throw $e(23264,{he:t})}}function YI(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return it(s,e);const t=Fu(s),n=Fu(e),r=it(t.seconds,n.seconds);return r!==0?r:it(t.nanos,n.nanos)}function JI(s,e){const t=s.values||[],n=e.values||[];for(let r=0;r<t.length&&r<n.length;++r){const i=qm(t[r],n[r]);if(i)return i}return it(t.length,n.length)}function Qm(s){return db(s)}function db(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const n=Fu(t);return`time(${n.seconds},${n.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return Su(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return Le.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let n="[",r=!0;for(const i of t.values||[])r?r=!1:n+=",",n+=db(i);return n+"]"})(s.arrayValue):"mapValue"in s?(function(t){const n=Object.keys(t.fields||{}).sort();let r="{",i=!0;for(const o of n)i?i=!1:r+=",",r+=`${o}:${db(t.fields[o])}`;return r+"}"})(s.mapValue):$e(61005,{value:s})}function vA(s){switch(Tu(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=wx(s);return e?16+vA(e):16;case 5:return 2*s.stringValue.length;case 6:return Su(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((r,i)=>r+vA(i)),0)})(s.arrayValue);case 10:case 11:return(function(n){let r=0;return Vu(n.fields,((i,o)=>{r+=i.length+vA(o)})),r})(s.mapValue);default:throw $e(13486,{value:s})}}function ZI(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function hb(s){return!!s&&"integerValue"in s}function kF(s){return!!s&&"arrayValue"in s}function eP(s){return!!s&&"nullValue"in s}function tP(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function AA(s){return!!s&&"mapValue"in s}function Tj(s){var t,n;return((n=(((t=s==null?void 0:s.mapValue)==null?void 0:t.fields)||{})[l3])==null?void 0:n.stringValue)===c3}function zg(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return Vu(s.mapValue.fields,((t,n)=>e.mapValue.fields[t]=zg(n))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=zg(s.arrayValue.values[t]);return e}return{...s}}function kj(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===Sj}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(e){this.value=e}static empty(){return new Wr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!AA(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=zg(t)}setAll(e){let t=gr.emptyPath(),n={},r=[];e.forEach(((o,u)=>{if(!t.isImmediateParentOf(u)){const d=this.getFieldsMap(t);this.applyChanges(d,n,r),n={},r=[],t=u.popLast()}o?n[u.lastSegment()]=zg(o):r.push(u.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());AA(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return lo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];AA(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Vu(t,((r,i)=>e[r]=i));for(const r of n)delete e[r]}clone(){return new Wr(zg(this.value))}}function u3(s){const e=[];return Vu(s.fields,((t,n)=>{const r=new gr([t]);if(AA(n)){const i=u3(n.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)})),new Gs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e,t,n,r,i,o,u){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=o,this.documentState=u}static newInvalidDocument(e){return new Nr(e,0,We.min(),We.min(),We.min(),Wr.empty(),0)}static newFoundDocument(e,t,n,r){return new Nr(e,1,t,We.min(),n,r,0)}static newNoDocument(e,t){return new Nr(e,2,t,We.min(),We.min(),Wr.empty(),0)}static newUnknownDocument(e,t){return new Nr(e,3,t,We.min(),We.min(),Wr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(We.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Wr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Wr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=We.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Nr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Nr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v_{constructor(e,t){this.position=e,this.inclusive=t}}function nP(s,e,t){let n=0;for(let r=0;r<s.position.length;r++){const i=e[r],o=s.position[r];if(i.field.isKeyField()?n=Le.comparator(Le.fromName(o.referenceValue),t.key):n=qm(o,t.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function rP(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!lo(s.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(e,t="asc"){this.field=e,this.dir=t}}function Ij(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d3{}class Rn extends d3{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new Rj(e,t,n):t==="array-contains"?new Mj(e,n):t==="in"?new Lj(e,n):t==="not-in"?new Oj(e,n):t==="array-contains-any"?new Bj(e,n):new Rn(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new Dj(e,n):new Nj(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(qm(t,this.value)):t!==null&&Tu(this.value)===Tu(t)&&this.matchesComparison(qm(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return $e(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ra extends d3{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ra(e,t)}matches(e){return h3(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function h3(s){return s.op==="and"}function p3(s){return Pj(s)&&h3(s)}function Pj(s){for(const e of s.filters)if(e instanceof ra)return!1;return!0}function pb(s){if(s instanceof Rn)return s.field.canonicalString()+s.op.toString()+Qm(s.value);if(p3(s))return s.filters.map((e=>pb(e))).join(",");{const e=s.filters.map((t=>pb(t))).join(",");return`${s.op}(${e})`}}function f3(s,e){return s instanceof Rn?(function(n,r){return r instanceof Rn&&n.op===r.op&&n.field.isEqual(r.field)&&lo(n.value,r.value)})(s,e):s instanceof ra?(function(n,r){return r instanceof ra&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce(((i,o,u)=>i&&f3(o,r.filters[u])),!0):!1})(s,e):void $e(19439)}function m3(s){return s instanceof Rn?(function(t){return`${t.field.canonicalString()} ${t.op} ${Qm(t.value)}`})(s):s instanceof ra?(function(t){return t.op.toString()+" {"+t.getFilters().map(m3).join(" ,")+"}"})(s):"Filter"}class Rj extends Rn{constructor(e,t,n){super(e,t,n),this.key=Le.fromName(n.referenceValue)}matches(e){const t=Le.comparator(e.key,this.key);return this.matchesComparison(t)}}class Dj extends Rn{constructor(e,t){super(e,"in",t),this.keys=g3("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Nj extends Rn{constructor(e,t){super(e,"not-in",t),this.keys=g3("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function g3(s,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((n=>Le.fromName(n.referenceValue)))}class Mj extends Rn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return kF(t)&&ty(t.arrayValue,this.value)}}class Lj extends Rn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ty(this.value.arrayValue,t)}}class Oj extends Rn{constructor(e,t){super(e,"not-in",t)}matches(e){if(ty(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ty(this.value.arrayValue,t)}}class Bj extends Rn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!kF(t)||!t.arrayValue.values)&&t.arrayValue.values.some((n=>ty(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vj{constructor(e,t=null,n=[],r=[],i=null,o=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=u,this.Te=null}}function sP(s,e=null,t=[],n=[],r=null,i=null,o=null){return new Vj(s,e,t,n,r,i,o)}function IF(s){const e=He(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((n=>pb(n))).join(","),t+="|ob:",t+=e.orderBy.map((n=>(function(i){return i.field.canonicalString()+i.dir})(n))).join(","),yx(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((n=>Qm(n))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((n=>Qm(n))).join(",")),e.Te=t}return e.Te}function PF(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!Ij(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!f3(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!rP(s.startAt,e.startAt)&&rP(s.endAt,e.endAt)}function fb(s){return Le.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a2{constructor(e,t=null,n=[],r=[],i=null,o="F",u=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=u,this.endAt=d,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function Uj(s,e,t,n,r,i,o,u){return new a2(s,e,t,n,r,i,o,u)}function RF(s){return new a2(s)}function iP(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function jj(s){return Le.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function y3(s){return s.collectionGroup!==null}function Hg(s){const e=He(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new zn(gr.comparator);return o.filters.forEach((d=>{d.getFlattenedFilters().forEach((h=>{h.isInequality()&&(u=u.add(h.field))}))})),u})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new ny(i,n))})),t.has(gr.keyField().canonicalString())||e.Ie.push(new ny(gr.keyField(),n))}return e.Ie}function so(s){const e=He(s);return e.Ee||(e.Ee=w3(e,Hg(s))),e.Ee}function $j(s){const e=He(s);return e.Re||(e.Re=w3(e,s.explicitOrderBy)),e.Re}function w3(s,e){if(s.limitType==="F")return sP(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((r=>{const i=r.dir==="desc"?"asc":"desc";return new ny(r.field,i)}));const t=s.endAt?new v_(s.endAt.position,s.endAt.inclusive):null,n=s.startAt?new v_(s.startAt.position,s.startAt.inclusive):null;return sP(s.path,s.collectionGroup,e,s.filters,s.limit,t,n)}}function mb(s,e){const t=s.filters.concat([e]);return new a2(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function zj(s,e){const t=s.explicitOrderBy.concat([e]);return new a2(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function A_(s,e,t){return new a2(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function vx(s,e){return PF(so(s),so(e))&&s.limitType===e.limitType}function v3(s){return`${IF(so(s))}|lt:${s.limitType}`}function qp(s){return`Query(target=${(function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map((r=>m3(r))).join(", ")}]`),yx(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((r=>Qm(r))).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((r=>Qm(r))).join(",")),`Target(${n})`})(so(s))}; limitType=${s.limitType})`}function Ax(s,e){return e.isFoundDocument()&&(function(n,r){const i=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):Le.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)})(s,e)&&(function(n,r){for(const i of Hg(n))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0})(s,e)&&(function(n,r){for(const i of n.filters)if(!i.matches(r))return!1;return!0})(s,e)&&(function(n,r){return!(n.startAt&&!(function(o,u,d){const h=nP(o,u,d);return o.inclusive?h<=0:h<0})(n.startAt,Hg(n),r)||n.endAt&&!(function(o,u,d){const h=nP(o,u,d);return o.inclusive?h>=0:h>0})(n.endAt,Hg(n),r))})(s,e)}function Hj(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function A3(s){return(e,t)=>{let n=!1;for(const r of Hg(s)){const i=Wj(r,e,t);if(i!==0)return i;n=n||r.field.isKeyField()}return 0}}function Wj(s,e,t){const n=s.field.isKeyField()?Le.comparator(e.key,t.key):(function(i,o,u){const d=o.data.field(i),h=u.data.field(i);return d!==null&&h!==null?qm(d,h):$e(42886)})(s.field,e,t);switch(s.dir){case"asc":return n;case"desc":return-1*n;default:return $e(19790,{direction:s.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[r,i]of n)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Vu(this.inner,((t,n)=>{for(const[r,i]of n)e(r,i)}))}isEmpty(){return n3(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gj=new on(Le.comparator);function Dl(){return Gj}const _3=new on(Le.comparator);function yg(...s){let e=_3;for(const t of s)e=e.insert(t.key,t);return e}function x3(s){let e=_3;return s.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function xd(){return Wg()}function E3(){return Wg()}function Wg(){return new Zh((s=>s.toString()),((s,e)=>s.isEqual(e)))}const qj=new on(Le.comparator),Qj=new zn(Le.comparator);function at(...s){let e=Qj;for(const t of s)e=e.add(t);return e}const Kj=new zn(it);function Xj(){return Kj}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DF(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:g_(e)?"-0":e}}function b3(s){return{integerValue:""+s}}function Yj(s,e){return Aj(e)?b3(e):DF(s,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{constructor(){this._=void 0}}function Jj(s,e,t){return s instanceof ry?(function(r,i){const o={fields:{[i3]:{stringValue:s3},[o3]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&TF(i)&&(i=wx(i)),i&&(o.fields[a3]=i),{mapValue:o}})(t,e):s instanceof sy?F3(s,e):s instanceof iy?S3(s,e):(function(r,i){const o=C3(r,i),u=aP(o)+aP(r.Ae);return hb(o)&&hb(r.Ae)?b3(u):DF(r.serializer,u)})(s,e)}function Zj(s,e,t){return s instanceof sy?F3(s,e):s instanceof iy?S3(s,e):t}function C3(s,e){return s instanceof __?(function(n){return hb(n)||(function(i){return!!i&&"doubleValue"in i})(n)})(e)?e:{integerValue:0}:null}class ry extends _x{}class sy extends _x{constructor(e){super(),this.elements=e}}function F3(s,e){const t=T3(e);for(const n of s.elements)t.some((r=>lo(r,n)))||t.push(n);return{arrayValue:{values:t}}}class iy extends _x{constructor(e){super(),this.elements=e}}function S3(s,e){let t=T3(e);for(const n of s.elements)t=t.filter((r=>!lo(r,n)));return{arrayValue:{values:t}}}class __ extends _x{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function aP(s){return bn(s.integerValue||s.doubleValue)}function T3(s){return kF(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e8{constructor(e,t){this.field=e,this.transform=t}}function t8(s,e){return s.field.isEqual(e.field)&&(function(n,r){return n instanceof sy&&r instanceof sy||n instanceof iy&&r instanceof iy?Gm(n.elements,r.elements,lo):n instanceof __&&r instanceof __?lo(n.Ae,r.Ae):n instanceof ry&&r instanceof ry})(s.transform,e.transform)}class n8{constructor(e,t){this.version=e,this.transformResults=t}}class Zi{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Zi}static exists(e){return new Zi(void 0,e)}static updateTime(e){return new Zi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function _A(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class xx{}function k3(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new NF(s.key,Zi.none()):new g0(s.key,s.data,Zi.none());{const t=s.data,n=Wr.empty();let r=new zn(gr.comparator);for(let i of e.fields)if(!r.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?n.delete(i):n.set(i,o),r=r.add(i)}return new Uu(s.key,n,new Gs(r.toArray()),Zi.none())}}function r8(s,e,t){s instanceof g0?(function(r,i,o){const u=r.value.clone(),d=lP(r.fieldTransforms,i,o.transformResults);u.setAll(d),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(s,e,t):s instanceof Uu?(function(r,i,o){if(!_A(r.precondition,i))return void i.convertToUnknownDocument(o.version);const u=lP(r.fieldTransforms,i,o.transformResults),d=i.data;d.setAll(I3(r)),d.setAll(u),i.convertToFoundDocument(o.version,d).setHasCommittedMutations()})(s,e,t):(function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Gg(s,e,t,n){return s instanceof g0?(function(i,o,u,d){if(!_A(i.precondition,o))return u;const h=i.value.clone(),f=cP(i.fieldTransforms,d,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(s,e,t,n):s instanceof Uu?(function(i,o,u,d){if(!_A(i.precondition,o))return u;const h=cP(i.fieldTransforms,d,o),f=o.data;return f.setAll(I3(i)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),u===null?null:u.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((g=>g.field)))})(s,e,t,n):(function(i,o,u){return _A(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u})(s,e,t)}function s8(s,e){let t=null;for(const n of s.fieldTransforms){const r=e.data.field(n.field),i=C3(n.transform,r||null);i!=null&&(t===null&&(t=Wr.empty()),t.set(n.field,i))}return t||null}function oP(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&Gm(n,r,((i,o)=>t8(i,o)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class g0 extends xx{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Uu extends xx{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function I3(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const n=s.data.field(t);e.set(t,n)}})),e}function lP(s,e,t){const n=new Map;_t(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let r=0;r<t.length;r++){const i=s[r],o=i.transform,u=e.data.field(i.field);n.set(i.field,Zj(o,u,t[r]))}return n}function cP(s,e,t){const n=new Map;for(const r of s){const i=r.transform,o=t.data.field(r.field);n.set(r.field,Jj(i,o,e))}return n}class NF extends xx{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class i8 extends xx{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a8{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&r8(i,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Gg(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Gg(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=E3();return this.mutations.forEach((r=>{const i=e.get(r.key),o=i.overlayedDocument;let u=this.applyToLocalView(o,i.mutatedFields);u=t.has(r.key)?null:u;const d=k3(o,u);d!==null&&n.set(r.key,d),o.isValidDocument()||o.convertToNoDocument(We.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),at())}isEqual(e){return this.batchId===e.batchId&&Gm(this.mutations,e.mutations,((t,n)=>oP(t,n)))&&Gm(this.baseMutations,e.baseMutations,((t,n)=>oP(t,n)))}}class MF{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){_t(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=(function(){return qj})();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,n[o].version);return new MF(e,t,n,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o8{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l8{constructor(e,t,n){this.alias=e,this.aggregateType=t,this.fieldPath=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c8{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var In,ct;function u8(s){switch(s){case se.OK:return $e(64938);case se.CANCELLED:case se.UNKNOWN:case se.DEADLINE_EXCEEDED:case se.RESOURCE_EXHAUSTED:case se.INTERNAL:case se.UNAVAILABLE:case se.UNAUTHENTICATED:return!1;case se.INVALID_ARGUMENT:case se.NOT_FOUND:case se.ALREADY_EXISTS:case se.PERMISSION_DENIED:case se.FAILED_PRECONDITION:case se.ABORTED:case se.OUT_OF_RANGE:case se.UNIMPLEMENTED:case se.DATA_LOSS:return!0;default:return $e(15467,{code:s})}}function P3(s){if(s===void 0)return Rl("GRPC error has no .code"),se.UNKNOWN;switch(s){case In.OK:return se.OK;case In.CANCELLED:return se.CANCELLED;case In.UNKNOWN:return se.UNKNOWN;case In.DEADLINE_EXCEEDED:return se.DEADLINE_EXCEEDED;case In.RESOURCE_EXHAUSTED:return se.RESOURCE_EXHAUSTED;case In.INTERNAL:return se.INTERNAL;case In.UNAVAILABLE:return se.UNAVAILABLE;case In.UNAUTHENTICATED:return se.UNAUTHENTICATED;case In.INVALID_ARGUMENT:return se.INVALID_ARGUMENT;case In.NOT_FOUND:return se.NOT_FOUND;case In.ALREADY_EXISTS:return se.ALREADY_EXISTS;case In.PERMISSION_DENIED:return se.PERMISSION_DENIED;case In.FAILED_PRECONDITION:return se.FAILED_PRECONDITION;case In.ABORTED:return se.ABORTED;case In.OUT_OF_RANGE:return se.OUT_OF_RANGE;case In.UNIMPLEMENTED:return se.UNIMPLEMENTED;case In.DATA_LOSS:return se.DATA_LOSS;default:return $e(39323,{code:s})}}(ct=In||(In={}))[ct.OK=0]="OK",ct[ct.CANCELLED=1]="CANCELLED",ct[ct.UNKNOWN=2]="UNKNOWN",ct[ct.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ct[ct.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ct[ct.NOT_FOUND=5]="NOT_FOUND",ct[ct.ALREADY_EXISTS=6]="ALREADY_EXISTS",ct[ct.PERMISSION_DENIED=7]="PERMISSION_DENIED",ct[ct.UNAUTHENTICATED=16]="UNAUTHENTICATED",ct[ct.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ct[ct.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ct[ct.ABORTED=10]="ABORTED",ct[ct.OUT_OF_RANGE=11]="OUT_OF_RANGE",ct[ct.UNIMPLEMENTED=12]="UNIMPLEMENTED",ct[ct.INTERNAL=13]="INTERNAL",ct[ct.UNAVAILABLE=14]="UNAVAILABLE",ct[ct.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d8(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h8=new _u([4294967295,4294967295],0);function uP(s){const e=d8().encode(s),t=new WD;return t.update(e),new Uint8Array(t.digest())}function dP(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new _u([t,n],0),new _u([r,i],0)]}class LF{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new wg(`Invalid padding: ${t}`);if(n<0)throw new wg(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new wg(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new wg(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=_u.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(_u.fromNumber(n)));return r.compare(h8)===1&&(r=new _u([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=uP(e),[n,r]=dP(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,r,i);if(!this.we(o))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new LF(i,r,t);return n.forEach((u=>o.insert(u))),o}insert(e){if(this.ge===0)return;const t=uP(e),[n,r]=dP(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,r,i);this.be(o)}}be(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class wg extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,y0.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Ex(We.min(),r,new on(it),Dl(),at())}}class y0{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new y0(n,t,at(),at(),at())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA{constructor(e,t,n,r){this.Se=e,this.removedTargetIds=t,this.key=n,this.De=r}}class R3{constructor(e,t){this.targetId=e,this.Ce=t}}class D3{constructor(e,t,n=wr.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class hP{constructor(){this.ve=0,this.Fe=pP(),this.Me=wr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=at(),t=at(),n=at();return this.Fe.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:$e(38017,{changeType:i})}})),new y0(this.Me,this.xe,e,t,n)}Ke(){this.Oe=!1,this.Fe=pP()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,_t(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class p8{constructor(e){this.Ge=e,this.ze=new Map,this.je=Dl(),this.He=Jv(),this.Je=Jv(),this.Ze=new on(it)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.We(),n.Ne||n.Ke(),n.Le(e.resumeToken);break;case 2:n.We(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.Qe(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:$e(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((n,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const i=r.target;if(fb(i))if(n===0){const o=new Le(i.path);this.et(t,o,Nr.newNoDocument(o,We.min()))}else _t(n===1,20013,{expectedCount:n});else{const o=this._t(t);if(o!==n){const u=this.ut(e),d=u?this.ct(u,e,o):1;if(d!==0){this.it(t);const h=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let o,u;try{o=Su(n).toUint8Array()}catch(d){if(d instanceof r3)return jh("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{u=new LF(o,r,i)}catch(d){return jh(d instanceof wg?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return u.ge===0?null:u}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach((i=>{const o=this.Ge.ht(),u=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(u)||(this.et(t,i,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((i,o)=>{const u=this.ot(o);if(u){if(i.current&&fb(u.target)){const d=new Le(u.target.path);this.It(d).has(o)||this.Et(o,d)||this.et(o,d,Nr.newNoDocument(d,e))}i.Be&&(t.set(o,i.ke()),i.Ke())}}));let n=at();this.Je.forEach(((i,o)=>{let u=!0;o.forEachWhile((d=>{const h=this.ot(d);return!h||h.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(n=n.add(i))})),this.je.forEach(((i,o)=>o.setReadTime(e)));const r=new Ex(e,t,this.Ze,this.je,n);return this.je=Dl(),this.He=Jv(),this.Je=Jv(),this.Ze=new on(it),r}Ye(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,n),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.qe(t,1):r.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new hP,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new zn(it),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new zn(it),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||be("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new hP),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Jv(){return new on(Le.comparator)}function pP(){return new on(Le.comparator)}const f8={asc:"ASCENDING",desc:"DESCENDING"},m8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},g8={and:"AND",or:"OR"};class y8{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function gb(s,e){return s.useProto3Json||yx(e)?e:{value:e}}function x_(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function N3(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function w8(s,e){return x_(s,e.toTimestamp())}function io(s){return _t(!!s,49232),We.fromTimestamp((function(t){const n=Fu(t);return new Wt(n.seconds,n.nanos)})(s))}function OF(s,e){return yb(s,e).canonicalString()}function yb(s,e){const t=(function(r){return new Vt(["projects",r.projectId,"databases",r.database])})(s).child("documents");return e===void 0?t:t.child(e)}function M3(s){const e=Vt.fromString(s);return _t(j3(e),10190,{key:e.toString()}),e}function wb(s,e){return OF(s.databaseId,e.path)}function NE(s,e){const t=M3(e);if(t.get(1)!==s.databaseId.projectId)throw new Ae(se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new Ae(se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new Le(O3(t))}function L3(s,e){return OF(s.databaseId,e)}function v8(s){const e=M3(s);return e.length===4?Vt.emptyPath():O3(e)}function vb(s){return new Vt(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function O3(s){return _t(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function fP(s,e,t){return{name:wb(s,e),fields:t.value.mapValue.fields}}function A8(s,e){let t;if("targetChange"in e){e.targetChange;const n=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:$e(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=(function(h,f){return h.useProto3Json?(_t(f===void 0||typeof f=="string",58123),wr.fromBase64String(f||"")):(_t(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),wr.fromUint8Array(f||new Uint8Array))})(s,e.targetChange.resumeToken),o=e.targetChange.cause,u=o&&(function(h){const f=h.code===void 0?se.UNKNOWN:P3(h.code);return new Ae(f,h.message||"")})(o);t=new D3(n,r,i,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const r=NE(s,n.document.name),i=io(n.document.updateTime),o=n.document.createTime?io(n.document.createTime):We.min(),u=new Wr({mapValue:{fields:n.document.fields}}),d=Nr.newFoundDocument(r,i,o,u),h=n.targetIds||[],f=n.removedTargetIds||[];t=new xA(h,f,d.key,d)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const r=NE(s,n.document),i=n.readTime?io(n.readTime):We.min(),o=Nr.newNoDocument(r,i),u=n.removedTargetIds||[];t=new xA([],u,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const r=NE(s,n.document),i=n.removedTargetIds||[];t=new xA([],i,r,null)}else{if(!("filter"in e))return $e(11601,{Vt:e});{e.filter;const n=e.filter;n.targetId;const{count:r=0,unchangedNames:i}=n,o=new c8(r,i),u=n.targetId;t=new R3(u,o)}}return t}function _8(s,e){let t;if(e instanceof g0)t={update:fP(s,e.key,e.value)};else if(e instanceof NF)t={delete:wb(s,e.key)};else if(e instanceof Uu)t={update:fP(s,e.key,e.data),updateMask:I8(e.fieldMask)};else{if(!(e instanceof i8))return $e(16599,{dt:e.type});t={verify:wb(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((n=>(function(i,o){const u=o.transform;if(u instanceof ry)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof sy)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof iy)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof __)return{fieldPath:o.field.canonicalString(),increment:u.Ae};throw $e(20930,{transform:o.transform})})(0,n)))),e.precondition.isNone||(t.currentDocument=(function(r,i){return i.updateTime!==void 0?{updateTime:w8(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:$e(27497)})(s,e.precondition)),t}function x8(s,e){return s&&s.length>0?(_t(e!==void 0,14353),s.map((t=>(function(r,i){let o=r.updateTime?io(r.updateTime):io(i);return o.isEqual(We.min())&&(o=io(i)),new n8(o,r.transformResults||[])})(t,e)))):[]}function E8(s,e){return{documents:[L3(s,e.path)]}}function B3(s,e){const t={structuredQuery:{}},n=e.path;let r;e.collectionGroup!==null?(r=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=L3(s,r);const i=(function(h){if(h.length!==0)return U3(ra.create(h,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const o=(function(h){if(h.length!==0)return h.map((f=>(function(w){return{field:Ac(w.field),direction:S8(w.dir)}})(f)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const u=gb(s,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function b8(s,e,t,n){const{ft:r,parent:i}=B3(s,e),o={},u=[];let d=0;return t.forEach((h=>{const f="aggregate_"+d++;o[f]=h.alias,h.aggregateType==="count"?u.push({alias:f,count:{}}):h.aggregateType==="avg"?u.push({alias:f,avg:{field:Ac(h.fieldPath)}}):h.aggregateType==="sum"&&u.push({alias:f,sum:{field:Ac(h.fieldPath)}})})),{request:{structuredAggregationQuery:{aggregations:u,structuredQuery:r.structuredQuery},parent:r.parent},gt:o,parent:i}}function C8(s){let e=v8(s.parent);const t=s.structuredQuery,n=t.from?t.from.length:0;let r=null;if(n>0){_t(n===1,65062);const f=t.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let i=[];t.where&&(i=(function(g){const w=V3(g);return w instanceof ra&&p3(w)?w.getFilters():[w]})(t.where));let o=[];t.orderBy&&(o=(function(g){return g.map((w=>(function(F){return new ny(Qp(F.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(F.direction))})(w)))})(t.orderBy));let u=null;t.limit&&(u=(function(g){let w;return w=typeof g=="object"?g.value:g,yx(w)?null:w})(t.limit));let d=null;t.startAt&&(d=(function(g){const w=!!g.before,A=g.values||[];return new v_(A,w)})(t.startAt));let h=null;return t.endAt&&(h=(function(g){const w=!g.before,A=g.values||[];return new v_(A,w)})(t.endAt)),Uj(e,r,o,i,u,"F",d,h)}function F8(s,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $e(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function V3(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Qp(t.unaryFilter.field);return Rn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=Qp(t.unaryFilter.field);return Rn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Qp(t.unaryFilter.field);return Rn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Qp(t.unaryFilter.field);return Rn.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return $e(61313);default:return $e(60726)}})(s):s.fieldFilter!==void 0?(function(t){return Rn.create(Qp(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return $e(58110);default:return $e(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return ra.create(t.compositeFilter.filters.map((n=>V3(n))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return $e(1026)}})(t.compositeFilter.op))})(s):$e(30097,{filter:s})}function S8(s){return f8[s]}function T8(s){return m8[s]}function k8(s){return g8[s]}function Ac(s){return{fieldPath:s.canonicalString()}}function Qp(s){return gr.fromServerFormat(s.fieldPath)}function U3(s){return s instanceof Rn?(function(t){if(t.op==="=="){if(tP(t.value))return{unaryFilter:{field:Ac(t.field),op:"IS_NAN"}};if(eP(t.value))return{unaryFilter:{field:Ac(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(tP(t.value))return{unaryFilter:{field:Ac(t.field),op:"IS_NOT_NAN"}};if(eP(t.value))return{unaryFilter:{field:Ac(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ac(t.field),op:T8(t.op),value:t.value}}})(s):s instanceof ra?(function(t){const n=t.getFilters().map((r=>U3(r)));return n.length===1?n[0]:{compositeFilter:{op:k8(t.op),filters:n}}})(s):$e(54877,{filter:s})}function I8(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function j3(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function $3(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu{constructor(e,t,n,r,i=We.min(),o=We.min(),u=wr.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=d}withSequenceNumber(e){return new yu(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new yu(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new yu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new yu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P8{constructor(e){this.yt=e}}function R8(s){const e=C8({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?A_(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D8{constructor(){this.Sn=new N8}addToCollectionParentIndex(e,t){return this.Sn.add(t),ae.resolve()}getCollectionParents(e,t){return ae.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return ae.resolve()}deleteFieldIndex(e,t){return ae.resolve()}deleteAllFieldIndexes(e){return ae.resolve()}createTargetIndexes(e,t){return ae.resolve()}getDocumentsMatchingTarget(e,t){return ae.resolve(null)}getIndexType(e,t){return ae.resolve(0)}getFieldIndexes(e,t){return ae.resolve([])}getNextCollectionGroupToUpdate(e){return ae.resolve(null)}getMinOffset(e,t){return ae.resolve(Cu.min())}getMinOffsetFromCollectionGroup(e,t){return ae.resolve(Cu.min())}updateCollectionGroup(e,t,n){return ae.resolve()}updateIndexEntries(e,t){return ae.resolve()}}class N8{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new zn(Vt.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new zn(Vt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mP={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},z3=41943040;class ds{static withCacheSize(e){return new ds(e,ds.DEFAULT_COLLECTION_PERCENTILE,ds.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ds.DEFAULT_COLLECTION_PERCENTILE=10,ds.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ds.DEFAULT=new ds(z3,ds.DEFAULT_COLLECTION_PERCENTILE,ds.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ds.DISABLED=new ds(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Km(0)}static ar(){return new Km(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gP="LruGarbageCollector",M8=1048576;function yP([s,e],[t,n]){const r=it(s,t);return r===0?it(e,n):r}class L8{constructor(e){this.Pr=e,this.buffer=new zn(yP),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();yP(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class O8{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){be(gP,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){i2(t)?be(gP,"Ignoring IndexedDB error during garbage collection: ",t):await s2(t)}await this.Ar(3e5)}))}}class B8{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((n=>Math.floor(t/100*n)))}nthSequenceNumber(e,t){if(t===0)return ae.resolve(gx.ce);const n=new L8(t);return this.Vr.forEachTarget(e,(r=>n.Er(r.sequenceNumber))).next((()=>this.Vr.mr(e,(r=>n.Er(r))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.Vr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(be("LruGarbageCollector","Garbage collection skipped; disabled"),ae.resolve(mP)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(be("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),mP):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let n,r,i,o,u,d,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(be("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),r=this.params.maximumSequenceNumbersToCollect):r=g,o=Date.now(),this.nthSequenceNumber(e,r)))).next((g=>(n=g,u=Date.now(),this.removeTargets(e,n,t)))).next((g=>(i=g,d=Date.now(),this.removeOrphanedDocuments(e,n)))).next((g=>(h=Date.now(),Gp()<=st.DEBUG&&be("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${r} in `+(u-o)+`ms
	Removed ${i} targets in `+(d-u)+`ms
	Removed ${g} documents in `+(h-d)+`ms
Total Duration: ${h-f}ms`),ae.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:g}))))}}function V8(s,e){return new B8(s,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U8{constructor(){this.changes=new Zh((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Nr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?ae.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j8{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $8{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(n!==null&&Gg(n.mutation,r,Gs.empty(),Wt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.getLocalViewOfDocuments(e,n,at()).next((()=>n))))}getLocalViewOfDocuments(e,t,n=at()){const r=xd();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((i=>{let o=yg();return i.forEach(((u,d)=>{o=o.insert(u,d.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const n=xd();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,at())))}populateOverlays(e,t,n){const r=[];return n.forEach((i=>{t.has(i)||r.push(i)})),this.documentOverlayCache.getOverlays(e,r).next((i=>{i.forEach(((o,u)=>{t.set(o,u)}))}))}computeViews(e,t,n,r){let i=Dl();const o=Wg(),u=(function(){return Wg()})();return t.forEach(((d,h)=>{const f=n.get(h.key);r.has(h.key)&&(f===void 0||f.mutation instanceof Uu)?i=i.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),Gg(f.mutation,h,f.mutation.getFieldMask(),Wt.now())):o.set(h.key,Gs.empty())})),this.recalculateAndSaveOverlays(e,i).next((d=>(d.forEach(((h,f)=>o.set(h,f))),t.forEach(((h,f)=>u.set(h,new j8(f,o.get(h)??null)))),u)))}recalculateAndSaveOverlays(e,t){const n=Wg();let r=new on(((o,u)=>o-u)),i=at();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const u of o)u.keys().forEach((d=>{const h=t.get(d);if(h===null)return;let f=n.get(d)||Gs.empty();f=u.applyToLocalView(h,f),n.set(d,f);const g=(r.get(u.batchId)||at()).add(d);r=r.insert(u.batchId,g)}))})).next((()=>{const o=[],u=r.getReverseIterator();for(;u.hasNext();){const d=u.getNext(),h=d.key,f=d.value,g=E3();f.forEach((w=>{if(!i.has(w)){const A=k3(t.get(w),n.get(w));A!==null&&g.set(w,A),i=i.add(w)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,g))}return ae.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,t,n,r){return jj(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):y3(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):ae.resolve(xd());let u=Jg,d=i;return o.next((h=>ae.forEach(h,((f,g)=>(u<g.largestBatchId&&(u=g.largestBatchId),i.get(f)?ae.resolve():this.remoteDocumentCache.getEntry(e,f).next((w=>{d=d.insert(f,w)}))))).next((()=>this.populateOverlays(e,h,i))).next((()=>this.computeViews(e,d,h,at()))).next((f=>({batchId:u,changes:x3(f)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Le(t)).next((n=>{let r=yg();return n.isFoundDocument()&&(r=r.insert(n.key,n)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let o=yg();return this.indexManager.getCollectionParents(e,i).next((u=>ae.forEach(u,(d=>{const h=(function(g,w){return new a2(w,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,d.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,n,r).next((f=>{f.forEach(((g,w)=>{o=o.insert(g,w)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((o=>{i.forEach(((d,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,Nr.newInvalidDocument(f)))}));let u=yg();return o.forEach(((d,h)=>{const f=i.get(d);f!==void 0&&Gg(f.mutation,h,Gs.empty(),Wt.now()),Ax(t,h)&&(u=u.insert(d,h))})),u}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z8{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return ae.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:io(r.createTime)}})(t)),ae.resolve()}getNamedQuery(e,t){return ae.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(r){return{name:r.name,query:R8(r.bundledQuery),readTime:io(r.readTime)}})(t)),ae.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H8{constructor(){this.overlays=new on(Le.comparator),this.Lr=new Map}getOverlay(e,t){return ae.resolve(this.overlays.get(t))}getOverlays(e,t){const n=xd();return ae.forEach(t,(r=>this.getOverlay(e,r).next((i=>{i!==null&&n.set(r,i)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((r,i)=>{this.bt(e,t,i)})),ae.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Lr.get(n);return r!==void 0&&(r.forEach((i=>this.overlays=this.overlays.remove(i))),this.Lr.delete(n)),ae.resolve()}getOverlaysForCollection(e,t,n){const r=xd(),i=t.length+1,o=new Le(t.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const d=u.getNext().value,h=d.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===i&&d.largestBatchId>n&&r.set(d.getKey(),d)}return ae.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new on(((h,f)=>h-f));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>n){let f=i.get(h.largestBatchId);f===null&&(f=xd(),i=i.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const u=xd(),d=i.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach(((h,f)=>u.set(h,f))),!(u.size()>=r)););return ae.resolve(u)}bt(e,t,n){const r=this.overlays.get(n.key);if(r!==null){const o=this.Lr.get(r.largestBatchId).delete(n.key);this.Lr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new o8(t,n));let i=this.Lr.get(t);i===void 0&&(i=at(),this.Lr.set(t,i)),this.Lr.set(t,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W8{constructor(){this.sessionToken=wr.EMPTY_BYTE_STRING}getSessionToken(e){return ae.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ae.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BF{constructor(){this.kr=new zn(tr.Kr),this.qr=new zn(tr.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const n=new tr(e,t);this.kr=this.kr.add(n),this.qr=this.qr.add(n)}$r(e,t){e.forEach((n=>this.addReference(n,t)))}removeReference(e,t){this.Wr(new tr(e,t))}Qr(e,t){e.forEach((n=>this.removeReference(n,t)))}Gr(e){const t=new Le(new Vt([])),n=new tr(t,e),r=new tr(t,e+1),i=[];return this.qr.forEachInRange([n,r],(o=>{this.Wr(o),i.push(o.key)})),i}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Le(new Vt([])),n=new tr(t,e),r=new tr(t,e+1);let i=at();return this.qr.forEachInRange([n,r],(o=>{i=i.add(o.key)})),i}containsKey(e){const t=new tr(e,0),n=this.kr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class tr{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Le.comparator(e.key,t.key)||it(e.Hr,t.Hr)}static Ur(e,t){return it(e.Hr,t.Hr)||Le.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G8{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new zn(tr.Kr)}checkEmpty(e){return ae.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,r){const i=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new a8(i,t,n,r);this.mutationQueue.push(o);for(const u of r)this.Jr=this.Jr.add(new tr(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return ae.resolve(o)}lookupMutationBatch(e,t){return ae.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.Xr(n),i=r<0?0:r;return ae.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ae.resolve(this.mutationQueue.length===0?SF:this.Yn-1)}getAllMutationBatches(e){return ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new tr(t,0),r=new tr(t,Number.POSITIVE_INFINITY),i=[];return this.Jr.forEachInRange([n,r],(o=>{const u=this.Zr(o.Hr);i.push(u)})),ae.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new zn(it);return t.forEach((r=>{const i=new tr(r,0),o=new tr(r,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([i,o],(u=>{n=n.add(u.Hr)}))})),ae.resolve(this.Yr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;Le.isDocumentKey(i)||(i=i.child(""));const o=new tr(new Le(i),0);let u=new zn(it);return this.Jr.forEachWhile((d=>{const h=d.key.path;return!!n.isPrefixOf(h)&&(h.length===r&&(u=u.add(d.Hr)),!0)}),o),ae.resolve(this.Yr(u))}Yr(e){const t=[];return e.forEach((n=>{const r=this.Zr(n);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){_t(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Jr;return ae.forEach(t.mutations,(r=>{const i=new tr(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Jr=n}))}nr(e){}containsKey(e,t){const n=new tr(t,0),r=this.Jr.firstAfterOrEqual(n);return ae.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ae.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q8{constructor(e){this.ti=e,this.docs=(function(){return new on(Le.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,o=this.ti(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ae.resolve(n?n.document.mutableCopy():Nr.newInvalidDocument(t))}getEntries(e,t){let n=Dl();return t.forEach((r=>{const i=this.docs.get(r);n=n.insert(r,i?i.document.mutableCopy():Nr.newInvalidDocument(r))})),ae.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Dl();const o=t.path,u=new Le(o.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(u);for(;d.hasNext();){const{key:h,value:{document:f}}=d.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||gj(mj(f),n)<=0||(r.has(f.key)||Ax(t,f))&&(i=i.insert(f.key,f.mutableCopy()))}return ae.resolve(i)}getAllFromCollectionGroup(e,t,n,r){$e(9500)}ni(e,t){return ae.forEach(this.docs,(n=>t(n)))}newChangeBuffer(e){return new Q8(this)}getSize(e){return ae.resolve(this.size)}}class Q8 extends U8{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.Mr.addEntry(e,r)):this.Mr.removeEntry(n)})),ae.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K8{constructor(e){this.persistence=e,this.ri=new Zh((t=>IF(t)),PF),this.lastRemoteSnapshotVersion=We.min(),this.highestTargetId=0,this.ii=0,this.si=new BF,this.targetCount=0,this.oi=Km._r()}forEachTarget(e,t){return this.ri.forEach(((n,r)=>t(r))),ae.resolve()}getLastRemoteSnapshotVersion(e){return ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ae.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),ae.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.ii&&(this.ii=t),ae.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Km(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,ae.resolve()}updateTargetData(e,t){return this.lr(t),ae.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,ae.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.ri.forEach(((o,u)=>{u.sequenceNumber<=t&&n.get(u.targetId)===null&&(this.ri.delete(o),i.push(this.removeMatchingKeysForTargetId(e,u.targetId)),r++)})),ae.waitFor(i).next((()=>r))}getTargetCount(e){return ae.resolve(this.targetCount)}getTargetData(e,t){const n=this.ri.get(t)||null;return ae.resolve(n)}addMatchingKeys(e,t,n){return this.si.$r(t,n),ae.resolve()}removeMatchingKeys(e,t,n){this.si.Qr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((o=>{i.push(r.markPotentiallyOrphaned(e,o))})),ae.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),ae.resolve()}getMatchingKeysForTargetId(e,t){const n=this.si.jr(t);return ae.resolve(n)}containsKey(e,t){return ae.resolve(this.si.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H3{constructor(e,t){this._i={},this.overlays={},this.ai=new gx(0),this.ui=!1,this.ui=!0,this.ci=new W8,this.referenceDelegate=e(this),this.li=new K8(this),this.indexManager=new D8,this.remoteDocumentCache=(function(r){return new q8(r)})((n=>this.referenceDelegate.hi(n))),this.serializer=new P8(t),this.Pi=new z8(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new H8,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this._i[e.toKey()];return n||(n=new G8(t,this.referenceDelegate),this._i[e.toKey()]=n),n}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,n){be("MemoryPersistence","Starting transaction:",e);const r=new X8(this.ai.next());return this.referenceDelegate.Ti(),n(r).next((i=>this.referenceDelegate.Ii(r).next((()=>i)))).toPromise().then((i=>(r.raiseOnCommittedEvent(),i)))}Ei(e,t){return ae.or(Object.values(this._i).map((n=>()=>n.containsKey(e,t))))}}class X8 extends wj{constructor(e){super(),this.currentSequenceNumber=e}}class VF{constructor(e){this.persistence=e,this.Ri=new BF,this.Ai=null}static Vi(e){return new VF(e)}get di(){if(this.Ai)return this.Ai;throw $e(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.di.delete(n.toString()),ae.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.di.add(n.toString()),ae.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),ae.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((r=>this.di.add(r.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((i=>this.di.add(i.toString())))})).next((()=>n.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ae.forEach(this.di,(n=>{const r=Le.fromPath(n);return this.mi(e,r).next((i=>{i||t.removeEntry(r,We.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((n=>{n?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return ae.or([()=>ae.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class E_{constructor(e,t){this.persistence=e,this.fi=new Zh((n=>_j(n.path)),((n,r)=>n.isEqual(r))),this.garbageCollector=V8(this,t)}static Vi(e,t){return new E_(e,t)}Ti(){}Ii(e){return ae.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>t.next((r=>n+r))))}pr(e){let t=0;return this.mr(e,(n=>{t++})).next((()=>t))}mr(e,t){return ae.forEach(this.fi,((n,r)=>this.wr(e,n,r).next((i=>i?ae.resolve():t(r)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ni(e,(o=>this.wr(e,o,t).next((u=>{u||(n++,i.removeEntry(o,We.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),ae.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.fi.set(n,e.currentSequenceNumber),ae.resolve()}removeReference(e,t,n){return this.fi.set(n,e.currentSequenceNumber),ae.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),ae.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=vA(e.data.value)),t}wr(e,t,n){return ae.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.fi.get(t);return ae.resolve(r!==void 0&&r>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UF{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Ts=n,this.Is=r}static Es(e,t){let n=at(),r=at();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new UF(e,t.fromCache,n,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y8{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J8{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return x6()?8:vj(Mr())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.gs(e,t).next((o=>{i.result=o})).next((()=>{if(!i.result)return this.ps(e,t,r,n).next((o=>{i.result=o}))})).next((()=>{if(i.result)return;const o=new Y8;return this.ys(e,t,o).next((u=>{if(i.result=u,this.As)return this.ws(e,t,o,u.size)}))})).next((()=>i.result))}ws(e,t,n,r){return n.documentReadCount<this.Vs?(Gp()<=st.DEBUG&&be("QueryEngine","SDK will not create cache indexes for query:",qp(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ae.resolve()):(Gp()<=st.DEBUG&&be("QueryEngine","Query:",qp(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.ds*r?(Gp()<=st.DEBUG&&be("QueryEngine","The SDK decides to create cache indexes for query:",qp(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,so(t))):ae.resolve())}gs(e,t){if(iP(t))return ae.resolve(null);let n=so(t);return this.indexManager.getIndexType(e,n).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=A_(t,null,"F"),n=so(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const o=at(...i);return this.fs.getDocuments(e,o).next((u=>this.indexManager.getMinOffset(e,n).next((d=>{const h=this.bs(t,u);return this.Ss(t,h,o,d.readTime)?this.gs(e,A_(t,null,"F")):this.Ds(e,h,t,d)}))))})))))}ps(e,t,n,r){return iP(t)||r.isEqual(We.min())?ae.resolve(null):this.fs.getDocuments(e,n).next((i=>{const o=this.bs(t,i);return this.Ss(t,o,n,r)?ae.resolve(null):(Gp()<=st.DEBUG&&be("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),qp(t)),this.Ds(e,o,t,fj(r,Jg)).next((u=>u)))}))}bs(e,t){let n=new zn(A3(e));return t.forEach(((r,i)=>{Ax(e,i)&&(n=n.add(i))})),n}Ss(e,t,n,r){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}ys(e,t,n){return Gp()<=st.DEBUG&&be("QueryEngine","Using full collection scan to execute query:",qp(t)),this.fs.getDocumentsMatchingQuery(e,t,Cu.min(),n)}Ds(e,t,n,r){return this.fs.getDocumentsMatchingQuery(e,n,r).next((i=>(t.forEach((o=>{i=i.insert(o.key,o)})),i)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jF="LocalStore",Z8=3e8;class e9{constructor(e,t,n,r){this.persistence=e,this.Cs=t,this.serializer=r,this.vs=new on(it),this.Fs=new Zh((i=>IF(i)),PF),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(n)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new $8(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function t9(s,e,t,n){return new e9(s,e,t,n)}async function W3(s,e){const t=He(s);return await t.persistence.runTransaction("Handle user change","readonly",(n=>{let r;return t.mutationQueue.getAllMutationBatches(n).next((i=>(r=i,t.Os(e),t.mutationQueue.getAllMutationBatches(n)))).next((i=>{const o=[],u=[];let d=at();for(const h of r){o.push(h.batchId);for(const f of h.mutations)d=d.add(f.key)}for(const h of i){u.push(h.batchId);for(const f of h.mutations)d=d.add(f.key)}return t.localDocuments.getDocuments(n,d).next((h=>({Ns:h,removedBatchIds:o,addedBatchIds:u})))}))}))}function n9(s,e){const t=He(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const r=e.batch.keys(),i=t.xs.newChangeBuffer({trackRemovals:!0});return(function(u,d,h,f){const g=h.batch,w=g.keys();let A=ae.resolve();return w.forEach((F=>{A=A.next((()=>f.getEntry(d,F))).next((C=>{const S=h.docVersions.get(F);_t(S!==null,48541),C.version.compareTo(S)<0&&(g.applyToRemoteDocument(C,h),C.isValidDocument()&&(C.setReadTime(h.commitVersion),f.addEntry(C)))}))})),A.next((()=>u.mutationQueue.removeMutationBatch(d,g)))})(t,n,e,i).next((()=>i.apply(n))).next((()=>t.mutationQueue.performConsistencyCheck(n))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(n,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(u){let d=at();for(let h=0;h<u.mutationResults.length;++h)u.mutationResults[h].transformResults.length>0&&(d=d.add(u.batch.mutations[h].key));return d})(e)))).next((()=>t.localDocuments.getDocuments(n,r)))}))}function G3(s){const e=He(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function r9(s,e){const t=He(s),n=e.snapshotVersion;let r=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const o=t.xs.newChangeBuffer({trackRemovals:!0});r=t.vs;const u=[];e.targetChanges.forEach(((f,g)=>{const w=r.get(g);if(!w)return;u.push(t.li.removeMatchingKeys(i,f.removedDocuments,g).next((()=>t.li.addMatchingKeys(i,f.addedDocuments,g))));let A=w.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?A=A.withResumeToken(wr.EMPTY_BYTE_STRING,We.min()).withLastLimboFreeSnapshotVersion(We.min()):f.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(f.resumeToken,n)),r=r.insert(g,A),(function(C,S,P){return C.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=Z8?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0})(w,A,f)&&u.push(t.li.updateTargetData(i,A))}));let d=Dl(),h=at();if(e.documentUpdates.forEach((f=>{e.resolvedLimboDocuments.has(f)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(i,f))})),u.push(s9(i,o,e.documentUpdates).next((f=>{d=f.Bs,h=f.Ls}))),!n.isEqual(We.min())){const f=t.li.getLastRemoteSnapshotVersion(i).next((g=>t.li.setTargetsMetadata(i,i.currentSequenceNumber,n)));u.push(f)}return ae.waitFor(u).next((()=>o.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,d,h))).next((()=>d))})).then((i=>(t.vs=r,i)))}function s9(s,e,t){let n=at(),r=at();return t.forEach((i=>n=n.add(i))),e.getEntries(s,n).next((i=>{let o=Dl();return t.forEach(((u,d)=>{const h=i.get(u);d.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(u)),d.isNoDocument()&&d.version.isEqual(We.min())?(e.removeEntry(u,d.readTime),o=o.insert(u,d)):!h.isValidDocument()||d.version.compareTo(h.version)>0||d.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(d),o=o.insert(u,d)):be(jF,"Ignoring outdated watch update for ",u,". Current version:",h.version," Watch version:",d.version)})),{Bs:o,Ls:r}}))}function i9(s,e){const t=He(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=SF),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function a9(s,e){const t=He(s);return t.persistence.runTransaction("Allocate target","readwrite",(n=>{let r;return t.li.getTargetData(n,e).next((i=>i?(r=i,ae.resolve(r)):t.li.allocateTargetId(n).next((o=>(r=new yu(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.li.addTargetData(n,r).next((()=>r)))))))})).then((n=>{const r=t.vs.get(n.targetId);return(r===null||n.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.vs=t.vs.insert(n.targetId,n),t.Fs.set(e,n.targetId)),n}))}async function Ab(s,e,t){const n=He(s),r=n.vs.get(e),i=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",i,(o=>n.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!i2(o))throw o;be(jF,`Failed to update sequence numbers for target ${e}: ${o}`)}n.vs=n.vs.remove(e),n.Fs.delete(r.target)}function wP(s,e,t){const n=He(s);let r=We.min(),i=at();return n.persistence.runTransaction("Execute query","readwrite",(o=>(function(d,h,f){const g=He(d),w=g.Fs.get(f);return w!==void 0?ae.resolve(g.vs.get(w)):g.li.getTargetData(h,f)})(n,o,so(e)).next((u=>{if(u)return r=u.lastLimboFreeSnapshotVersion,n.li.getMatchingKeysForTargetId(o,u.targetId).next((d=>{i=d}))})).next((()=>n.Cs.getDocumentsMatchingQuery(o,e,t?r:We.min(),t?i:at()))).next((u=>(o9(n,Hj(e),u),{documents:u,ks:i})))))}function o9(s,e,t){let n=s.Ms.get(e)||We.min();t.forEach(((r,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)})),s.Ms.set(e,n)}class vP{constructor(){this.activeTargetIds=Xj()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class l9{constructor(){this.vo=new vP,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,n){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new vP,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c9{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AP="ConnectivityMonitor";class _P{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){be(AP,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){be(AP,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zv=null;function _b(){return Zv===null?Zv=(function(){return 268435456+Math.round(2147483648*Math.random())})():Zv++,"0x"+Zv.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ME="RestConnection",u9={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class d9{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${n}/databases/${r}`,this.$o=this.databaseId.database===y_?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Wo(e,t,n,r,i){const o=_b(),u=this.Qo(e,t.toUriEncodedString());be(ME,`Sending RPC '${e}' ${o}:`,u,n);const d={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(d,r,i);const{host:h}=new URL(u),f=Ou(h);return this.zo(e,u,d,n,f).then((g=>(be(ME,`Received RPC '${e}' ${o}: `,g),g)),(g=>{throw jh(ME,`RPC '${e}' ${o} failed with error: `,g,"url: ",u,"request:",n),g}))}jo(e,t,n,r,i,o){return this.Wo(e,t,n,r,i)}Go(e,t,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+r2})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,i)=>e[i]=r)),n&&n.headers.forEach(((r,i)=>e[i]=r))}Qo(e,t){const n=u9[e];let r=`${this.qo}/v1/${t}:${n}`;return this.databaseInfo.apiKey&&(r=`${r}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),r}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h9{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cr="WebChannelConnection",sg=(s,e,t)=>{s.listen(e,(n=>{try{t(n)}catch(r){setTimeout((()=>{throw r}),0)}}))};class ff extends d9{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!ff.c_){const e=KD();sg(e,QD.STAT_EVENT,(t=>{t.stat===cb.PROXY?be(Cr,"STAT_EVENT: detected buffering proxy"):t.stat===cb.NOPROXY&&be(Cr,"STAT_EVENT: detected no buffering proxy")})),ff.c_=!0}}zo(e,t,n,r,i){const o=_b();return new Promise(((u,d)=>{const h=new GD;h.setWithCredentials(!0),h.listenOnce(qD.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case wA.NO_ERROR:const g=h.getResponseJson();be(Cr,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),u(g);break;case wA.TIMEOUT:be(Cr,`RPC '${e}' ${o} timed out`),d(new Ae(se.DEADLINE_EXCEEDED,"Request time out"));break;case wA.HTTP_ERROR:const w=h.getStatus();if(be(Cr,`RPC '${e}' ${o} failed with status:`,w,"response text:",h.getResponseText()),w>0){let A=h.getResponseJson();Array.isArray(A)&&(A=A[0]);const F=A==null?void 0:A.error;if(F&&F.status&&F.message){const C=(function(P){const O=P.toLowerCase().replace(/_/g,"-");return Object.values(se).indexOf(O)>=0?O:se.UNKNOWN})(F.status);d(new Ae(C,F.message))}else d(new Ae(se.UNKNOWN,"Server responded with status "+h.getStatus()))}else d(new Ae(se.UNAVAILABLE,"Connection failed."));break;default:$e(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{be(Cr,`RPC '${e}' ${o} completed.`)}}));const f=JSON.stringify(r);be(Cr,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",f,n,15)}))}T_(e,t,n){const r=_b(),i=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Go(u.initMessageHeaders,t,n),u.encodeInitMessageHeaders=!0;const h=i.join("");be(Cr,`Creating RPC '${e}' stream ${r}: ${h}`,u);const f=o.createWebChannel(h,u);this.I_(f);let g=!1,w=!1;const A=new h9({Ho:F=>{w?be(Cr,`Not sending because RPC '${e}' stream ${r} is closed:`,F):(g||(be(Cr,`Opening RPC '${e}' stream ${r} transport.`),f.open(),g=!0),be(Cr,`RPC '${e}' stream ${r} sending:`,F),f.send(F))},Jo:()=>f.close()});return sg(f,gg.EventType.OPEN,(()=>{w||(be(Cr,`RPC '${e}' stream ${r} transport opened.`),A.i_())})),sg(f,gg.EventType.CLOSE,(()=>{w||(w=!0,be(Cr,`RPC '${e}' stream ${r} transport closed`),A.o_(),this.E_(f))})),sg(f,gg.EventType.ERROR,(F=>{w||(w=!0,jh(Cr,`RPC '${e}' stream ${r} transport errored. Name:`,F.name,"Message:",F.message),A.o_(new Ae(se.UNAVAILABLE,"The operation could not be completed")))})),sg(f,gg.EventType.MESSAGE,(F=>{var C;if(!w){const S=F.data[0];_t(!!S,16349);const P=S,O=(P==null?void 0:P.error)||((C=P[0])==null?void 0:C.error);if(O){be(Cr,`RPC '${e}' stream ${r} received error:`,O);const N=O.status;let V=(function(R){const D=In[R];if(D!==void 0)return P3(D)})(N),z=O.message;N==="NOT_FOUND"&&z.includes("database")&&z.includes("does not exist")&&z.includes(this.databaseId.database)&&jh(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),V===void 0&&(V=se.INTERNAL,z="Unknown error status: "+N+" with message "+O.message),w=!0,A.o_(new Ae(V,z)),f.close()}else be(Cr,`RPC '${e}' stream ${r} received:`,S),A.__(S)}})),ff.u_(),setTimeout((()=>{A.s_()}),0),A}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,n){super.Go(e,t,n),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return XD()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p9(s){return new ff(s)}function LE(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bx(s){return new y8(s,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ff.c_=!1;class q3{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Ci=e,this.timerId=t,this.R_=n,this.A_=r,this.V_=i,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&be("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xP="PersistentStream";class Q3{constructor(e,t,n,r,i,o,u,d){this.Ci=e,this.b_=n,this.S_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=d,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new q3(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===se.RESOURCE_EXHAUSTED?(Rl(t.toString()),Rl("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,r])=>{this.D_===t&&this.G_(n,r)}),(n=>{e((()=>{const r=new Ae(se.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(r)}))}))}G_(e,t){const n=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{n((()=>this.listener.Zo()))})),this.stream.Yo((()=>{n((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((r=>{n((()=>this.z_(r)))})),this.stream.onMessage((r=>{n((()=>++this.F_==1?this.H_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return be(xP,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(be(xP,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class f9 extends Q3{constructor(e,t,n,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=A8(this.serializer,e),n=(function(i){if(!("targetChange"in i))return We.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?We.min():o.readTime?io(o.readTime):We.min()})(e);return this.listener.J_(t,n)}Z_(e){const t={};t.database=vb(this.serializer),t.addTarget=(function(i,o){let u;const d=o.target;if(u=fb(d)?{documents:E8(i,d)}:{query:B3(i,d).ft},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=N3(i,o.resumeToken);const h=gb(i,o.expectedCount);h!==null&&(u.expectedCount=h)}else if(o.snapshotVersion.compareTo(We.min())>0){u.readTime=x_(i,o.snapshotVersion.toTimestamp());const h=gb(i,o.expectedCount);h!==null&&(u.expectedCount=h)}return u})(this.serializer,e);const n=F8(this.serializer,e);n&&(t.labels=n),this.K_(t)}X_(e){const t={};t.database=vb(this.serializer),t.removeTarget=e,this.K_(t)}}class m9 extends Q3{constructor(e,t,n,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return _t(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,_t(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){_t(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=x8(e.writeResults,e.commitTime),n=io(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=vb(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((n=>_8(this.serializer,n)))};this.K_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g9{}class y9 extends g9{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Ae(se.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,o])=>this.connection.Wo(e,yb(t,n),r,i,o))).catch((i=>{throw i.name==="FirebaseError"?(i.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ae(se.UNKNOWN,i.toString())}))}jo(e,t,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,u])=>this.connection.jo(e,yb(t,n),r,o,u,i))).catch((o=>{throw o.name==="FirebaseError"?(o.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ae(se.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function w9(s,e,t,n){return new y9(s,e,t,n)}class v9{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Rl(t),this.aa=!1):be("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $h="RemoteStore";class A9{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=i,this.Aa.Mo((o=>{n.enqueueAndForget((async()=>{ep(this)&&(be($h,"Restarting streams for network reachability change."),await(async function(d){const h=He(d);h.Ea.add(4),await w0(h),h.Va.set("Unknown"),h.Ea.delete(4),await Cx(h)})(this))}))})),this.Va=new v9(n,r)}}async function Cx(s){if(ep(s))for(const e of s.Ra)await e(!0)}async function w0(s){for(const e of s.Ra)await e(!1)}function K3(s,e){const t=He(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),WF(t)?HF(t):o2(t).O_()&&zF(t,e))}function $F(s,e){const t=He(s),n=o2(t);t.Ia.delete(e),n.O_()&&X3(t,e),t.Ia.size===0&&(n.O_()?n.L_():ep(t)&&t.Va.set("Unknown"))}function zF(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(We.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}o2(s).Z_(e)}function X3(s,e){s.da.$e(e),o2(s).X_(e)}function HF(s){s.da=new p8({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),o2(s).start(),s.Va.ua()}function WF(s){return ep(s)&&!o2(s).x_()&&s.Ia.size>0}function ep(s){return He(s).Ea.size===0}function Y3(s){s.da=void 0}async function _9(s){s.Va.set("Online")}async function x9(s){s.Ia.forEach(((e,t)=>{zF(s,e)}))}async function E9(s,e){Y3(s),WF(s)?(s.Va.ha(e),HF(s)):s.Va.set("Unknown")}async function b9(s,e,t){if(s.Va.set("Online"),e instanceof D3&&e.state===2&&e.cause)try{await(async function(r,i){const o=i.cause;for(const u of i.targetIds)r.Ia.has(u)&&(await r.remoteSyncer.rejectListen(u,o),r.Ia.delete(u),r.da.removeTarget(u))})(s,e)}catch(n){be($h,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await b_(s,n)}else if(e instanceof xA?s.da.Xe(e):e instanceof R3?s.da.st(e):s.da.tt(e),!t.isEqual(We.min()))try{const n=await G3(s.localStore);t.compareTo(n)>=0&&await(function(i,o){const u=i.da.Tt(o);return u.targetChanges.forEach(((d,h)=>{if(d.resumeToken.approximateByteSize()>0){const f=i.Ia.get(h);f&&i.Ia.set(h,f.withResumeToken(d.resumeToken,o))}})),u.targetMismatches.forEach(((d,h)=>{const f=i.Ia.get(d);if(!f)return;i.Ia.set(d,f.withResumeToken(wr.EMPTY_BYTE_STRING,f.snapshotVersion)),X3(i,d);const g=new yu(f.target,d,h,f.sequenceNumber);zF(i,g)})),i.remoteSyncer.applyRemoteEvent(u)})(s,t)}catch(n){be($h,"Failed to raise snapshot:",n),await b_(s,n)}}async function b_(s,e,t){if(!i2(e))throw e;s.Ea.add(1),await w0(s),s.Va.set("Offline"),t||(t=()=>G3(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{be($h,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await Cx(s)}))}function J3(s,e){return e().catch((t=>b_(s,t,e)))}async function Fx(s){const e=He(s),t=ku(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:SF;for(;C9(e);)try{const r=await i9(e.localStore,n);if(r===null){e.Ta.length===0&&t.L_();break}n=r.batchId,F9(e,r)}catch(r){await b_(e,r)}Z3(e)&&eN(e)}function C9(s){return ep(s)&&s.Ta.length<10}function F9(s,e){s.Ta.push(e);const t=ku(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function Z3(s){return ep(s)&&!ku(s).x_()&&s.Ta.length>0}function eN(s){ku(s).start()}async function S9(s){ku(s).ra()}async function T9(s){const e=ku(s);for(const t of s.Ta)e.ea(t.mutations)}async function k9(s,e,t){const n=s.Ta.shift(),r=MF.from(n,e,t);await J3(s,(()=>s.remoteSyncer.applySuccessfulWrite(r))),await Fx(s)}async function I9(s,e){e&&ku(s).Y_&&await(async function(n,r){if((function(o){return u8(o)&&o!==se.ABORTED})(r.code)){const i=n.Ta.shift();ku(n).B_(),await J3(n,(()=>n.remoteSyncer.rejectFailedWrite(i.batchId,r))),await Fx(n)}})(s,e),Z3(s)&&eN(s)}async function EP(s,e){const t=He(s);t.asyncQueue.verifyOperationInProgress(),be($h,"RemoteStore received new credentials");const n=ep(t);t.Ea.add(3),await w0(t),n&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Cx(t)}async function P9(s,e){const t=He(s);e?(t.Ea.delete(2),await Cx(t)):e||(t.Ea.add(2),await w0(t),t.Va.set("Unknown"))}function o2(s){return s.ma||(s.ma=(function(t,n,r){const i=He(t);return i.sa(),new f9(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)})(s.datastore,s.asyncQueue,{Zo:_9.bind(null,s),Yo:x9.bind(null,s),t_:E9.bind(null,s),J_:b9.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),WF(s)?HF(s):s.Va.set("Unknown")):(await s.ma.stop(),Y3(s))}))),s.ma}function ku(s){return s.fa||(s.fa=(function(t,n,r){const i=He(t);return i.sa(),new m9(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:S9.bind(null,s),t_:I9.bind(null,s),ta:T9.bind(null,s),na:k9.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await Fx(s)):(await s.fa.stop(),s.Ta.length>0&&(be($h,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GF{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new ro,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const o=Date.now()+n,u=new GF(e,t,o,r,i);return u.start(n),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ae(se.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function qF(s,e){if(Rl("AsyncQueue",`${e}: ${s}`),i2(s))return new Ae(se.UNAVAILABLE,`${e}: ${s}`);throw s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{static emptySet(e){return new mf(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Le.comparator(t.key,n.key):(t,n)=>Le.comparator(t.key,n.key),this.keyedMap=yg(),this.sortedSet=new on(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof mf)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=n.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new mf;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{constructor(){this.ga=new on(Le.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):$e(63341,{Vt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Xm{constructor(e,t,n,r,i,o,u,d,h){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=d,this.hasCachedResults=h}static fromInitialDocuments(e,t,n,r,i){const o=[];return t.forEach((u=>{o.push({type:0,doc:u})})),new Xm(e,t,mf.emptySet(t),o,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&vx(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R9{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class D9{constructor(){this.queries=CP(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const r=He(t),i=r.queries;r.queries=CP(),i.forEach(((o,u)=>{for(const d of u.ba)d.onError(n)}))})(this,new Ae(se.ABORTED,"Firestore shutting down"))}}function CP(){return new Zh((s=>v3(s)),vx)}async function tN(s,e){const t=He(s);let n=3;const r=e.query;let i=t.queries.get(r);i?!i.Sa()&&e.Da()&&(n=2):(i=new R9,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await t.onListen(r,!0);break;case 1:i.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const u=qF(o,`Initialization of query '${qp(e.query)}' failed`);return void e.onError(u)}t.queries.set(r,i),i.ba.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&QF(t)}async function nN(s,e){const t=He(s),n=e.query;let r=3;const i=t.queries.get(n);if(i){const o=i.ba.indexOf(e);o>=0&&(i.ba.splice(o,1),i.ba.length===0?r=e.Da()?0:1:!i.Sa()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function N9(s,e){const t=He(s);let n=!1;for(const r of e){const i=r.query,o=t.queries.get(i);if(o){for(const u of o.ba)u.Fa(r)&&(n=!0);o.wa=r}}n&&QF(t)}function M9(s,e,t){const n=He(s),r=n.queries.get(e);if(r)for(const i of r.ba)i.onError(t);n.queries.delete(e)}function QF(s){s.Ca.forEach((e=>{e.next()}))}var xb,FP;(FP=xb||(xb={})).Ma="default",FP.Cache="cache";class rN{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const r of e.docChanges)r.type!==3&&n.push(r);e=new Xm(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.Ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Xm.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==xb.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sN{constructor(e){this.key=e}}class iN{constructor(e){this.key=e}}class L9{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=at(),this.mutatedKeys=at(),this.eu=A3(e),this.tu=new mf(this.eu)}get nu(){return this.Za}ru(e,t){const n=t?t.iu:new bP,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,u=!1;const d=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((f,g)=>{const w=r.get(f),A=Ax(this.query,g)?g:null,F=!!w&&this.mutatedKeys.has(w.key),C=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let S=!1;w&&A?w.data.isEqual(A.data)?F!==C&&(n.track({type:3,doc:A}),S=!0):this.su(w,A)||(n.track({type:2,doc:A}),S=!0,(d&&this.eu(A,d)>0||h&&this.eu(A,h)<0)&&(u=!0)):!w&&A?(n.track({type:0,doc:A}),S=!0):w&&!A&&(n.track({type:1,doc:w}),S=!0,(d||h)&&(u=!0)),S&&(A?(o=o.add(A),i=C?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),n.track({type:1,doc:f})}return{tu:o,iu:n,Ss:u,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((f,g)=>(function(A,F){const C=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $e(20277,{Vt:S})}};return C(A)-C(F)})(f.type,g.type)||this.eu(f.doc,g.doc))),this.ou(n),r=r??!1;const u=t&&!r?this._u():[],d=this.Ya.size===0&&this.current&&!r?1:0,h=d!==this.Xa;return this.Xa=d,o.length!==0||h?{snapshot:new Xm(this.query,e.tu,i,o,e.mutatedKeys,d===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new bP,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=at(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Ya=this.Ya.add(n.key))}));const t=[];return e.forEach((n=>{this.Ya.has(n)||t.push(new iN(n))})),this.Ya.forEach((n=>{e.has(n)||t.push(new sN(n))})),t}cu(e){this.Za=e.ks,this.Ya=at();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Xm.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const KF="SyncEngine";class O9{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class B9{constructor(e){this.key=e,this.hu=!1}}class V9{constructor(e,t,n,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Zh((u=>v3(u)),vx),this.Iu=new Map,this.Eu=new Set,this.Ru=new on(Le.comparator),this.Au=new Map,this.Vu=new BF,this.du={},this.mu=new Map,this.fu=Km.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function U9(s,e,t=!0){const n=dN(s);let r;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await aN(n,e,t,!0),r}async function j9(s,e){const t=dN(s);await aN(t,e,!0,!1)}async function aN(s,e,t,n){const r=await a9(s.localStore,so(e)),i=r.targetId,o=s.sharedClientState.addLocalQueryTarget(i,t);let u;return n&&(u=await $9(s,e,i,o==="current",r.resumeToken)),s.isPrimaryClient&&t&&K3(s.remoteStore,r),u}async function $9(s,e,t,n,r){s.pu=(g,w,A)=>(async function(C,S,P,O){let N=S.view.ru(P);N.Ss&&(N=await wP(C.localStore,S.query,!1).then((({documents:R})=>S.view.ru(R,N))));const V=O&&O.targetChanges.get(S.targetId),z=O&&O.targetMismatches.get(S.targetId)!=null,H=S.view.applyChanges(N,C.isPrimaryClient,V,z);return TP(C,S.targetId,H.au),H.snapshot})(s,g,w,A);const i=await wP(s.localStore,e,!0),o=new L9(e,i.ks),u=o.ru(i.documents),d=y0.createSynthesizedTargetChangeForCurrentChange(t,n&&s.onlineState!=="Offline",r),h=o.applyChanges(u,s.isPrimaryClient,d);TP(s,t,h.au);const f=new O9(e,t,o);return s.Tu.set(e,f),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),h.snapshot}async function z9(s,e,t){const n=He(s),r=n.Tu.get(e),i=n.Iu.get(r.targetId);if(i.length>1)return n.Iu.set(r.targetId,i.filter((o=>!vx(o,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Ab(n.localStore,r.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(r.targetId),t&&$F(n.remoteStore,r.targetId),Eb(n,r.targetId)})).catch(s2)):(Eb(n,r.targetId),await Ab(n.localStore,r.targetId,!0))}async function H9(s,e){const t=He(s),n=t.Tu.get(e),r=t.Iu.get(n.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),$F(t.remoteStore,n.targetId))}async function W9(s,e,t){const n=J9(s);try{const r=await(function(o,u){const d=He(o),h=Wt.now(),f=u.reduce(((A,F)=>A.add(F.key)),at());let g,w;return d.persistence.runTransaction("Locally write mutations","readwrite",(A=>{let F=Dl(),C=at();return d.xs.getEntries(A,f).next((S=>{F=S,F.forEach(((P,O)=>{O.isValidDocument()||(C=C.add(P))}))})).next((()=>d.localDocuments.getOverlayedDocuments(A,F))).next((S=>{g=S;const P=[];for(const O of u){const N=s8(O,g.get(O.key).overlayedDocument);N!=null&&P.push(new Uu(O.key,N,u3(N.value.mapValue),Zi.exists(!0)))}return d.mutationQueue.addMutationBatch(A,h,P,u)})).next((S=>{w=S;const P=S.applyToLocalDocumentSet(g,C);return d.documentOverlayCache.saveOverlays(A,S.batchId,P)}))})).then((()=>({batchId:w.batchId,changes:x3(g)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(r.batchId),(function(o,u,d){let h=o.du[o.currentUser.toKey()];h||(h=new on(it)),h=h.insert(u,d),o.du[o.currentUser.toKey()]=h})(n,r.batchId,t),await v0(n,r.changes),await Fx(n.remoteStore)}catch(r){const i=qF(r,"Failed to persist write");t.reject(i)}}async function oN(s,e){const t=He(s);try{const n=await r9(t.localStore,e);e.targetChanges.forEach(((r,i)=>{const o=t.Au.get(i);o&&(_t(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?_t(o.hu,14607):r.removedDocuments.size>0&&(_t(o.hu,42227),o.hu=!1))})),await v0(t,n,e)}catch(n){await s2(n)}}function SP(s,e,t){const n=He(s);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const r=[];n.Tu.forEach(((i,o)=>{const u=o.view.va(e);u.snapshot&&r.push(u.snapshot)})),(function(o,u){const d=He(o);d.onlineState=u;let h=!1;d.queries.forEach(((f,g)=>{for(const w of g.ba)w.va(u)&&(h=!0)})),h&&QF(d)})(n.eventManager,e),r.length&&n.Pu.J_(r),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function G9(s,e,t){const n=He(s);n.sharedClientState.updateQueryState(e,"rejected",t);const r=n.Au.get(e),i=r&&r.key;if(i){let o=new on(Le.comparator);o=o.insert(i,Nr.newNoDocument(i,We.min()));const u=at().add(i),d=new Ex(We.min(),new Map,new on(it),o,u);await oN(n,d),n.Ru=n.Ru.remove(i),n.Au.delete(e),XF(n)}else await Ab(n.localStore,e,!1).then((()=>Eb(n,e,t))).catch(s2)}async function q9(s,e){const t=He(s),n=e.batch.batchId;try{const r=await n9(t.localStore,e);cN(t,n,null),lN(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await v0(t,r)}catch(r){await s2(r)}}async function Q9(s,e,t){const n=He(s);try{const r=await(function(o,u){const d=He(o);return d.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let f;return d.mutationQueue.lookupMutationBatch(h,u).next((g=>(_t(g!==null,37113),f=g.keys(),d.mutationQueue.removeMutationBatch(h,g)))).next((()=>d.mutationQueue.performConsistencyCheck(h))).next((()=>d.documentOverlayCache.removeOverlaysForBatchId(h,f,u))).next((()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f))).next((()=>d.localDocuments.getDocuments(h,f)))}))})(n.localStore,e);cN(n,e,t),lN(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await v0(n,r)}catch(r){await s2(r)}}function lN(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function cN(s,e,t){const n=He(s);let r=n.du[n.currentUser.toKey()];if(r){const i=r.get(e);i&&(t?i.reject(t):i.resolve(),r=r.remove(e)),n.du[n.currentUser.toKey()]=r}}function Eb(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const n of s.Iu.get(e))s.Tu.delete(n),t&&s.Pu.yu(n,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((n=>{s.Vu.containsKey(n)||uN(s,n)}))}function uN(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&($F(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),XF(s))}function TP(s,e,t){for(const n of t)n instanceof sN?(s.Vu.addReference(n.key,e),K9(s,n)):n instanceof iN?(be(KF,"Document no longer in limbo: "+n.key),s.Vu.removeReference(n.key,e),s.Vu.containsKey(n.key)||uN(s,n.key)):$e(19791,{wu:n})}function K9(s,e){const t=e.key,n=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(n)||(be(KF,"New document in limbo: "+t),s.Eu.add(n),XF(s))}function XF(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new Le(Vt.fromString(e)),n=s.fu.next();s.Au.set(n,new B9(t)),s.Ru=s.Ru.insert(t,n),K3(s.remoteStore,new yu(so(RF(t.path)),n,"TargetPurposeLimboResolution",gx.ce))}}async function v0(s,e,t){const n=He(s),r=[],i=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach(((u,d)=>{o.push(n.pu(d,e,t).then((h=>{var f;if((h||t)&&n.isPrimaryClient){const g=h?!h.fromCache:(f=t==null?void 0:t.targetChanges.get(d.targetId))==null?void 0:f.current;n.sharedClientState.updateQueryState(d.targetId,g?"current":"not-current")}if(h){r.push(h);const g=UF.Es(d.targetId,h);i.push(g)}})))})),await Promise.all(o),n.Pu.J_(r),await(async function(d,h){const f=He(d);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>ae.forEach(h,(w=>ae.forEach(w.Ts,(A=>f.persistence.referenceDelegate.addReference(g,w.targetId,A))).next((()=>ae.forEach(w.Is,(A=>f.persistence.referenceDelegate.removeReference(g,w.targetId,A)))))))))}catch(g){if(!i2(g))throw g;be(jF,"Failed to update sequence numbers: "+g)}for(const g of h){const w=g.targetId;if(!g.fromCache){const A=f.vs.get(w),F=A.snapshotVersion,C=A.withLastLimboFreeSnapshotVersion(F);f.vs=f.vs.insert(w,C)}}})(n.localStore,i))}async function X9(s,e){const t=He(s);if(!t.currentUser.isEqual(e)){be(KF,"User change. New user:",e.toKey());const n=await W3(t.localStore,e);t.currentUser=e,(function(i,o){i.mu.forEach((u=>{u.forEach((d=>{d.reject(new Ae(se.CANCELLED,o))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await v0(t,n.Ns)}}function Y9(s,e){const t=He(s),n=t.Au.get(e);if(n&&n.hu)return at().add(n.key);{let r=at();const i=t.Iu.get(e);if(!i)return r;for(const o of i){const u=t.Tu.get(o);r=r.unionWith(u.view.nu)}return r}}function dN(s){const e=He(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=oN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Y9.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=G9.bind(null,e),e.Pu.J_=N9.bind(null,e.eventManager),e.Pu.yu=M9.bind(null,e.eventManager),e}function J9(s){const e=He(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=q9.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Q9.bind(null,e),e}class C_{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=bx(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return t9(this.persistence,new J8,e.initialUser,this.serializer)}Cu(e){return new H3(VF.Vi,this.serializer)}Du(e){return new l9}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}C_.provider={build:()=>new C_};class Z9 extends C_{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){_t(this.persistence.referenceDelegate instanceof E_,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new O8(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?ds.withCacheSize(this.cacheSizeBytes):ds.DEFAULT;return new H3((n=>E_.Vi(n,t)),this.serializer)}}class bb{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>SP(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=X9.bind(null,this.syncEngine),await P9(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new D9})()}createDatastore(e){const t=bx(e.databaseInfo.databaseId),n=p9(e.databaseInfo);return w9(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return(function(n,r,i,o,u){return new A9(n,r,i,o,u)})(this.localStore,this.datastore,e.asyncQueue,(t=>SP(this.syncEngine,t,0)),(function(){return _P.v()?new _P:new c9})())}createSyncEngine(e,t){return(function(r,i,o,u,d,h,f){const g=new V9(r,i,o,u,d,h);return f&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(r){const i=He(r);be($h,"RemoteStore shutting down."),i.Ea.add(5),await w0(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}bb.provider={build:()=>new bb};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hN{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Rl("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iu="FirestoreClient";class e${constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this._databaseInfo=r,this.user=Dr.UNAUTHENTICATED,this.clientId=FF.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async o=>{be(Iu,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(n,(o=>(be(Iu,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ro;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=qF(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function OE(s,e){s.asyncQueue.verifyOperationInProgress(),be(Iu,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let n=t.initialUser;s.setCredentialChangeListener((async r=>{n.isEqual(r)||(await W3(e.localStore,r),n=r)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function kP(s,e){s.asyncQueue.verifyOperationInProgress();const t=await t$(s);be(Iu,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((n=>EP(e.remoteStore,n))),s.setAppCheckTokenChangeListener(((n,r)=>EP(e.remoteStore,r))),s._onlineComponents=e}async function t$(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){be(Iu,"Using user provided OfflineComponentProvider");try{await OE(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===se.FAILED_PRECONDITION||r.code===se.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;jh("Error using user provided cache. Falling back to memory cache: "+t),await OE(s,new C_)}}else be(Iu,"Using default OfflineComponentProvider"),await OE(s,new Z9(void 0));return s._offlineComponents}async function YF(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(be(Iu,"Using user provided OnlineComponentProvider"),await kP(s,s._uninitializedComponentsProvider._online)):(be(Iu,"Using default OnlineComponentProvider"),await kP(s,new bb))),s._onlineComponents}function n$(s){return YF(s).then((e=>e.syncEngine))}function r$(s){return YF(s).then((e=>e.datastore))}async function pN(s){const e=await YF(s),t=e.eventManager;return t.onListen=U9.bind(null,e.syncEngine),t.onUnlisten=z9.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=j9.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=H9.bind(null,e.syncEngine),t}function s$(s,e,t={}){const n=new ro;return s.asyncQueue.enqueueAndForget((async()=>(function(i,o,u,d,h){const f=new hN({next:w=>{f.Nu(),o.enqueueAndForget((()=>nN(i,g)));const A=w.docs.has(u);!A&&w.fromCache?h.reject(new Ae(se.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&w.fromCache&&d&&d.source==="server"?h.reject(new Ae(se.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(w)},error:w=>h.reject(w)}),g=new rN(RF(u.path),f,{includeMetadataChanges:!0,Ka:!0});return tN(i,g)})(await pN(s),s.asyncQueue,e,t,n))),n.promise}function i$(s,e,t={}){const n=new ro;return s.asyncQueue.enqueueAndForget((async()=>(function(i,o,u,d,h){const f=new hN({next:w=>{f.Nu(),o.enqueueAndForget((()=>nN(i,g))),w.fromCache&&d.source==="server"?h.reject(new Ae(se.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(w)},error:w=>h.reject(w)}),g=new rN(u,f,{includeMetadataChanges:!0,Ka:!0});return tN(i,g)})(await pN(s),s.asyncQueue,e,t,n))),n.promise}function a$(s,e,t){const n=new ro;return s.asyncQueue.enqueueAndForget((async()=>{try{const r=await r$(s);n.resolve((async function(o,u,d){var C;const h=He(o),{request:f,gt:g,parent:w}=b8(h.serializer,$j(u),d);h.connection.Ko||delete f.parent;const A=(await h.jo("RunAggregationQuery",h.serializer.databaseId,w,f,1)).filter((S=>!!S.result));_t(A.length===1,64727);const F=(C=A[0].result)==null?void 0:C.aggregateFields;return Object.keys(F).reduce(((S,P)=>(S[g[P]]=F[P],S)),{})})(r,e,t))}catch(r){n.reject(r)}})),n.promise}function o$(s,e){const t=new ro;return s.asyncQueue.enqueueAndForget((async()=>W9(await n$(s),e,t))),t.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fN(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l$="ComponentProvider",IP=new Map;function c$(s,e,t,n,r){return new Cj(s,e,t,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,fN(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mN="firestore.googleapis.com",PP=!0;class RP{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ae(se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=mN,this.ssl=PP}else this.host=e.host,this.ssl=e.ssl??PP;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=z3;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<M8)throw new Ae(se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}hj("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=fN(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Ae(se.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Ae(se.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Ae(se.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,r){return n.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Sx{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new RP({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ae(se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ae(se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new RP(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new nj;switch(n.type){case"firstParty":return new aj(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ae(se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const n=IP.get(t);n&&(be(l$,"Removing Datastore"),IP.delete(t),n.terminate())})(this),Promise.resolve()}}function u$(s,e,t,n={}){var h;s=oo(s,Sx);const r=Ou(e),i=s._getSettings(),o={...i,emulatorOptions:s._getEmulatorOptions()},u=`${e}:${t}`;r&&(hF(`https://${u}`),pF("Firestore",!0)),i.host!==mN&&i.host!==u&&jh("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d={...i,host:u,ssl:r,emulatorOptions:n};if(!Oh(d,o)&&(s._setSettings(d),n.mockUserToken)){let f,g;if(typeof n.mockUserToken=="string")f=n.mockUserToken,g=Dr.MOCK_USER;else{f=aD(n.mockUserToken,(h=s._app)==null?void 0:h.options.projectId);const w=n.mockUserToken.sub||n.mockUserToken.user_id;if(!w)throw new Ae(se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new Dr(w)}s._authCredentials=new rj(new JD(f,g))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ju(this.firestore,e,this._query)}}class Nn{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Nn(this.firestore,e,this._key)}toJSON(){return{type:Nn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(m0(t,Nn._jsonSchema))return new Nn(e,n||null,new Le(Vt.fromString(t.referencePath)))}}Nn._jsonSchemaVersion="firestore/documentReference/1.0",Nn._jsonSchema={type:Dn("string",Nn._jsonSchemaVersion),referencePath:Dn("string")};class xu extends ju{constructor(e,t,n){super(e,t,RF(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Nn(this.firestore,null,new Le(e))}withConverter(e){return new xu(this.firestore,e,this._path)}}function hs(s,e,...t){if(s=mn(s),ZD("collection","path",e),s instanceof Sx){const n=Vt.fromString(e,...t);return WI(n),new xu(s,null,n)}{if(!(s instanceof Nn||s instanceof xu))throw new Ae(se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=s._path.child(Vt.fromString(e,...t));return WI(n),new xu(s.firestore,null,n)}}function ia(s,e,...t){if(s=mn(s),arguments.length===1&&(e=FF.newId()),ZD("doc","path",e),s instanceof Sx){const n=Vt.fromString(e,...t);return HI(n),new Nn(s,null,new Le(n))}{if(!(s instanceof Nn||s instanceof xu))throw new Ae(se.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=s._path.child(Vt.fromString(e,...t));return HI(n),new Nn(s.firestore,s instanceof xu?s.converter:null,new Le(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DP="AsyncQueue";class NP{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new q3(this,"async_queue_retry"),this._c=()=>{const n=LE();n&&be(DP,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=LE();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=LE();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ro;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!i2(e))throw e;be(DP,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,Rl("INTERNAL UNHANDLED ERROR: ",MP(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=GF.createAndSchedule(this,e,t,n,(i=>this.hc(i)));return this.tc.push(r),r}uc(){this.nc&&$e(47125,{Pc:MP(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,n)=>t.targetTimeMs-n.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function MP(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class tp extends Sx{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new NP,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new NP(e),this._firestoreClient=void 0,await e}}}function d$(s,e){const t=typeof s=="object"?s:gF(),n=typeof s=="string"?s:y_,r=ux(t,"firestore").getImmediate({identifier:n});if(!r._initialized){const i=rD("firestore");i&&u$(r,...i)}return r}function Tx(s){if(s._terminated)throw new Ae(se.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||h$(s),s._firestoreClient}function h$(s){var n,r,i,o;const e=s._freezeSettings(),t=c$(s._databaseId,((n=s._app)==null?void 0:n.options.appId)||"",s._persistenceKey,(r=s._app)==null?void 0:r.options.apiKey,e);s._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new e$(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(d){const h=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(h),_online:h}})(s._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new xi(wr.fromBase64String(e))}catch(t){throw new Ae(se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new xi(wr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:xi._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(m0(e,xi._jsonSchema))return xi.fromBase64String(e.bytes)}}xi._jsonSchemaVersion="firestore/bytes/1.0",xi._jsonSchema={type:Dn("string",xi._jsonSchemaVersion),bytes:Dn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JF{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ae(se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kx{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ae(se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ae(se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return it(this._lat,e._lat)||it(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ao._jsonSchemaVersion}}static fromJSON(e){if(m0(e,ao._jsonSchema))return new ao(e.latitude,e.longitude)}}ao._jsonSchemaVersion="firestore/geoPoint/1.0",ao._jsonSchema={type:Dn("string",ao._jsonSchemaVersion),latitude:Dn("number"),longitude:Dn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,r){if(n.length!==r.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==r[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ea._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(m0(e,ea._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ea(e.vectorValues);throw new Ae(se.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ea._jsonSchemaVersion="firestore/vectorValue/1.0",ea._jsonSchema={type:Dn("string",ea._jsonSchemaVersion),vectorValues:Dn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p$=/^__.*__$/;class f${constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Uu(e,this.data,this.fieldMask,t,this.fieldTransforms):new g0(e,this.data,t,this.fieldTransforms)}}class gN{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Uu(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function yN(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $e(40011,{dataSource:s})}}class ZF{constructor(e,t,n,r,i,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,i===void 0&&this.validatePath(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new ZF({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var r;const t=(r=this.path)==null?void 0:r.child(e),n=this.contextWith({path:t,arrayElement:!1});return n.validatePathSegment(e),n}childContextForFieldPath(e){var r;const t=(r=this.path)==null?void 0:r.child(e),n=this.contextWith({path:t,arrayElement:!1});return n.validatePath(),n}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return F_(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(yN(this.dataSource)&&p$.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class m${constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||bx(e)}createContext(e,t,n,r=!1){return new ZF({dataSource:e,methodName:t,targetDoc:n,path:gr.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function eS(s){const e=s._freezeSettings(),t=bx(s._databaseId);return new m$(s._databaseId,!!e.ignoreUndefinedProperties,t)}function g$(s,e,t,n,r,i={}){const o=s.createContext(i.merge||i.mergeFields?2:0,e,t,r);nS("Data must be an object, but it was:",o,n);const u=wN(n,o);let d,h;if(i.merge)d=new Gs(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const g of i.mergeFields){const w=zh(e,g,t);if(!o.contains(w))throw new Ae(se.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);_N(f,w)||f.push(w)}d=new Gs(f),h=o.fieldTransforms.filter((g=>d.covers(g.field)))}else d=null,h=o.fieldTransforms;return new f$(new Wr(u),d,h)}class Ix extends kx{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ix}}class tS extends kx{_toFieldTransform(e){return new e8(e.path,new ry)}isEqual(e){return e instanceof tS}}function y$(s,e,t,n){const r=s.createContext(1,e,t);nS("Data must be an object, but it was:",r,n);const i=[],o=Wr.empty();Vu(n,((d,h)=>{const f=AN(e,d,t);h=mn(h);const g=r.childContextForFieldPath(f);if(h instanceof Ix)i.push(f);else{const w=A0(h,g);w!=null&&(i.push(f),o.set(f,w))}}));const u=new Gs(i);return new gN(o,u,r.fieldTransforms)}function w$(s,e,t,n,r,i){const o=s.createContext(1,e,t),u=[zh(e,n,t)],d=[r];if(i.length%2!=0)throw new Ae(se.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let w=0;w<i.length;w+=2)u.push(zh(e,i[w])),d.push(i[w+1]);const h=[],f=Wr.empty();for(let w=u.length-1;w>=0;--w)if(!_N(h,u[w])){const A=u[w];let F=d[w];F=mn(F);const C=o.childContextForFieldPath(A);if(F instanceof Ix)h.push(A);else{const S=A0(F,C);S!=null&&(h.push(A),f.set(A,S))}}const g=new Gs(h);return new gN(f,g,o.fieldTransforms)}function v$(s,e,t,n=!1){return A0(t,s.createContext(n?4:3,e))}function A0(s,e){if(vN(s=mn(s)))return nS("Unsupported field value:",e,s),wN(s,e);if(s instanceof kx)return(function(n,r){if(!yN(r.dataSource))throw r.createError(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.createError(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(r);i&&r.fieldTransforms.push(i)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(n,r){const i=[];let o=0;for(const u of n){let d=A0(u,r.childContextForArray(o));d==null&&(d={nullValue:"NULL_VALUE"}),i.push(d),o++}return{arrayValue:{values:i}}})(s,e)}return(function(n,r){if((n=mn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Yj(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=Wt.fromDate(n);return{timestampValue:x_(r.serializer,i)}}if(n instanceof Wt){const i=new Wt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:x_(r.serializer,i)}}if(n instanceof ao)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof xi)return{bytesValue:N3(r.serializer,n._byteString)};if(n instanceof Nn){const i=r.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw r.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:OF(n.firestore._databaseId||r.databaseId,n._key.path)}}if(n instanceof ea)return(function(o,u){const d=o instanceof ea?o.toArray():o;return{mapValue:{fields:{[l3]:{stringValue:c3},[w_]:{arrayValue:{values:d.map((f=>{if(typeof f!="number")throw u.createError("VectorValues must only contain numeric values.");return DF(u.serializer,f)}))}}}}}})(n,r);if($3(n))return n._toProto(r.serializer);throw r.createError(`Unsupported field value: ${mx(n)}`)})(s,e)}function wN(s,e){const t={};return n3(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Vu(s,((n,r)=>{const i=A0(r,e.childContextForField(n));i!=null&&(t[n]=i)})),{mapValue:{fields:t}}}function vN(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Wt||s instanceof ao||s instanceof xi||s instanceof Nn||s instanceof kx||s instanceof ea||$3(s))}function nS(s,e,t){if(!vN(t)||!e3(t)){const n=mx(t);throw n==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+n)}}function zh(s,e,t){if((e=mn(e))instanceof JF)return e._internalPath;if(typeof e=="string")return AN(s,e);throw F_("Field path arguments must be of type string or ",s,!1,void 0,t)}const A$=new RegExp("[~\\*/\\[\\]]");function AN(s,e,t){if(e.search(A$)>=0)throw F_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new JF(...e.split("."))._internalPath}catch{throw F_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function F_(s,e,t,n,r){const i=n&&!n.isEmpty(),o=r!==void 0;let u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let d="";return(i||o)&&(d+=" (found",i&&(d+=` in field ${n}`),o&&(d+=` in document ${r}`),d+=")"),new Ae(se.INVALID_ARGUMENT,u+s+d)}function _N(s,e){return s.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _${convertValue(e,t="none"){switch(Tu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return bn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Su(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw $e(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Vu(e,((r,i)=>{n[r]=this.convertValue(i,t)})),n}convertVectorValue(e){var n,r,i;const t=(i=(r=(n=e.fields)==null?void 0:n[w_].arrayValue)==null?void 0:r.values)==null?void 0:i.map((o=>bn(o.doubleValue)));return new ea(t)}convertGeoPoint(e){return new ao(bn(e.latitude),bn(e.longitude))}convertArray(e,t){return(e.values||[]).map((n=>this.convertValue(n,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=wx(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Zg(e));default:return null}}convertTimestamp(e){const t=Fu(e);return new Wt(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Vt.fromString(e);_t(j3(n),9688,{name:e});const r=new ey(n.get(1),n.get(3)),i=new Le(n.popFirst(5));return r.isEqual(t)||Rl(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS extends _${constructor(e){super(),this.firestore=e}convertBytes(e){return new xi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Nn(this.firestore,null,t)}}function _0(){return new tS("serverTimestamp")}const LP="@firebase/firestore",OP="4.11.0";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x${constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class E${constructor(e,t,n){this._userDataWriter=t,this._data=n,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}_fieldsProto(){return new Wr({mapValue:{fields:this._data}}).clone().value.mapValue.fields}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Nn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new b$(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const t=this._document.data.field(zh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class b$ extends xN{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C$(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new Ae(se.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class sS{}class iS extends sS{}function ta(s,e,...t){let n=[];e instanceof sS&&n.push(e),n=n.concat(t),(function(i){const o=i.filter((d=>d instanceof aS)).length,u=i.filter((d=>d instanceof Px)).length;if(o>1||o>0&&u>0)throw new Ae(se.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const r of n)s=r._apply(s);return s}class Px extends iS{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Px(e,t,n)}_apply(e){const t=this._parse(e);return bN(e._query,t),new ju(e.firestore,e.converter,mb(e._query,t))}_parse(e){const t=eS(e.firestore);return(function(i,o,u,d,h,f,g){let w;if(h.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new Ae(se.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){VP(g,f);const F=[];for(const C of g)F.push(BP(d,i,C));w={arrayValue:{values:F}}}else w=BP(d,i,g)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||VP(g,f),w=v$(u,o,g,f==="in"||f==="not-in");return Rn.create(h,f,w)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Eu(s,e,t){const n=e,r=zh("where",s);return Px._create(r,n,t)}class aS extends sS{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new aS(e,t)}_parse(e){const t=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return t.length===1?t[0]:ra.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(r,i){let o=r;const u=i.getFlattenedFilters();for(const d of u)bN(o,d),o=mb(o,d)})(e._query,t),new ju(e.firestore,e.converter,mb(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class oS extends iS{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new oS(e,t)}_apply(e){const t=(function(r,i,o){if(r.startAt!==null)throw new Ae(se.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new Ae(se.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ny(i,o)})(e._query,this._field,this._direction);return new ju(e.firestore,e.converter,zj(e._query,t))}}function Pu(s,e="asc"){const t=e,n=zh("orderBy",s);return oS._create(n,t)}class lS extends iS{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new lS(e,t,n)}_apply(e){return new ju(e.firestore,e.converter,A_(e._query,this._limit,this._limitType))}}function EN(s){return pj("limit",s),lS._create("limit",s,"F")}function BP(s,e,t){if(typeof(t=mn(t))=="string"){if(t==="")throw new Ae(se.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!y3(e)&&t.indexOf("/")!==-1)throw new Ae(se.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Vt.fromString(t));if(!Le.isDocumentKey(n))throw new Ae(se.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return ZI(s,new Le(n))}if(t instanceof Nn)return ZI(s,t._key);throw new Ae(se.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${mx(t)}.`)}function VP(s,e){if(!Array.isArray(s)||s.length===0)throw new Ae(se.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function bN(s,e){const t=(function(r,i){for(const o of r)for(const u of o.getFlattenedFilters())if(i.indexOf(u.op)>=0)return u.op;return null})(s.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ae(se.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ae(se.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function F$(s,e,t){let n;return n=s?s.toFirestore(e):e,n}function S$(){return new x$("count")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BE(s){return T$(s,{count:S$()})}function T$(s,e){const t=oo(s.firestore,tp),n=Tx(t),r=Ej(e,((i,o)=>new l8(o,i.aggregateType,i._internalFieldPath)));return a$(n,s._query,r).then((i=>(function(u,d,h){const f=new rS(u);return new E$(d,f,h)})(t,s,i)))}class vg{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Mh extends xN{constructor(e,t,n,r,i,o){super(e,t,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new EA(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(zh("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ae(se.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Mh._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Mh._jsonSchemaVersion="firestore/documentSnapshot/1.0",Mh._jsonSchema={type:Dn("string",Mh._jsonSchemaVersion),bundleSource:Dn("string","DocumentSnapshot"),bundleName:Dn("string"),bundle:Dn("string")};class EA extends Mh{data(e={}){return super.data(e)}}class gf{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new vg(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new EA(this._firestore,this._userDataWriter,n.key,n,new vg(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ae(se.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((u=>{const d=new EA(r._firestore,r._userDataWriter,u.doc.key,u.doc,new vg(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter);return u.doc,{type:"added",doc:d,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((u=>i||u.type!==3)).map((u=>{const d=new EA(r._firestore,r._userDataWriter,u.doc.key,u.doc,new vg(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,f=-1;return u.type!==0&&(h=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),f=o.indexOf(u.doc.key)),{type:k$(u.type),doc:d,oldIndex:h,newIndex:f}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ae(se.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=gf._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=FF.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function k$(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $e(61501,{type:s})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */gf._jsonSchemaVersion="firestore/querySnapshot/1.0",gf._jsonSchema={type:Dn("string",gf._jsonSchemaVersion),bundleSource:Dn("string","QuerySnapshot"),bundleName:Dn("string"),bundle:Dn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I$(s){s=oo(s,Nn);const e=oo(s.firestore,tp),t=Tx(e);return s$(t,s._key).then((n=>P$(e,s,n)))}function np(s){s=oo(s,ju);const e=oo(s.firestore,tp),t=Tx(e),n=new rS(e);return C$(s._query),i$(t,s._query).then((r=>new gf(e,n,s,r)))}function Rx(s,e,t,...n){s=oo(s,Nn);const r=oo(s.firestore,tp),i=eS(r);let o;return o=typeof(e=mn(e))=="string"||e instanceof JF?w$(i,"updateDoc",s._key,e,t,n):y$(i,"updateDoc",s._key,e),cS(r,[o.toMutation(s._key,Zi.exists(!0))])}function x0(s){return cS(oo(s.firestore,tp),[new NF(s._key,Zi.none())])}function E0(s,e){const t=oo(s.firestore,tp),n=ia(s),r=F$(s.converter,e),i=eS(s.firestore);return cS(t,[g$(i,"addDoc",n._key,r,s.converter!==null,{}).toMutation(n._key,Zi.exists(!1))]).then((()=>n))}function cS(s,e){const t=Tx(s);return o$(t,e)}function P$(s,e,t){const n=t.docs.get(e._key),r=new rS(s);return new Mh(s,r,e._key,n,new vg(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){tj(Yh),Bh(new bu("firestore",((n,{instanceIdentifier:r,options:i})=>{const o=n.getProvider("app").getImmediate(),u=new tp(new sj(n.getProvider("auth-internal")),new oj(o,n.getProvider("app-check-internal")),Fj(o,r),o);return i={useFetchStreams:t,...i},u._setSettings(i),u}),"PUBLIC").setMultipleInstances(!0)),eo(LP,OP,e),eo(LP,OP,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CN="firebasestorage.googleapis.com",FN="storageBucket",R$=120*1e3,D$=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn extends go{constructor(e,t,n=0){super(VE(e),`Firebase Storage: ${t} (${VE(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,yn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return VE(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var gn;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(gn||(gn={}));function VE(s){return"storage/"+s}function uS(){const s="An unknown error occurred, please check the error payload for server response.";return new yn(gn.UNKNOWN,s)}function N$(s){return new yn(gn.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function M$(s){return new yn(gn.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function L$(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new yn(gn.UNAUTHENTICATED,s)}function O$(){return new yn(gn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function B$(s){return new yn(gn.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function V$(){return new yn(gn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function U$(){return new yn(gn.CANCELED,"User canceled the upload/download.")}function j$(s){return new yn(gn.INVALID_URL,"Invalid URL '"+s+"'.")}function $$(s){return new yn(gn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function z$(){return new yn(gn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+FN+"' property when initializing the app?")}function H$(){return new yn(gn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function W$(){return new yn(gn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function G$(s){return new yn(gn.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Cb(s){return new yn(gn.INVALID_ARGUMENT,s)}function SN(){return new yn(gn.APP_DELETED,"The Firebase app was deleted.")}function q$(s){return new yn(gn.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function qg(s,e){return new yn(gn.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function ig(s){throw new yn(gn.INTERNAL_ERROR,"Internal error: "+s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=qs.makeFromUrl(e,t)}catch{return new qs(e,"")}if(n.path==="")return n;throw $$(e)}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";function i(V){V.path.charAt(V.path.length-1)==="/"&&(V.path_=V.path_.slice(0,-1))}const o="(/(.*))?$",u=new RegExp("^gs://"+r+o,"i"),d={bucket:1,path:3};function h(V){V.path_=decodeURIComponent(V.path)}const f="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),w="(/([^?#]*).*)?$",A=new RegExp(`^https?://${g}/${f}/b/${r}/o${w}`,"i"),F={bucket:1,path:3},C=t===CN?"(?:storage.googleapis.com|storage.cloud.google.com)":t,S="([^?#]*)",P=new RegExp(`^https?://${C}/${r}/${S}`,"i"),N=[{regex:u,indices:d,postModify:i},{regex:A,indices:F,postModify:h},{regex:P,indices:{bucket:1,path:2},postModify:h}];for(let V=0;V<N.length;V++){const z=N[V],H=z.regex.exec(e);if(H){const R=H[z.indices.bucket];let D=H[z.indices.path];D||(D=""),n=new qs(R,D),z.postModify(n);break}}if(n==null)throw j$(e);return n}}class Q${constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K$(s,e,t){let n=1,r=null,i=null,o=!1,u=0;function d(){return u===2}let h=!1;function f(...S){h||(h=!0,e.apply(null,S))}function g(S){r=setTimeout(()=>{r=null,s(A,d())},S)}function w(){i&&clearTimeout(i)}function A(S,...P){if(h){w();return}if(S){w(),f.call(null,S,...P);return}if(d()||o){w(),f.call(null,S,...P);return}n<64&&(n*=2);let N;u===1?(u=2,N=0):N=(n+Math.random())*1e3,g(N)}let F=!1;function C(S){F||(F=!0,w(),!h&&(r!==null?(S||(u=2),clearTimeout(r),g(0)):S||(u=1)))}return g(0),i=setTimeout(()=>{o=!0,C(!0)},t),C}function X$(s){s(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y$(s){return s!==void 0}function J$(s){return typeof s=="object"&&!Array.isArray(s)}function dS(s){return typeof s=="string"||s instanceof String}function UP(s){return hS()&&s instanceof Blob}function hS(){return typeof Blob<"u"}function jP(s,e,t,n){if(n<e)throw Cb(`Invalid value for '${s}'. Expected ${e} or greater.`);if(n>t)throw Cb(`Invalid value for '${s}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dx(s,e,t){let n=e;return t==null&&(n=`https://${e}`),`${t}://${n}/v0${s}`}function TN(s){const e=encodeURIComponent;let t="?";for(const n in s)if(s.hasOwnProperty(n)){const r=e(n)+"="+e(s[n]);t=t+r+"&"}return t=t.slice(0,-1),t}var Lh;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(Lh||(Lh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z$(s,e){const t=s>=500&&s<600,r=[408,429].indexOf(s)!==-1,i=e.indexOf(s)!==-1;return t||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ez{constructor(e,t,n,r,i,o,u,d,h,f,g,w=!0,A=!1){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=u,this.errorCallback_=d,this.timeout_=h,this.progressCallback_=f,this.connectionFactory_=g,this.retry=w,this.isUsingEmulator=A,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((F,C)=>{this.resolve_=F,this.reject_=C,this.start_()})}start_(){const e=(n,r)=>{if(r){n(!1,new eA(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=u=>{const d=u.loaded,h=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(d,h)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const u=i.getErrorCode()===Lh.NO_ERROR,d=i.getStatus();if(!u||Z$(d,this.additionalRetryCodes_)&&this.retry){const f=i.getErrorCode()===Lh.ABORT;n(!1,new eA(!1,null,f));return}const h=this.successCodes_.indexOf(d)!==-1;n(!0,new eA(h,i))})},t=(n,r)=>{const i=this.resolve_,o=this.reject_,u=r.connection;if(r.wasSuccessCode)try{const d=this.callback_(u,u.getResponse());Y$(d)?i(d):i()}catch(d){o(d)}else if(u!==null){const d=uS();d.serverResponse=u.getErrorText(),this.errorCallback_?o(this.errorCallback_(u,d)):o(d)}else if(r.canceled){const d=this.appDelete_?SN():U$();o(d)}else{const d=V$();o(d)}};this.canceled_?t(!1,new eA(!1,null,!0)):this.backoffId_=K$(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&X$(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class eA{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function tz(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function nz(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function rz(s,e){e&&(s["X-Firebase-GMPID"]=e)}function sz(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function iz(s,e,t,n,r,i,o=!0,u=!1){const d=TN(s.urlParams),h=s.url+d,f=Object.assign({},s.headers);return rz(f,e),tz(f,t),nz(f,i),sz(f,n),new ez(h,s.method,f,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,r,o,u)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function az(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function oz(...s){const e=az();if(e!==void 0){const t=new e;for(let n=0;n<s.length;n++)t.append(s[n]);return t.getBlob()}else{if(hS())return new Blob(s);throw new yn(gn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function lz(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cz(s){if(typeof atob>"u")throw G$("base-64");return atob(s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Za={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class UE{constructor(e,t){this.data=e,this.contentType=t||null}}function uz(s,e){switch(s){case Za.RAW:return new UE(kN(e));case Za.BASE64:case Za.BASE64URL:return new UE(IN(s,e));case Za.DATA_URL:return new UE(hz(e),pz(e))}throw uS()}function kN(s){const e=[];for(let t=0;t<s.length;t++){let n=s.charCodeAt(t);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const i=n,o=s.charCodeAt(++t);n=65536|(i&1023)<<10|o&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function dz(s){let e;try{e=decodeURIComponent(s)}catch{throw qg(Za.DATA_URL,"Malformed data URL.")}return kN(e)}function IN(s,e){switch(s){case Za.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw qg(s,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case Za.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw qg(s,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=cz(e)}catch(r){throw r.message.includes("polyfill")?r:qg(s,"Invalid character found")}const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}class PN{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw qg(Za.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;n!=null&&(this.base64=fz(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function hz(s){const e=new PN(s);return e.base64?IN(Za.BASE64,e.rest):dz(e.rest)}function pz(s){return new PN(s).contentType}function fz(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(e,t){let n=0,r="";UP(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(UP(this.data_)){const n=this.data_,r=lz(n,e,t);return r===null?null:new _c(r)}else{const n=new Uint8Array(this.data_.buffer,e,t-e);return new _c(n,!0)}}static getBlob(...e){if(hS()){const t=e.map(n=>n instanceof _c?n.data_:n);return new _c(oz.apply(null,t))}else{const t=e.map(o=>dS(o)?uz(Za.RAW,o).data:o.data_);let n=0;t.forEach(o=>{n+=o.byteLength});const r=new Uint8Array(n);let i=0;return t.forEach(o=>{for(let u=0;u<o.length;u++)r[i++]=o[u]}),new _c(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RN(s){let e;try{e=JSON.parse(s)}catch{return null}return J$(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mz(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function gz(s,e){const t=e.split("/").filter(n=>n.length>0).join("/");return s.length===0?t:s+"/"+t}function DN(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yz(s,e){return e}class Br{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||yz}}let tA=null;function wz(s){return!dS(s)||s.length<2?s:DN(s)}function NN(){if(tA)return tA;const s=[];s.push(new Br("bucket")),s.push(new Br("generation")),s.push(new Br("metageneration")),s.push(new Br("name","fullPath",!0));function e(i,o){return wz(o)}const t=new Br("name");t.xform=e,s.push(t);function n(i,o){return o!==void 0?Number(o):o}const r=new Br("size");return r.xform=n,s.push(r),s.push(new Br("timeCreated")),s.push(new Br("updated")),s.push(new Br("md5Hash",null,!0)),s.push(new Br("cacheControl",null,!0)),s.push(new Br("contentDisposition",null,!0)),s.push(new Br("contentEncoding",null,!0)),s.push(new Br("contentLanguage",null,!0)),s.push(new Br("contentType",null,!0)),s.push(new Br("metadata","customMetadata",!0)),tA=s,tA}function vz(s,e){function t(){const n=s.bucket,r=s.fullPath,i=new qs(n,r);return e._makeStorageReference(i)}Object.defineProperty(s,"ref",{get:t})}function Az(s,e,t){const n={};n.type="file";const r=t.length;for(let i=0;i<r;i++){const o=t[i];n[o.local]=o.xform(n,e[o.server])}return vz(n,s),n}function MN(s,e,t){const n=RN(e);return n===null?null:Az(s,n,t)}function _z(s,e,t,n){const r=RN(e);if(r===null||!dS(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(h=>{const f=s.bucket,g=s.fullPath,w="/b/"+o(f)+"/o/"+o(g),A=Dx(w,t,n),F=TN({alt:"media",token:h});return A+F})[0]}function xz(s,e){const t={},n=e.length;for(let r=0;r<n;r++){const i=e[r];i.writable&&(t[i.server]=s[i.local])}return JSON.stringify(t)}class pS{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LN(s){if(!s)throw uS()}function Ez(s,e){function t(n,r){const i=MN(s,r,e);return LN(i!==null),i}return t}function bz(s,e){function t(n,r){const i=MN(s,r,e);return LN(i!==null),_z(i,r,s.host,s._protocol)}return t}function ON(s){function e(t,n){let r;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?r=O$():r=L$():t.getStatus()===402?r=M$(s.bucket):t.getStatus()===403?r=B$(s.path):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}return e}function BN(s){const e=ON(s);function t(n,r){let i=e(n,r);return n.getStatus()===404&&(i=N$(s.path)),i.serverResponse=r.serverResponse,i}return t}function Cz(s,e,t){const n=e.fullServerUrl(),r=Dx(n,s.host,s._protocol),i="GET",o=s.maxOperationRetryTime,u=new pS(r,i,bz(s,t),o);return u.errorHandler=BN(e),u}function Fz(s,e){const t=e.fullServerUrl(),n=Dx(t,s.host,s._protocol),r="DELETE",i=s.maxOperationRetryTime;function o(d,h){}const u=new pS(n,r,o,i);return u.successCodes=[200,204],u.errorHandler=BN(e),u}function Sz(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function Tz(s,e,t){const n=Object.assign({},t);return n.fullPath=s.path,n.size=e.size(),n.contentType||(n.contentType=Sz(null,e)),n}function kz(s,e,t,n,r){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function u(){let N="";for(let V=0;V<2;V++)N=N+Math.random().toString().slice(2);return N}const d=u();o["Content-Type"]="multipart/related; boundary="+d;const h=Tz(e,n,r),f=xz(h,t),g="--"+d+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+f+`\r
--`+d+`\r
Content-Type: `+h.contentType+`\r
\r
`,w=`\r
--`+d+"--",A=_c.getBlob(g,n,w);if(A===null)throw H$();const F={name:h.fullPath},C=Dx(i,s.host,s._protocol),S="POST",P=s.maxUploadRetryTime,O=new pS(C,S,Ez(s,t),P);return O.urlParams=F,O.headers=o,O.body=A.uploadData(),O.errorHandler=ON(e),O}class Iz{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Lh.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Lh.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Lh.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,r,i){if(this.sent_)throw ig("cannot .send() more than once");if(Ou(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ig("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ig("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ig("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ig("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Pz extends Iz{initXhr(){this.xhr_.responseType="text"}}function fS(){return new Pz}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e,t){this._service=e,t instanceof qs?this._location=t:this._location=qs.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Hh(e,t)}get root(){const e=new qs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return DN(this._location.path)}get storage(){return this._service}get parent(){const e=mz(this._location.path);if(e===null)return null;const t=new qs(this._location.bucket,e);return new Hh(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw q$(e)}}function Rz(s,e,t){s._throwIfRoot("uploadBytes");const n=kz(s.storage,s._location,NN(),new _c(e,!0),t);return s.storage.makeRequestWithTokens(n,fS).then(r=>({metadata:r,ref:s}))}function Dz(s){s._throwIfRoot("getDownloadURL");const e=Cz(s.storage,s._location,NN());return s.storage.makeRequestWithTokens(e,fS).then(t=>{if(t===null)throw W$();return t})}function Nz(s){s._throwIfRoot("deleteObject");const e=Fz(s.storage,s._location);return s.storage.makeRequestWithTokens(e,fS)}function Mz(s,e){const t=gz(s._location.path,e),n=new qs(s._location.bucket,t);return new Hh(s.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lz(s){return/^[A-Za-z]+:\/\//.test(s)}function Oz(s,e){return new Hh(s,e)}function VN(s,e){if(s instanceof mS){const t=s;if(t._bucket==null)throw z$();const n=new Hh(t,t._bucket);return e!=null?VN(n,e):n}else return e!==void 0?Mz(s,e):s}function Bz(s,e){if(e&&Lz(e)){if(s instanceof mS)return Oz(s,e);throw Cb("To use ref(service, url), the first argument must be a Storage instance.")}else return VN(s,e)}function $P(s,e){const t=e==null?void 0:e[FN];return t==null?null:qs.makeFromBucketSpec(t,s)}function Vz(s,e,t,n={}){s.host=`${e}:${t}`;const r=Ou(e);r&&(hF(`https://${s.host}/b`),pF("Storage",!0)),s._isUsingEmulator=!0,s._protocol=r?"https":"http";const{mockUserToken:i}=n;i&&(s._overrideAuthToken=typeof i=="string"?i:aD(i,s.app.options.projectId))}class mS{constructor(e,t,n,r,i,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=CN,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=R$,this._maxUploadRetryTime=D$,this._requests=new Set,r!=null?this._bucket=qs.makeFromBucketSpec(r,this._host):this._bucket=$P(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=qs.makeFromBucketSpec(this._url,e):this._bucket=$P(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){jP("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){jP("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(_i(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Hh(this,e)}_makeRequest(e,t,n,r,i=!0){if(this._deleted)return new Q$(SN());{const o=iz(e,this._appId,n,r,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const zP="@firebase/storage",HP="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UN="storage";function Wh(s,e,t){return s=mn(s),Rz(s,e,t)}function Gh(s){return s=mn(s),Dz(s)}function Fb(s){return s=mn(s),Nz(s)}function co(s,e){return s=mn(s),Bz(s,e)}function Uz(s=gF(),e){s=mn(s);const n=ux(s,UN).getImmediate({identifier:e}),r=rD("storage");return r&&jz(n,...r),n}function jz(s,e,t,n={}){Vz(s,e,t,n)}function $z(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),n=s.getProvider("auth-internal"),r=s.getProvider("app-check-internal");return new mS(t,n,r,e,Yh)}function zz(){Bh(new bu(UN,$z,"PUBLIC").setMultipleInstances(!0)),eo(zP,HP,""),eo(zP,HP,"esm2020")}zz();const Hz={apiKey:"AIzaSyD_jwiALUoQcZIOkfhgvJ1MTUsD4mQD8cU",authDomain:`studomate1.firebaseapp.com
`,projectId:"studomate1",storageBucket:"studomate1.firebasestorage.app",messagingSenderId:"819063499606",appId:"1:819063499606:web:79b8457a7333050e0404f7"},gS=cD(Hz),yS=ZU(gS),Jt=d$(gS),uo=Uz(gS),WP=s=>{let e;const t=new Set,n=(h,f)=>{const g=typeof h=="function"?h(e):h;if(!Object.is(g,e)){const w=e;e=f??(typeof g!="object"||g===null)?g:Object.assign({},e,g),t.forEach(A=>A(e,w))}},r=()=>e,u={setState:n,getState:r,getInitialState:()=>d,subscribe:h=>(t.add(h),()=>t.delete(h))},d=e=s(n,r,u);return u},Wz=(s=>s?WP(s):WP),Gz=s=>s;function qz(s,e=Gz){const t=Wv.useSyncExternalStore(s.subscribe,Wv.useCallback(()=>e(s.getState()),[s,e]),Wv.useCallback(()=>e(s.getInitialState()),[s,e]));return Wv.useDebugValue(t),t}const GP=s=>{const e=Wz(s),t=n=>qz(e,n);return Object.assign(t,e),t},Qz=(s=>s?GP(s):GP),b0=Qz(s=>({user:null,adminProfile:null,loading:!0,setUser:e=>s({user:e}),setAdminProfile:e=>s({adminProfile:e}),setLoading:e=>s({loading:e}),checkUserRole:async e=>{try{const t=await I$(ia(Jt,"admins",e));t.exists()?s({adminProfile:t.data()}):s({adminProfile:null})}catch(t){console.error("Error fetching admin profile:",t),t.code==="permission-denied"&&console.error('Check your Firestore Security Rules. You might not have permission to read the "admins" collection.'),s({adminProfile:null})}}})),Kz=()=>{const s=ax(),{setUser:e,setAdminProfile:t}=b0(),n=async()=>{try{await yS.signOut(),e(null),t(null),s("/login")}catch(i){console.error("Error signing out:",i)}},r=[{path:"/dashboard",label:"Dashboard",icon:BB},{path:"/universities",label:"Manage Universities",icon:eb},{path:"/modules",label:"Modules",icon:gB},{path:"/exams",label:"Exams",icon:Hm},{path:"/tests",label:"Tests",icon:PB},{path:"/supplementary-exams",label:"Supp. Exams",icon:kB},{path:"/users",label:"Manage Users",icon:cI},{path:"/analytics",label:"Analytics",icon:KR},{path:"/announcements",label:"Announcements",icon:YR}];return _.jsxs("div",{"trae-inspector-start-line":"47","trae-inspector-start-column":"4","trae-inspector-end-line":"92","trae-inspector-end-column":"10","trae-inspector-file-path":"src/components/Sidebar.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"h-screen w-64 bg-gradient-to-b from-blue-600 to-blue-800 text-white flex flex-col fixed left-0 top-0 z-10",children:[_.jsxs("div",{"trae-inspector-start-line":"48","trae-inspector-start-column":"6","trae-inspector-end-line":"53","trae-inspector-end-column":"12","trae-inspector-file-path":"src/components/Sidebar.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"p-6 flex items-center space-x-3",children:[_.jsx("div",{"trae-inspector-start-line":"49","trae-inspector-start-column":"8","trae-inspector-end-line":"51","trae-inspector-end-column":"14","trae-inspector-file-path":"src/components/Sidebar.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-white/10 p-2 rounded-lg",children:_.jsx(eb,{className:"h-8 w-8 text-white"})}),_.jsx("span",{"trae-inspector-start-line":"52","trae-inspector-start-column":"8","trae-inspector-end-line":"52","trae-inspector-end-column":"62","trae-inspector-file-path":"src/components/Sidebar.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22StudentMATE%22%2C%22textStartLine%22%3A%2252%22%2C%22textStartColumn%22%3A%2244%22%2C%22textEndLine%22%3A%2252%22%2C%22textEndColumn%22%3A%2255%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-xl font-bold",children:"StudentMATE"})]}),_.jsx("nav",{"trae-inspector-start-line":"55","trae-inspector-start-column":"6","trae-inspector-end-line":"72","trae-inspector-end-column":"12","trae-inspector-file-path":"src/components/Sidebar.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex-1 px-4 py-4 space-y-2 overflow-y-auto",children:r.map(i=>_.jsxs(GR,{to:i.path,className:({isActive:o})=>`flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${o?"bg-white/20 text-white":"text-blue-100 hover:bg-white/10 hover:text-white"}`,children:[_.jsx(i.icon,{className:"h-5 w-5"}),_.jsx("span",{"trae-inspector-start-line":"69","trae-inspector-start-column":"12","trae-inspector-end-line":"69","trae-inspector-end-column":"61","trae-inspector-file-path":"src/components/Sidebar.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"font-medium",children:i.label})]},i.path))}),_.jsxs("div",{"trae-inspector-start-line":"74","trae-inspector-start-column":"6","trae-inspector-end-line":"91","trae-inspector-end-column":"12","trae-inspector-file-path":"src/components/Sidebar.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"p-4 border-t border-blue-500",children:[_.jsxs("div",{"trae-inspector-start-line":"75","trae-inspector-start-column":"8","trae-inspector-end-line":"83","trae-inspector-end-column":"14","trae-inspector-file-path":"src/components/Sidebar.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-blue-900/50 rounded-lg p-4 mb-4 flex items-center space-x-3",children:[_.jsx("div",{"trae-inspector-start-line":"76","trae-inspector-start-column":"10","trae-inspector-end-line":"78","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/Sidebar.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center",children:_.jsx(cI,{className:"h-6 w-6 text-white"})}),_.jsxs("div",{"trae-inspector-start-line":"79","trae-inspector-start-column":"10","trae-inspector-end-line":"82","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/Sidebar.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("p",{"trae-inspector-start-line":"80","trae-inspector-start-column":"12","trae-inspector-end-line":"80","trae-inspector-end-column":"56","trae-inspector-file-path":"src/components/Sidebar.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Admin%22%2C%22textStartLine%22%3A%2280%22%2C%22textStartColumn%22%3A%2247%22%2C%22textEndLine%22%3A%2280%22%2C%22textEndColumn%22%3A%2252%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-sm font-medium",children:"Admin"}),_.jsx("p",{"trae-inspector-start-line":"81","trae-inspector-start-column":"12","trae-inspector-end-line":"81","trae-inspector-end-column":"64","trae-inspector-file-path":"src/components/Sidebar.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Super%20Admin%22%2C%22textStartLine%22%3A%2281%22%2C%22textStartColumn%22%3A%2249%22%2C%22textEndLine%22%3A%2281%22%2C%22textEndColumn%22%3A%2260%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-xs text-blue-200",children:"Super Admin"})]})]}),_.jsxs("button",{"trae-inspector-start-line":"84","trae-inspector-start-column":"8","trae-inspector-end-line":"90","trae-inspector-end-column":"17","trae-inspector-file-path":"src/components/Sidebar.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:n,className:"w-full flex items-center justify-center space-x-2 px-4 py-2 bg-red-500/80 hover:bg-red-600 rounded-lg transition-colors text-sm",children:[_.jsx(HB,{className:"h-4 w-4"}),_.jsx("span",{"trae-inspector-start-line":"89","trae-inspector-start-column":"10","trae-inspector-end-line":"89","trae-inspector-end-column":"29","trae-inspector-file-path":"src/components/Sidebar.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Logout%22%2C%22textStartLine%22%3A%2289%22%2C%22textStartColumn%22%3A%2216%22%2C%22textEndLine%22%3A%2289%22%2C%22textEndColumn%22%3A%2222%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:"Logout"})]})]})]})},Xz=()=>{const{user:s}=b0();return _.jsxs("header",{"trae-inspector-start-line":"9","trae-inspector-start-column":"4","trae-inspector-end-line":"42","trae-inspector-end-column":"13","trae-inspector-file-path":"src/components/Header.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-white h-16 border-b border-gray-200 flex items-center justify-between px-6 sticky top-0 z-10",children:[_.jsx("div",{"trae-inspector-start-line":"10","trae-inspector-start-column":"6","trae-inspector-end-line":"21","trae-inspector-end-column":"12","trae-inspector-file-path":"src/components/Header.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-center flex-1",children:_.jsxs("div",{"trae-inspector-start-line":"11","trae-inspector-start-column":"8","trae-inspector-end-line":"20","trae-inspector-end-column":"14","trae-inspector-file-path":"src/components/Header.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"relative w-96",children:[_.jsx("div",{"trae-inspector-start-line":"12","trae-inspector-start-column":"10","trae-inspector-end-line":"14","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/Header.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:_.jsx(lx,{className:"h-5 w-5 text-gray-400"})}),_.jsx("input",{"trae-inspector-start-line":"15","trae-inspector-start-column":"10","trae-inspector-end-line":"19","trae-inspector-end-column":"12","trae-inspector-file-path":"src/components/Header.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-full leading-5 bg-gray-50 placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm transition duration-150 ease-in-out",placeholder:"Search..."})]})}),_.jsxs("div",{"trae-inspector-start-line":"23","trae-inspector-start-column":"6","trae-inspector-end-line":"41","trae-inspector-end-column":"12","trae-inspector-file-path":"src/components/Header.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-center space-x-4",children:[_.jsxs("button",{"trae-inspector-start-line":"24","trae-inspector-start-column":"8","trae-inspector-end-line":"27","trae-inspector-end-column":"17","trae-inspector-file-path":"src/components/Header.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"p-2 text-gray-400 hover:text-gray-500 relative",children:[_.jsx(fB,{className:"h-6 w-6"}),_.jsx("span",{"trae-inspector-start-line":"26","trae-inspector-start-column":"10","trae-inspector-end-line":"26","trae-inspector-end-column":"114","trae-inspector-file-path":"src/components/Header.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"absolute top-1 right-1 block h-2 w-2 rounded-full bg-red-500 ring-2 ring-white"})]}),_.jsxs("div",{"trae-inspector-start-line":"29","trae-inspector-start-column":"8","trae-inspector-end-line":"40","trae-inspector-end-column":"14","trae-inspector-file-path":"src/components/Header.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-center space-x-3 pl-4 border-l border-gray-200",children:[_.jsx("span",{"trae-inspector-start-line":"30","trae-inspector-start-column":"10","trae-inspector-end-line":"32","trae-inspector-end-column":"17","trae-inspector-file-path":"src/components/Header.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-sm font-medium text-gray-700",children:(s==null?void 0:s.email)||"Admin"}),_.jsx("div",{"trae-inspector-start-line":"33","trae-inspector-start-column":"10","trae-inspector-end-line":"39","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/Header.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden",children:s!=null&&s.photoURL?_.jsx("img",{"trae-inspector-start-line":"35","trae-inspector-start-column":"14","trae-inspector-end-line":"35","trae-inspector-end-column":"94","trae-inspector-file-path":"src/components/Header.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",src:s.photoURL,alt:"Profile",className:"h-full w-full object-cover"}):_.jsx(JR,{className:"h-5 w-5 text-gray-500"})})]})]})]})},ba=({children:s})=>_.jsxs("div",{"trae-inspector-start-line":"11","trae-inspector-start-column":"4","trae-inspector-end-line":"19","trae-inspector-end-column":"10","trae-inspector-file-path":"src/components/Layout.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"min-h-screen bg-gray-50 flex",children:[_.jsx(Kz,{}),_.jsxs("div",{"trae-inspector-start-line":"13","trae-inspector-start-column":"6","trae-inspector-end-line":"18","trae-inspector-end-column":"12","trae-inspector-file-path":"src/components/Layout.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex-1 ml-64 flex flex-col",children:[_.jsx(Xz,{}),_.jsx("main",{"trae-inspector-start-line":"15","trae-inspector-start-column":"8","trae-inspector-end-line":"17","trae-inspector-end-column":"15","trae-inspector-file-path":"src/components/Layout.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex-1 p-6 overflow-auto",children:s})]})]}),Ca=({children:s})=>{const{user:e,loading:t,setUser:n,setLoading:r,checkUserRole:i}=b0();return q.useEffect(()=>{const o=$V(yS,async u=>{n(u),u&&await i(u.uid),r(!1)});return()=>o()},[n,r,i]),t?_.jsx("div",{"trae-inspector-start-line":"24","trae-inspector-start-column":"6","trae-inspector-end-line":"26","trae-inspector-end-column":"12","trae-inspector-file-path":"src/components/ProtectedRoute.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"min-h-screen flex items-center justify-center bg-gray-50",children:_.jsx("div",{"trae-inspector-start-line":"25","trae-inspector-start-column":"8","trae-inspector-end-line":"25","trae-inspector-end-column":"105","trae-inspector-file-path":"src/components/ProtectedRoute.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e?_.jsx(_.Fragment,{children:s}):_.jsx(JE,{to:"/login",replace:!0})},Yz=()=>{const[s,e]=q.useState(""),[t,n]=q.useState(""),[r,i]=q.useState(""),[o,u]=q.useState(!1),d=ax(),{checkUserRole:h}=b0(),f=async g=>{g.preventDefault(),i(""),u(!0);try{const w=await VV(yS,s,t);await h(w.user.uid),d("/dashboard")}catch(w){i("Failed to login. Please check your credentials."),console.error(w)}finally{u(!1)}};return _.jsxs("div",{"trae-inspector-start-line":"34","trae-inspector-start-column":"4","trae-inspector-end-line":"114","trae-inspector-end-column":"10","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[_.jsxs("div",{"trae-inspector-start-line":"35","trae-inspector-start-column":"6","trae-inspector-end-line":"47","trae-inspector-end-column":"12","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"sm:mx-auto sm:w-full sm:max-w-md",children:[_.jsx("div",{"trae-inspector-start-line":"36","trae-inspector-start-column":"8","trae-inspector-end-line":"40","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex justify-center",children:_.jsx("div",{"trae-inspector-start-line":"37","trae-inspector-start-column":"10","trae-inspector-end-line":"39","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-blue-600 p-2 rounded-full",children:_.jsx(NB,{className:"h-10 w-10 text-white"})})}),_.jsx("h2",{"trae-inspector-start-line":"41","trae-inspector-start-column":"8","trae-inspector-end-line":"43","trae-inspector-end-column":"13","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22StudentMATE%20Admin%22%2C%22textStartLine%22%3A%2241%22%2C%22textStartColumn%22%3A%2279%22%2C%22textEndLine%22%3A%2243%22%2C%22textEndColumn%22%3A%228%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"StudentMATE Admin"}),_.jsx("p",{"trae-inspector-start-line":"44","trae-inspector-start-column":"8","trae-inspector-end-line":"46","trae-inspector-end-column":"12","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Sign%20in%20to%20access%20the%20control%20panel%22%2C%22textStartLine%22%3A%2244%22%2C%22textStartColumn%22%3A%2262%22%2C%22textEndLine%22%3A%2246%22%2C%22textEndColumn%22%3A%228%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"mt-2 text-center text-sm text-gray-600",children:"Sign in to access the control panel"})]}),_.jsx("div",{"trae-inspector-start-line":"49","trae-inspector-start-column":"6","trae-inspector-end-line":"113","trae-inspector-end-column":"12","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:_.jsx("div",{"trae-inspector-start-line":"50","trae-inspector-start-column":"8","trae-inspector-end-line":"112","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:_.jsxs("form",{"trae-inspector-start-line":"51","trae-inspector-start-column":"10","trae-inspector-end-line":"111","trae-inspector-end-column":"17","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"space-y-6",onSubmit:f,children:[_.jsxs("div",{"trae-inspector-start-line":"52","trae-inspector-start-column":"12","trae-inspector-end-line":"72","trae-inspector-end-column":"18","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("label",{"trae-inspector-start-line":"53","trae-inspector-start-column":"14","trae-inspector-end-line":"55","trae-inspector-end-column":"22","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Email%20address%22%2C%22textStartLine%22%3A%2253%22%2C%22textStartColumn%22%3A%2289%22%2C%22textEndLine%22%3A%2255%22%2C%22textEndColumn%22%3A%2214%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),_.jsxs("div",{"trae-inspector-start-line":"56","trae-inspector-start-column":"14","trae-inspector-end-line":"71","trae-inspector-end-column":"20","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"mt-1 relative rounded-md shadow-sm",children:[_.jsx("div",{"trae-inspector-start-line":"57","trae-inspector-start-column":"16","trae-inspector-end-line":"59","trae-inspector-end-column":"22","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:_.jsx(XR,{className:"h-5 w-5 text-gray-400"})}),_.jsx("input",{"trae-inspector-start-line":"60","trae-inspector-start-column":"16","trae-inspector-end-line":"70","trae-inspector-end-column":"18","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:s,onChange:g=>e(g.target.value),className:"focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md py-2 border",placeholder:"admin@studentmate.com"})]})]}),_.jsxs("div",{"trae-inspector-start-line":"74","trae-inspector-start-column":"12","trae-inspector-end-line":"94","trae-inspector-end-column":"18","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("label",{"trae-inspector-start-line":"75","trae-inspector-start-column":"14","trae-inspector-end-line":"77","trae-inspector-end-column":"22","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Password%22%2C%22textStartLine%22%3A%2275%22%2C%22textStartColumn%22%3A%2292%22%2C%22textEndLine%22%3A%2277%22%2C%22textEndColumn%22%3A%2214%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),_.jsxs("div",{"trae-inspector-start-line":"78","trae-inspector-start-column":"14","trae-inspector-end-line":"93","trae-inspector-end-column":"20","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"mt-1 relative rounded-md shadow-sm",children:[_.jsx("div",{"trae-inspector-start-line":"79","trae-inspector-start-column":"16","trae-inspector-end-line":"81","trae-inspector-end-column":"22","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:_.jsx($B,{className:"h-5 w-5 text-gray-400"})}),_.jsx("input",{"trae-inspector-start-line":"82","trae-inspector-start-column":"16","trae-inspector-end-line":"92","trae-inspector-end-column":"18","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:t,onChange:g=>n(g.target.value),className:"focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md py-2 border",placeholder:""})]})]}),r&&_.jsx("div",{"trae-inspector-start-line":"97","trae-inspector-start-column":"14","trae-inspector-end-line":"99","trae-inspector-end-column":"20","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-red-600 text-sm text-center",children:r}),_.jsx("div",{"trae-inspector-start-line":"102","trae-inspector-start-column":"12","trae-inspector-end-line":"110","trae-inspector-end-column":"18","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:_.jsx("button",{"trae-inspector-start-line":"103","trae-inspector-start-column":"14","trae-inspector-end-line":"109","trae-inspector-end-column":"23","trae-inspector-file-path":"src/pages/Login.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"submit",disabled:o,className:`w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${o?"opacity-75 cursor-not-allowed":""}`,children:o?"Signing in...":"Sign in"})})]})})})]})},Ol="assessments",Jz=async(s,e,t)=>{const n=ta(hs(Jt,Ol),Eu("universityId","==",s),Eu("moduleId","==",e),Eu("type","==",t),Pu("year","desc"));return(await np(n)).docs.map(i=>({assessmentId:i.id,...i.data()}))},Zz=async(s=5)=>{const e=ta(hs(Jt,Ol),Pu("createdAt","desc"),EN(s));return(await np(e)).docs.map(n=>({assessmentId:n.id,...n.data()}))},eH=async()=>{const s=hs(Jt,Ol),e=await BE(ta(s,Eu("type","==","exam"))),t=await BE(ta(s,Eu("type","==","test"))),n=await BE(ta(s,Eu("type","==","supplementary")));return{exams:e.data().count,tests:t.data().count,supps:n.data().count}},tH=async(s,e,t,n,r,i,o)=>{let u="";if(o){const h=co(uo,`assessments/${s}/${e}/${t}/${Date.now()}_${o.name}`);await Wh(h,o),u=await Gh(h)}return(await E0(hs(Jt,Ol),{universityId:s,moduleId:e,type:t,title:n,year:r,pdfUrl:u||null,createdBy:i,createdAt:_0()})).id},nH=async s=>{if(s.pdfUrl)try{const e=co(uo,s.pdfUrl);await Fb(e)}catch(e){console.error("Error deleting file from storage:",e)}await x0(ia(Jt,Ol,s.assessmentId))},qP=async(s,e,t,n,r)=>{const i={...t};if(n){const o=co(uo,`questions/${s}/${Date.now()}_content_${n.name}`);await Wh(o,n),i.contentUrl=await Gh(o)}if(r){const o=co(uo,`questions/${s}/${Date.now()}_answer_${r.name}`);await Wh(o,r),i.answerUrl=await Gh(o)}await Rx(ia(Jt,Ol,s,"questions",e),i)},rH=async s=>{const e=ta(hs(Jt,Ol,s,"questions"),Pu("order","asc"));return(await np(e)).docs.map(n=>({questionId:n.id,...n.data()}))},QP=async(s,e,t,n,r,i,o,u,d,h,f)=>{let g="";if(r){const A=co(uo,`questions/${s}/${Date.now()}_content_${r.name}`);await Wh(A,r),g=await Gh(A)}let w="";if(o){const A=co(uo,`questions/${s}/${Date.now()}_answer_${o.name}`);await Wh(A,o),w=await Gh(A)}await E0(hs(Jt,Ol,s,"questions"),{title:e,marks:t,order:n,contentUrl:g||null,content:i||null,answerUrl:w||null,answerText:null,videoUrl:d||null,page:h||null,coordinates:f||null,createdAt:_0()})},sH=async(s,e)=>{if(e.contentUrl)try{const t=co(uo,e.contentUrl);await Fb(t)}catch(t){console.error("Error deleting content image",t)}if(e.answerUrl)try{const t=co(uo,e.answerUrl);await Fb(t)}catch(t){console.error("Error deleting answer image",t)}await x0(ia(Jt,Ol,s,"questions",e.questionId))},Nx="universities",l2=async()=>{const s=ta(hs(Jt,Nx),Pu("name"));return(await np(s)).docs.map(t=>({universityId:t.id,...t.data()}))},iH=async(s,e,t)=>{let n="";if(t){const i=co(uo,`university-logos/${Date.now()}_${t.name}`);await Wh(i,t),n=await Gh(i)}return(await E0(hs(Jt,Nx),{name:s,code:e,logoUrl:n,createdAt:_0()})).id},aH=async(s,e,t)=>{let n={...e};if(t){const r=co(uo,`university-logos/${Date.now()}_${t.name}`);await Wh(r,t),n.logoUrl=await Gh(r)}await Rx(ia(Jt,Nx,s),n)},oH=async s=>{await x0(ia(Jt,Nx,s))},nA=43200,KP=1440,XP=Symbol.for("constructDateFrom");function wS(s,e){return typeof s=="function"?s(e):s&&typeof s=="object"&&XP in s?s[XP](e):s instanceof Date?new s.constructor(e):new Date(e)}function Ru(s,e){return wS(s,s)}let lH={};function cH(){return lH}function YP(s){const e=Ru(s),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+s-+t}function vS(s,...e){const t=wS.bind(null,s||e.find(n=>typeof n=="object"));return e.map(t)}function bA(s,e){const t=+Ru(s)-+Ru(e);return t<0?-1:t>0?1:t}function uH(s){return wS(s,Date.now())}function dH(s,e,t){const[n,r]=vS(t==null?void 0:t.in,s,e),i=n.getFullYear()-r.getFullYear(),o=n.getMonth()-r.getMonth();return i*12+o}function hH(s){return e=>{const n=(s?Math[s]:Math.trunc)(e);return n===0?0:n}}function pH(s,e){return+Ru(s)-+Ru(e)}function fH(s,e){const t=Ru(s);return t.setHours(23,59,59,999),t}function mH(s,e){const t=Ru(s),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function gH(s,e){const t=Ru(s);return+fH(t)==+mH(t)}function yH(s,e,t){const[n,r,i]=vS(t==null?void 0:t.in,s,s,e),o=bA(r,i),u=Math.abs(dH(r,i));if(u<1)return 0;r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-o*u);let d=bA(r,i)===-o;gH(n)&&u===1&&bA(n,i)===1&&(d=!1);const h=o*(u-+d);return h===0?0:h}function wH(s,e,t){const n=pH(s,e)/1e3;return hH(t==null?void 0:t.roundingMethod)(n)}const vH={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},AH=(s,e,t)=>{let n;const r=vH[s];return typeof r=="string"?n=r:e===1?n=r.one:n=r.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+n:n+" ago":n};function jE(s){return(e={})=>{const t=e.width?String(e.width):s.defaultWidth;return s.formats[t]||s.formats[s.defaultWidth]}}const _H={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},xH={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},EH={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},bH={date:jE({formats:_H,defaultWidth:"full"}),time:jE({formats:xH,defaultWidth:"full"}),dateTime:jE({formats:EH,defaultWidth:"full"})},CH={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},FH=(s,e,t,n)=>CH[s];function ag(s){return(e,t)=>{const n=t!=null&&t.context?String(t.context):"standalone";let r;if(n==="formatting"&&s.formattingValues){const o=s.defaultFormattingWidth||s.defaultWidth,u=t!=null&&t.width?String(t.width):o;r=s.formattingValues[u]||s.formattingValues[o]}else{const o=s.defaultWidth,u=t!=null&&t.width?String(t.width):s.defaultWidth;r=s.values[u]||s.values[o]}const i=s.argumentCallback?s.argumentCallback(e):e;return r[i]}}const SH={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},TH={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},kH={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},IH={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},PH={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},RH={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},DH=(s,e)=>{const t=Number(s),n=t%100;if(n>20||n<10)switch(n%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},NH={ordinalNumber:DH,era:ag({values:SH,defaultWidth:"wide"}),quarter:ag({values:TH,defaultWidth:"wide",argumentCallback:s=>s-1}),month:ag({values:kH,defaultWidth:"wide"}),day:ag({values:IH,defaultWidth:"wide"}),dayPeriod:ag({values:PH,defaultWidth:"wide",formattingValues:RH,defaultFormattingWidth:"wide"})};function og(s){return(e,t={})=>{const n=t.width,r=n&&s.matchPatterns[n]||s.matchPatterns[s.defaultMatchWidth],i=e.match(r);if(!i)return null;const o=i[0],u=n&&s.parsePatterns[n]||s.parsePatterns[s.defaultParseWidth],d=Array.isArray(u)?LH(u,g=>g.test(o)):MH(u,g=>g.test(o));let h;h=s.valueCallback?s.valueCallback(d):d,h=t.valueCallback?t.valueCallback(h):h;const f=e.slice(o.length);return{value:h,rest:f}}}function MH(s,e){for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t)&&e(s[t]))return t}function LH(s,e){for(let t=0;t<s.length;t++)if(e(s[t]))return t}function OH(s){return(e,t={})=>{const n=e.match(s.matchPattern);if(!n)return null;const r=n[0],i=e.match(s.parsePattern);if(!i)return null;let o=s.valueCallback?s.valueCallback(i[0]):i[0];o=t.valueCallback?t.valueCallback(o):o;const u=e.slice(r.length);return{value:o,rest:u}}}const BH=/^(\d+)(th|st|nd|rd)?/i,VH=/\d+/i,UH={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},jH={any:[/^b/i,/^(a|c)/i]},$H={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},zH={any:[/1/i,/2/i,/3/i,/4/i]},HH={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},WH={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},GH={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},qH={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},QH={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},KH={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},XH={ordinalNumber:OH({matchPattern:BH,parsePattern:VH,valueCallback:s=>parseInt(s,10)}),era:og({matchPatterns:UH,defaultMatchWidth:"wide",parsePatterns:jH,defaultParseWidth:"any"}),quarter:og({matchPatterns:$H,defaultMatchWidth:"wide",parsePatterns:zH,defaultParseWidth:"any",valueCallback:s=>s+1}),month:og({matchPatterns:HH,defaultMatchWidth:"wide",parsePatterns:WH,defaultParseWidth:"any"}),day:og({matchPatterns:GH,defaultMatchWidth:"wide",parsePatterns:qH,defaultParseWidth:"any"}),dayPeriod:og({matchPatterns:QH,defaultMatchWidth:"any",parsePatterns:KH,defaultParseWidth:"any"})},YH={code:"en-US",formatDistance:AH,formatLong:bH,formatRelative:FH,localize:NH,match:XH,options:{weekStartsOn:0,firstWeekContainsDate:1}};function JH(s,e,t){const n=cH(),r=(t==null?void 0:t.locale)??n.locale??YH,i=2520,o=bA(s,e);if(isNaN(o))throw new RangeError("Invalid time value");const u=Object.assign({},t,{addSuffix:t==null?void 0:t.addSuffix,comparison:o}),[d,h]=vS(t==null?void 0:t.in,...o>0?[e,s]:[s,e]),f=wH(h,d),g=(YP(h)-YP(d))/1e3,w=Math.round((f-g)/60);let A;if(w<2)return t!=null&&t.includeSeconds?f<5?r.formatDistance("lessThanXSeconds",5,u):f<10?r.formatDistance("lessThanXSeconds",10,u):f<20?r.formatDistance("lessThanXSeconds",20,u):f<40?r.formatDistance("halfAMinute",0,u):f<60?r.formatDistance("lessThanXMinutes",1,u):r.formatDistance("xMinutes",1,u):w===0?r.formatDistance("lessThanXMinutes",1,u):r.formatDistance("xMinutes",w,u);if(w<45)return r.formatDistance("xMinutes",w,u);if(w<90)return r.formatDistance("aboutXHours",1,u);if(w<KP){const F=Math.round(w/60);return r.formatDistance("aboutXHours",F,u)}else{if(w<i)return r.formatDistance("xDays",1,u);if(w<nA){const F=Math.round(w/KP);return r.formatDistance("xDays",F,u)}else if(w<nA*2)return A=Math.round(w/nA),r.formatDistance("aboutXMonths",A,u)}if(A=yH(h,d),A<12){const F=Math.round(w/nA);return r.formatDistance("xMonths",F,u)}else{const F=A%12,C=Math.trunc(A/12);return F<3?r.formatDistance("aboutXYears",C,u):F<9?r.formatDistance("overXYears",C,u):r.formatDistance("almostXYears",C+1,u)}}function ZH(s,e){return JH(s,uH(s),e)}const $E=({title:s,value:e,icon:t,color:n})=>_.jsxs("div",{"trae-inspector-start-line":"16","trae-inspector-start-column":"2","trae-inspector-end-line":"24","trae-inspector-end-column":"8","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-white rounded-xl shadow-sm p-6 flex items-center space-x-4",children:[_.jsx("div",{"trae-inspector-start-line":"17","trae-inspector-start-column":"4","trae-inspector-end-line":"19","trae-inspector-end-column":"10","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:`p-4 rounded-lg ${n}`,children:_.jsx(t,{className:"h-6 w-6 text-white"})}),_.jsxs("div",{"trae-inspector-start-line":"20","trae-inspector-start-column":"4","trae-inspector-end-line":"23","trae-inspector-end-column":"10","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("h3",{"trae-inspector-start-line":"21","trae-inspector-start-column":"6","trae-inspector-end-line":"21","trae-inspector-end-column":"67","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-2xl font-bold text-gray-900",children:e}),_.jsx("p",{"trae-inspector-start-line":"22","trae-inspector-start-column":"6","trae-inspector-end-line":"22","trae-inspector-end-column":"54","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-sm text-gray-500",children:s})]})]}),eW=()=>{const[s,e]=q.useState([]),[t,n]=q.useState({exams:0,tests:0,supps:0}),[r,i]=q.useState([]),[o,u]=q.useState(!0);return q.useEffect(()=>{(async()=>{try{const[h,f,g]=await Promise.all([Zz(),eH(),l2()]);e(h),n(f),i(g)}catch(h){console.error("Error loading dashboard data:",h)}finally{u(!1)}})()},[]),_.jsxs("div",{"trae-inspector-start-line":"54","trae-inspector-start-column":"4","trae-inspector-end-line":"161","trae-inspector-end-column":"10","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"space-y-6",children:[_.jsxs("div",{"trae-inspector-start-line":"55","trae-inspector-start-column":"6","trae-inspector-end-line":"70","trae-inspector-end-column":"12","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex justify-between items-center",children:[_.jsx("h1",{"trae-inspector-start-line":"56","trae-inspector-start-column":"8","trae-inspector-end-line":"56","trae-inspector-end-column":"77","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Admin%20Dashboard%22%2C%22textStartLine%22%3A%2256%22%2C%22textStartColumn%22%3A%2257%22%2C%22textEndLine%22%3A%2256%22%2C%22textEndColumn%22%3A%2272%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-2xl font-bold text-gray-900",children:"Admin Dashboard"}),_.jsxs("div",{"trae-inspector-start-line":"57","trae-inspector-start-column":"8","trae-inspector-end-line":"69","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex space-x-2 bg-white rounded-lg p-1 shadow-sm overflow-x-auto max-w-md",children:[r.slice(0,5).map(d=>_.jsx("button",{"trae-inspector-start-line":"59","trae-inspector-start-column":"12","trae-inspector-end-line":"64","trae-inspector-end-column":"21","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-4 py-1.5 rounded-md text-sm font-medium text-gray-600 hover:bg-gray-100 whitespace-nowrap",children:d.code},d.universityId)),_.jsxs(o_,{to:"/universities",className:"px-4 py-1.5 text-sm font-medium text-blue-600 hover:bg-blue-50 rounded-md whitespace-nowrap flex items-center",children:["View All ",_.jsx(uB,{className:"ml-1 h-3 w-3"})]})]})]}),_.jsxs("div",{"trae-inspector-start-line":"73","trae-inspector-start-column":"6","trae-inspector-end-line":"92","trae-inspector-end-column":"12","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[_.jsx($E,{title:"Total Exams",value:t.exams,icon:wB,color:"bg-blue-500"}),_.jsx($E,{title:"Total Tests",value:t.tests,icon:Hm,color:"bg-orange-500"}),_.jsx($E,{title:"Supp. Exams",value:t.supps,icon:SB,color:"bg-green-500"})]}),_.jsx("div",{"trae-inspector-start-line":"94","trae-inspector-start-column":"6","trae-inspector-end-line":"160","trae-inspector-end-column":"12","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:_.jsxs("div",{"trae-inspector-start-line":"96","trae-inspector-start-column":"8","trae-inspector-end-line":"159","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"lg:col-span-3 bg-white rounded-xl shadow-sm overflow-hidden",children:[_.jsxs("div",{"trae-inspector-start-line":"97","trae-inspector-start-column":"10","trae-inspector-end-line":"102","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[_.jsx("h2",{"trae-inspector-start-line":"98","trae-inspector-start-column":"12","trae-inspector-end-line":"98","trae-inspector-end-column":"71","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Recent%20Uploads%22%2C%22textStartLine%22%3A%2298%22%2C%22textStartColumn%22%3A%2252%22%2C%22textEndLine%22%3A%2298%22%2C%22textEndColumn%22%3A%2266%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"font-bold text-gray-900",children:"Recent Uploads"}),_.jsx(o_,{to:"/exams",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center",children:"+ Manage Assessments"})]}),_.jsx("div",{"trae-inspector-start-line":"103","trae-inspector-start-column":"10","trae-inspector-end-line":"158","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"overflow-x-auto",children:_.jsxs("table",{"trae-inspector-start-line":"104","trae-inspector-start-column":"12","trae-inspector-end-line":"157","trae-inspector-end-column":"20","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"w-full",children:[_.jsx("thead",{"trae-inspector-start-line":"105","trae-inspector-start-column":"14","trae-inspector-end-line":"113","trae-inspector-end-column":"22","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-gray-50 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:_.jsxs("tr",{"trae-inspector-start-line":"106","trae-inspector-start-column":"16","trae-inspector-end-line":"112","trae-inspector-end-column":"21","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("th",{"trae-inspector-start-line":"107","trae-inspector-start-column":"18","trae-inspector-end-line":"107","trae-inspector-end-column":"53","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Type%22%2C%22textStartLine%22%3A%22107%22%2C%22textStartColumn%22%3A%2244%22%2C%22textEndLine%22%3A%22107%22%2C%22textEndColumn%22%3A%2248%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3",children:"Type"}),_.jsx("th",{"trae-inspector-start-line":"108","trae-inspector-start-column":"18","trae-inspector-end-line":"108","trae-inspector-end-column":"54","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Title%22%2C%22textStartLine%22%3A%22108%22%2C%22textStartColumn%22%3A%2244%22%2C%22textEndLine%22%3A%22108%22%2C%22textEndColumn%22%3A%2249%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3",children:"Title"}),_.jsx("th",{"trae-inspector-start-line":"109","trae-inspector-start-column":"18","trae-inspector-end-line":"109","trae-inspector-end-column":"53","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Year%22%2C%22textStartLine%22%3A%22109%22%2C%22textStartColumn%22%3A%2244%22%2C%22textEndLine%22%3A%22109%22%2C%22textEndColumn%22%3A%2248%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3",children:"Year"}),_.jsx("th",{"trae-inspector-start-line":"110","trae-inspector-start-column":"18","trae-inspector-end-line":"110","trae-inspector-end-column":"53","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Date%22%2C%22textStartLine%22%3A%22110%22%2C%22textStartColumn%22%3A%2244%22%2C%22textEndLine%22%3A%22110%22%2C%22textEndColumn%22%3A%2248%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3",children:"Date"}),_.jsx("th",{"trae-inspector-start-line":"111","trae-inspector-start-column":"18","trae-inspector-end-line":"111","trae-inspector-end-column":"59","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Created%20By%22%2C%22textStartLine%22%3A%22111%22%2C%22textStartColumn%22%3A%2244%22%2C%22textEndLine%22%3A%22111%22%2C%22textEndColumn%22%3A%2254%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3",children:"Created By"})]})}),_.jsx("tbody",{"trae-inspector-start-line":"114","trae-inspector-start-column":"14","trae-inspector-end-line":"156","trae-inspector-end-column":"22","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"divide-y divide-gray-100",children:o?_.jsx("tr",{"trae-inspector-start-line":"116","trae-inspector-start-column":"18","trae-inspector-end-line":"118","trae-inspector-end-column":"23","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:_.jsx("td",{"trae-inspector-start-line":"117","trae-inspector-start-column":"20","trae-inspector-end-line":"117","trae-inspector-end-column":"99","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Loading...%22%2C%22textStartLine%22%3A%22117%22%2C%22textStartColumn%22%3A%2284%22%2C%22textEndLine%22%3A%22117%22%2C%22textEndColumn%22%3A%2294%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:"Loading..."})}):s.length===0?_.jsx("tr",{"trae-inspector-start-line":"120","trae-inspector-start-column":"18","trae-inspector-end-line":"125","trae-inspector-end-column":"23","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:_.jsxs("td",{"trae-inspector-start-line":"121","trae-inspector-start-column":"20","trae-inspector-end-line":"124","trae-inspector-end-column":"25","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",colSpan:5,className:"px-6 py-4 text-center text-gray-500 py-10",children:[_.jsx("p",{"trae-inspector-start-line":"122","trae-inspector-start-column":"22","trae-inspector-end-line":"122","trae-inspector-end-column":"92","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22No%20recent%20uploads%22%2C%22textStartLine%22%3A%22122%22%2C%22textStartColumn%22%3A%2271%22%2C%22textEndLine%22%3A%22122%22%2C%22textEndColumn%22%3A%2288%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-lg font-medium text-gray-900",children:"No recent uploads"}),_.jsx("p",{"trae-inspector-start-line":"123","trae-inspector-start-column":"22","trae-inspector-end-line":"123","trae-inspector-end-column":"118","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Start%20by%20adding%20universities%2C%20modules%2C%20and%20assessments.%22%2C%22textStartLine%22%3A%22123%22%2C%22textStartColumn%22%3A%2259%22%2C%22textEndLine%22%3A%22123%22%2C%22textEndColumn%22%3A%22114%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-sm text-gray-500",children:"Start by adding universities, modules, and assessments."})]})}):s.map(d=>{var h,f;return _.jsxs("tr",{"trae-inspector-start-line":"128","trae-inspector-start-column":"20","trae-inspector-end-line":"153","trae-inspector-end-column":"25","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"hover:bg-gray-50 transition-colors",children:[_.jsx("td",{"trae-inspector-start-line":"129","trae-inspector-start-column":"22","trae-inspector-end-line":"137","trae-inspector-end-column":"27","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4 text-sm font-medium text-gray-900 capitalize",children:_.jsx("span",{"trae-inspector-start-line":"130","trae-inspector-start-column":"24","trae-inspector-end-line":"136","trae-inspector-end-column":"31","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:`px-2 py-1 rounded-full text-xs ${d.type==="exam"?"bg-blue-100 text-blue-800":d.type==="test"?"bg-orange-100 text-orange-800":"bg-green-100 text-green-800"}`,children:d.type})}),_.jsx("td",{"trae-inspector-start-line":"138","trae-inspector-start-column":"22","trae-inspector-end-line":"140","trae-inspector-end-column":"27","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4",children:_.jsx("div",{"trae-inspector-start-line":"139","trae-inspector-start-column":"24","trae-inspector-end-line":"139","trae-inspector-end-column":"91","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-sm font-bold text-gray-900",children:d.title})}),_.jsx("td",{"trae-inspector-start-line":"141","trae-inspector-start-column":"22","trae-inspector-end-line":"141","trae-inspector-end-column":"86","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4 text-sm text-gray-500",children:d.year}),_.jsx("td",{"trae-inspector-start-line":"142","trae-inspector-start-column":"22","trae-inspector-end-line":"146","trae-inspector-end-column":"27","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4",children:_.jsx("div",{"trae-inspector-start-line":"143","trae-inspector-start-column":"24","trae-inspector-end-line":"145","trae-inspector-end-column":"30","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-sm text-gray-900",children:(h=d.createdAt)!=null&&h.seconds?new Date(d.createdAt.seconds*1e3).toLocaleDateString():"Just now"})}),_.jsxs("td",{"trae-inspector-start-line":"147","trae-inspector-start-column":"22","trae-inspector-end-line":"152","trae-inspector-end-column":"27","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4 text-sm text-gray-500 flex items-center space-x-2",children:[_.jsx("span",{"trae-inspector-start-line":"148","trae-inspector-start-column":"24","trae-inspector-end-line":"148","trae-inspector-end-column":"67","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:d.createdBy.split("@")[0]}),_.jsx("span",{"trae-inspector-start-line":"149","trae-inspector-start-column":"24","trae-inspector-end-line":"151","trae-inspector-end-column":"31","trae-inspector-file-path":"src/pages/Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-xs text-gray-400",children:(f=d.createdAt)!=null&&f.seconds?ZH(new Date(d.createdAt.seconds*1e3),{addSuffix:!0}):"now"})]})]},d.assessmentId)})})]})})]})})]})},C0=({isOpen:s,onClose:e,title:t,children:n})=>s?_.jsx("div",{"trae-inspector-start-line":"15","trae-inspector-start-column":"4","trae-inspector-end-line":"40","trae-inspector-end-column":"10","trae-inspector-file-path":"src/components/Modal.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"fixed inset-0 z-50 overflow-y-auto",children:_.jsxs("div",{"trae-inspector-start-line":"16","trae-inspector-start-column":"6","trae-inspector-end-line":"39","trae-inspector-end-column":"12","trae-inspector-file-path":"src/components/Modal.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[_.jsx("div",{"trae-inspector-start-line":"17","trae-inspector-start-column":"8","trae-inspector-end-line":"19","trae-inspector-end-column":"14","trae-inspector-file-path":"src/components/Modal.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:_.jsx("div",{"trae-inspector-start-line":"18","trae-inspector-start-column":"10","trae-inspector-end-line":"18","trae-inspector-end-column":"91","trae-inspector-file-path":"src/components/Modal.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"absolute inset-0 bg-gray-500 opacity-75",onClick:e})}),_.jsx("span",{"trae-inspector-start-line":"21","trae-inspector-start-column":"8","trae-inspector-end-line":"21","trae-inspector-end-column":"110","trae-inspector-file-path":"src/components/Modal.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22%E2%80%8B%22%2C%22textStartLine%22%3A%2221%22%2C%22textStartColumn%22%3A%2296%22%2C%22textEndLine%22%3A%2221%22%2C%22textEndColumn%22%3A%22103%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),_.jsx("div",{"trae-inspector-start-line":"23","trae-inspector-start-column":"8","trae-inspector-end-line":"38","trae-inspector-end-column":"14","trae-inspector-file-path":"src/components/Modal.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:_.jsxs("div",{"trae-inspector-start-line":"24","trae-inspector-start-column":"10","trae-inspector-end-line":"37","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/Modal.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[_.jsxs("div",{"trae-inspector-start-line":"25","trae-inspector-start-column":"12","trae-inspector-end-line":"35","trae-inspector-end-column":"18","trae-inspector-file-path":"src/components/Modal.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex justify-between items-start mb-4",children:[_.jsx("h3",{"trae-inspector-start-line":"26","trae-inspector-start-column":"14","trae-inspector-end-line":"28","trae-inspector-end-column":"19","trae-inspector-file-path":"src/components/Modal.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-lg leading-6 font-medium text-gray-900",id:"modal-title",children:t}),_.jsx("button",{"trae-inspector-start-line":"29","trae-inspector-start-column":"14","trae-inspector-end-line":"34","trae-inspector-end-column":"23","trae-inspector-file-path":"src/components/Modal.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:e,className:"bg-white rounded-md text-gray-400 hover:text-gray-500 focus:outline-none",children:_.jsx(pg,{className:"h-6 w-6"})})]}),n]})})]})}):null,tW=()=>{const[s,e]=q.useState([]),[t,n]=q.useState(!0),[r,i]=q.useState(!1),[o,u]=q.useState(""),[d,h]=q.useState(null),[f,g]=q.useState(""),[w,A]=q.useState(""),[F,C]=q.useState(null),[S,P]=q.useState(!1),O=async()=>{try{const R=await l2();e(R)}catch(R){console.error("Error fetching universities:",R)}finally{n(!1)}};q.useEffect(()=>{O()},[]);const N=R=>{R?(h(R),g(R.name),A(R.code)):(h(null),g(""),A("")),C(null),i(!0)},V=async R=>{R.preventDefault(),P(!0);try{d?await aH(d.universityId,{name:f,code:w},F):await iH(f,w,F),i(!1),O()}catch(D){console.error("Error saving university:",D)}finally{P(!1)}},z=async R=>{if(window.confirm("Are you sure you want to delete this university?"))try{await oH(R),O()}catch(D){console.error("Error deleting university:",D)}},H=s.filter(R=>R.name.toLowerCase().includes(o.toLowerCase())||R.code.toLowerCase().includes(o.toLowerCase()));return _.jsxs("div",{"trae-inspector-start-line":"85","trae-inspector-start-column":"4","trae-inspector-end-line":"214","trae-inspector-end-column":"10","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsxs("div",{"trae-inspector-start-line":"86","trae-inspector-start-column":"6","trae-inspector-end-line":"95","trae-inspector-end-column":"12","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex justify-between items-center mb-6",children:[_.jsx("h1",{"trae-inspector-start-line":"87","trae-inspector-start-column":"8","trae-inspector-end-line":"87","trae-inspector-end-column":"81","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Manage%20Universities%22%2C%22textStartLine%22%3A%2287%22%2C%22textStartColumn%22%3A%2257%22%2C%22textEndLine%22%3A%2287%22%2C%22textEndColumn%22%3A%2276%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-2xl font-bold text-gray-900",children:"Manage Universities"}),_.jsxs("button",{"trae-inspector-start-line":"88","trae-inspector-start-column":"8","trae-inspector-end-line":"94","trae-inspector-end-column":"17","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:()=>N(),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2",children:[_.jsx(l0,{className:"h-5 w-5"}),_.jsx("span",{"trae-inspector-start-line":"93","trae-inspector-start-column":"10","trae-inspector-end-line":"93","trae-inspector-end-column":"37","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Add%20University%22%2C%22textStartLine%22%3A%2293%22%2C%22textStartColumn%22%3A%2216%22%2C%22textEndLine%22%3A%2293%22%2C%22textEndColumn%22%3A%2230%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:"Add University"})]})]}),_.jsxs("div",{"trae-inspector-start-line":"97","trae-inspector-start-column":"6","trae-inspector-end-line":"164","trae-inspector-end-column":"12","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[_.jsx("div",{"trae-inspector-start-line":"98","trae-inspector-start-column":"8","trae-inspector-end-line":"111","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"p-4 border-b border-gray-100",children:_.jsxs("div",{"trae-inspector-start-line":"99","trae-inspector-start-column":"10","trae-inspector-end-line":"110","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"relative max-w-md",children:[_.jsx("div",{"trae-inspector-start-line":"100","trae-inspector-start-column":"12","trae-inspector-end-line":"102","trae-inspector-end-column":"18","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:_.jsx(lx,{className:"h-5 w-5 text-gray-400"})}),_.jsx("input",{"trae-inspector-start-line":"103","trae-inspector-start-column":"12","trae-inspector-end-line":"109","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"text",placeholder:"Search universities...",value:o,onChange:R=>u(R.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg leading-5 bg-gray-50 placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})}),_.jsx("div",{"trae-inspector-start-line":"113","trae-inspector-start-column":"8","trae-inspector-end-line":"163","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"overflow-x-auto",children:_.jsxs("table",{"trae-inspector-start-line":"114","trae-inspector-start-column":"10","trae-inspector-end-line":"162","trae-inspector-end-column":"18","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"w-full",children:[_.jsx("thead",{"trae-inspector-start-line":"115","trae-inspector-start-column":"12","trae-inspector-end-line":"122","trae-inspector-end-column":"20","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-gray-50 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:_.jsxs("tr",{"trae-inspector-start-line":"116","trae-inspector-start-column":"14","trae-inspector-end-line":"121","trae-inspector-end-column":"19","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("th",{"trae-inspector-start-line":"117","trae-inspector-start-column":"16","trae-inspector-end-line":"117","trae-inspector-end-column":"51","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Logo%22%2C%22textStartLine%22%3A%22117%22%2C%22textStartColumn%22%3A%2242%22%2C%22textEndLine%22%3A%22117%22%2C%22textEndColumn%22%3A%2246%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3",children:"Logo"}),_.jsx("th",{"trae-inspector-start-line":"118","trae-inspector-start-column":"16","trae-inspector-end-line":"118","trae-inspector-end-column":"51","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Name%22%2C%22textStartLine%22%3A%22118%22%2C%22textStartColumn%22%3A%2242%22%2C%22textEndLine%22%3A%22118%22%2C%22textEndColumn%22%3A%2246%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3",children:"Name"}),_.jsx("th",{"trae-inspector-start-line":"119","trae-inspector-start-column":"16","trae-inspector-end-line":"119","trae-inspector-end-column":"51","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Code%22%2C%22textStartLine%22%3A%22119%22%2C%22textStartColumn%22%3A%2242%22%2C%22textEndLine%22%3A%22119%22%2C%22textEndColumn%22%3A%2246%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3",children:"Code"}),_.jsx("th",{"trae-inspector-start-line":"120","trae-inspector-start-column":"16","trae-inspector-end-line":"120","trae-inspector-end-column":"65","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Actions%22%2C%22textStartLine%22%3A%22120%22%2C%22textStartColumn%22%3A%2253%22%2C%22textEndLine%22%3A%22120%22%2C%22textEndColumn%22%3A%2260%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3 text-right",children:"Actions"})]})}),_.jsx("tbody",{"trae-inspector-start-line":"123","trae-inspector-start-column":"12","trae-inspector-end-line":"161","trae-inspector-end-column":"20","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"divide-y divide-gray-100",children:t?_.jsx("tr",{"trae-inspector-start-line":"125","trae-inspector-start-column":"16","trae-inspector-end-line":"127","trae-inspector-end-column":"21","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:_.jsx("td",{"trae-inspector-start-line":"126","trae-inspector-start-column":"18","trae-inspector-end-line":"126","trae-inspector-end-column":"97","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Loading...%22%2C%22textStartLine%22%3A%22126%22%2C%22textStartColumn%22%3A%2282%22%2C%22textEndLine%22%3A%22126%22%2C%22textEndColumn%22%3A%2292%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",colSpan:4,className:"px-6 py-4 text-center text-gray-500",children:"Loading..."})}):H.length===0?_.jsx("tr",{"trae-inspector-start-line":"129","trae-inspector-start-column":"16","trae-inspector-end-line":"131","trae-inspector-end-column":"21","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:_.jsx("td",{"trae-inspector-start-line":"130","trae-inspector-start-column":"18","trae-inspector-end-line":"130","trae-inspector-end-column":"108","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22No%20universities%20found%22%2C%22textStartLine%22%3A%22130%22%2C%22textStartColumn%22%3A%2282%22%2C%22textEndLine%22%3A%22130%22%2C%22textEndColumn%22%3A%22103%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",colSpan:4,className:"px-6 py-4 text-center text-gray-500",children:"No universities found"})}):H.map(R=>_.jsxs("tr",{"trae-inspector-start-line":"134","trae-inspector-start-column":"18","trae-inspector-end-line":"158","trae-inspector-end-column":"23","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"hover:bg-gray-50",children:[_.jsx("td",{"trae-inspector-start-line":"135","trae-inspector-start-column":"20","trae-inspector-end-line":"141","trae-inspector-end-column":"25","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4",children:R.logoUrl?_.jsx("img",{"trae-inspector-start-line":"137","trae-inspector-start-column":"24","trae-inspector-end-line":"137","trae-inspector-end-column":"109","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",src:R.logoUrl,alt:R.name,className:"h-10 w-10 object-contain rounded"}):_.jsx("div",{"trae-inspector-start-line":"139","trae-inspector-start-column":"24","trae-inspector-end-line":"139","trae-inspector-end-column":"139","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22No%20Logo%22%2C%22textStartLine%22%3A%22139%22%2C%22textStartColumn%22%3A%22126%22%2C%22textEndLine%22%3A%22139%22%2C%22textEndColumn%22%3A%22133%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"h-10 w-10 bg-gray-200 rounded flex items-center justify-center text-gray-500 text-xs",children:"No Logo"})}),_.jsx("td",{"trae-inspector-start-line":"142","trae-inspector-start-column":"20","trae-inspector-end-line":"142","trae-inspector-end-column":"95","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4 text-sm font-medium text-gray-900",children:R.name}),_.jsx("td",{"trae-inspector-start-line":"143","trae-inspector-start-column":"20","trae-inspector-end-line":"143","trae-inspector-end-column":"83","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4 text-sm text-gray-500",children:R.code}),_.jsxs("td",{"trae-inspector-start-line":"144","trae-inspector-start-column":"20","trae-inspector-end-line":"157","trae-inspector-end-column":"25","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4 text-right space-x-2",children:[_.jsx("button",{"trae-inspector-start-line":"145","trae-inspector-start-column":"22","trae-inspector-end-line":"150","trae-inspector-end-column":"31","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:()=>N(R),className:"text-blue-600 hover:text-blue-900",children:_.jsx(dF,{className:"h-5 w-5"})}),_.jsx("button",{"trae-inspector-start-line":"151","trae-inspector-start-column":"22","trae-inspector-end-line":"156","trae-inspector-end-column":"31","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:()=>z(R.universityId),className:"text-red-600 hover:text-red-900",children:_.jsx(c0,{className:"h-5 w-5"})})]})]},R.universityId))})]})})]}),_.jsx(C0,{isOpen:r,onClose:()=>i(!1),title:d?"Edit University":"Add University",children:_.jsxs("form",{"trae-inspector-start-line":"171","trae-inspector-start-column":"8","trae-inspector-end-line":"212","trae-inspector-end-column":"15","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onSubmit:V,className:"space-y-4",children:[_.jsxs("div",{"trae-inspector-start-line":"172","trae-inspector-start-column":"10","trae-inspector-end-line":"182","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("label",{"trae-inspector-start-line":"173","trae-inspector-start-column":"12","trae-inspector-end-line":"173","trae-inspector-end-column":"94","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22University%20Name%22%2C%22textStartLine%22%3A%22173%22%2C%22textStartColumn%22%3A%2271%22%2C%22textEndLine%22%3A%22173%22%2C%22textEndColumn%22%3A%2286%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700",children:"University Name"}),_.jsx("input",{"trae-inspector-start-line":"174","trae-inspector-start-column":"12","trae-inspector-end-line":"181","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"text",required:!0,value:f,onChange:R=>g(R.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"University of Pretoria"})]}),_.jsxs("div",{"trae-inspector-start-line":"183","trae-inspector-start-column":"10","trae-inspector-end-line":"193","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("label",{"trae-inspector-start-line":"184","trae-inspector-start-column":"12","trae-inspector-end-line":"184","trae-inspector-end-column":"94","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22University%20Code%22%2C%22textStartLine%22%3A%22184%22%2C%22textStartColumn%22%3A%2271%22%2C%22textEndLine%22%3A%22184%22%2C%22textEndColumn%22%3A%2286%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700",children:"University Code"}),_.jsx("input",{"trae-inspector-start-line":"185","trae-inspector-start-column":"12","trae-inspector-end-line":"192","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"text",required:!0,value:w,onChange:R=>A(R.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"UP"})]}),_.jsxs("div",{"trae-inspector-start-line":"194","trae-inspector-start-column":"10","trae-inspector-end-line":"202","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("label",{"trae-inspector-start-line":"195","trae-inspector-start-column":"12","trae-inspector-end-line":"195","trae-inspector-end-column":"83","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Logo%22%2C%22textStartLine%22%3A%22195%22%2C%22textStartColumn%22%3A%2271%22%2C%22textEndLine%22%3A%22195%22%2C%22textEndColumn%22%3A%2275%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700",children:"Logo"}),_.jsx("input",{"trae-inspector-start-line":"196","trae-inspector-start-column":"12","trae-inspector-end-line":"201","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"file",accept:"image/*",onChange:R=>C(R.target.files?R.target.files[0]:null),className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]}),_.jsx("div",{"trae-inspector-start-line":"203","trae-inspector-start-column":"10","trae-inspector-end-line":"211","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"mt-5 sm:mt-6",children:_.jsx("button",{"trae-inspector-start-line":"204","trae-inspector-start-column":"12","trae-inspector-end-line":"210","trae-inspector-end-column":"21","trae-inspector-file-path":"src/pages/Universities.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"submit",disabled:S,className:`w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:text-sm ${S?"opacity-75 cursor-not-allowed":""}`,children:S?"Saving...":"Save"})})]})})]})},Mx="modules",jN=async s=>{const e=ta(hs(Jt,Mx),Eu("universityId","==",s),Pu("code"));return(await np(e)).docs.map(n=>({moduleId:n.id,...n.data()}))},nW=async(s,e,t)=>(await E0(hs(Jt,Mx),{universityId:s,code:e,name:t,createdAt:_0()})).id,rW=async(s,e)=>{await Rx(ia(Jt,Mx,s),e)},sW=async s=>{await x0(ia(Jt,Mx,s))},iW=()=>{const[s,e]=q.useState([]),[t,n]=q.useState(""),[r,i]=q.useState([]),[o,u]=q.useState(!1),[d,h]=q.useState(!1),[f,g]=q.useState(""),[w,A]=q.useState(null),[F,C]=q.useState(""),[S,P]=q.useState(""),[O,N]=q.useState(!1);q.useEffect(()=>{(async()=>{try{const U=await l2();e(U),U.length>0&&n(U[0].universityId)}catch(U){console.error("Error fetching universities:",U)}})()},[]),q.useEffect(()=>{t&&V(t)},[t]);const V=async L=>{u(!0);try{const U=await jN(L);i(U)}catch(U){console.error("Error fetching modules:",U)}finally{u(!1)}},z=L=>{L?(A(L),C(L.code),P(L.name)):(A(null),C(""),P("")),h(!0)},H=async L=>{if(L.preventDefault(),!!t){N(!0);try{w?await rW(w.moduleId,{code:F,name:S}):await nW(t,F,S),h(!1),V(t)}catch(U){console.error("Error saving module:",U)}finally{N(!1)}}},R=async L=>{if(window.confirm("Are you sure you want to delete this module?"))try{await sW(L),V(t)}catch(U){console.error("Error deleting module:",U)}},D=r.filter(L=>L.name.toLowerCase().includes(f.toLowerCase())||L.code.toLowerCase().includes(f.toLowerCase()));return _.jsxs("div",{"trae-inspector-start-line":"105","trae-inspector-start-column":"4","trae-inspector-end-line":"239","trae-inspector-end-column":"10","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsxs("div",{"trae-inspector-start-line":"106","trae-inspector-start-column":"6","trae-inspector-end-line":"116","trae-inspector-end-column":"12","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex justify-between items-center mb-6",children:[_.jsx("h1",{"trae-inspector-start-line":"107","trae-inspector-start-column":"8","trae-inspector-end-line":"107","trae-inspector-end-column":"76","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Manage%20Modules%22%2C%22textStartLine%22%3A%22107%22%2C%22textStartColumn%22%3A%2257%22%2C%22textEndLine%22%3A%22107%22%2C%22textEndColumn%22%3A%2271%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-2xl font-bold text-gray-900",children:"Manage Modules"}),_.jsxs("button",{"trae-inspector-start-line":"108","trae-inspector-start-column":"8","trae-inspector-end-line":"115","trae-inspector-end-column":"17","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:()=>z(),disabled:!t,className:`bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 ${t?"":"opacity-50 cursor-not-allowed"}`,children:[_.jsx(l0,{className:"h-5 w-5"}),_.jsx("span",{"trae-inspector-start-line":"114","trae-inspector-start-column":"10","trae-inspector-end-line":"114","trae-inspector-end-column":"33","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Add%20Module%22%2C%22textStartLine%22%3A%22114%22%2C%22textStartColumn%22%3A%2216%22%2C%22textEndLine%22%3A%22114%22%2C%22textEndColumn%22%3A%2226%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:"Add Module"})]})]}),_.jsx("div",{"trae-inspector-start-line":"118","trae-inspector-start-column":"6","trae-inspector-end-line":"150","trae-inspector-end-column":"12","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-white rounded-xl shadow-sm overflow-hidden mb-6",children:_.jsxs("div",{"trae-inspector-start-line":"119","trae-inspector-start-column":"8","trae-inspector-end-line":"149","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"p-4 border-b border-gray-100 flex items-center space-x-4",children:[_.jsxs("div",{"trae-inspector-start-line":"120","trae-inspector-start-column":"10","trae-inspector-end-line":"133","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex-1",children:[_.jsx("label",{"trae-inspector-start-line":"121","trae-inspector-start-column":"12","trae-inspector-end-line":"121","trae-inspector-end-column":"101","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Select%20University%22%2C%22textStartLine%22%3A%22121%22%2C%22textStartColumn%22%3A%2276%22%2C%22textEndLine%22%3A%22121%22%2C%22textEndColumn%22%3A%2293%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select University"}),_.jsx("select",{"trae-inspector-start-line":"122","trae-inspector-start-column":"12","trae-inspector-end-line":"132","trae-inspector-end-column":"21","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",value:t,onChange:L=>n(L.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md border",children:s.map(L=>_.jsxs("option",{"trae-inspector-start-line":"128","trae-inspector-start-column":"16","trae-inspector-end-line":"130","trae-inspector-end-column":"25","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",value:L.universityId,children:[L.name," (",L.code,")"]},L.universityId))})]}),_.jsxs("div",{"trae-inspector-start-line":"134","trae-inspector-start-column":"10","trae-inspector-end-line":"148","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex-1",children:[_.jsx("label",{"trae-inspector-start-line":"135","trae-inspector-start-column":"12","trae-inspector-end-line":"135","trae-inspector-end-column":"98","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Search%20Modules%22%2C%22textStartLine%22%3A%22135%22%2C%22textStartColumn%22%3A%2276%22%2C%22textEndLine%22%3A%22135%22%2C%22textEndColumn%22%3A%2290%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Modules"}),_.jsxs("div",{"trae-inspector-start-line":"136","trae-inspector-start-column":"12","trae-inspector-end-line":"147","trae-inspector-end-column":"18","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"relative",children:[_.jsx("div",{"trae-inspector-start-line":"137","trae-inspector-start-column":"14","trae-inspector-end-line":"139","trae-inspector-end-column":"20","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:_.jsx(lx,{className:"h-5 w-5 text-gray-400"})}),_.jsx("input",{"trae-inspector-start-line":"140","trae-inspector-start-column":"14","trae-inspector-end-line":"146","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"text",placeholder:"Search by code or name...",value:f,onChange:L=>g(L.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg leading-5 bg-gray-50 placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]})]})}),_.jsx("div",{"trae-inspector-start-line":"152","trae-inspector-start-column":"6","trae-inspector-end-line":"198","trae-inspector-end-column":"12","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-white rounded-xl shadow-sm overflow-hidden",children:_.jsx("div",{"trae-inspector-start-line":"153","trae-inspector-start-column":"8","trae-inspector-end-line":"197","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"overflow-x-auto",children:_.jsxs("table",{"trae-inspector-start-line":"154","trae-inspector-start-column":"10","trae-inspector-end-line":"196","trae-inspector-end-column":"18","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"w-full",children:[_.jsx("thead",{"trae-inspector-start-line":"155","trae-inspector-start-column":"12","trae-inspector-end-line":"161","trae-inspector-end-column":"20","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-gray-50 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:_.jsxs("tr",{"trae-inspector-start-line":"156","trae-inspector-start-column":"14","trae-inspector-end-line":"160","trae-inspector-end-column":"19","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("th",{"trae-inspector-start-line":"157","trae-inspector-start-column":"16","trae-inspector-end-line":"157","trae-inspector-end-column":"51","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Code%22%2C%22textStartLine%22%3A%22157%22%2C%22textStartColumn%22%3A%2242%22%2C%22textEndLine%22%3A%22157%22%2C%22textEndColumn%22%3A%2246%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3",children:"Code"}),_.jsx("th",{"trae-inspector-start-line":"158","trae-inspector-start-column":"16","trae-inspector-end-line":"158","trae-inspector-end-column":"51","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Name%22%2C%22textStartLine%22%3A%22158%22%2C%22textStartColumn%22%3A%2242%22%2C%22textEndLine%22%3A%22158%22%2C%22textEndColumn%22%3A%2246%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3",children:"Name"}),_.jsx("th",{"trae-inspector-start-line":"159","trae-inspector-start-column":"16","trae-inspector-end-line":"159","trae-inspector-end-column":"65","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Actions%22%2C%22textStartLine%22%3A%22159%22%2C%22textStartColumn%22%3A%2253%22%2C%22textEndLine%22%3A%22159%22%2C%22textEndColumn%22%3A%2260%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3 text-right",children:"Actions"})]})}),_.jsx("tbody",{"trae-inspector-start-line":"162","trae-inspector-start-column":"12","trae-inspector-end-line":"195","trae-inspector-end-column":"20","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"divide-y divide-gray-100",children:o?_.jsx("tr",{"trae-inspector-start-line":"164","trae-inspector-start-column":"16","trae-inspector-end-line":"166","trae-inspector-end-column":"21","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:_.jsx("td",{"trae-inspector-start-line":"165","trae-inspector-start-column":"18","trae-inspector-end-line":"165","trae-inspector-end-column":"97","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Loading...%22%2C%22textStartLine%22%3A%22165%22%2C%22textStartColumn%22%3A%2282%22%2C%22textEndLine%22%3A%22165%22%2C%22textEndColumn%22%3A%2292%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",colSpan:3,className:"px-6 py-4 text-center text-gray-500",children:"Loading..."})}):D.length===0?_.jsx("tr",{"trae-inspector-start-line":"168","trae-inspector-start-column":"16","trae-inspector-end-line":"172","trae-inspector-end-column":"21","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:_.jsx("td",{"trae-inspector-start-line":"169","trae-inspector-start-column":"18","trae-inspector-end-line":"171","trae-inspector-end-column":"23","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",colSpan:3,className:"px-6 py-4 text-center text-gray-500",children:t?"No modules found for this university":"Please select a university"})}):D.map(L=>_.jsxs("tr",{"trae-inspector-start-line":"175","trae-inspector-start-column":"18","trae-inspector-end-line":"192","trae-inspector-end-column":"23","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"hover:bg-gray-50",children:[_.jsx("td",{"trae-inspector-start-line":"176","trae-inspector-start-column":"20","trae-inspector-end-line":"176","trae-inspector-end-column":"95","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4 text-sm font-medium text-blue-600",children:L.code}),_.jsx("td",{"trae-inspector-start-line":"177","trae-inspector-start-column":"20","trae-inspector-end-line":"177","trae-inspector-end-column":"83","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4 text-sm text-gray-900",children:L.name}),_.jsxs("td",{"trae-inspector-start-line":"178","trae-inspector-start-column":"20","trae-inspector-end-line":"191","trae-inspector-end-column":"25","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4 text-right space-x-2",children:[_.jsx("button",{"trae-inspector-start-line":"179","trae-inspector-start-column":"22","trae-inspector-end-line":"184","trae-inspector-end-column":"31","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:()=>z(L),className:"text-blue-600 hover:text-blue-900",children:_.jsx(dF,{className:"h-5 w-5"})}),_.jsx("button",{"trae-inspector-start-line":"185","trae-inspector-start-column":"22","trae-inspector-end-line":"190","trae-inspector-end-column":"31","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:()=>R(L.moduleId),className:"text-red-600 hover:text-red-900",children:_.jsx(c0,{className:"h-5 w-5"})})]})]},L.moduleId))})]})})}),_.jsx(C0,{isOpen:d,onClose:()=>h(!1),title:w?"Edit Module":"Add Module",children:_.jsxs("form",{"trae-inspector-start-line":"205","trae-inspector-start-column":"8","trae-inspector-end-line":"237","trae-inspector-end-column":"15","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onSubmit:H,className:"space-y-4",children:[_.jsxs("div",{"trae-inspector-start-line":"206","trae-inspector-start-column":"10","trae-inspector-end-line":"216","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("label",{"trae-inspector-start-line":"207","trae-inspector-start-column":"12","trae-inspector-end-line":"207","trae-inspector-end-column":"90","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Module%20Code%22%2C%22textStartLine%22%3A%22207%22%2C%22textStartColumn%22%3A%2271%22%2C%22textEndLine%22%3A%22207%22%2C%22textEndColumn%22%3A%2282%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700",children:"Module Code"}),_.jsx("input",{"trae-inspector-start-line":"208","trae-inspector-start-column":"12","trae-inspector-end-line":"215","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"text",required:!0,value:F,onChange:L=>C(L.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"SMTH011"})]}),_.jsxs("div",{"trae-inspector-start-line":"217","trae-inspector-start-column":"10","trae-inspector-end-line":"227","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("label",{"trae-inspector-start-line":"218","trae-inspector-start-column":"12","trae-inspector-end-line":"218","trae-inspector-end-column":"90","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Module%20Name%22%2C%22textStartLine%22%3A%22218%22%2C%22textStartColumn%22%3A%2271%22%2C%22textEndLine%22%3A%22218%22%2C%22textEndColumn%22%3A%2282%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700",children:"Module Name"}),_.jsx("input",{"trae-inspector-start-line":"219","trae-inspector-start-column":"12","trae-inspector-end-line":"226","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"text",required:!0,value:S,onChange:L=>P(L.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Introduction to Calculus"})]}),_.jsx("div",{"trae-inspector-start-line":"228","trae-inspector-start-column":"10","trae-inspector-end-line":"236","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"mt-5 sm:mt-6",children:_.jsx("button",{"trae-inspector-start-line":"229","trae-inspector-start-column":"12","trae-inspector-end-line":"235","trae-inspector-end-column":"21","trae-inspector-file-path":"src/pages/Modules.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"submit",disabled:O,className:`w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:text-sm ${O?"opacity-75 cursor-not-allowed":""}`,children:O?"Saving...":"Save"})})]})})]})},Hr=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Sb=[.001,0,0,.001,0,0],zE=1.35,zs={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},xc={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},ay="pdfjs_internal_editor_",Xe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},lt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},aW={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Tb={TRIANGLES:1,LATTICE:2},Vn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},CA={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},kn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Kp={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Lx={ERRORS:0,WARNINGS:1,INFOS:5},oy={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},lg={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},oW={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Ox=Lx.WARNINGS;function lW(s){Number.isInteger(s)&&(Ox=s)}function cW(){return Ox}function Bx(s){Ox>=Lx.INFOS&&console.info(`Info: ${s}`)}function Ge(s){Ox>=Lx.WARNINGS&&console.warn(`Warning: ${s}`)}function At(s){throw new Error(s)}function vt(s,e){s||At(e)}function uW(s){switch(s==null?void 0:s.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function $N(s,e=null,t=null){if(!s)return null;if(t&&typeof s=="string"){if(t.addDefaultProtocol&&s.startsWith("www.")){const r=s.match(/\./g);(r==null?void 0:r.length)>=2&&(s=`http://${s}`)}if(t.tryConvertEncoding)try{s=gW(s)}catch{}}const n=e?URL.parse(s,e):URL.parse(s);return uW(n)?n:null}function zN(s,e,t=!1){const n=URL.parse(s);return n?(n.hash=e,n.href):t&&$N(s,"http://example.com")?s.split("#",1)[0]+`${e?`#${e}`:""}`:""}function qe(s,e,t,n=!1){return Object.defineProperty(s,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const rp=(function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e})();class JP extends rp{constructor(e,t){super(e,"PasswordException"),this.code=t}}class HE extends rp{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class kb extends rp{constructor(e){super(e,"InvalidPDFException")}}class S_ extends rp{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class dW extends rp{constructor(e){super(e,"FormatError")}}class Du extends rp{constructor(e){super(e,"AbortException")}}function hW(s){(typeof s!="object"||(s==null?void 0:s.length)===void 0)&&At("Invalid argument for bytesToString");const e=s.length,t=8192;if(e<t)return String.fromCharCode.apply(null,s);const n=[];for(let r=0;r<e;r+=t){const i=Math.min(r+t,e),o=s.subarray(r,i);n.push(String.fromCharCode.apply(null,o))}return n.join("")}function Vx(s){typeof s!="string"&&At("Invalid argument for stringToBytes");const e=s.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=s.charCodeAt(n)&255;return t}function pW(s){return String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255)}function fW(){const s=new Uint8Array(4);return s[0]=1,new Uint32Array(s.buffer,0,1)[0]===1}function mW(){try{return new Function(""),!0}catch{return!1}}class Hn{static get isLittleEndian(){return qe(this,"isLittleEndian",fW())}static get isEvalSupported(){return qe(this,"isEvalSupported",mW())}static get isOffscreenCanvasSupported(){return qe(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return qe(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return qe(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return qe(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return qe(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return qe(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const WE=Array.from(Array(256).keys(),s=>s.toString(16).padStart(2,"0"));var Fl,FA,Ib;class _e{static makeHexColor(e,t,n){return`#${WE[e]}${WE[t]}${WE[n]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,n=0){const r=e[n],i=e[n+1];e[n]=r*t[0]+i*t[2]+t[4],e[n+1]=r*t[1]+i*t[3]+t[5]}static applyTransformToBezier(e,t,n=0){const r=t[0],i=t[1],o=t[2],u=t[3],d=t[4],h=t[5];for(let f=0;f<6;f+=2){const g=e[n+f],w=e[n+f+1];e[n+f]=g*r+w*o+d,e[n+f+1]=g*i+w*u+h}}static applyInverseTransform(e,t){const n=e[0],r=e[1],i=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-r*t[2]+t[2]*t[5]-t[4]*t[3])/i,e[1]=(-n*t[1]+r*t[0]+t[4]*t[1]-t[5]*t[0])/i}static axialAlignedBoundingBox(e,t,n){const r=t[0],i=t[1],o=t[2],u=t[3],d=t[4],h=t[5],f=e[0],g=e[1],w=e[2],A=e[3];let F=r*f+d,C=F,S=r*w+d,P=S,O=u*g+h,N=O,V=u*A+h,z=V;if(i!==0||o!==0){const H=i*f,R=i*w,D=o*g,L=o*A;F+=D,P+=D,S+=L,C+=L,O+=H,z+=H,V+=R,N+=R}n[0]=Math.min(n[0],F,S,C,P),n[1]=Math.min(n[1],O,V,N,z),n[2]=Math.max(n[2],F,S,C,P),n[3]=Math.max(n[3],O,V,N,z)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],r=e[1],i=e[2],o=e[3],u=n**2+r**2,d=n*i+r*o,h=i**2+o**2,f=(u+h)/2,g=Math.sqrt(f**2-(u*h-d**2));t[0]=Math.sqrt(f+g||1),t[1]=Math.sqrt(f-g||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>r)return null;const i=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return i>o?null:[n,i,r,o]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,r,i){i[0]=Math.min(i[0],e,n),i[1]=Math.min(i[1],t,r),i[2]=Math.max(i[2],e,n),i[3]=Math.max(i[3],t,r)}static bezierBoundingBox(e,t,n,r,i,o,u,d,h){h[0]=Math.min(h[0],e,u),h[1]=Math.min(h[1],t,d),h[2]=Math.max(h[2],e,u),h[3]=Math.max(h[3],t,d),I(this,Fl,Ib).call(this,e,n,i,u,t,r,o,d,3*(-e+3*(n-i)+u),6*(e-2*n+i),3*(n-e),h),I(this,Fl,Ib).call(this,e,n,i,u,t,r,o,d,3*(-t+3*(r-o)+d),6*(t-2*r+o),3*(r-t),h)}}Fl=new WeakSet,FA=function(e,t,n,r,i,o,u,d,h,f){if(h<=0||h>=1)return;const g=1-h,w=h*h,A=w*h,F=g*(g*(g*e+3*h*t)+3*w*n)+A*r,C=g*(g*(g*i+3*h*o)+3*w*u)+A*d;f[0]=Math.min(f[0],F),f[1]=Math.min(f[1],C),f[2]=Math.max(f[2],F),f[3]=Math.max(f[3],C)},Ib=function(e,t,n,r,i,o,u,d,h,f,g,w){if(Math.abs(h)<1e-12){Math.abs(f)>=1e-12&&I(this,Fl,FA).call(this,e,t,n,r,i,o,u,d,-g/f,w);return}const A=f**2-4*g*h;if(A<0)return;const F=Math.sqrt(A),C=2*h;I(this,Fl,FA).call(this,e,t,n,r,i,o,u,d,(-f+F)/C,w),I(this,Fl,FA).call(this,e,t,n,r,i,o,u,d,(-f-F)/C,w)},T(_e,Fl);function gW(s){return decodeURIComponent(escape(s))}let GE=null,ZP=null;function yW(s){return GE||(GE=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,ZP=new Map([["","t"]])),s.replaceAll(GE,(e,t,n)=>t?t.normalize("NFKC"):ZP.get(n))}function HN(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const s=new Uint8Array(32);return crypto.getRandomValues(s),hW(s)}const sf="pdfjs_internal_id_";function wW(s,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[n,r,...i]=t;if(!s(n)&&!Number.isInteger(n)||!e(r))return!1;const o=i.length;let u=!0;switch(r.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;u=!1;break;default:return!1}for(const d of i)if(!(typeof d=="number"||u&&d===null))return!1;return!0}function hr(s,e,t){return Math.min(Math.max(s,e),t)}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(s){return s.reduce((e,t)=>e+t,0)});class ly{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function r(i){var d;if(!i)return;let o=null;const u=i.name;if(u==="#text")o=i.value;else if(ly.shouldBuildText(u))(d=i==null?void 0:i.attributes)!=null&&d.textContent?o=i.attributes.textContent:i.value&&(o=i.value);else return;if(o!==null&&t.push({str:o}),!!i.children)for(const h of i.children)r(h)}return r(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class WN{static setupStorage(e,t,n,r,i){const o=r.getValue(t,{value:null});switch(n.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),i==="print")break;e.addEventListener("input",u=>{r.setValue(t,{value:u.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(o.value===n.attributes.xfaOn?e.setAttribute("checked",!0):o.value===n.attributes.xfaOff&&e.removeAttribute("checked"),i==="print")break;e.addEventListener("change",u=>{r.setValue(t,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),i==="print")break;e.addEventListener("input",u=>{r.setValue(t,{value:u.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const u of n.children)u.attributes.value===o.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}e.addEventListener("input",u=>{const d=u.target.options,h=d.selectedIndex===-1?"":d[d.selectedIndex].value;r.setValue(t,{value:h})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:r,linkService:i}){const{attributes:o}=t,u=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${r}`);for(const[d,h]of Object.entries(o))if(h!=null)switch(d){case"class":h.length&&e.setAttribute(d,h.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",h);break;case"style":Object.assign(e.style,h);break;case"textContent":e.textContent=h;break;default:(!u||d!=="href"&&d!=="newWindow")&&e.setAttribute(d,h)}u&&i.addLinkAttributes(e,o.href,o.newWindow),n&&o.dataId&&this.setupStorage(e,o.dataId,t,n)}static render(e){var g,w;const t=e.annotationStorage,n=e.linkService,r=e.xfaHtml,i=e.intent||"display",o=document.createElement(r.name);r.attributes&&this.setAttributes({html:o,element:r,intent:i,linkService:n});const u=i!=="richText",d=e.div;if(d.append(o),e.viewport){const A=`matrix(${e.viewport.transform.join(",")})`;d.style.transform=A}u&&d.setAttribute("class","xfaLayer xfaFont");const h=[];if(r.children.length===0){if(r.value){const A=document.createTextNode(r.value);o.append(A),u&&ly.shouldBuildText(r.name)&&h.push(A)}return{textDivs:h}}const f=[[r,-1,o]];for(;f.length>0;){const[A,F,C]=f.at(-1);if(F+1===A.children.length){f.pop();continue}const S=A.children[++f.at(-1)[1]];if(S===null)continue;const{name:P}=S;if(P==="#text"){const N=document.createTextNode(S.value);h.push(N),C.append(N);continue}const O=(g=S==null?void 0:S.attributes)!=null&&g.xmlns?document.createElementNS(S.attributes.xmlns,P):document.createElement(P);if(C.append(O),S.attributes&&this.setAttributes({html:O,element:S,storage:t,intent:i,linkService:n}),((w=S.children)==null?void 0:w.length)>0)f.push([S,-1,O]);else if(S.value){const N=document.createTextNode(S.value);u&&ly.shouldBuildText(P)&&h.push(N),O.append(N)}}for(const A of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))A.setAttribute("readOnly",!0);return{textDivs:h}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Mo="http://www.w3.org/2000/svg",vd=class vd{};re(vd,"CSS",96),re(vd,"PDF",72),re(vd,"PDF_TO_CSS_UNITS",vd.CSS/vd.PDF);let Nu=vd;async function F0(s,e="text"){if(Ag(s,document.baseURI)){const t=await fetch(s);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const r=new XMLHttpRequest;r.open("GET",s,!0),r.responseType=e,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(r.response);return}t(r.responseText);return}n(new Error(r.statusText))}},r.send(null)})}class S0{constructor({viewBox:e,userUnit:t,scale:n,rotation:r,offsetX:i=0,offsetY:o=0,dontFlip:u=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=r,this.offsetX=i,this.offsetY=o,n*=t;const d=(e[2]+e[0])/2,h=(e[3]+e[1])/2;let f,g,w,A;switch(r%=360,r<0&&(r+=360),r){case 180:f=-1,g=0,w=0,A=1;break;case 90:f=0,g=1,w=1,A=0;break;case 270:f=0,g=-1,w=-1,A=0;break;case 0:f=1,g=0,w=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(w=-w,A=-A);let F,C,S,P;f===0?(F=Math.abs(h-e[1])*n+i,C=Math.abs(d-e[0])*n+o,S=(e[3]-e[1])*n,P=(e[2]-e[0])*n):(F=Math.abs(d-e[0])*n+i,C=Math.abs(h-e[1])*n+o,S=(e[2]-e[0])*n,P=(e[3]-e[1])*n),this.transform=[f*n,g*n,w*n,A*n,F-f*n*d-w*n*h,C-g*n*d-A*n*h],this.width=S,this.height=P}get rawDims(){const e=this.viewBox;return qe(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:r=this.offsetY,dontFlip:i=!1}={}){return new S0({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:r,dontFlip:i})}convertToViewportPoint(e,t){const n=[e,t];return _e.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];_e.applyTransform(t,this.transform);const n=[e[2],e[3]];return _e.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return _e.applyInverseTransform(n,this.transform),n}}class AS extends rp{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Ux(s){const e=s.length;let t=0;for(;t<e&&s[t].trim()==="";)t++;return s.substring(t,t+5).toLowerCase()==="data:"}function _S(s){return typeof s=="string"&&/\.pdf$/i.test(s)}function vW(s){return[s]=s.split(/[#?]/,1),s.substring(s.lastIndexOf("/")+1)}function AW(s,e="document.pdf"){if(typeof s!="string")return e;if(Ux(s))return Ge('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(s);if(!n)return e;const r=u=>{try{let d=decodeURIComponent(u);return d.includes("/")?(d=d.split("/").at(-1),d.test(/^\.pdf$/i)?d:u):d}catch{return u}},i=/\.pdf$/i,o=n.pathname.split("/").at(-1);if(i.test(o))return r(o);if(n.searchParams.size>0){const u=Array.from(n.searchParams.values()).reverse();for(const h of u)if(i.test(h))return r(h);const d=Array.from(n.searchParams.keys()).reverse();for(const h of d)if(i.test(h))return r(h)}if(n.hash){const d=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(d)return r(d[0])}return e}class eR{constructor(){re(this,"started",Object.create(null));re(this,"times",[])}time(e){e in this.started&&Ge(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ge(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:r,end:i}of this.times)e.push(`${n.padEnd(t)} ${i-r}ms
`);return e.join("")}}function Ag(s,e){const t=e?URL.parse(s,e):URL.parse(s);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function Fi(s){s.preventDefault()}function fn(s){s.preventDefault(),s.stopPropagation()}function _W(s){console.log("Deprecated API usage: "+s)}var hy;class T_{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;c(this,hy)||x(this,hy,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=c(this,hy).exec(e);if(!t)return null;const n=parseInt(t[1],10);let r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let u=parseInt(t[5],10);u=u>=0&&u<=59?u:0;let d=parseInt(t[6],10);d=d>=0&&d<=59?d:0;const h=t[7]||"Z";let f=parseInt(t[8],10);f=f>=0&&f<=23?f:0;let g=parseInt(t[9],10)||0;return g=g>=0&&g<=59?g:0,h==="-"?(o+=f,u+=g):h==="+"&&(o-=f,u-=g),new Date(Date.UTC(n,r,i,o,u,d))}}hy=new WeakMap,T(T_,hy);function xW(s,{scale:e=1,rotation:t=0}){const{width:n,height:r}=s.attributes.style,i=[0,0,parseInt(n),parseInt(r)];return new S0({viewBox:i,userUnit:1,scale:e,rotation:t})}function T0(s){if(s.startsWith("#")){const e=parseInt(s.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return s.startsWith("rgb(")?s.slice(4,-1).split(",").map(e=>parseInt(e)):s.startsWith("rgba(")?s.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ge(`Not a valid color format: "${s}"`),[0,0,0])}function EW(s){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of s.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;s.set(t,T0(n))}e.remove()}function sn(s){const{a:e,b:t,c:n,d:r,e:i,f:o}=s.getTransform();return[e,t,n,r,i,o]}function Fa(s){const{a:e,b:t,c:n,d:r,e:i,f:o}=s.getTransform().invertSelf();return[e,t,n,r,i,o]}function qh(s,e,t=!1,n=!0){if(e instanceof S0){const{pageWidth:r,pageHeight:i}=e.rawDims,{style:o}=s,u=Hn.isCSSRoundSupported,d=`var(--total-scale-factor) * ${r}px`,h=`var(--total-scale-factor) * ${i}px`,f=u?`round(down, ${d}, var(--scale-round-x))`:`calc(${d})`,g=u?`round(down, ${h}, var(--scale-round-y))`:`calc(${h})`;!t||e.rotation%180===0?(o.width=f,o.height=g):(o.width=g,o.height=f)}n&&s.setAttribute("data-main-rotation",e.rotation)}class ho{constructor(){const{pixelRatio:e}=ho;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,r,i=-1){let o=1/0,u=1/0,d=1/0;n=ho.capPixels(n,i),n>0&&(o=Math.sqrt(n/(e*t))),r!==-1&&(u=r/e,d=r/t);const h=Math.min(o,u,d);return this.sx>h||this.sy>h?(this.sx=h,this.sy=h,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const Pb=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class bW{static get isDarkMode(){var e;return qe(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class CW{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:n}=window.getComputedStyle(e);return e.remove(),qe(this,"commentForegroundColor",T0(n))}}function FW(s,e,t,n){n=Math.min(Math.max(n??1,0),1);const r=255*(1-n);return s=Math.round(s*n+r),e=Math.round(e*n+r),t=Math.round(t*n+r),[s,e,t]}function tR(s,e){const t=s[0]/255,n=s[1]/255,r=s[2]/255,i=Math.max(t,n,r),o=Math.min(t,n,r),u=(i+o)/2;if(i===o)e[0]=e[1]=0;else{const d=i-o;switch(e[1]=u<.5?d/(i+o):d/(2-i-o),i){case t:e[0]=((n-r)/d+(n<r?6:0))*60;break;case n:e[0]=((r-t)/d+2)*60;break;case r:e[0]=((t-n)/d+4)*60;break}}e[2]=u}function Rb(s,e){const t=s[0],n=s[1],r=s[2],i=(1-Math.abs(2*r-1))*n,o=i*(1-Math.abs(t/60%2-1)),u=r-i/2;switch(Math.floor(t/60)){case 0:e[0]=i+u,e[1]=o+u,e[2]=u;break;case 1:e[0]=o+u,e[1]=i+u,e[2]=u;break;case 2:e[0]=u,e[1]=i+u,e[2]=o+u;break;case 3:e[0]=u,e[1]=o+u,e[2]=i+u;break;case 4:e[0]=o+u,e[1]=u,e[2]=i+u;break;case 5:case 6:e[0]=i+u,e[1]=u,e[2]=o+u;break}}function nR(s){return s<=.03928?s/12.92:((s+.055)/1.055)**2.4}function rR(s,e,t){Rb(s,t),t.map(nR);const n=.2126*t[0]+.7152*t[1]+.0722*t[2];Rb(e,t),t.map(nR);const r=.2126*t[0]+.7152*t[1]+.0722*t[2];return n>r?(n+.05)/(r+.05):(r+.05)/(n+.05)}const sR=new Map;function SW(s,e){const t=s[0]+s[1]*256+s[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let n=sR.get(t);if(n)return n;const r=new Float32Array(9),i=r.subarray(0,3),o=r.subarray(3,6);tR(s,o);const u=r.subarray(6,9);tR(e,u);const d=u[2]<.5,h=d?12:4.5;if(o[2]=d?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),rR(o,u,i)<h){let f,g;d?(f=o[2],g=1):(f=0,g=o[2]);const w=.005;for(;g-f>w;){const A=o[2]=(f+g)/2;d===rR(o,u,i)<h?f=A:g=A}o[2]=d?g:f}return Rb(o,i),n=_e.makeHexColor(Math.round(i[0]*255),Math.round(i[1]*255),Math.round(i[2]*255)),sR.set(t,n),n}function GN({html:s,dir:e,className:t},n){const r=document.createDocumentFragment();if(typeof s=="string"){const i=document.createElement("p");i.dir=e||"auto";const o=s.split(/(?:\r\n?|\n)/);for(let u=0,d=o.length;u<d;++u){const h=o[u];i.append(document.createTextNode(h)),u<d-1&&i.append(document.createElement("br"))}r.append(i)}else WN.render({xfaHtml:s,div:r,intent:"richText"});r.firstElementChild.classList.add("richText",t),n.append(r)}function qN(s){const e=new Path2D;if(!s)return e;for(let t=0,n=s.length;t<n;)switch(s[t++]){case lg.moveTo:e.moveTo(s[t++],s[t++]);break;case lg.lineTo:e.lineTo(s[t++],s[t++]);break;case lg.curveTo:e.bezierCurveTo(s[t++],s[t++],s[t++],s[t++],s[t++],s[t++]);break;case lg.quadraticCurveTo:e.quadraticCurveTo(s[t++],s[t++],s[t++],s[t++]);break;case lg.closePath:e.closePath();break;default:Ge(`Unrecognized drawing path operator: ${s[t-1]}`);break}return e}var Uo,Vi,wf,Ec,Ed,Ym,QN,KN;const ut=class ut{constructor(){T(this,Ym)}get pagesNumber(){return c(ut,Ec)}set pagesNumber(e){c(ut,Ec)!==e&&(x(ut,Ec,e),e===0&&(x(ut,Vi,null),x(ut,Uo,null)))}addListener(e){c(ut,Ed).push(e)}removeListener(e){const t=c(ut,Ed).indexOf(e);t>=0&&c(ut,Ed).splice(t,1)}movePages(e,t,n){I(this,Ym,KN).call(this,!0);const r=c(ut,Vi),i=c(ut,Uo);c(ut,wf).set(i);const o=t.length,u=new Uint32Array(o);let d=0;for(let A=0;A<o;A++){const F=t[A]-1;u[A]=r[F],F<n&&(d+=1)}const h=c(ut,Ec);let f=n-d;const g=h-o;f=hr(f,0,g);for(let A=0,F=0;A<h;A++)e.has(A+1)||(r[F++]=r[A]);r.copyWithin(f+o,f,g),r.set(u,f);let w=!1;for(let A=0,F=h;A<F;A++){const C=r[A];w||(w=C!==A+1),i[C-1]=A+1}I(this,Ym,QN).call(this),w||(this.pagesNumber=0)}hasBeenAltered(){return c(ut,Vi)!==null}getPageMappingForSaving(){return{pageIndices:c(ut,Uo)?c(ut,Uo).map(e=>e-1):null}}getPrevPageNumber(e){return c(ut,wf)[c(ut,Vi)[e-1]-1]}getPageNumber(e){var t;return((t=c(ut,Uo))==null?void 0:t[e-1])??e}getPageId(e){var t;return((t=c(ut,Vi))==null?void 0:t[e-1])??e}static get instance(){return qe(this,"instance",new ut)}getMapping(){return c(ut,Vi).subarray(0,this.pagesNumber)}};Uo=new WeakMap,Vi=new WeakMap,wf=new WeakMap,Ec=new WeakMap,Ed=new WeakMap,Ym=new WeakSet,QN=function(){for(const e of c(ut,Ed))e()},KN=function(e){if(c(ut,Vi))return;const t=c(ut,Ec),n=new Uint32Array(3*t),r=x(ut,Vi,n.subarray(0,t)),i=x(ut,Uo,n.subarray(t,2*t));if(e)for(let o=0;o<t;o++)r[o]=i[o]=o+1;x(ut,wf,n.subarray(2*t))},T(ut,Uo,null),T(ut,Vi,null),T(ut,wf,null),T(ut,Ec,0),T(ut,Ed,[]);let cy=ut;var bc,Cc,oi,li,py,Fc,vf,Af,fy,U_,XN,yr,YN,JN,Xp,_g;const Bo=class Bo{constructor(e){T(this,yr);T(this,bc,null);T(this,Cc,null);T(this,oi);T(this,li,null);T(this,py,null);T(this,Fc,null);T(this,vf,null);T(this,Af,null);x(this,oi,e),c(Bo,fy)||x(Bo,fy,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=x(this,bc,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=c(this,oi)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",Fi,{signal:t}),e.addEventListener("pointerdown",I(Bo,U_,XN),{signal:t}));const n=x(this,li,document.createElement("div"));n.className="buttons",e.append(n);const r=c(this,oi).toolbarPosition;if(r){const{style:i}=e,o=c(this,oi)._uiManager.direction==="ltr"?1-r[0]:r[0];i.insetInlineEnd=`${100*o}%`,i.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return c(this,bc)}hide(){var e;c(this,bc).classList.add("hidden"),(e=c(this,Cc))==null||e.hideDropdown()}show(){var e,t;c(this,bc).classList.remove("hidden"),(e=c(this,py))==null||e.shown(),(t=c(this,Fc))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=c(this,oi),n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",c(Bo,fy)[e]),I(this,yr,Xp).call(this,n)&&n.addEventListener("click",r=>{t.delete()},{signal:t._signal}),c(this,li).append(n)}async addAltText(e){const t=await e.render();I(this,yr,Xp).call(this,t),c(this,li).append(t,c(this,yr,_g)),x(this,py,e)}addComment(e,t=null){if(c(this,Fc))return;const n=e.renderForToolbar();if(!n)return;I(this,yr,Xp).call(this,n);const r=x(this,vf,c(this,yr,_g));t?(c(this,li).insertBefore(n,t),c(this,li).insertBefore(r,t)):c(this,li).append(n,r),x(this,Fc,e),e.toolbar=this}addColorPicker(e){if(c(this,Cc))return;x(this,Cc,e);const t=e.renderButton();I(this,yr,Xp).call(this,t),c(this,li).append(t,c(this,yr,_g))}async addEditSignatureButton(e){const t=x(this,Af,await e.renderEditButton(c(this,oi)));I(this,yr,Xp).call(this,t),c(this,li).append(t,c(this,yr,_g))}removeButton(e){var t,n;switch(e){case"comment":(t=c(this,Fc))==null||t.removeToolbarCommentButton(),x(this,Fc,null),(n=c(this,vf))==null||n.remove(),x(this,vf,null);break}}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,n){if(!t&&e==="comment")return;const r=c(this,li).querySelector(n);r&&e==="comment"&&this.addComment(t,r)}updateEditSignatureButton(e){c(this,Af)&&(c(this,Af).title=e)}remove(){var e;c(this,bc).remove(),(e=c(this,Cc))==null||e.destroy(),x(this,Cc,null)}};bc=new WeakMap,Cc=new WeakMap,oi=new WeakMap,li=new WeakMap,py=new WeakMap,Fc=new WeakMap,vf=new WeakMap,Af=new WeakMap,fy=new WeakMap,U_=new WeakSet,XN=function(e){e.stopPropagation()},yr=new WeakSet,YN=function(e){c(this,oi)._focusEventsAllowed=!1,fn(e)},JN=function(e){c(this,oi)._focusEventsAllowed=!0,fn(e)},Xp=function(e){const t=c(this,oi)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",I(this,yr,YN).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",I(this,yr,JN).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Fi,{signal:t}),!0)},_g=function(){const e=document.createElement("div");return e.className="divider",e},T(Bo,U_),T(Bo,fy,null);let Db=Bo;var my,bd,jo,Nl,ZN,eM,Nb;class TW{constructor(e){T(this,Nl);T(this,my,null);T(this,bd,null);T(this,jo);x(this,jo,e)}show(e,t,n){const[r,i]=I(this,Nl,eM).call(this,t,n),{style:o}=c(this,bd)||x(this,bd,I(this,Nl,ZN).call(this));e.append(c(this,bd)),o.insetInlineEnd=`${100*r}%`,o.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){c(this,bd).remove()}}my=new WeakMap,bd=new WeakMap,jo=new WeakMap,Nl=new WeakSet,ZN=function(){const e=x(this,bd,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=c(this,jo)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",Fi,{signal:t});const n=x(this,my,document.createElement("div"));return n.className="buttons",e.append(n),c(this,jo).hasCommentManager()&&I(this,Nl,Nb).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{c(this,jo).commentSelection("floating_button")}),I(this,Nl,Nb).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{c(this,jo).highlightSelection("floating_button")}),e},eM=function(e,t){let n=0,r=0;for(const i of e){const o=i.y+i.height;if(o<n)continue;const u=i.x+(t?i.width:0);if(o>n){r=u,n=o;continue}t?u>r&&(r=u):u<r&&(r=u)}return[t?1-r:r,n]},Nb=function(e,t,n,r){const i=document.createElement("button");i.classList.add("basic",e),i.tabIndex=0,i.setAttribute("data-l10n-id",t);const o=document.createElement("span");i.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",n);const u=c(this,jo)._signal;u instanceof AbortSignal&&!u.aborted&&(i.addEventListener("contextmenu",Fi,{signal:u}),i.addEventListener("click",r,{signal:u})),c(this,my).append(i)};function tM(s,e,t){for(const n of t)e.addEventListener(n,s[n].bind(s))}var Cd,Fd,_f,Sd;const St=class St{static initializeAndAddPointerId(e){(c(St,Fd)||x(St,Fd,new Set)).add(e)}static setPointer(e,t){c(St,Cd)||x(St,Cd,t),c(St,Sd)??x(St,Sd,e)}static setTimeStamp(e){x(St,_f,e)}static isSamePointerId(e){return c(St,Cd)===e}static isSamePointerIdOrRemove(e){var t;return c(St,Cd)===e?!0:((t=c(St,Fd))==null||t.delete(e),!1)}static isSamePointerType(e){return c(St,Sd)===e}static isInitializedAndDifferentPointerType(e){return c(St,Sd)!==null&&!St.isSamePointerType(e)}static isSameTimeStamp(e){return c(St,_f)===e}static isUsingMultiplePointers(){var e;return((e=c(St,Fd))==null?void 0:e.size)>=1}static clearPointerType(){x(St,Sd,null)}static clearPointerIds(){x(St,Cd,NaN),x(St,Fd,null)}static clearTimeStamp(){x(St,_f,NaN)}};Cd=new WeakMap,Fd=new WeakMap,_f=new WeakMap,Sd=new WeakMap,T(St,Cd,NaN),T(St,Fd,null),T(St,_f,NaN),T(St,Sd,null);let Sr=St;var j_;class kW{constructor(){T(this,j_,0)}get id(){return`${ay}${Bn(this,j_)._++}`}}j_=new WeakMap;var xf,gy,Tr,Ef,SA;const IS=class IS{constructor(){T(this,Ef);T(this,xf,HN());T(this,gy,0);T(this,Tr,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=e;const i=r.decode().then(()=>(n.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return qe(this,"_isSVGFittingCanvas",i)}async getFromFile(e){const{lastModified:t,name:n,size:r,type:i}=e;return I(this,Ef,SA).call(this,`${t}_${n}_${r}_${i}`,e)}async getFromUrl(e){return I(this,Ef,SA).call(this,e,e)}async getFromBlob(e,t){const n=await t;return I(this,Ef,SA).call(this,e,n)}async getFromId(e){c(this,Tr)||x(this,Tr,new Map);const t=c(this,Tr).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){c(this,Tr)||x(this,Tr,new Map);let n=c(this,Tr).get(e);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const r=new OffscreenCanvas(t.width,t.height);return r.getContext("2d").drawImage(t,0,0),n={bitmap:r.transferToImageBitmap(),id:`image_${c(this,xf)}_${Bn(this,gy)._++}`,refCounter:1,isSvg:!1},c(this,Tr).set(e,n),c(this,Tr).set(n.id,n),n}getSvgUrl(e){const t=c(this,Tr).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var r;c(this,Tr)||x(this,Tr,new Map);const t=c(this,Tr).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const i=new OffscreenCanvas(n.width,n.height);i.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=i.convertToBlob()}(r=n.close)==null||r.call(n),t.bitmap=null}isValidId(e){return e.startsWith(`image_${c(this,xf)}_`)}};xf=new WeakMap,gy=new WeakMap,Tr=new WeakMap,Ef=new WeakSet,SA=async function(e,t){c(this,Tr)||x(this,Tr,new Map);let n=c(this,Tr).get(e);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${c(this,xf)}_${Bn(this,gy)._++}`,refCounter:0,isSvg:!1});let r;if(typeof t=="string"?(n.url=t,r=await F0(t,"blob")):t instanceof File?r=n.file=t:t instanceof Blob&&(r=t),r.type==="image/svg+xml"){const i=IS._isSVGFittingCanvas,o=new FileReader,u=new Image,d=new Promise((h,f)=>{u.onload=()=>{n.bitmap=u,n.isSvg=!0,h()},o.onload=async()=>{const g=n.svgUrl=o.result;u.src=await i?`${g}#svgView(preserveAspectRatio(none))`:g},u.onerror=o.onerror=f});o.readAsDataURL(r),await d}else n.bitmap=await createImageBitmap(r);n.refCounter=1}catch(r){Ge(r),n=null}return c(this,Tr).set(e,n),n&&c(this,Tr).set(n.id,n),n};let Mb=IS;var _n,Sc,yy,nn;class IW{constructor(e=128){T(this,_n,[]);T(this,Sc,!1);T(this,yy);T(this,nn,-1);x(this,yy,e)}add({cmd:e,undo:t,post:n,mustExec:r,type:i=NaN,overwriteIfSameType:o=!1,keepUndo:u=!1}){if(r&&e(),c(this,Sc))return;const d={cmd:e,undo:t,post:n,type:i};if(c(this,nn)===-1){c(this,_n).length>0&&(c(this,_n).length=0),x(this,nn,0),c(this,_n).push(d);return}if(o&&c(this,_n)[c(this,nn)].type===i){u&&(d.undo=c(this,_n)[c(this,nn)].undo),c(this,_n)[c(this,nn)]=d;return}const h=c(this,nn)+1;h===c(this,yy)?c(this,_n).splice(0,1):(x(this,nn,h),h<c(this,_n).length&&c(this,_n).splice(h)),c(this,_n).push(d)}undo(){if(c(this,nn)===-1)return;x(this,Sc,!0);const{undo:e,post:t}=c(this,_n)[c(this,nn)];e(),t==null||t(),x(this,Sc,!1),x(this,nn,c(this,nn)-1)}redo(){if(c(this,nn)<c(this,_n).length-1){x(this,nn,c(this,nn)+1),x(this,Sc,!0);const{cmd:e,post:t}=c(this,_n)[c(this,nn)];e(),t==null||t(),x(this,Sc,!1)}}hasSomethingToUndo(){return c(this,nn)!==-1}hasSomethingToRedo(){return c(this,nn)<c(this,_n).length-1}cleanType(e){if(c(this,nn)!==-1){for(let t=c(this,nn);t>=0;t--)if(c(this,_n)[t].type!==e){c(this,_n).splice(t+1,c(this,nn)-t),x(this,nn,t);return}c(this,_n).length=0,x(this,nn,-1)}}destroy(){x(this,_n,null)}}_n=new WeakMap,Sc=new WeakMap,yy=new WeakMap,nn=new WeakMap;var $_,nM;class k0{constructor(e){T(this,$_);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Hn.platform;for(const[n,r,i={}]of e)for(const o of n){const u=o.startsWith("mac+");t&&u?(this.callbacks.set(o.slice(4),{callback:r,options:i}),this.allKeys.add(o.split("+").at(-1))):!t&&!u&&(this.callbacks.set(o,{callback:r,options:i}),this.allKeys.add(o.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(I(this,$_,nM).call(this,t));if(!n)return;const{callback:r,options:{bubbles:i=!1,args:o=[],checker:u=null}}=n;u&&!u(e,t)||(r.bind(e,...o,t)(),i||fn(t))}}$_=new WeakSet,nM=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const z_=class z_{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return EW(e),qe(this,"_colors",e)}convert(e){const t=T0(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,r]of this._colors)if(r.every((i,o)=>i===t[o]))return z_._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?_e.makeHexColor(...t):e}};re(z_,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let Lb=z_;var bf,bs,Cf,rn,xn,Ff,ci,Sf,ui,kr,Tc,kc,Tf,Ic,Ia,di,Td,wy,vy,kf,Ay,Pa,Pc,If,Rc,Ra,H_,Dc,Pf,_y,Nc,kd,Rf,Mc,xy,Pn,bt,$o,Lc,Oc,Ey,Df,by,Bc,Da,zo,Cy,Fy,hi,ve,TA,Ob,rM,sM,xg,iM,aM,oM,Bb,lM,cM,uM,dM,Vr,Lo,hM,pM,Vb,fM,Eg,Ub;const of=class of{constructor(e,t,n,r,i,o,u,d,h,f,g,w,A,F,C,S){T(this,ve);T(this,bf,new AbortController);T(this,bs,null);T(this,Cf,null);T(this,rn,new Map);T(this,xn,new Map);T(this,Ff,null);T(this,ci,null);T(this,Sf,null);T(this,ui,new IW);T(this,kr,null);T(this,Tc,null);T(this,kc,null);T(this,Tf,0);T(this,Ic,new Set);T(this,Ia,null);T(this,di,null);T(this,Td,new Set);re(this,"_editorUndoBar",null);T(this,wy,!1);T(this,vy,!1);T(this,kf,!1);T(this,Ay,null);T(this,Pa,null);T(this,Pc,null);T(this,If,null);T(this,Rc,!1);T(this,Ra,null);T(this,H_,new kW);T(this,Dc,!1);T(this,Pf,!1);T(this,_y,!1);T(this,Nc,null);T(this,kd,null);T(this,Rf,null);T(this,Mc,null);T(this,xy,null);T(this,Pn,Xe.NONE);T(this,bt,new Set);T(this,$o,null);T(this,Lc,null);T(this,Oc,null);T(this,Ey,null);T(this,Df,null);T(this,by,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});T(this,Bc,[0,0]);T(this,Da,null);T(this,zo,null);T(this,Cy,null);T(this,Fy,null);T(this,hi,null);const P=this._signal=c(this,bf).signal;x(this,zo,e),x(this,Cy,t),x(this,Fy,n),x(this,Ff,r),x(this,kr,i),x(this,Lc,o),x(this,Df,d),this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:P}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:P}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:P}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:P}),u._on("setpreference",this.onSetPreference.bind(this),{signal:P}),u._on("switchannotationeditorparams",O=>this.updateParams(O.type,O.value),{signal:P}),u._on("pagesedited",this.onPagesEdited.bind(this),{signal:P}),window.addEventListener("pointerdown",()=>{x(this,Pf,!0)},{capture:!0,signal:P}),window.addEventListener("pointerup",()=>{x(this,Pf,!1)},{capture:!0,signal:P}),I(this,ve,iM).call(this),I(this,ve,dM).call(this),I(this,ve,Bb).call(this),x(this,ci,d.annotationStorage),x(this,Ay,d.filterFactory),x(this,Oc,h),x(this,If,f||null),x(this,wy,g),x(this,vy,w),x(this,kf,A),x(this,xy,F||null),this.viewParameters={realScale:Nu.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=C||null,this._supportsPinchToZoom=S!==!1,i==null||i.setSidebarUiManager(this)}static get _keyboardManager(){const e=of.prototype,t=o=>c(o,zo).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),n=(o,{target:u})=>{if(u instanceof HTMLInputElement){const{type:d}=u;return d!=="text"&&d!=="number"}return!0},r=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return qe(this,"_keyboardManager",new k0([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:u})=>!(u instanceof HTMLButtonElement)&&c(o,zo).contains(u)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:u})=>!(u instanceof HTMLButtonElement)&&c(o,zo).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}]]))}destroy(){var e,t,n,r,i,o,u,d,h;(e=c(this,hi))==null||e.resolve(),x(this,hi,null),(t=c(this,bf))==null||t.abort(),x(this,bf,null),this._signal=null;for(const f of c(this,xn).values())f.destroy();c(this,xn).clear(),c(this,rn).clear(),c(this,Td).clear(),(n=c(this,Mc))==null||n.clear(),x(this,bs,null),c(this,bt).clear(),c(this,ui).destroy(),(r=c(this,Ff))==null||r.destroy(),(i=c(this,kr))==null||i.destroy(),(o=c(this,Lc))==null||o.destroy(),(u=c(this,Ra))==null||u.hide(),x(this,Ra,null),(d=c(this,Rf))==null||d.destroy(),x(this,Rf,null),x(this,Cf,null),c(this,Pa)&&(clearTimeout(c(this,Pa)),x(this,Pa,null)),c(this,Da)&&(clearTimeout(c(this,Da)),x(this,Da,null)),(h=this._editorUndoBar)==null||h.destroy(),x(this,Df,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return c(this,xy)}get useNewAltTextFlow(){return c(this,vy)}get useNewAltTextWhenAddingImage(){return c(this,kf)}get hcmFilter(){return qe(this,"hcmFilter",c(this,Oc)?c(this,Ay).addHCMFilter(c(this,Oc).foreground,c(this,Oc).background):"none")}get direction(){return qe(this,"direction",getComputedStyle(c(this,zo)).direction)}get _highlightColors(){return qe(this,"_highlightColors",c(this,If)?new Map(c(this,If).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return qe(this,"highlightColors",null);const t=new Map,n=!!c(this,Oc);for(const[r,i]of e){const o=r.endsWith("_HCM");if(n&&o){t.set(r.replace("_HCM",""),i);continue}!n&&!o&&t.set(r,i)}return qe(this,"highlightColors",t)}get highlightColorNames(){return qe(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),x(this,kc,e)}setMainHighlightColorPicker(e){x(this,Rf,e)}editAltText(e,t=!1){var n;(n=c(this,Ff))==null||n.editAltText(this,e,t)}hasCommentManager(){return!!c(this,kr)}editComment(e,t,n,r){var i;(i=c(this,kr))==null||i.showDialog(this,e,t,n,r)}selectComment(e,t){const n=c(this,xn).get(e),r=n==null?void 0:n.getEditorByUID(t);r==null||r.toggleComment(!0,!0)}updateComment(e){var t;(t=c(this,kr))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=c(this,kr))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=c(this,kr))==null||t.removeComments([e.uid])}deleteComment(e,t){const n=()=>{e.comment=t},r=()=>{var i;(i=this._editorUndoBar)==null||i.show(n,"comment"),this.toggleComment(null),e.comment=null};this.addCommands({cmd:r,undo:n,mustExec:!0})}toggleComment(e,t,n=void 0){var r;(r=c(this,kr))==null||r.toggleCommentPopup(e,t,n)}makeCommentColor(e,t){var n;return e&&((n=c(this,kr))==null?void 0:n.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=c(this,kr))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(c(this,xn).has(e-1))return;const{resolve:t,promise:n}=Promise.withResolvers(),r=i=>{i.pageNumber===e&&(this._eventBus._off("editorsrendered",r),t())};this._eventBus.on("editorsrendered",r),await n}getSignature(e){var t;(t=c(this,Lc))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return c(this,Lc)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":x(this,kf,t);break}}onPagesEdited({pagesMapper:e}){for(const r of c(this,rn).values())r.updatePageIndex(e.getPrevPageNumber(r.pageIndex+1)-1);const t=c(this,xn),n=x(this,xn,new Map);for(const[r,i]of t){const o=e.getPrevPageNumber(r+1)-1;if(o===-1){i.destroy();continue}n.set(o,i),i.updatePageIndex(o)}}onPageChanging({pageNumber:e}){x(this,Tf,e-1)}focusMainContainer(){c(this,zo).focus()}findParent(e,t){for(const n of c(this,xn).values()){const{x:r,y:i,width:o,height:u}=n.div.getBoundingClientRect();if(e>=r&&e<=r+o&&t>=i&&t<=i+u)return n}return null}disableUserSelect(e=!1){c(this,Cy).classList.toggle("noUserSelect",e)}addShouldRescale(e){c(this,Td).add(e)}removeShouldRescale(e){c(this,Td).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Nu.PDF_TO_CSS_UNITS;for(const n of c(this,Td))n.onScaleChanging();(t=c(this,kc))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:r,anchorOffset:i,focusNode:o,focusOffset:u}=n,d=n.toString(),f=I(this,ve,TA).call(this,n).closest(".textLayer"),g=this.getSelectionBoxes(f);if(!g)return;n.empty();const w=I(this,ve,Ob).call(this,f),A=c(this,Pn)===Xe.NONE,F=()=>{const C=w==null?void 0:w.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:g,anchorNode:r,anchorOffset:i,focusNode:o,focusOffset:u,text:d});A&&this.showAllEditors("highlight",!0,!0),t&&(C==null||C.editComment())};if(A){this.switchToMode(Xe.HIGHLIGHT,F);return}F()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!c(this,ci))return null;const t=`${ay}${e}`,n=c(this,ci).getRawValue(t);return n&&c(this,ci).remove(t),n}addToAnnotationStorage(e){!e.isEmpty()&&c(this,ci)&&!c(this,ci).has(e.id)&&c(this,ci).setValue(e.id,e)}a11yAlert(e,t=null){const n=c(this,Fy);n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,c(this,Rc)&&(x(this,Rc,!1),I(this,ve,xg).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of c(this,bt))if(t.div.contains(e)){x(this,kd,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!c(this,kd))return;const[e,t]=c(this,kd);x(this,kd,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){I(this,ve,Bb).call(this),this.setEditingState(!0)}removeEditListeners(){I(this,ve,lM).call(this),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of c(this,di))if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of c(this,di))if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var n;if(e.preventDefault(),(n=c(this,bs))==null||n.commitOrRemove(),!this.hasSelection)return;const t=[];for(const r of c(this,bt)){const i=r.serialize(!0);i&&t.push(i)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const i of t.items)for(const o of c(this,di))if(o.isHandlingMimeForPasting(i.type)){o.paste(i,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(i){Ge(`paste: "${i.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const r=this.currentLayer;try{const i=[];for(const d of n){const h=await r.deserialize(d);if(!h)return;i.push(h)}const o=()=>{for(const d of i)I(this,ve,Vb).call(this,d);I(this,ve,Ub).call(this,i)},u=()=>{for(const d of i)d.remove()};this.addCommands({cmd:o,undo:u,mustExec:!0})}catch(i){Ge(`paste: "${i.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),c(this,Pn)!==Xe.NONE&&!this.isEditorHandlingKeyboard&&of._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,c(this,Rc)&&(x(this,Rc,!1),I(this,ve,xg).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(I(this,ve,aM).call(this),I(this,ve,cM).call(this),I(this,ve,Vr).call(this,{isEditing:c(this,Pn)!==Xe.NONE,isEmpty:I(this,ve,Eg).call(this),hasSomethingToUndo:c(this,ui).hasSomethingToUndo(),hasSomethingToRedo:c(this,ui).hasSomethingToRedo(),hasSelectedEditor:!1})):(I(this,ve,oM).call(this),I(this,ve,uM).call(this),I(this,ve,Vr).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!c(this,di)){x(this,di,e);for(const t of c(this,di))I(this,ve,Lo).call(this,t.defaultPropertiesToUpdate)}}getId(){return c(this,H_).id}get currentLayer(){return c(this,xn).get(c(this,Tf))}getLayer(e){return c(this,xn).get(e)}get currentPageIndex(){return c(this,Tf)}addLayer(e){c(this,xn).set(e.pageIndex,e),c(this,Dc)?e.enable():e.disable()}removeLayer(e){c(this,xn).delete(e.pageIndex)}async updateMode(e,t=null,n=!1,r=!1,i=!1,o=!1){var u,d,h,f,g,w;if(c(this,Pn)!==e&&!(c(this,hi)&&(await c(this,hi).promise,!c(this,hi)))){if(x(this,hi,Promise.withResolvers()),(u=c(this,kc))==null||u.commitOrRemove(),c(this,Pn)===Xe.POPUP&&((d=c(this,kr))==null||d.hideSidebar()),(h=c(this,kr))==null||h.destroyPopup(),x(this,Pn,e),e===Xe.NONE){this.setEditingState(!1),I(this,ve,pM).call(this);for(const A of c(this,rn).values())A.hideStandaloneCommentButton();(f=this._editorUndoBar)==null||f.hide(),this.toggleComment(null),c(this,hi).resolve();return}for(const A of c(this,rn).values())A.addStandaloneCommentButton();e===Xe.SIGNATURE&&await((g=c(this,Lc))==null?void 0:g.loadSignatures()),n&&Sr.clearPointerType(),this.setEditingState(!0),await I(this,ve,hM).call(this),this.unselectAll();for(const A of c(this,xn).values())A.updateMode(e);if(e===Xe.POPUP){c(this,Cf)||x(this,Cf,await c(this,Df).getAnnotationsByType(new Set(c(this,di).map(C=>C._editorType))));const A=new Set,F=[];for(const C of c(this,rn).values()){const{annotationElementId:S,hasComment:P,deleted:O}=C;S&&A.add(S),P&&!O&&F.push(C.getData())}for(const C of c(this,Cf)){const{id:S,popupRef:P,contentsObj:O}=C;P&&(O!=null&&O.str)&&!A.has(S)&&!c(this,Ic).has(S)&&F.push(C)}(w=c(this,kr))==null||w.showSidebar(F)}if(!t){r&&this.addNewEditorFromKeyboard(),c(this,hi).resolve();return}for(const A of c(this,rn).values())A.uid===t?(this.setSelected(A),o?A.editComment():i?A.enterInEditMode():A.focus()):A.unselect();c(this,hi).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==c(this,Pn)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(c(this,di)){switch(e){case lt.CREATE:this.currentLayer.addNewEditor(t);return;case lt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(c(this,Ey)||x(this,Ey,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const n of c(this,bt))n.updateParams(e,t);else for(const n of c(this,di))n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){var i;for(const o of c(this,rn).values())o.editorType===e&&o.show(t);(((i=c(this,Ey))==null?void 0:i.get(lt.HIGHLIGHT_SHOW_ALL))??!0)!==t&&I(this,ve,Lo).call(this,[[lt.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(c(this,_y)!==e){x(this,_y,e);for(const t of c(this,xn).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of c(this,rn).values())t.pageIndex===e&&(yield t)}getEditor(e){return c(this,rn).get(e)}addEditor(e){c(this,rn).set(e.id,e)}removeEditor(e){var t,n;e.div.contains(document.activeElement)&&(c(this,Pa)&&clearTimeout(c(this,Pa)),x(this,Pa,setTimeout(()=>{this.focusMainContainer(),x(this,Pa,null)},0))),c(this,rn).delete(e.id),e.annotationElementId&&((t=c(this,Mc))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!c(this,Ic).has(e.annotationElementId))&&((n=c(this,ci))==null||n.remove(e.id))}addDeletedAnnotationElement(e){c(this,Ic).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return c(this,Ic).has(e)}removeDeletedAnnotationElement(e){c(this,Ic).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){c(this,bs)!==e&&(x(this,bs,e),e&&I(this,ve,Lo).call(this,e.propertiesToUpdate))}updateUI(e){c(this,ve,fM)===e&&I(this,ve,Lo).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){I(this,ve,Lo).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(c(this,bt).has(e)){c(this,bt).delete(e),e.unselect(),I(this,ve,Vr).call(this,{hasSelectedEditor:this.hasSelection});return}c(this,bt).add(e),e.select(),I(this,ve,Lo).call(this,e.propertiesToUpdate),I(this,ve,Vr).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.uid}),(t=c(this,kc))==null||t.commitOrRemove();for(const n of c(this,bt))n!==e&&n.unselect();c(this,bt).clear(),c(this,bt).add(e),e.select(),I(this,ve,Lo).call(this,e.propertiesToUpdate),I(this,ve,Vr).call(this,{hasSelectedEditor:!0})}isSelected(e){return c(this,bt).has(e)}get firstSelectedEditor(){return c(this,bt).values().next().value}unselect(e){e.unselect(),c(this,bt).delete(e),I(this,ve,Vr).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return c(this,bt).size!==0}get isEnterHandled(){return c(this,bt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;c(this,ui).undo(),I(this,ve,Vr).call(this,{hasSomethingToUndo:c(this,ui).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:I(this,ve,Eg).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){c(this,ui).redo(),I(this,ve,Vr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:c(this,ui).hasSomethingToRedo(),isEmpty:I(this,ve,Eg).call(this)})}addCommands(e){c(this,ui).add(e),I(this,ve,Vr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:I(this,ve,Eg).call(this)})}cleanUndoStack(e){c(this,ui).cleanType(e)}delete(){var i;this.commitOrRemove();const e=(i=this.currentLayer)==null?void 0:i.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...c(this,bt)],n=()=>{var o;(o=this._editorUndoBar)==null||o.show(r,t.length===1?t[0].editorType:t.length);for(const u of t)u.remove()},r=()=>{for(const o of t)I(this,ve,Vb).call(this,o)};this.addCommands({cmd:n,undo:r,mustExec:!0})}commitOrRemove(){var e;(e=c(this,bs))==null||e.commitOrRemove()}hasSomethingToControl(){return c(this,bs)||this.hasSelection}selectAll(){for(const e of c(this,bt))e.commit();I(this,ve,Ub).call(this,c(this,rn).values())}unselectAll(){var e;if(!(c(this,bs)&&(c(this,bs).commitOrRemove(),c(this,Pn)!==Xe.NONE))&&!((e=c(this,kc))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of c(this,bt))t.unselect();c(this,bt).clear(),I(this,ve,Vr).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;c(this,Bc)[0]+=e,c(this,Bc)[1]+=t;const[r,i]=c(this,Bc),o=[...c(this,bt)],u=1e3;c(this,Da)&&clearTimeout(c(this,Da)),x(this,Da,setTimeout(()=>{x(this,Da,null),c(this,Bc)[0]=c(this,Bc)[1]=0,this.addCommands({cmd:()=>{for(const d of o)c(this,rn).has(d.id)&&(d.translateInPage(r,i),d.translationDone())},undo:()=>{for(const d of o)c(this,rn).has(d.id)&&(d.translateInPage(-r,-i),d.translationDone())},mustExec:!1})},u));for(const d of o)d.translateInPage(e,t),d.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),x(this,Ia,new Map);for(const e of c(this,bt))c(this,Ia).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!c(this,Ia))return!1;this.disableUserSelect(!1);const e=c(this,Ia);x(this,Ia,null);let t=!1;for(const[{x:r,y:i,pageIndex:o},u]of e)u.newX=r,u.newY=i,u.newPageIndex=o,t||(t=r!==u.savedX||i!==u.savedY||o!==u.savedPageIndex);if(!t)return!1;const n=(r,i,o,u)=>{if(c(this,rn).has(r.id)){const d=c(this,xn).get(u);d?r._setParentAndPosition(d,i,o):(r.pageIndex=u,r.x=i,r.y=o)}};return this.addCommands({cmd:()=>{for(const[r,{newX:i,newY:o,newPageIndex:u}]of e)n(r,i,o,u)},undo:()=>{for(const[r,{savedX:i,savedY:o,savedPageIndex:u}]of e)n(r,i,o,u)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(c(this,Ia))for(const n of c(this,Ia).keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||c(this,bt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return c(this,bs)===e}getActive(){return c(this,bs)}getMode(){return c(this,Pn)}isEditingMode(){return c(this,Pn)!==Xe.NONE}get imageManager(){return qe(this,"imageManager",new Mb)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let h=0,f=t.rangeCount;h<f;h++)if(!e.contains(t.getRangeAt(h).commonAncestorContainer))return null;const{x:n,y:r,width:i,height:o}=e.getBoundingClientRect();let u;switch(e.getAttribute("data-main-rotation")){case"90":u=(h,f,g,w)=>({x:(f-r)/o,y:1-(h+g-n)/i,width:w/o,height:g/i});break;case"180":u=(h,f,g,w)=>({x:1-(h+g-n)/i,y:1-(f+w-r)/o,width:g/i,height:w/o});break;case"270":u=(h,f,g,w)=>({x:1-(f+w-r)/o,y:(h-n)/i,width:w/o,height:g/i});break;default:u=(h,f,g,w)=>({x:(h-n)/i,y:(f-r)/o,width:g/i,height:w/o});break}const d=[];for(let h=0,f=t.rangeCount;h<f;h++){const g=t.getRangeAt(h);if(!g.collapsed)for(const{x:w,y:A,width:F,height:C}of g.getClientRects())F===0||C===0||d.push(u(w,A,F,C))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:e,id:t}){(c(this,Sf)||x(this,Sf,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=c(this,Sf))==null||t.delete(e)}renderAnnotationElement(e){var r;const t=(r=c(this,Sf))==null?void 0:r.get(e.data.id);if(!t)return;const n=c(this,ci).getRawValue(t);n&&(c(this,Pn)===Xe.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}setMissingCanvas(e,t,n){var i;const r=(i=c(this,Mc))==null?void 0:i.get(e);r&&(r.setCanvas(t,n),c(this,Mc).delete(e))}addMissingCanvas(e,t){(c(this,Mc)||x(this,Mc,new Map)).set(e,t)}};bf=new WeakMap,bs=new WeakMap,Cf=new WeakMap,rn=new WeakMap,xn=new WeakMap,Ff=new WeakMap,ci=new WeakMap,Sf=new WeakMap,ui=new WeakMap,kr=new WeakMap,Tc=new WeakMap,kc=new WeakMap,Tf=new WeakMap,Ic=new WeakMap,Ia=new WeakMap,di=new WeakMap,Td=new WeakMap,wy=new WeakMap,vy=new WeakMap,kf=new WeakMap,Ay=new WeakMap,Pa=new WeakMap,Pc=new WeakMap,If=new WeakMap,Rc=new WeakMap,Ra=new WeakMap,H_=new WeakMap,Dc=new WeakMap,Pf=new WeakMap,_y=new WeakMap,Nc=new WeakMap,kd=new WeakMap,Rf=new WeakMap,Mc=new WeakMap,xy=new WeakMap,Pn=new WeakMap,bt=new WeakMap,$o=new WeakMap,Lc=new WeakMap,Oc=new WeakMap,Ey=new WeakMap,Df=new WeakMap,by=new WeakMap,Bc=new WeakMap,Da=new WeakMap,zo=new WeakMap,Cy=new WeakMap,Fy=new WeakMap,hi=new WeakMap,ve=new WeakSet,TA=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},Ob=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of c(this,xn).values())if(n.hasTextLayer(e))return n;return null},rM=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=I(this,ve,TA).call(this,e).closest(".textLayer"),r=this.getSelectionBoxes(n);r&&(c(this,Ra)||x(this,Ra,new TW(this)),c(this,Ra).show(n,r,this.direction==="ltr"))},sM=function(){var i,o,u;const e=document.getSelection();if(!e||e.isCollapsed){c(this,$o)&&((i=c(this,Ra))==null||i.hide(),x(this,$o,null),I(this,ve,Vr).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===c(this,$o))return;const r=I(this,ve,TA).call(this,e).closest(".textLayer");if(!r){c(this,$o)&&((o=c(this,Ra))==null||o.hide(),x(this,$o,null),I(this,ve,Vr).call(this,{hasSelectedText:!1}));return}if((u=c(this,Ra))==null||u.hide(),x(this,$o,t),I(this,ve,Vr).call(this,{hasSelectedText:!0}),!(c(this,Pn)!==Xe.HIGHLIGHT&&c(this,Pn)!==Xe.NONE)&&(c(this,Pn)===Xe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),x(this,Rc,this.isShiftKeyDown),!this.isShiftKeyDown)){const d=c(this,Pn)===Xe.HIGHLIGHT?I(this,ve,Ob).call(this,r):null;if(d==null||d.toggleDrawing(),c(this,Pf)){const h=new AbortController,f=this.combinedSignal(h),g=w=>{w.type==="pointerup"&&w.button!==0||(h.abort(),d==null||d.toggleDrawing(!0),w.type==="pointerup"&&I(this,ve,xg).call(this,"main_toolbar"))};window.addEventListener("pointerup",g,{signal:f}),window.addEventListener("blur",g,{signal:f})}else d==null||d.toggleDrawing(!0),I(this,ve,xg).call(this,"main_toolbar")}},xg=function(e=""){c(this,Pn)===Xe.HIGHLIGHT?this.highlightSelection(e):c(this,wy)&&I(this,ve,rM).call(this)},iM=function(){document.addEventListener("selectionchange",I(this,ve,sM).bind(this),{signal:this._signal})},aM=function(){if(c(this,Pc))return;x(this,Pc,new AbortController);const e=this.combinedSignal(c(this,Pc));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},oM=function(){var e;(e=c(this,Pc))==null||e.abort(),x(this,Pc,null)},Bb=function(){if(c(this,Nc))return;x(this,Nc,new AbortController);const e=this.combinedSignal(c(this,Nc));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},lM=function(){var e;(e=c(this,Nc))==null||e.abort(),x(this,Nc,null)},cM=function(){if(c(this,Tc))return;x(this,Tc,new AbortController);const e=this.combinedSignal(c(this,Tc));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},uM=function(){var e;(e=c(this,Tc))==null||e.abort(),x(this,Tc,null)},dM=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Vr=function(e){Object.entries(e).some(([n,r])=>c(this,by)[n]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(c(this,by),e)}),c(this,Pn)===Xe.HIGHLIGHT&&e.hasSelectedEditor===!1&&I(this,ve,Lo).call(this,[[lt.HIGHLIGHT_FREE,!0]]))},Lo=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},hM=async function(){if(!c(this,Dc)){x(this,Dc,!0);const e=[];for(const t of c(this,xn).values())e.push(t.enable());await Promise.all(e);for(const t of c(this,rn).values())t.enable()}},pM=function(){if(this.unselectAll(),c(this,Dc)){x(this,Dc,!1);for(const e of c(this,xn).values())e.disable();for(const e of c(this,rn).values())e.disable()}},Vb=function(e){const t=c(this,xn).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},fM=function(){let e=null;for(e of c(this,bt));return e},Eg=function(){if(c(this,rn).size===0)return!0;if(c(this,rn).size===1)for(const e of c(this,rn).values())return e.isEmpty();return!1},Ub=function(e){for(const t of c(this,bt))t.unselect();c(this,bt).clear();for(const t of e)t.isEmpty()||(c(this,bt).add(t),t.select());I(this,ve,Vr).call(this,{hasSelectedEditor:this.hasSelection})},re(of,"TRANSLATE_SMALL",1),re(of,"TRANSLATE_BIG",10);let Qh=of;var Qn,Na,Ui,Nf,Ma,Cs,Mf,La,ns,Ho,Id,Oa,Vc,Ji,bg,kA;const Ur=class Ur{constructor(e){T(this,Ji);T(this,Qn,null);T(this,Na,!1);T(this,Ui,null);T(this,Nf,null);T(this,Ma,null);T(this,Cs,null);T(this,Mf,!1);T(this,La,null);T(this,ns,null);T(this,Ho,null);T(this,Id,null);T(this,Oa,!1);x(this,ns,e),x(this,Oa,e._uiManager.useNewAltTextFlow),c(Ur,Vc)||x(Ur,Vc,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Ur._l10n??(Ur._l10n=e)}async render(){const e=x(this,Ui,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=x(this,Nf,document.createElement("span"));e.append(t),c(this,Oa)?(e.classList.add("new"),e.setAttribute("data-l10n-id",c(Ur,Vc).missing),t.setAttribute("data-l10n-id",c(Ur,Vc)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=c(this,ns)._uiManager._signal;e.addEventListener("contextmenu",Fi,{signal:n}),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:n});const r=i=>{i.preventDefault(),c(this,ns)._uiManager.editAltText(c(this,ns)),c(this,Oa)&&c(this,ns)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:c(this,Ji,bg)}})};return e.addEventListener("click",r,{capture:!0,signal:n}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(x(this,Mf,!0),r(i))},{signal:n}),await I(this,Ji,kA).call(this),e}finish(){c(this,Ui)&&(c(this,Ui).focus({focusVisible:c(this,Mf)}),x(this,Mf,!1))}isEmpty(){return c(this,Oa)?c(this,Qn)===null:!c(this,Qn)&&!c(this,Na)}hasData(){return c(this,Oa)?c(this,Qn)!==null||!!c(this,Ho):this.isEmpty()}get guessedText(){return c(this,Ho)}async setGuessedText(e){c(this,Qn)===null&&(x(this,Ho,e),x(this,Id,await Ur._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),I(this,Ji,kA).call(this))}toggleAltTextBadge(e=!1){var t;if(!c(this,Oa)||c(this,Qn)){(t=c(this,La))==null||t.remove(),x(this,La,null);return}if(!c(this,La)){const n=x(this,La,document.createElement("div"));n.className="noAltTextBadge",c(this,ns).div.append(n)}c(this,La).classList.toggle("hidden",!e)}serialize(e){let t=c(this,Qn);return!e&&c(this,Ho)===t&&(t=c(this,Id)),{altText:t,decorative:c(this,Na),guessedText:c(this,Ho),textWithDisclaimer:c(this,Id)}}get data(){return{altText:c(this,Qn),decorative:c(this,Na)}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:r,cancel:i=!1}){n&&(x(this,Ho,n),x(this,Id,r)),!(c(this,Qn)===e&&c(this,Na)===t)&&(i||(x(this,Qn,e),x(this,Na,t)),I(this,Ji,kA).call(this))}toggle(e=!1){c(this,Ui)&&(!e&&c(this,Cs)&&(clearTimeout(c(this,Cs)),x(this,Cs,null)),c(this,Ui).disabled=!e)}shown(){c(this,ns)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:c(this,Ji,bg)}})}destroy(){var e,t;(e=c(this,Ui))==null||e.remove(),x(this,Ui,null),x(this,Nf,null),x(this,Ma,null),(t=c(this,La))==null||t.remove(),x(this,La,null)}};Qn=new WeakMap,Na=new WeakMap,Ui=new WeakMap,Nf=new WeakMap,Ma=new WeakMap,Cs=new WeakMap,Mf=new WeakMap,La=new WeakMap,ns=new WeakMap,Ho=new WeakMap,Id=new WeakMap,Oa=new WeakMap,Vc=new WeakMap,Ji=new WeakSet,bg=function(){return c(this,Qn)&&"added"||c(this,Qn)===null&&this.guessedText&&"review"||"missing"},kA=async function(){var r,i,o;const e=c(this,Ui);if(!e)return;if(c(this,Oa)){if(e.classList.toggle("done",!!c(this,Qn)),e.setAttribute("data-l10n-id",c(Ur,Vc)[c(this,Ji,bg)]),(r=c(this,Nf))==null||r.setAttribute("data-l10n-id",c(Ur,Vc)[`${c(this,Ji,bg)}-label`]),!c(this,Qn)){(i=c(this,Ma))==null||i.remove();return}}else{if(!c(this,Qn)&&!c(this,Na)){e.classList.remove("done"),(o=c(this,Ma))==null||o.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=c(this,Ma);if(!t){x(this,Ma,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${c(this,ns).id}`;const u=100,d=c(this,ns)._uiManager._signal;d.addEventListener("abort",()=>{clearTimeout(c(this,Cs)),x(this,Cs,null)},{once:!0}),e.addEventListener("mouseenter",()=>{x(this,Cs,setTimeout(()=>{x(this,Cs,null),c(this,Ma).classList.add("show"),c(this,ns)._reportTelemetry({action:"alt_text_tooltip"})},u))},{signal:d}),e.addEventListener("mouseleave",()=>{var h;c(this,Cs)&&(clearTimeout(c(this,Cs)),x(this,Cs,null)),(h=c(this,Ma))==null||h.classList.remove("show")},{signal:d})}c(this,Na)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=c(this,Qn)),t.parentNode||e.append(t);const n=c(this,ns).getElementForAltText();n==null||n.setAttribute("aria-describedby",t.id)},T(Ur,Vc,null),re(Ur,"_l10n",null);let k_=Ur;var or,pi,Pd,Bt,Sy,Uc,fi,jc,$c,Rd,Ty,jb;class rA{constructor(e){T(this,Ty);T(this,or,null);T(this,pi,null);T(this,Pd,!1);T(this,Bt,null);T(this,Sy,null);T(this,Uc,null);T(this,fi,null);T(this,jc,null);T(this,$c,!1);T(this,Rd,null);x(this,Bt,e)}renderForToolbar(){const e=x(this,pi,document.createElement("button"));return e.className="comment",I(this,Ty,jb).call(this,e,!1)}renderForStandalone(){const e=x(this,or,document.createElement("button"));e.className="annotationCommentButton";const t=c(this,Bt).commentButtonPosition;if(t){const{style:n}=e;n.insetInlineEnd=`calc(${100*(c(this,Bt)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,n.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const r=c(this,Bt).commentButtonColor;r&&(n.backgroundColor=r)}return I(this,Ty,jb).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=c(this,or)??c(this,pi))==null||e.focus()},0)}onUpdatedColor(){if(!c(this,or))return;const e=c(this,Bt).commentButtonColor;e&&(c(this,or).style.backgroundColor=e),c(this,Bt)._uiManager.updatePopupColor(c(this,Bt))}get commentButtonWidth(){var e;return(((e=c(this,or))==null?void 0:e.getBoundingClientRect().width)??0)/c(this,Bt).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(c(this,Rd))return c(this,Rd);if(!c(this,or))return null;const{x:e,y:t,height:n}=c(this,or).getBoundingClientRect(),{x:r,y:i,width:o,height:u}=c(this,Bt).parent.boundingClientRect;return[(e-r)/o,(t+n-i)/u]}set commentPopupPositionInLayer(e){x(this,Rd,e)}hasDefaultPopupPosition(){return c(this,Rd)===null}removeStandaloneCommentButton(){var e;(e=c(this,or))==null||e.remove(),x(this,or,null)}removeToolbarCommentButton(){var e;(e=c(this,pi))==null||e.remove(),x(this,pi,null)}setCommentButtonStates({selected:e,hasPopup:t}){c(this,or)&&(c(this,or).classList.toggle("selected",e),c(this,or).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let n,r;if(t)[n,r]=t;else{[n,r]=c(this,Bt).commentButtonPosition;const{width:f,height:g,x:w,y:A}=c(this,Bt);n=w+n*f,r=A+r*g}const i=c(this,Bt).parent.boundingClientRect,{x:o,y:u,width:d,height:h}=i;c(this,Bt)._uiManager.editComment(c(this,Bt),o+n*d,u+r*h,{...e,parentDimensions:i})}finish(){c(this,pi)&&(c(this,pi).focus({focusVisible:c(this,Pd)}),x(this,Pd,!1))}isDeleted(){return c(this,$c)||c(this,fi)===""}isEmpty(){return c(this,fi)===null}hasBeenEdited(){return this.isDeleted()||c(this,fi)!==c(this,Sy)}serialize(){return this.data}get data(){return{text:c(this,fi),richText:c(this,Uc),date:c(this,jc),deleted:this.isDeleted()}}set data(e){if(e!==c(this,fi)&&x(this,Uc,null),e===null){x(this,fi,""),x(this,$c,!0);return}x(this,fi,e),x(this,jc,new Date),x(this,$c,!1)}restoreData({text:e,richText:t,date:n}){x(this,fi,e),x(this,Uc,t),x(this,jc,n),x(this,$c,!1)}setInitialText(e,t=null){x(this,Sy,e),this.data=e,x(this,jc,null),x(this,Uc,t)}shown(){}destroy(){var e,t;(e=c(this,pi))==null||e.remove(),x(this,pi,null),(t=c(this,or))==null||t.remove(),x(this,or,null),x(this,fi,""),x(this,Uc,null),x(this,jc,null),x(this,Bt,null),x(this,Pd,!1),x(this,$c,!1)}}or=new WeakMap,pi=new WeakMap,Pd=new WeakMap,Bt=new WeakMap,Sy=new WeakMap,Uc=new WeakMap,fi=new WeakMap,jc=new WeakMap,$c=new WeakMap,Rd=new WeakMap,Ty=new WeakSet,jb=function(e,t){if(!c(this,Bt)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[c(this,Bt)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const n=c(this,Bt)._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return e;e.addEventListener("contextmenu",Fi,{signal:n}),t&&(e.addEventListener("focusin",i=>{c(this,Bt)._focusEventsAllowed=!1,fn(i)},{capture:!0,signal:n}),e.addEventListener("focusout",i=>{c(this,Bt)._focusEventsAllowed=!0,fn(i)},{capture:!0,signal:n})),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:n});const r=i=>{i.preventDefault(),e===c(this,pi)?this.edit():c(this,Bt).toggleComment(!0)};return e.addEventListener("click",r,{capture:!0,signal:n}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(x(this,Pd,!0),r(i))},{signal:n}),e.addEventListener("pointerenter",()=>{c(this,Bt).toggleComment(!1,!0)},{signal:n}),e.addEventListener("pointerleave",()=>{c(this,Bt).toggleComment(!1,!1)},{signal:n}),e};var Lf,Dd,ky,Iy,Py,Ry,Dy,Wo,Nd,Go,Md,qo,Mu,mM,gM,yM;const PS=class PS{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:r=null,onPinching:i=null,onPinchEnd:o=null,signal:u}){T(this,Mu);T(this,Lf);T(this,Dd,!1);T(this,ky,null);T(this,Iy);T(this,Py);T(this,Ry);T(this,Dy);T(this,Wo,null);T(this,Nd);T(this,Go,null);T(this,Md);T(this,qo,null);x(this,Lf,e),x(this,ky,n),x(this,Iy,t),x(this,Py,r),x(this,Ry,i),x(this,Dy,o),x(this,Md,new AbortController),x(this,Nd,AbortSignal.any([u,c(this,Md).signal])),e.addEventListener("touchstart",I(this,Mu,mM).bind(this),{passive:!1,signal:c(this,Nd)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/ho.pixelRatio}destroy(){var e,t;(e=c(this,Md))==null||e.abort(),x(this,Md,null),(t=c(this,Wo))==null||t.abort(),x(this,Wo,null)}};Lf=new WeakMap,Dd=new WeakMap,ky=new WeakMap,Iy=new WeakMap,Py=new WeakMap,Ry=new WeakMap,Dy=new WeakMap,Wo=new WeakMap,Nd=new WeakMap,Go=new WeakMap,Md=new WeakMap,qo=new WeakMap,Mu=new WeakSet,mM=function(e){var r,i,o;if((r=c(this,Iy))!=null&&r.call(this))return;if(e.touches.length===1){if(c(this,Wo))return;const u=x(this,Wo,new AbortController),d=AbortSignal.any([c(this,Nd),u.signal]),h=c(this,Lf),f={capture:!0,signal:d,passive:!1},g=w=>{var A;w.pointerType==="touch"&&((A=c(this,Wo))==null||A.abort(),x(this,Wo,null))};h.addEventListener("pointerdown",w=>{w.pointerType==="touch"&&(fn(w),g(w))},f),h.addEventListener("pointerup",g,f),h.addEventListener("pointercancel",g,f);return}if(!c(this,qo)){x(this,qo,new AbortController);const u=AbortSignal.any([c(this,Nd),c(this,qo).signal]),d=c(this,Lf),h={signal:u,capture:!1,passive:!1};d.addEventListener("touchmove",I(this,Mu,gM).bind(this),h);const f=I(this,Mu,yM).bind(this);d.addEventListener("touchend",f,h),d.addEventListener("touchcancel",f,h),h.capture=!0,d.addEventListener("pointerdown",fn,h),d.addEventListener("pointermove",fn,h),d.addEventListener("pointercancel",fn,h),d.addEventListener("pointerup",fn,h),(i=c(this,Py))==null||i.call(this)}if(fn(e),e.touches.length!==2||(o=c(this,ky))!=null&&o.call(this)){x(this,Go,null);return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),x(this,Go,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY})},gM=function(e){var V;if(!c(this,Go)||e.touches.length!==2)return;fn(e);let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:r,screenY:i}=t,{screenX:o,screenY:u}=n,d=c(this,Go),{touch0X:h,touch0Y:f,touch1X:g,touch1Y:w}=d,A=g-h,F=w-f,C=o-r,S=u-i,P=Math.hypot(C,S)||1,O=Math.hypot(A,F)||1;if(!c(this,Dd)&&Math.abs(O-P)<=PS.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(d.touch0X=r,d.touch0Y=i,d.touch1X=o,d.touch1Y=u,!c(this,Dd)){x(this,Dd,!0);return}const N=[(r+o)/2,(i+u)/2];(V=c(this,Ry))==null||V.call(this,N,O,P)},yM=function(e){var t;e.touches.length>=2||(c(this,qo)&&(c(this,qo).abort(),x(this,qo,null),(t=c(this,Dy))==null||t.call(this)),c(this,Go)&&(fn(e),x(this,Go,null),x(this,Dd,!1)))};let I_=PS;var Ld,ji,Kt,Ct,Qo,Of,zc,Ny,lr,Od,Ko,mi,Hc,My,Bd,Fs,Ly,Vd,Xo,Ba,Bf,Vf,gi,Ud,Oy,W_,Ue,$b,By,zb,IA,wM,vM,Hb,PA,Wb,AM,_M,xM,Gb,EM,qb,bM,CM,FM,Qb,Cg;const Ke=class Ke{constructor(e){T(this,Ue);T(this,Ld,null);T(this,ji,null);T(this,Kt,null);T(this,Ct,null);T(this,Qo,null);T(this,Of,!1);T(this,zc,null);T(this,Ny,"");T(this,lr,null);T(this,Od,null);T(this,Ko,null);T(this,mi,null);T(this,Hc,null);T(this,My,"");T(this,Bd,!1);T(this,Fs,null);T(this,Ly,!1);T(this,Vd,!1);T(this,Xo,!1);T(this,Ba,null);T(this,Bf,0);T(this,Vf,0);T(this,gi,null);T(this,Ud,null);re(this,"isSelected",!1);re(this,"_isCopy",!1);re(this,"_editToolbar",null);re(this,"_initialOptions",Object.create(null));re(this,"_initialData",null);re(this,"_isVisible",!0);re(this,"_uiManager",null);re(this,"_focusEventsAllowed",!0);T(this,Oy,!1);T(this,W_,Ke._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:n,pageHeight:r,pageX:i,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,r],this.pageTranslation=[i,o];const[u,d]=this.parentDimensions;this.x=e.x/u,this.y=e.y/d,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=Ke.prototype._resizeWithKeyboard,t=Qh.TRANSLATE_SMALL,n=Qh.TRANSLATE_BIG;return qe(this,"_resizerKeyboardManager",new k0([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],Ke.prototype._stopResizingWithKeyboard]]))}updatePageIndex(e){this.pageIndex=e}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return qe(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new PW({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Ke._l10n??(Ke._l10n=e),Ke._l10nResizer||(Ke._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Ke._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Ke._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){At("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return c(this,Oy)}set _isDraggable(e){var t;x(this,Oy,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=c(this,W_)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(I(this,Ue,Cg).call(this),(t=c(this,mi))==null||t.remove(),x(this,mi,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(c(this,Bd)?x(this,Bd,!1):this.parent.setSelected(this))}focusout(e){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,r){const[i,o]=this.parentDimensions;[n,r]=this.screenToPageTranslation(n,r),this.x=(e+n)/i,this.y=(t+r)/o,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,r]=this.parentDimensions;this.setAt(e*n,t*r,this.width*n,this.height*r),this._onTranslated()}translate(e,t){I(this,Ue,$b).call(this,this.parentDimensions,e,t)}translateInPage(e,t){c(this,Fs)||x(this,Fs,[this.x,this.y,this.width,this.height]),I(this,Ue,$b).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){c(this,Fs)||x(this,Fs,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[r,i]}=this;if(this.x+=e/r,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:g,y:w}=this.div.getBoundingClientRect();this.parent.findNewParent(this,g,w)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:u}=this;const[d,h]=this.getBaseTranslation();o+=d,u+=h;const{style:f}=n;f.left=`${(100*o).toFixed(2)}%`,f.top=`${(100*u).toFixed(2)}%`,this._onTranslating(o,u),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!c(this,Fs)&&(c(this,Fs)[0]!==this.x||c(this,Fs)[1]!==this.y)}get _hasBeenResized(){return!!c(this,Fs)&&(c(this,Fs)[2]!==this.width||c(this,Fs)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=Ke,r=n/e,i=n/t;switch(this.rotation){case 90:return[-r,i];case 180:return[r,i];case 270:return[r,-i];default:return[-r,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,r]}=this;let{x:i,y:o,width:u,height:d}=this;if(u*=n,d*=r,i*=n,o*=r,this._mustFixPosition)switch(e){case 0:i=hr(i,0,n-u),o=hr(o,0,r-d);break;case 90:i=hr(i,0,n-d),o=hr(o,u,r);break;case 180:i=hr(i,u,n),o=hr(o,d,r);break;case 270:i=hr(i,d,n),o=hr(o,0,r-u);break}this.x=i/=n,this.y=o/=r;const[h,f]=this.getBaseTranslation();i+=h,o+=f,t.left=`${(100*i).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var n;return I(n=Ke,By,zb).call(n,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var n;return I(n=Ke,By,zb).call(n,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(){const{div:{style:e},width:t,height:n}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*n).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=c(this,Kt))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||c(this,Vd))return this._editToolbar;this._editToolbar=new Db(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=c(this,Kt))==null||t.destroy()}addContainer(e){var n;const t=(n=this._editToolbar)==null?void 0:n.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return c(this,Kt)||(k_.initialize(Ke._l10n),x(this,Kt,new k_(this)),c(this,Ld)&&(c(this,Kt).data=c(this,Ld),x(this,Ld,null))),c(this,Kt)}get altTextData(){var e;return(e=c(this,Kt))==null?void 0:e.data}set altTextData(e){c(this,Kt)&&(c(this,Kt).data=e)}get guessedAltText(){var e;return(e=c(this,Kt))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=c(this,Kt))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=c(this,Kt))==null?void 0:t.serialize(e)}hasAltText(){return!!c(this,Kt)&&!c(this,Kt).isEmpty()}hasAltTextData(){var e;return((e=c(this,Kt))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=c(this,Ct))==null||e.focusButton()}addCommentButton(){return this.canAddComment?c(this,Ct)||x(this,Ct,new rA(this)):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(c(this,Qo)){this._uiManager.isEditingMode()&&c(this,Qo).classList.remove("hidden");return}this.hasComment&&(x(this,Qo,c(this,Ct).renderForStandalone()),this.div.append(c(this,Qo)))}}removeStandaloneCommentButton(){c(this,Ct).removeStandaloneCommentButton(),x(this,Qo,null)}hideStandaloneCommentButton(){var e;(e=c(this,Qo))==null||e.classList.add("hidden")}get comment(){if(!c(this,Ct))return null;const{data:{richText:e,text:t,date:n,deleted:r}}=c(this,Ct);return{text:t,richText:e,date:n,deleted:r,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){c(this,Ct)||x(this,Ct,new rA(this)),typeof e=="object"&&e!==null?c(this,Ct).restoreData(e):c(this,Ct).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:n}){if(!t||(c(this,Ct)||x(this,Ct,new rA(this)),c(this,Ct).setInitialText(e,n),!this.annotationElementId))return;const r=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);r&&this.updateFromAnnotationLayer(r)}get hasEditedComment(){var e;return(e=c(this,Ct))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=c(this,Ct))==null?void 0:e.isDeleted()}get hasComment(){return!!c(this,Ct)&&!c(this,Ct).isEmpty()&&!c(this,Ct).isDeleted()}async editComment(e){c(this,Ct)||x(this,Ct,new rA(this)),c(this,Ct).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){c(this,Ct).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,r]=e.rect,[i]=this.pageDimensions,[o]=this.pageTranslation,u=o+i+1,d=r-100,h=u+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,d,h,r]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){c(this,Ct).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var o;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=c(this,Of)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),I(this,Ue,qb).call(this);const[t,n]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*n/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/n).toFixed(2)}%`);const[r,i]=this.getInitialTranslation();return this.translate(r,i),tM(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(c(this,Ud)||x(this,Ud,new I_({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:I(this,Ue,AM).bind(this),onPinching:I(this,Ue,_M).bind(this),onPinchEnd:I(this,Ue,xM).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(o=this._uiManager._editorUndoBar)==null||o.hide(),e}pointerdown(e){const{isMac:t}=Hn.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(x(this,Bd,!0),this._isDraggable){I(this,Ue,EM).call(this,e);return}I(this,Ue,Gb).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){c(this,Ba)&&clearTimeout(c(this,Ba)),x(this,Ba,setTimeout(()=>{var e;x(this,Ba,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const r=this.parentScale,[i,o]=this.pageDimensions,[u,d]=this.pageTranslation,h=e/r,f=t/r,g=this.x*i,w=this.y*o,A=this.width*i,F=this.height*o;switch(n){case 0:return[g+h+u,o-w-f-F+d,g+h+A+u,o-w-f+d];case 90:return[g+f+u,o-w+h+d,g+f+F+u,o-w+h+A+d];case 180:return[g-h-A+u,o-w+f+d,g-h+u,o-w+f+F+d];case 270:return[g-f-F+u,o-w-h-A+d,g-f+u,o-w-h+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,r,i,o]=e,u=i-n,d=o-r;switch(this.rotation){case 0:return[n,t-o,u,d];case 90:return[n,t-r,d,u];case 180:return[i,t-r,u,d];case 270:return[i,t-o,d,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Ke._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=c(this,Ct))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:n,opacity:r,deleted:i,richText:o},uid:u,pageIndex:d,creationDate:h,modificationDate:f}=this;return{id:u,pageIndex:d,rect:this.getPDFRect(),richText:o,contentsObj:{str:e},creationDate:h,modificationDate:n||f,popupRef:!i,color:t,opacity:r}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),x(this,Vd,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),x(this,Vd,!1),!0):!1}isInEditMode(){return c(this,Vd)}shouldGetKeyboardEvents(){return c(this,Xo)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:r}=this.getClientDimensions(),{innerHeight:i,innerWidth:o}=window;return t<o&&r>0&&e<i&&n>0}rebuild(){I(this,Ue,qb).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var n;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((n=this._initialData)==null?void 0:n.popupRef)||""}}static async deserialize(e,t,n){const r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});r.rotation=e.rotation,x(r,Ld,e.accessibilityData),r._isCopy=e.isCopy||!1;const[i,o]=r.pageDimensions,[u,d,h,f]=r.getRectInCurrentCoords(e.rect,o);return r.x=u/i,r.y=d/o,r.width=h/i,r.height=f/o,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t,n;if((e=c(this,Hc))==null||e.abort(),x(this,Hc,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),c(this,Ba)&&(clearTimeout(c(this,Ba)),x(this,Ba,null)),I(this,Ue,Cg).call(this),this.removeEditToolbar(),c(this,gi)){for(const r of c(this,gi).values())clearTimeout(r);x(this,gi,null)}this.parent=null,(t=c(this,Ud))==null||t.destroy(),x(this,Ud,null),(n=c(this,mi))==null||n.remove(),x(this,mi,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(I(this,Ue,wM).call(this),c(this,lr).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[n,r,i,o]=this.getPDFRect();return[Ke._round(n+(i-n)*e),Ke._round(r+(o-r)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return c(this,Ct).commentPopupPositionInLayer}set commentPopupPosition(e){c(this,Ct).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return c(this,Ct).hasDefaultPopupPosition()}get commentButtonWidth(){return c(this,Ct).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){var t;(t=c(this,Ct))==null||t.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),x(this,Ko,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=c(this,lr).children;if(!c(this,ji)){x(this,ji,Array.from(t));const o=I(this,Ue,bM).bind(this),u=I(this,Ue,CM).bind(this),d=this._uiManager._signal;for(const h of c(this,ji)){const f=h.getAttribute("data-resizer-name");h.setAttribute("role","spinbutton"),h.addEventListener("keydown",o,{signal:d}),h.addEventListener("blur",u,{signal:d}),h.addEventListener("focus",I(this,Ue,FM).bind(this,f),{signal:d}),h.setAttribute("data-l10n-id",Ke._l10nResizer[f])}}const n=c(this,ji)[0];let r=0;for(const o of t){if(o===n)break;r++}const i=(360-this.rotation+this.parentRotation)%360/90*(c(this,ji).length/4);if(i!==r){if(i<r)for(let u=0;u<r-i;u++)c(this,lr).append(c(this,lr).firstElementChild);else if(i>r)for(let u=0;u<i-r;u++)c(this,lr).firstElementChild.before(c(this,lr).lastElementChild);let o=0;for(const u of t){const h=c(this,ji)[o++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",Ke._l10nResizer[h])}}I(this,Ue,Qb).call(this,0),x(this,Xo,!0),c(this,lr).firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){c(this,Xo)&&I(this,Ue,Wb).call(this,c(this,My),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){I(this,Ue,Cg).call(this),this.div.focus()}select(){var e,t,n;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var r,i;(r=this.div)!=null&&r.classList.contains("selectedEditor")&&((i=this._editToolbar)==null||i.show())});return}(t=this._editToolbar)==null||t.show(),(n=c(this,Kt))==null||n.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,n,r,i;this.isSelected&&(this.isSelected=!1,(e=c(this,lr))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(r=this._editToolbar)==null||r.hide(),(i=c(this,Kt))==null||i.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return c(this,Ly)}set isEditing(e){x(this,Ly,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){c(this,gi)||x(this,gi,new Map);const{action:n}=e;let r=c(this,gi).get(n);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(e),c(this,gi).delete(n),c(this,gi).size===0&&x(this,gi,null)},Ke._telemetryTimeout),c(this,gi).set(n,r);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),x(this,Of,!1)}disable(){this.div&&(this.div.tabIndex=-1),x(this,Of,!0)}updateFakeAnnotationElement(e){if(!c(this,mi)&&!this.deleted){x(this,mi,e.addFakeAnnotation(this));return}if(this.deleted){c(this,mi).remove(),x(this,mi,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&c(this,mi).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Ld=new WeakMap,ji=new WeakMap,Kt=new WeakMap,Ct=new WeakMap,Qo=new WeakMap,Of=new WeakMap,zc=new WeakMap,Ny=new WeakMap,lr=new WeakMap,Od=new WeakMap,Ko=new WeakMap,mi=new WeakMap,Hc=new WeakMap,My=new WeakMap,Bd=new WeakMap,Fs=new WeakMap,Ly=new WeakMap,Vd=new WeakMap,Xo=new WeakMap,Ba=new WeakMap,Bf=new WeakMap,Vf=new WeakMap,gi=new WeakMap,Ud=new WeakMap,Oy=new WeakMap,W_=new WeakMap,Ue=new WeakSet,$b=function([e,t],n,r){[n,r]=this.screenToPageTranslation(n,r),this.x+=n/e,this.y+=r/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},By=new WeakSet,zb=function(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},IA=function(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}},wM=function(){if(c(this,lr))return;x(this,lr,document.createElement("div")),c(this,lr).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const r=document.createElement("div");c(this,lr).append(r),r.classList.add("resizer",n),r.setAttribute("data-resizer-name",n),r.addEventListener("pointerdown",I(this,Ue,vM).bind(this,n),{signal:t}),r.addEventListener("contextmenu",Fi,{signal:t}),r.tabIndex=-1}this.div.prepend(c(this,lr))},vM=function(e,t){var f;t.preventDefault();const{isMac:n}=Hn.platform;if(t.button!==0||t.ctrlKey&&n)return;(f=c(this,Kt))==null||f.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,x(this,Od,[t.screenX,t.screenY]);const i=new AbortController,o=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",I(this,Ue,Wb).bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",fn,{passive:!1,signal:o}),window.addEventListener("contextmenu",Fi,{signal:o}),x(this,Ko,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const u=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const h=()=>{var g;i.abort(),this.parent.togglePointerEvents(!0),(g=c(this,Kt))==null||g.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=u,this.div.style.cursor=d,I(this,Ue,PA).call(this)};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})},Hb=function(e,t,n,r){this.width=n,this.height=r,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},PA=function(){if(!c(this,Ko))return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:r}=c(this,Ko);x(this,Ko,null);const i=this.x,o=this.y,u=this.width,d=this.height;i===e&&o===t&&u===n&&d===r||this.addCommands({cmd:I(this,Ue,Hb).bind(this,i,o,u,d),undo:I(this,Ue,Hb).bind(this,e,t,n,r),mustExec:!0})},Wb=function(e,t){const[n,r]=this.parentDimensions,i=this.x,o=this.y,u=this.width,d=this.height,h=Ke.MIN_SIZE/n,f=Ke.MIN_SIZE/r,g=I(this,Ue,IA).call(this,this.rotation),w=(ye,pe)=>[g[0]*ye+g[2]*pe,g[1]*ye+g[3]*pe],A=I(this,Ue,IA).call(this,360-this.rotation),F=(ye,pe)=>[A[0]*ye+A[2]*pe,A[1]*ye+A[3]*pe];let C,S,P=!1,O=!1;switch(e){case"topLeft":P=!0,C=(ye,pe)=>[0,0],S=(ye,pe)=>[ye,pe];break;case"topMiddle":C=(ye,pe)=>[ye/2,0],S=(ye,pe)=>[ye/2,pe];break;case"topRight":P=!0,C=(ye,pe)=>[ye,0],S=(ye,pe)=>[0,pe];break;case"middleRight":O=!0,C=(ye,pe)=>[ye,pe/2],S=(ye,pe)=>[0,pe/2];break;case"bottomRight":P=!0,C=(ye,pe)=>[ye,pe],S=(ye,pe)=>[0,0];break;case"bottomMiddle":C=(ye,pe)=>[ye/2,pe],S=(ye,pe)=>[ye/2,0];break;case"bottomLeft":P=!0,C=(ye,pe)=>[0,pe],S=(ye,pe)=>[ye,0];break;case"middleLeft":O=!0,C=(ye,pe)=>[0,pe/2],S=(ye,pe)=>[ye,pe/2];break}const N=C(u,d),V=S(u,d);let z=w(...V);const H=Ke._round(i+z[0]),R=Ke._round(o+z[1]);let D=1,L=1,U,j;if(t.fromKeyboard)({deltaX:U,deltaY:j}=t);else{const{screenX:ye,screenY:pe}=t,[ie,we]=c(this,Od);[U,j]=this.screenToPageTranslation(ye-ie,pe-we),c(this,Od)[0]=ye,c(this,Od)[1]=pe}if([U,j]=F(U/n,j/r),P){const ye=Math.hypot(u,d);D=L=Math.max(Math.min(Math.hypot(V[0]-N[0]-U,V[1]-N[1]-j)/ye,1/u,1/d),h/u,f/d)}else O?D=hr(Math.abs(V[0]-N[0]-U),h,1)/u:L=hr(Math.abs(V[1]-N[1]-j),f,1)/d;const G=Ke._round(u*D),$=Ke._round(d*L);z=w(...S(G,$));const ge=H-z[0],xe=R-z[1];c(this,Fs)||x(this,Fs,[this.x,this.y,this.width,this.height]),this.width=G,this.height=$,this.x=ge,this.y=xe,this.setDims(),this.fixAndSetPosition(),this._onResizing()},AM=function(){var e;x(this,Ko,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=c(this,Kt))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},_M=function(e,t,n){let i=.7*(n/t)+1-.7;if(i===1)return;const o=I(this,Ue,IA).call(this,this.rotation),u=(H,R)=>[o[0]*H+o[2]*R,o[1]*H+o[3]*R],[d,h]=this.parentDimensions,f=this.x,g=this.y,w=this.width,A=this.height,F=Ke.MIN_SIZE/d,C=Ke.MIN_SIZE/h;i=Math.max(Math.min(i,1/w,1/A),F/w,C/A);const S=Ke._round(w*i),P=Ke._round(A*i);if(S===w&&P===A)return;c(this,Fs)||x(this,Fs,[f,g,w,A]);const O=u(w/2,A/2),N=Ke._round(f+O[0]),V=Ke._round(g+O[1]),z=u(S/2,P/2);this.x=N-z[0],this.y=V-z[1],this.width=S,this.height=P,this.setDims(),this.fixAndSetPosition(),this._onResizing()},xM=function(){var e;(e=c(this,Kt))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),I(this,Ue,PA).call(this)},Gb=function(e){const{isMac:t}=Hn.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},EM=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const r=new AbortController,i=this._uiManager.combinedSignal(r),o={capture:!0,passive:!1,signal:i},u=h=>{r.abort(),x(this,zc,null),x(this,Bd,!1),this._uiManager.endDragSession()||I(this,Ue,Gb).call(this,h),n&&this._onStopDragging()};t&&(x(this,Bf,e.clientX),x(this,Vf,e.clientY),x(this,zc,e.pointerId),x(this,Ny,e.pointerType),window.addEventListener("pointermove",h=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:f,clientY:g,pointerId:w}=h;if(w!==c(this,zc)){fn(h);return}const[A,F]=this.screenToPageTranslation(f-c(this,Bf),g-c(this,Vf));x(this,Bf,f),x(this,Vf,g),this._uiManager.dragSelectedEditors(A,F)},o),window.addEventListener("touchmove",fn,o),window.addEventListener("pointerdown",h=>{h.pointerType===c(this,Ny)&&(c(this,Ud)||h.isPrimary)&&u(h),fn(h)},o));const d=h=>{if(!c(this,zc)||c(this,zc)===h.pointerId){u(h);return}fn(h)};window.addEventListener("pointerup",d,{signal:i}),window.addEventListener("blur",d,{signal:i})},qb=function(){if(c(this,Hc)||!this.div)return;x(this,Hc,new AbortController);const e=this._uiManager.combinedSignal(c(this,Hc));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},bM=function(e){Ke._resizerKeyboardManager.exec(this,e)},CM=function(e){var t;c(this,Xo)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==c(this,lr)&&I(this,Ue,Cg).call(this)},FM=function(e){x(this,My,c(this,Xo)?e:"")},Qb=function(e){if(c(this,ji))for(const t of c(this,ji))t.tabIndex=e},Cg=function(){x(this,Xo,!1),I(this,Ue,Qb).call(this,-1),I(this,Ue,PA).call(this)},T(Ke,By),re(Ke,"_l10n",null),re(Ke,"_l10nResizer",null),re(Ke,"_borderLineWidth",-1),re(Ke,"_colorManager",new Lb),re(Ke,"_zIndex",1),re(Ke,"_telemetryTimeout",1e3);let Ut=Ke;class PW extends Ut{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const iR=3285377520,ii=4294901760,Sa=65535;class SM{constructor(e){this.h1=e?e&4294967295:iR,this.h2=e?e&4294967295:iR}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let C=0,S=e.length;C<S;C++){const P=e.charCodeAt(C);P<=255?t[n++]=P:(t[n++]=P>>>8,t[n++]=P&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=n>>2,i=n-r*4,o=new Uint32Array(t.buffer,0,r);let u=0,d=0,h=this.h1,f=this.h2;const g=3432918353,w=461845907,A=g&Sa,F=w&Sa;for(let C=0;C<r;C++)C&1?(u=o[C],u=u*g&ii|u*A&Sa,u=u<<15|u>>>17,u=u*w&ii|u*F&Sa,h^=u,h=h<<13|h>>>19,h=h*5+3864292196):(d=o[C],d=d*g&ii|d*A&Sa,d=d<<15|d>>>17,d=d*w&ii|d*F&Sa,f^=d,f=f<<13|f>>>19,f=f*5+3864292196);switch(u=0,i){case 3:u^=t[r*4+2]<<16;case 2:u^=t[r*4+1]<<8;case 1:u^=t[r*4],u=u*g&ii|u*A&Sa,u=u<<15|u>>>17,u=u*w&ii|u*F&Sa,r&1?h^=u:f^=u}this.h1=h,this.h2=f}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&ii|e*36045&Sa,t=t*4283543511&ii|((t<<16|e>>>16)*2950163797&ii)>>>16,e^=t>>>1,e=e*444984403&ii|e*60499&Sa,t=t*3301882366&ii|((t<<16|e>>>16)*3120437893&ii)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Kb=Object.freeze({map:null,hash:"",transfer:void 0});var jd,$d,Yo,cr,G_,TM;class xS{constructor(){T(this,G_);T(this,jd,!1);T(this,$d,null);T(this,Yo,null);T(this,cr,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=c(this,cr).get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return c(this,cr).get(e)}remove(e){const t=c(this,cr).get(e);if(t!==void 0&&(t instanceof Ut&&c(this,Yo).delete(t.annotationElementId),c(this,cr).delete(e),c(this,cr).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const n of c(this,cr).values())if(n instanceof Ut)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=c(this,cr).get(e);let r=!1;if(n!==void 0)for(const[i,o]of Object.entries(t))n[i]!==o&&(r=!0,n[i]=o);else r=!0,c(this,cr).set(e,t);r&&I(this,G_,TM).call(this),t instanceof Ut&&((c(this,Yo)||x(this,Yo,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return c(this,cr).has(e)}get size(){return c(this,cr).size}resetModified(){c(this,jd)&&(x(this,jd,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new kM(this)}get serializable(){if(c(this,cr).size===0)return Kb;const e=new Map,t=new SM,n=[],r=Object.create(null);let i=!1;for(const[o,u]of c(this,cr)){const d=u instanceof Ut?u.serialize(!1,r):u;u.page&&(u.pageIndex=u.page._pageIndex,delete u.page),d&&(e.set(o,d),t.update(`${o}:${JSON.stringify(d)}`),i||(i=!!d.bitmap))}if(i)for(const o of e.values())o.bitmap&&n.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:Kb}get editorStats(){let e=null;const t=new Map;let n=0,r=0;for(const i of c(this,cr).values()){if(!(i instanceof Ut)){i.popup&&(i.popup.deleted?r+=1:n+=1);continue}i.isCommentDeleted?r+=1:i.hasEditedComment&&(n+=1);const o=i.telemetryFinalData;if(!o)continue;const{type:u}=o;t.has(u)||t.set(u,Object.getPrototypeOf(i).constructor),e||(e=Object.create(null));const d=e[u]||(e[u]=new Map);for(const[h,f]of Object.entries(o)){if(h==="type")continue;let g=d.get(h);g||(g=new Map,d.set(h,g));const w=g.get(f)??0;g.set(f,w+1)}}if((r>0||n>0)&&(e||(e=Object.create(null)),e.comments={deleted:r,edited:n}),!e)return null;for(const[i,o]of t)e[i]=o.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){x(this,$d,null)}updateEditor(e,t){var r;const n=(r=c(this,Yo))==null?void 0:r.get(e);return n?(n.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=c(this,Yo))==null?void 0:t.get(e))||null}get modifiedIds(){if(c(this,$d))return c(this,$d);const e=[];if(c(this,Yo))for(const t of c(this,Yo).values())t.serialize()&&e.push(t.annotationElementId);return x(this,$d,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return c(this,cr).entries()}}jd=new WeakMap,$d=new WeakMap,Yo=new WeakMap,cr=new WeakMap,G_=new WeakSet,TM=function(){c(this,jd)||(x(this,jd,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Vy;class kM extends xS{constructor(t){super();T(this,Vy);const{map:n,hash:r,transfer:i}=t.serializable,o=structuredClone(n,i?{transfer:i}:null);x(this,Vy,{map:o,hash:r,transfer:i})}get print(){At("Should not call PrintAnnotationStorage.print")}get serializable(){return c(this,Vy)}get modifiedIds(){return qe(this,"modifiedIds",{ids:new Set,hash:""})}}Vy=new WeakMap;var Uf;class RW{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){T(this,Uf,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),c(this,Uf).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:n}){if(!(!e||c(this,Uf).has(e.loadedName))){if(vt(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:i,style:o}=e,u=new FontFace(r,i,o);this.addNativeFontFace(u);try{await u.load(),c(this,Uf).add(r),n==null||n(e)}catch{Ge(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}At("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(r){throw Ge(`Failed to load font '${n.family}': '${r}'.`),e.disableFontFace=!0,r}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const r=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,r)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return qe(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return qe(this,"isSyncFontLoadingSupported",Hr||Hn.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(vt(!r.done,"completeRequest() cannot be called twice."),r.done=!0;n.length>0&&n[0].done;){const i=n.shift();setTimeout(i.callback,0)}}const{loadingRequests:n}=this,r={done:!1,complete:t,callback:e};return n.push(r),r}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return qe(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(V,z){return V.charCodeAt(z)<<24|V.charCodeAt(z+1)<<16|V.charCodeAt(z+2)<<8|V.charCodeAt(z+3)&255}function r(V,z,H,R){const D=V.substring(0,z),L=V.substring(z+H);return D+R+L}let i,o;const u=this._document.createElement("canvas");u.width=1,u.height=1;const d=u.getContext("2d");let h=0;function f(V,z){if(++h>30){Ge("Load test font never loaded."),z();return}if(d.font="30px "+V,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){z();return}setTimeout(f.bind(null,V,z))}const g=`lt${Date.now()}${this.loadTestFontId++}`;let w=this._loadTestFont;w=r(w,976,g.length,g);const F=16,C=1482184792;let S=n(w,F);for(i=0,o=g.length-3;i<o;i+=4)S=S-C+n(g,i)|0;i<g.length&&(S=S-C+n(g+"XXX",i)|0),w=r(w,F,4,pW(S));const P=`url(data:font/opentype;base64,${btoa(w)});`,O=`@font-face {font-family:"${g}";src:${P}}`;this.insertRule(O);const N=this._document.createElement("div");N.style.visibility="hidden",N.style.width=N.style.height="10px",N.style.position="absolute",N.style.top=N.style.left="0px";for(const V of[e.loadedName,g]){const z=this._document.createElement("span");z.textContent="Hi",z.style.fontFamily=V,N.append(z)}this._document.body.append(N),f(g,()=>{N.remove(),t.complete()})}}Uf=new WeakMap;var Tt;class DW{constructor(e,t=null,n,r){T(this,Tt);this.compiledGlyphs=Object.create(null),x(this,Tt,e),this._inspectFont=t,n&&Object.assign(this,n),r&&(this.charProcOperatorList=r)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${this.data.toBase64()});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let r=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(r+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${r}src:${e}}`}return(n=this._inspectFont)==null||n.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let r;try{r=e.get(n)}catch(o){Ge(`getPathGenerator - ignoring character: "${o}".`)}const i=qN(r==null?void 0:r.path);return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=i}get black(){return c(this,Tt).black}get bold(){return c(this,Tt).bold}get disableFontFace(){return c(this,Tt).disableFontFace??!1}set disableFontFace(e){qe(this,"disableFontFace",!!e)}get fontExtraProperties(){return c(this,Tt).fontExtraProperties??!1}get isInvalidPDFjsFont(){return c(this,Tt).isInvalidPDFjsFont}get isType3Font(){return c(this,Tt).isType3Font}get italic(){return c(this,Tt).italic}get missingFile(){return c(this,Tt).missingFile}get remeasure(){return c(this,Tt).remeasure}get vertical(){return c(this,Tt).vertical}get ascent(){return c(this,Tt).ascent}get defaultWidth(){return c(this,Tt).defaultWidth}get descent(){return c(this,Tt).descent}get bbox(){return c(this,Tt).bbox}set bbox(e){qe(this,"bbox",e)}get fontMatrix(){return c(this,Tt).fontMatrix}get fallbackName(){return c(this,Tt).fallbackName}get loadedName(){return c(this,Tt).loadedName}get mimetype(){return c(this,Tt).mimetype}get name(){return c(this,Tt).name}get data(){return c(this,Tt).data}clearData(){c(this,Tt).clearData()}get cssFontInfo(){return c(this,Tt).cssFontInfo}get systemFontInfo(){return c(this,Tt).systemFontInfo}get defaultVMetrics(){return c(this,Tt).defaultVMetrics}}Tt=new WeakMap;var jf,$f,Uy,zf,RA;const lf=class lf{constructor(e){T(this,zf);T(this,jf);T(this,$f);T(this,Uy);x(this,jf,e),x(this,$f,new DataView(c(this,jf))),x(this,Uy,new TextDecoder)}static write(e){const t=new TextEncoder,n={};let r=0;for(const h of lf.strings){const f=t.encode(e[h]);n[h]=f,r+=4+f.length}const i=new ArrayBuffer(r),o=new Uint8Array(i),u=new DataView(i);let d=0;for(const h of lf.strings){const f=n[h],g=f.length;u.setUint32(d,g),o.set(f,d+4),d+=4+g}return vt(d===i.byteLength,"CssFontInfo.write: Buffer overflow"),i}get fontFamily(){return I(this,zf,RA).call(this,0)}get fontWeight(){return I(this,zf,RA).call(this,1)}get italicAngle(){return I(this,zf,RA).call(this,2)}};jf=new WeakMap,$f=new WeakMap,Uy=new WeakMap,zf=new WeakSet,RA=function(e){vt(e<lf.strings.length,"Invalid string index");let t=0;for(let r=0;r<e;r++)t+=c(this,$f).getUint32(t)+4;const n=c(this,$f).getUint32(t);return c(this,Uy).decode(new Uint8Array(c(this,jf),t+4,n))},re(lf,"strings",["fontFamily","fontWeight","italicAngle"]);let P_=lf;var Wc,Va,zd,Hd,Fg;const cf=class cf{constructor(e){T(this,Hd);T(this,Wc);T(this,Va);T(this,zd);x(this,Wc,e),x(this,Va,new DataView(c(this,Wc))),x(this,zd,new TextDecoder)}static write(e){const t=new TextEncoder,n={};let r=0;for(const w of cf.strings){const A=t.encode(e[w]);n[w]=A,r+=4+A.length}r+=4;let i,o,u=1+r;e.style&&(i=t.encode(e.style.style),o=t.encode(e.style.weight),u+=4+i.length+4+o.length);const d=new ArrayBuffer(u),h=new Uint8Array(d),f=new DataView(d);let g=0;f.setUint8(g++,e.guessFallback?1:0),f.setUint32(g,0),g+=4,r=0;for(const w of cf.strings){const A=n[w],F=A.length;r+=4+F,f.setUint32(g,F),h.set(A,g+4),g+=4+F}return f.setUint32(g-r-4,r),e.style&&(f.setUint32(g,i.length),h.set(i,g+4),g+=4+i.length,f.setUint32(g,o.length),h.set(o,g+4),g+=4+o.length),vt(g<=d.byteLength,"SubstitionInfo.write: Buffer overflow"),d.transferToFixedLength(g)}get guessFallback(){return c(this,Va).getUint8(0)!==0}get css(){return I(this,Hd,Fg).call(this,0)}get loadedName(){return I(this,Hd,Fg).call(this,1)}get baseFontName(){return I(this,Hd,Fg).call(this,2)}get src(){return I(this,Hd,Fg).call(this,3)}get style(){let e=1;e+=4+c(this,Va).getUint32(e);const t=c(this,Va).getUint32(e),n=c(this,zd).decode(new Uint8Array(c(this,Wc),e+4,t));e+=4+t;const r=c(this,Va).getUint32(e),i=c(this,zd).decode(new Uint8Array(c(this,Wc),e+4,r));return{style:n,weight:i}}};Wc=new WeakMap,Va=new WeakMap,zd=new WeakMap,Hd=new WeakSet,Fg=function(e){vt(e<cf.strings.length,"Invalid string index");let t=5;for(let r=0;r<e;r++)t+=c(this,Va).getUint32(t)+4;const n=c(this,Va).getUint32(t);return c(this,zd).decode(new Uint8Array(c(this,Wc),t+4,n))},re(cf,"strings",["css","loadedName","baseFontName","src"]);let R_=cf;var Hf,Wf,Gf,qf,Ss,Ua,jy,kt,pn,Oi,DA,Sg;const Ye=class Ye{constructor({data:e,extra:t}){T(this,pn);T(this,Ua);T(this,jy);T(this,kt);x(this,Ua,e),x(this,jy,new TextDecoder),x(this,kt,new DataView(c(this,Ua))),t&&Object.assign(this,t)}get black(){return I(this,pn,Oi).call(this,0)}get bold(){return I(this,pn,Oi).call(this,1)}get disableFontFace(){return I(this,pn,Oi).call(this,2)}get fontExtraProperties(){return I(this,pn,Oi).call(this,3)}get isInvalidPDFjsFont(){return I(this,pn,Oi).call(this,4)}get isType3Font(){return I(this,pn,Oi).call(this,5)}get italic(){return I(this,pn,Oi).call(this,6)}get missingFile(){return I(this,pn,Oi).call(this,7)}get remeasure(){return I(this,pn,Oi).call(this,8)}get vertical(){return I(this,pn,Oi).call(this,9)}get ascent(){return I(this,pn,DA).call(this,0)}get defaultWidth(){return I(this,pn,DA).call(this,1)}get descent(){return I(this,pn,DA).call(this,2)}get bbox(){let e=c(Ye,Wf);if(c(this,kt).getUint8(e)===0)return;e+=1;const n=[];for(let r=0;r<4;r++)n.push(c(this,kt).getInt16(e,!0)),e+=2;return n}get fontMatrix(){let e=c(Ye,Gf);if(c(this,kt).getUint8(e)===0)return;e+=1;const n=[];for(let r=0;r<6;r++)n.push(c(this,kt).getFloat64(e,!0)),e+=8;return n}get defaultVMetrics(){let e=c(Ye,qf);if(c(this,kt).getUint8(e)===0)return;e+=1;const n=[];for(let r=0;r<3;r++)n.push(c(this,kt).getInt16(e,!0)),e+=2;return n}get fallbackName(){return I(this,pn,Sg).call(this,0)}get loadedName(){return I(this,pn,Sg).call(this,1)}get mimetype(){return I(this,pn,Sg).call(this,2)}get name(){return I(this,pn,Sg).call(this,3)}get data(){let e=c(Ye,Ss);const t=c(this,kt).getUint32(e);e+=4+t;const n=c(this,kt).getUint32(e);e+=4+n;const r=c(this,kt).getUint32(e);e+=4+r;const i=c(this,kt).getUint32(e);if(i!==0)return new Uint8Array(c(this,Ua),e+4,i)}clearData(){let e=c(Ye,Ss);const t=c(this,kt).getUint32(e);e+=4+t;const n=c(this,kt).getUint32(e);e+=4+n;const r=c(this,kt).getUint32(e);e+=4+r;const i=c(this,kt).getUint32(e);new Uint8Array(c(this,Ua),e+4,i).fill(0),c(this,kt).setUint32(e,0)}get cssFontInfo(){let e=c(Ye,Ss);const t=c(this,kt).getUint32(e);e+=4+t;const n=c(this,kt).getUint32(e);e+=4+n;const r=c(this,kt).getUint32(e);if(r===0)return null;const i=new Uint8Array(r);return i.set(new Uint8Array(c(this,Ua),e+4,r)),new P_(i.buffer)}get systemFontInfo(){let e=c(Ye,Ss);const t=c(this,kt).getUint32(e);e+=4+t;const n=c(this,kt).getUint32(e);if(n===0)return null;const r=new Uint8Array(n);return r.set(new Uint8Array(c(this,Ua),e+4,n)),new R_(r.buffer)}static write(e){const t=e.systemFontInfo?R_.write(e.systemFontInfo):null,n=e.cssFontInfo?P_.write(e.cssFontInfo):null,r=new TextEncoder,i={};let o=0;for(const C of Ye.strings)i[C]=r.encode(e[C]),o+=4+i[C].length;const u=c(Ye,Ss)+4+o+4+(t?t.byteLength:0)+4+(n?n.byteLength:0)+4+(e.data?e.data.length:0),d=new ArrayBuffer(u),h=new Uint8Array(d),f=new DataView(d);let g=0;const w=Ye.bools.length;let A=0,F=0;for(let C=0;C<w;C++){const S=e[Ye.bools[C]];A|=(S===void 0?0:S?2:1)<<F,F+=2,(F===8||C===w-1)&&(f.setUint8(g++,A),A=0,F=0)}vt(g===c(Ye,Hf),"FontInfo.write: Boolean properties offset mismatch");for(const C of Ye.numbers)f.setFloat64(g,e[C]),g+=8;if(vt(g===c(Ye,Wf),"FontInfo.write: Number properties offset mismatch"),e.bbox){f.setUint8(g++,4);for(const C of e.bbox)f.setInt16(g,C,!0),g+=2}else f.setUint8(g++,0),g+=8;if(vt(g===c(Ye,Gf),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){f.setUint8(g++,6);for(const C of e.fontMatrix)f.setFloat64(g,C,!0),g+=8}else f.setUint8(g++,0),g+=48;if(vt(g===c(Ye,qf),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){f.setUint8(g++,1);for(const C of e.defaultVMetrics)f.setInt16(g,C,!0),g+=2}else f.setUint8(g++,0),g+=6;vt(g===c(Ye,Ss),"FontInfo.write: DefaultVMetrics properties offset mismatch"),f.setUint32(c(Ye,Ss),0),g+=4;for(const C of Ye.strings){const S=i[C],P=S.length;f.setUint32(g,P),h.set(S,g+4),g+=4+P}if(f.setUint32(c(Ye,Ss),g-c(Ye,Ss)-4),!t)f.setUint32(g,0),g+=4;else{const C=t.byteLength;f.setUint32(g,C),vt(g+4+C<=d.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),h.set(new Uint8Array(t),g+4),g+=4+C}if(!n)f.setUint32(g,0),g+=4;else{const C=n.byteLength;f.setUint32(g,C),vt(g+4+C<=d.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),h.set(new Uint8Array(n),g+4),g+=4+C}return e.data===void 0?(f.setUint32(g,0),g+=4):(f.setUint32(g,e.data.length),h.set(e.data,g+4),g+=4+e.data.length),vt(g<=d.byteLength,"FontInfo.write: Buffer overflow"),d.transferToFixedLength(g)}};Hf=new WeakMap,Wf=new WeakMap,Gf=new WeakMap,qf=new WeakMap,Ss=new WeakMap,Ua=new WeakMap,jy=new WeakMap,kt=new WeakMap,pn=new WeakSet,Oi=function(e){vt(e<Ye.bools.length,"Invalid boolean index");const t=Math.floor(e/4),n=e*2%8,r=c(this,kt).getUint8(t)>>n&3;return r===0?void 0:r===2},DA=function(e){return vt(e<Ye.numbers.length,"Invalid number index"),c(this,kt).getFloat64(c(Ye,Hf)+e*8)},Sg=function(e){vt(e<Ye.strings.length,"Invalid string index");let t=c(Ye,Ss)+4;for(let i=0;i<e;i++)t+=c(this,kt).getUint32(t)+4;const n=c(this,kt).getUint32(t),r=new Uint8Array(n);return r.set(new Uint8Array(c(this,Ua),t+4,n)),c(this,jy).decode(r)},re(Ye,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),re(Ye,"numbers",["ascent","defaultWidth","descent"]),re(Ye,"strings",["fallbackName","loadedName","mimetype","name"]),T(Ye,Hf,Math.ceil(Ye.bools.length*2/8)),T(Ye,Wf,c(Ye,Hf)+Ye.numbers.length*8),T(Ye,Gf,c(Ye,Wf)+1+8),T(Ye,qf,c(Ye,Gf)+1+48),T(Ye,Ss,c(Ye,qf)+1+6);let Xb=Ye;var $y,zy,Hy,Wy,Gy,qy,Qy,Ky;const Ot=class Ot{constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,n=null,r=[],i=[],o=[],u=[],d=null,h=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,n=e[2],o=e[3],t===1?r.push(...e[4],...e[5]):r.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,d=e[1],r=e[2],i=e[3],u=e[4]||[],n=e[6],h=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const f=Math.floor(r.length/2),g=Math.floor(i.length/3),w=o.length,A=u.length;let F=0;for(const z of u)F+=1,F=Math.ceil(F/4)*4,F+=4+z.coords.length*4,F+=4+z.colors.length*4,z.verticesPerRow!==void 0&&(F+=4);const C=20+f*8+g*3+w*8+(n?16:0)+(h?3:0)+F,S=new ArrayBuffer(C),P=new DataView(S),O=new Uint8Array(S);P.setUint8(c(Ot,$y),t),P.setUint8(c(Ot,zy),n?1:0),P.setUint8(c(Ot,Hy),h?1:0),P.setUint8(c(Ot,Wy),d),P.setUint32(c(Ot,Gy),f,!0),P.setUint32(c(Ot,qy),g,!0),P.setUint32(c(Ot,Qy),w,!0),P.setUint32(c(Ot,Ky),A,!0);let N=20;new Float32Array(S,N,f*2).set(r),N+=f*8,O.set(i,N),N+=g*3;for(const[z,H]of o)P.setFloat32(N,z,!0),N+=4,P.setUint32(N,parseInt(H.slice(1),16),!0),N+=4;if(n)for(const z of n)P.setFloat32(N,z,!0),N+=4;h&&(O.set(h,N),N+=3);for(let z=0;z<u.length;z++){const H=u[z];P.setUint8(N,H.type),N+=1,N=Math.ceil(N/4)*4,P.setUint32(N,H.coords.length,!0),N+=4,new Int32Array(S,N,H.coords.length).set(H.coords),N+=H.coords.length*4,P.setUint32(N,H.colors.length,!0),N+=4,new Int32Array(S,N,H.colors.length).set(H.colors),N+=H.colors.length*4,H.verticesPerRow!==void 0&&(P.setUint32(N,H.verticesPerRow,!0),N+=4)}return S}getIR(){const e=this.view,t=this.data[c(Ot,$y)],n=!!this.data[c(Ot,zy)],r=!!this.data[c(Ot,Hy)],i=e.getUint32(c(Ot,Gy),!0),o=e.getUint32(c(Ot,qy),!0),u=e.getUint32(c(Ot,Qy),!0),d=e.getUint32(c(Ot,Ky),!0);let h=20;const f=new Float32Array(this.buffer,h,i*2);h+=i*8;const g=new Uint8Array(this.buffer,h,o*3);h+=o*3;const w=[];for(let S=0;S<u;++S){const P=e.getFloat32(h,!0);h+=4;const O=e.getUint32(h,!0);h+=4,w.push([P,`#${O.toString(16).padStart(6,"0")}`])}let A=null;if(n){A=[];for(let S=0;S<4;++S)A.push(e.getFloat32(h,!0)),h+=4}let F=null;r&&(F=new Uint8Array(this.buffer,h,3),h+=3);const C=[];for(let S=0;S<d;++S){const P=e.getUint8(h);h+=1,h=Math.ceil(h/4)*4;const O=e.getUint32(h,!0);h+=4;const N=new Int32Array(this.buffer,h,O);h+=O*4;const V=e.getUint32(h,!0);h+=4;const z=new Int32Array(this.buffer,h,V);h+=V*4;const H={type:P,coords:N,colors:z};P===Tb.LATTICE&&(H.verticesPerRow=e.getUint32(h,!0),h+=4),C.push(H)}if(t===1)return["RadialAxial","axial",A,w,Array.from(f.slice(0,2)),Array.from(f.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",A,w,[f[0],f[1]],[f[3],f[4]],f[2],f[5]];if(t===3){const S=this.data[c(Ot,Wy)];let P=null;if(f.length>0){let O=f[0],N=f[0],V=f[1],z=f[1];for(let H=0;H<f.length;H+=2){const R=f[H],D=f[H+1];O=O>R?R:O,V=V>D?D:V,N=N<R?R:N,z=z<D?D:z}P=[O,V,N,z]}return["Mesh",S,f,g,C,P,A,F]}throw new Error(`Unsupported pattern kind: ${t}`)}};$y=new WeakMap,zy=new WeakMap,Hy=new WeakMap,Wy=new WeakMap,Gy=new WeakMap,qy=new WeakMap,Qy=new WeakMap,Ky=new WeakMap,T(Ot,$y,0),T(Ot,zy,1),T(Ot,Hy,2),T(Ot,Wy,3),T(Ot,Gy,4),T(Ot,qy,8),T(Ot,Qy,12),T(Ot,Ky,16);let Yb=Ot;var Qf;class NW{constructor(e){T(this,Qf);x(this,Qf,e)}static write(e){let t,n;return Hn.isFloat16ArraySupported?(n=new ArrayBuffer(e.length*2),t=new Float16Array(n)):(n=new ArrayBuffer(e.length*4),t=new Float32Array(n)),t.set(e),n}get path(){return Hn.isFloat16ArraySupported?new Float16Array(c(this,Qf)):new Float32Array(c(this,Qf))}}Qf=new WeakMap;function MW(s){if(s instanceof URL)return s.href;if(typeof s=="string"){if(Hr)return s;const e=URL.parse(s,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function LW(s){if(Hr&&typeof Buffer<"u"&&s instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength)return s;if(typeof s=="string")return Vx(s);if(s instanceof ArrayBuffer||ArrayBuffer.isView(s)||typeof s=="object"&&!isNaN(s==null?void 0:s.length))return new Uint8Array(s);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function sA(s){if(typeof s!="string")return null;if(s.endsWith("/"))return s;throw new Error(`Invalid factory url: "${s}" must include trailing slash.`)}const Jb=s=>typeof s=="object"&&Number.isInteger(s==null?void 0:s.num)&&s.num>=0&&Number.isInteger(s==null?void 0:s.gen)&&s.gen>=0,OW=s=>typeof s=="object"&&typeof(s==null?void 0:s.name)=="string",BW=wW.bind(null,Jb,OW);var Jo,q_;class VW{constructor(){T(this,Jo,new Map);T(this,q_,Promise.resolve())}postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};c(this,q_).then(()=>{for(const[r]of c(this,Jo))r.call(this,n)})}addEventListener(e,t,n=null){let r=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:i}=n;if(i.aborted){Ge("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);r=()=>i.removeEventListener("abort",o),i.addEventListener("abort",o)}c(this,Jo).set(t,r)}removeEventListener(e,t){const n=c(this,Jo).get(t);n==null||n(),c(this,Jo).delete(t)}terminate(){for(const[,e]of c(this,Jo))e==null||e();c(this,Jo).clear()}}Jo=new WeakMap,q_=new WeakMap;const iA={DATA:1,ERROR:2},Tn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function aR(){}function es(s){if(s instanceof Du||s instanceof kb||s instanceof JP||s instanceof S_||s instanceof HE)return s;switch(s instanceof Error||typeof s=="object"&&s!==null||At('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),s.name){case"AbortException":return new Du(s.message);case"InvalidPDFException":return new kb(s.message);case"PasswordException":return new JP(s.message,s.code);case"ResponseException":return new S_(s.message,s.status,s.missing);case"UnknownErrorException":return new HE(s.message,s.details)}return new HE(s.message,s.toString())}var Kf,bi,IM,PM,RM,NA;class Tg{constructor(e,t,n){T(this,bi);T(this,Kf,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",I(this,bi,IM).bind(this),{signal:c(this,Kf).signal})}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const r=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[r]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},n)}catch(o){i.reject(o)}return i.promise}sendWithStream(e,t,n,r){const i=this.streamId++,o=this.sourceName,u=this.targetName,d=this.comObj;return new ReadableStream({start:h=>{const f=Promise.withResolvers();return this.streamControllers[i]={controller:h,startCall:f,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:o,targetName:u,action:e,streamId:i,data:t,desiredSize:h.desiredSize},r),f.promise},pull:h=>{const f=Promise.withResolvers();return this.streamControllers[i].pullCall=f,d.postMessage({sourceName:o,targetName:u,stream:Tn.PULL,streamId:i,desiredSize:h.desiredSize}),f.promise},cancel:h=>{vt(h instanceof Error,"cancel must have a valid reason");const f=Promise.withResolvers();return this.streamControllers[i].cancelCall=f,this.streamControllers[i].isClosed=!0,d.postMessage({sourceName:o,targetName:u,stream:Tn.CANCEL,streamId:i,reason:es(h)}),f.promise}},n)}destroy(){var e;(e=c(this,Kf))==null||e.abort(),x(this,Kf,null)}}Kf=new WeakMap,bi=new WeakSet,IM=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){I(this,bi,RM).call(this,e);return}if(e.callback){const n=e.callbackId,r=this.callbackCapabilities[n];if(!r)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===iA.DATA)r.resolve(e.data);else if(e.callback===iA.ERROR)r.reject(es(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,r=e.sourceName,i=this.comObj;Promise.try(t,e.data).then(function(o){i.postMessage({sourceName:n,targetName:r,callback:iA.DATA,callbackId:e.callbackId,data:o})},function(o){i.postMessage({sourceName:n,targetName:r,callback:iA.ERROR,callbackId:e.callbackId,reason:es(o)})});return}if(e.streamId){I(this,bi,PM).call(this,e);return}t(e.data)},PM=function(e){const t=e.streamId,n=this.sourceName,r=e.sourceName,i=this.comObj,o=this,u=this.actionHandler[e.action],d={enqueue(h,f=1,g){if(this.isCancelled)return;const w=this.desiredSize;this.desiredSize-=f,w>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:n,targetName:r,stream:Tn.ENQUEUE,streamId:t,chunk:h},g)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:r,stream:Tn.CLOSE,streamId:t}),delete o.streamSinks[t])},error(h){vt(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:r,stream:Tn.ERROR,streamId:t,reason:es(h)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[t]=d,Promise.try(u,e.data,d).then(function(){i.postMessage({sourceName:n,targetName:r,stream:Tn.START_COMPLETE,streamId:t,success:!0})},function(h){i.postMessage({sourceName:n,targetName:r,stream:Tn.START_COMPLETE,streamId:t,reason:es(h)})})},RM=function(e){const t=e.streamId,n=this.sourceName,r=e.sourceName,i=this.comObj,o=this.streamControllers[t],u=this.streamSinks[t];switch(e.stream){case Tn.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(es(e.reason));break;case Tn.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(es(e.reason));break;case Tn.PULL:if(!u){i.postMessage({sourceName:n,targetName:r,stream:Tn.PULL_COMPLETE,streamId:t,success:!0});break}u.desiredSize<=0&&e.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=e.desiredSize,Promise.try(u.onPull||aR).then(function(){i.postMessage({sourceName:n,targetName:r,stream:Tn.PULL_COMPLETE,streamId:t,success:!0})},function(h){i.postMessage({sourceName:n,targetName:r,stream:Tn.PULL_COMPLETE,streamId:t,reason:es(h)})});break;case Tn.ENQUEUE:if(vt(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case Tn.CLOSE:if(vt(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),I(this,bi,NA).call(this,o,t);break;case Tn.ERROR:vt(o,"error should have stream controller"),o.controller.error(es(e.reason)),I(this,bi,NA).call(this,o,t);break;case Tn.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(es(e.reason)),I(this,bi,NA).call(this,o,t);break;case Tn.CANCEL:if(!u)break;const d=es(e.reason);Promise.try(u.onCancel||aR,d).then(function(){i.postMessage({sourceName:n,targetName:r,stream:Tn.CANCEL_COMPLETE,streamId:t,success:!0})},function(h){i.postMessage({sourceName:n,targetName:r,stream:Tn.CANCEL_COMPLETE,streamId:t,reason:es(h)})}),u.sinkCapability.reject(d),u.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},NA=async function(e,t){var n,r,i;await Promise.allSettled([(n=e.startCall)==null?void 0:n.promise,(r=e.pullCall)==null?void 0:r.promise,(i=e.cancelCall)==null?void 0:i.promise]),delete this.streamControllers[t]};var Xy;class DM{constructor({enableHWA:e=!1}){T(this,Xy,!1);x(this,Xy,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!c(this,Xy)})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){At("Abstract method `_createCanvas` called.")}}Xy=new WeakMap;class UW extends DM{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class NM{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){At("Abstract method `_fetch` called.")}}class oR extends NM{async _fetch(e){const t=await F0(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Vx(t)}}class MM{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,r,i){return"none"}destroy(e=!1){}}var Wd,Xf,Zo,el,Ir,Gd,qd,Ce,Fr,kg,Yp,MA,Jp,LM,Zb,Zp,Ig,Pg,eC,Rg;class jW extends MM{constructor({docId:t,ownerDocument:n=globalThis.document}){super();T(this,Ce);T(this,Wd);T(this,Xf);T(this,Zo);T(this,el);T(this,Ir);T(this,Gd);T(this,qd,0);x(this,el,t),x(this,Ir,n)}addFilter(t){if(!t)return"none";let n=c(this,Ce,Fr).get(t);if(n)return n;const[r,i,o]=I(this,Ce,MA).call(this,t),u=t.length===1?r:`${r}${i}${o}`;if(n=c(this,Ce,Fr).get(u),n)return c(this,Ce,Fr).set(t,n),n;const d=`g_${c(this,el)}_transfer_map_${Bn(this,qd)._++}`,h=I(this,Ce,Jp).call(this,d);c(this,Ce,Fr).set(t,h),c(this,Ce,Fr).set(u,h);const f=I(this,Ce,Zp).call(this,d);return I(this,Ce,Pg).call(this,r,i,o,f),h}addHCMFilter(t,n){var F;const r=`${t}-${n}`,i="base";let o=c(this,Ce,kg).get(i);if((o==null?void 0:o.key)===r||(o?((F=o.filter)==null||F.remove(),o.key=r,o.url="none",o.filter=null):(o={key:r,url:"none",filter:null},c(this,Ce,kg).set(i,o)),!t||!n))return o.url;const u=I(this,Ce,Rg).call(this,t);t=_e.makeHexColor(...u);const d=I(this,Ce,Rg).call(this,n);if(n=_e.makeHexColor(...d),c(this,Ce,Yp).style.color="",t==="#000000"&&n==="#ffffff"||t===n)return o.url;const h=new Array(256);for(let C=0;C<=255;C++){const S=C/255;h[C]=S<=.03928?S/12.92:((S+.055)/1.055)**2.4}const f=h.join(","),g=`g_${c(this,el)}_hcm_filter`,w=o.filter=I(this,Ce,Zp).call(this,g);I(this,Ce,Pg).call(this,f,f,f,w),I(this,Ce,Zb).call(this,w);const A=(C,S)=>{const P=u[C]/255,O=d[C]/255,N=new Array(S+1);for(let V=0;V<=S;V++)N[V]=P+V/S*(O-P);return N.join(",")};return I(this,Ce,Pg).call(this,A(0,5),A(1,5),A(2,5),w),o.url=I(this,Ce,Jp).call(this,g),o.url}addAlphaFilter(t){let n=c(this,Ce,Fr).get(t);if(n)return n;const[r]=I(this,Ce,MA).call(this,[t]),i=`alpha_${r}`;if(n=c(this,Ce,Fr).get(i),n)return c(this,Ce,Fr).set(t,n),n;const o=`g_${c(this,el)}_alpha_map_${Bn(this,qd)._++}`,u=I(this,Ce,Jp).call(this,o);c(this,Ce,Fr).set(t,u),c(this,Ce,Fr).set(i,u);const d=I(this,Ce,Zp).call(this,o);return I(this,Ce,eC).call(this,r,d),u}addLuminosityFilter(t){let n=c(this,Ce,Fr).get(t||"luminosity");if(n)return n;let r,i;if(t?([r]=I(this,Ce,MA).call(this,[t]),i=`luminosity_${r}`):i="luminosity",n=c(this,Ce,Fr).get(i),n)return c(this,Ce,Fr).set(t,n),n;const o=`g_${c(this,el)}_luminosity_map_${Bn(this,qd)._++}`,u=I(this,Ce,Jp).call(this,o);c(this,Ce,Fr).set(t,u),c(this,Ce,Fr).set(i,u);const d=I(this,Ce,Zp).call(this,o);return I(this,Ce,LM).call(this,d),t&&I(this,Ce,eC).call(this,r,d),u}addHighlightHCMFilter(t,n,r,i,o){var O;const u=`${n}-${r}-${i}-${o}`;let d=c(this,Ce,kg).get(t);if((d==null?void 0:d.key)===u||(d?((O=d.filter)==null||O.remove(),d.key=u,d.url="none",d.filter=null):(d={key:u,url:"none",filter:null},c(this,Ce,kg).set(t,d)),!n||!r))return d.url;const[h,f]=[n,r].map(I(this,Ce,Rg).bind(this));let g=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),w=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[A,F]=[i,o].map(I(this,Ce,Rg).bind(this));w<g&&([g,w,A,F]=[w,g,F,A]),c(this,Ce,Yp).style.color="";const C=(N,V,z)=>{const H=new Array(256),R=(w-g)/z,D=N/255,L=(V-N)/(255*z);let U=0;for(let j=0;j<=z;j++){const G=Math.round(g+j*R),$=D+j*L;for(let ge=U;ge<=G;ge++)H[ge]=$;U=G+1}for(let j=U;j<256;j++)H[j]=H[U-1];return H.join(",")},S=`g_${c(this,el)}_hcm_${t}_filter`,P=d.filter=I(this,Ce,Zp).call(this,S);return I(this,Ce,Zb).call(this,P),I(this,Ce,Pg).call(this,C(A[0],F[0],5),C(A[1],F[1],5),C(A[2],F[2],5),P),d.url=I(this,Ce,Jp).call(this,S),d.url}destroy(t=!1){var n,r,i,o;t&&((n=c(this,Gd))!=null&&n.size)||((r=c(this,Zo))==null||r.parentNode.parentNode.remove(),x(this,Zo,null),(i=c(this,Xf))==null||i.clear(),x(this,Xf,null),(o=c(this,Gd))==null||o.clear(),x(this,Gd,null),x(this,qd,0))}}Wd=new WeakMap,Xf=new WeakMap,Zo=new WeakMap,el=new WeakMap,Ir=new WeakMap,Gd=new WeakMap,qd=new WeakMap,Ce=new WeakSet,Fr=function(){return c(this,Xf)||x(this,Xf,new Map)},kg=function(){return c(this,Gd)||x(this,Gd,new Map)},Yp=function(){if(!c(this,Zo)){const t=c(this,Ir).createElement("div"),{style:n}=t;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const r=c(this,Ir).createElementNS(Mo,"svg");r.setAttribute("width",0),r.setAttribute("height",0),x(this,Zo,c(this,Ir).createElementNS(Mo,"defs")),t.append(r),r.append(c(this,Zo)),c(this,Ir).body.append(t)}return c(this,Zo)},MA=function(t){if(t.length===1){const h=t[0],f=new Array(256);for(let w=0;w<256;w++)f[w]=h[w]/255;const g=f.join(",");return[g,g,g]}const[n,r,i]=t,o=new Array(256),u=new Array(256),d=new Array(256);for(let h=0;h<256;h++)o[h]=n[h]/255,u[h]=r[h]/255,d[h]=i[h]/255;return[o.join(","),u.join(","),d.join(",")]},Jp=function(t){if(c(this,Wd)===void 0){x(this,Wd,"");const n=c(this,Ir).URL;n!==c(this,Ir).baseURI&&(Ux(n)?Ge('#createUrl: ignore "data:"-URL for performance reasons.'):x(this,Wd,zN(n,"")))}return`url(${c(this,Wd)}#${t})`},LM=function(t){const n=c(this,Ir).createElementNS(Mo,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(n)},Zb=function(t){const n=c(this,Ir).createElementNS(Mo,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(n)},Zp=function(t){const n=c(this,Ir).createElementNS(Mo,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",t),c(this,Ce,Yp).append(n),n},Ig=function(t,n,r){const i=c(this,Ir).createElementNS(Mo,n);i.setAttribute("type","discrete"),i.setAttribute("tableValues",r),t.append(i)},Pg=function(t,n,r,i){const o=c(this,Ir).createElementNS(Mo,"feComponentTransfer");i.append(o),I(this,Ce,Ig).call(this,o,"feFuncR",t),I(this,Ce,Ig).call(this,o,"feFuncG",n),I(this,Ce,Ig).call(this,o,"feFuncB",r)},eC=function(t,n){const r=c(this,Ir).createElementNS(Mo,"feComponentTransfer");n.append(r),I(this,Ce,Ig).call(this,r,"feFuncA",t)},Rg=function(t){return c(this,Ce,Yp).style.color=t,T0(getComputedStyle(c(this,Ce,Yp)).getPropertyValue("color"))};class OM{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){At("Abstract method `_fetch` called.")}}class lR extends OM{async _fetch(e){const t=await F0(e,"arraybuffer");return new Uint8Array(t)}}class BM{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){At("Abstract method `_fetch` called.")}}class cR extends BM{async _fetch(e){const t=await F0(e,"arraybuffer");return new Uint8Array(t)}}Hr&&Ge("Please use the `legacy` build in Node.js environments.");async function ES(s){const t=await process.getBuiltinModule("fs").promises.readFile(s);return new Uint8Array(t)}class $W extends MM{}class zW extends DM{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class HW extends NM{async _fetch(e){return ES(e)}}class WW extends OM{async _fetch(e){return ES(e)}}class GW extends BM{async _fetch(e){return ES(e)}}const Wp="__forcedDependency",{floor:uR,ceil:dR}=Math;function aA(s,e,t,n,r,i){s[e*4+0]=Math.min(s[e*4+0],t),s[e*4+1]=Math.min(s[e*4+1],n),s[e*4+2]=Math.max(s[e*4+2],r),s[e*4+3]=Math.max(s[e*4+3],i)}const tC=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var Yf,Gc;class qW{constructor(e,t){T(this,Yf);T(this,Gc);x(this,Yf,e),x(this,Gc,t)}get length(){return c(this,Yf).length}isEmpty(e){return c(this,Yf)[e]===tC}minX(e){return c(this,Gc)[e*4+0]/256}minY(e){return c(this,Gc)[e*4+1]/256}maxX(e){return(c(this,Gc)[e*4+2]+1)/256}maxY(e){return(c(this,Gc)[e*4+3]+1)/256}}Yf=new WeakMap,Gc=new WeakMap;const oA=(s,e)=>{if(!s)return;let t=s.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},s.set(e,t)),t};var rs,ss,Qd,$i,Kd,tl,Ft,It,nl,is,Yy,Jf,Xd,Yd,rl,Pr,ja,Jy,nC;class QW{constructor(e,t,n=!1){T(this,Jy);T(this,rs,{__proto__:null});T(this,ss,{__proto__:null,transform:[],moveText:[],sameLineText:[],[Wp]:[]});T(this,Qd,new Map);T(this,$i,[]);T(this,Kd,[]);T(this,tl,[[1,0,0,1,0,0]]);T(this,Ft,[-1/0,-1/0,1/0,1/0]);T(this,It,new Float64Array([1/0,1/0,-1/0,-1/0]));T(this,nl,-1);T(this,is,new Set);T(this,Yy,new Map);T(this,Jf,new Map);T(this,Xd);T(this,Yd);T(this,rl);T(this,Pr);T(this,ja);x(this,Xd,e.width),x(this,Yd,e.height),I(this,Jy,nC).call(this,t),n&&x(this,ja,new Map)}growOperationsCount(e){e>=c(this,Pr).length&&I(this,Jy,nC).call(this,e,c(this,Pr))}save(e){return x(this,rs,{__proto__:c(this,rs)}),x(this,ss,{__proto__:c(this,ss),transform:{__proto__:c(this,ss).transform},moveText:{__proto__:c(this,ss).moveText},sameLineText:{__proto__:c(this,ss).sameLineText},[Wp]:{__proto__:c(this,ss)[Wp]}}),x(this,Ft,{__proto__:c(this,Ft)}),c(this,$i).push(e),this}restore(e){var r;const t=Object.getPrototypeOf(c(this,rs));if(t===null)return this;x(this,rs,t),x(this,ss,Object.getPrototypeOf(c(this,ss))),x(this,Ft,Object.getPrototypeOf(c(this,Ft)));const n=c(this,$i).pop();return n!==void 0&&((r=oA(c(this,ja),e))==null||r.dependencies.add(n),c(this,Pr)[e]=c(this,Pr)[n]),this}recordOpenMarker(e){return c(this,$i).push(e),this}getOpenMarker(){return c(this,$i).length===0?null:c(this,$i).at(-1)}recordCloseMarker(e){var n;const t=c(this,$i).pop();return t!==void 0&&((n=oA(c(this,ja),e))==null||n.dependencies.add(t),c(this,Pr)[e]=c(this,Pr)[t]),this}beginMarkedContent(e){return c(this,Kd).push(e),this}endMarkedContent(e){var n;const t=c(this,Kd).pop();return t!==void 0&&((n=oA(c(this,ja),e))==null||n.dependencies.add(t),c(this,Pr)[e]=c(this,Pr)[t]),this}pushBaseTransform(e){return c(this,tl).push(_e.multiplyByDOMMatrix(c(this,tl).at(-1),e.getTransform())),this}popBaseTransform(){return c(this,tl).length>1&&c(this,tl).pop(),this}recordSimpleData(e,t){return c(this,rs)[e]=t,this}recordIncrementalData(e,t){return c(this,ss)[e].push(t),this}resetIncrementalData(e,t){return c(this,ss)[e].length=0,this}recordNamedData(e,t){return c(this,Qd).set(e,t),this}recordSimpleDataFromNamed(e,t,n){c(this,rs)[e]=c(this,Qd).get(t)??n}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Wp,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in c(this,rs)&&this.recordFutureForcedDependency(t,c(this,rs)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of c(this,is))this.recordFutureForcedDependency(Wp,e);return this}resetBBox(e){return c(this,nl)!==e&&(x(this,nl,e),c(this,It)[0]=1/0,c(this,It)[1]=1/0,c(this,It)[2]=-1/0,c(this,It)[3]=-1/0),this}recordClipBox(e,t,n,r,i,o){const u=_e.multiplyByDOMMatrix(c(this,tl).at(-1),t.getTransform()),d=[1/0,1/0,-1/0,-1/0];_e.axialAlignedBoundingBox([n,i,r,o],u,d);const h=_e.intersect(c(this,Ft),d);return h?(c(this,Ft)[0]=h[0],c(this,Ft)[1]=h[1],c(this,Ft)[2]=h[2],c(this,Ft)[3]=h[3]):(c(this,Ft)[0]=c(this,Ft)[1]=1/0,c(this,Ft)[2]=c(this,Ft)[3]=-1/0),this}recordBBox(e,t,n,r,i,o){const u=c(this,Ft);if(u[0]===1/0)return this;const d=_e.multiplyByDOMMatrix(c(this,tl).at(-1),t.getTransform());if(u[0]===-1/0)return _e.axialAlignedBoundingBox([n,i,r,o],d,c(this,It)),this;const h=[1/0,1/0,-1/0,-1/0];return _e.axialAlignedBoundingBox([n,i,r,o],d,h),c(this,It)[0]=Math.min(c(this,It)[0],Math.max(h[0],u[0])),c(this,It)[1]=Math.min(c(this,It)[1],Math.max(h[1],u[1])),c(this,It)[2]=Math.max(c(this,It)[2],Math.min(h[2],u[2])),c(this,It)[3]=Math.max(c(this,It)[3],Math.min(h[3],u[3])),this}recordCharacterBBox(e,t,n,r=1,i=0,o=0,u){const d=n.bbox;let h,f;if(d&&(h=d[2]!==d[0]&&d[3]!==d[1]&&c(this,Jf).get(n),h!==!1&&(f=[0,0,0,0],_e.axialAlignedBoundingBox(d,n.fontMatrix,f),(r!==1||i!==0||o!==0)&&_e.scaleMinMax([r,0,0,-r,i,o],f),h)))return this.recordBBox(e,t,f[0],f[2],f[1],f[3]);if(!u)return this.recordFullPageBBox(e);const g=u();return d&&f&&h===void 0&&(h=f[0]<=i-g.actualBoundingBoxLeft&&f[2]>=i+g.actualBoundingBoxRight&&f[1]<=o-g.actualBoundingBoxAscent&&f[3]>=o+g.actualBoundingBoxDescent,c(this,Jf).set(n,h),h)?this.recordBBox(e,t,f[0],f[2],f[1],f[3]):this.recordBBox(e,t,i-g.actualBoundingBoxLeft,i+g.actualBoundingBoxRight,o-g.actualBoundingBoxAscent,o+g.actualBoundingBoxDescent)}recordFullPageBBox(e){return c(this,It)[0]=Math.max(0,c(this,Ft)[0]),c(this,It)[1]=Math.max(0,c(this,Ft)[1]),c(this,It)[2]=Math.min(c(this,Xd),c(this,Ft)[2]),c(this,It)[3]=Math.min(c(this,Yd),c(this,Ft)[3]),this}getSimpleIndex(e){return c(this,rs)[e]}recordDependencies(e,t){const n=c(this,is),r=c(this,rs),i=c(this,ss);for(const o of t)o in c(this,rs)?n.add(r[o]):o in i&&i[o].forEach(n.add,n);return this}recordNamedDependency(e,t){return c(this,Qd).has(t)&&c(this,is).add(c(this,Qd).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[Wp]),c(this,ja)){const n=oA(c(this,ja),e),{dependencies:r}=n;c(this,is).forEach(r.add,r),c(this,$i).forEach(r.add,r),c(this,Kd).forEach(r.add,r),r.delete(e),n.isRenderingOperation=!0}if(c(this,nl)===e){const n=uR(c(this,It)[0]*256/c(this,Xd)),r=uR(c(this,It)[1]*256/c(this,Yd)),i=dR(c(this,It)[2]*256/c(this,Xd)),o=dR(c(this,It)[3]*256/c(this,Yd));aA(c(this,rl),e,n,r,i,o);for(const u of c(this,is))u!==e&&aA(c(this,rl),u,n,r,i,o);for(const u of c(this,$i))u!==e&&aA(c(this,rl),u,n,r,i,o);for(const u of c(this,Kd))u!==e&&aA(c(this,rl),u,n,r,i,o);t||(c(this,is).clear(),x(this,nl,-1))}return this}recordShowTextOperation(e,t=!1){const n=Array.from(c(this,is));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const r of n)this.recordIncrementalData("sameLineText",r);return this}bboxToClipBoxDropOperation(e,t=!1){return c(this,nl)===e&&(x(this,nl,-1),c(this,Ft)[0]=Math.max(c(this,Ft)[0],c(this,It)[0]),c(this,Ft)[1]=Math.max(c(this,Ft)[1],c(this,It)[1]),c(this,Ft)[2]=Math.min(c(this,Ft)[2],c(this,It)[2]),c(this,Ft)[3]=Math.min(c(this,Ft)[3],c(this,It)[3]),t||c(this,is).clear()),this}_takePendingDependencies(){const e=c(this,is);return x(this,is,new Set),e}_extractOperation(e){const t=c(this,Yy).get(e);return c(this,Yy).delete(e),t}_pushPendingDependencies(e){for(const t of e)c(this,is).add(t)}take(){return c(this,Jf).clear(),new qW(c(this,Pr),c(this,rl))}takeDebugMetadata(){return c(this,ja)}}rs=new WeakMap,ss=new WeakMap,Qd=new WeakMap,$i=new WeakMap,Kd=new WeakMap,tl=new WeakMap,Ft=new WeakMap,It=new WeakMap,nl=new WeakMap,is=new WeakMap,Yy=new WeakMap,Jf=new WeakMap,Xd=new WeakMap,Yd=new WeakMap,rl=new WeakMap,Pr=new WeakMap,ja=new WeakMap,Jy=new WeakSet,nC=function(e,t){const n=new ArrayBuffer(e*4);x(this,rl,new Uint8ClampedArray(n)),x(this,Pr,new Uint32Array(n)),t&&t.length>0?(c(this,Pr).set(t),c(this,Pr).fill(tC,t.length)):c(this,Pr).fill(tC)};var Nt,un,zi,Zf,em;const RS=class RS{constructor(e,t,n){T(this,Nt);T(this,un);T(this,zi);T(this,Zf,0);T(this,em,0);if(e instanceof RS&&c(e,zi)===!!n)return e;x(this,Nt,e),x(this,un,t),x(this,zi,!!n)}growOperationsCount(){throw new Error("Unreachable")}save(e){return Bn(this,em)._++,c(this,Nt).save(c(this,un)),this}restore(e){return c(this,em)>0&&(c(this,Nt).restore(c(this,un)),Bn(this,em)._--),this}recordOpenMarker(e){return Bn(this,Zf)._++,this}getOpenMarker(){return c(this,Zf)>0?c(this,un):c(this,Nt).getOpenMarker()}recordCloseMarker(e){return Bn(this,Zf)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return c(this,Nt).pushBaseTransform(e),this}popBaseTransform(){return c(this,Nt).popBaseTransform(),this}recordSimpleData(e,t){return c(this,Nt).recordSimpleData(e,c(this,un)),this}recordIncrementalData(e,t){return c(this,Nt).recordIncrementalData(e,c(this,un)),this}resetIncrementalData(e,t){return c(this,Nt).resetIncrementalData(e,c(this,un)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,n){return c(this,Nt).recordSimpleDataFromNamed(e,t,c(this,un)),this}recordFutureForcedDependency(e,t){return c(this,Nt).recordFutureForcedDependency(e,c(this,un)),this}inheritSimpleDataAsFutureForcedDependencies(e){return c(this,Nt).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return c(this,Nt).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return c(this,zi)||c(this,Nt).resetBBox(c(this,un)),this}recordClipBox(e,t,n,r,i,o){return c(this,zi)||c(this,Nt).recordClipBox(c(this,un),t,n,r,i,o),this}recordBBox(e,t,n,r,i,o){return c(this,zi)||c(this,Nt).recordBBox(c(this,un),t,n,r,i,o),this}recordCharacterBBox(e,t,n,r,i,o,u){return c(this,zi)||c(this,Nt).recordCharacterBBox(c(this,un),t,n,r,i,o,u),this}recordFullPageBBox(e){return c(this,zi)||c(this,Nt).recordFullPageBBox(c(this,un)),this}getSimpleIndex(e){return c(this,Nt).getSimpleIndex(e)}recordDependencies(e,t){return c(this,Nt).recordDependencies(c(this,un),t),this}recordNamedDependency(e,t){return c(this,Nt).recordNamedDependency(c(this,un),t),this}recordOperation(e){return c(this,Nt).recordOperation(c(this,un),!0),this}recordShowTextOperation(e){return c(this,Nt).recordShowTextOperation(c(this,un),!0),this}bboxToClipBoxDropOperation(e){return c(this,zi)||c(this,Nt).bboxToClipBoxDropOperation(c(this,un),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};Nt=new WeakMap,un=new WeakMap,zi=new WeakMap,Zf=new WeakMap,em=new WeakMap;let D_=RS;const ai={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},fr={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function rC(s,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],t,n),s.clip(r)}class bS{isModifyingCurrentTransform(){return!1}getPattern(){At("Abstract method `getPattern` called.")}}class KW extends bS{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(e,t=null){let n,r=this._p0,i=this._p1;if(t&&(r=r.slice(),i=i.slice(),_e.applyTransform(r,t),_e.applyTransform(i,t)),this._type==="axial")n=e.createLinearGradient(r[0],r[1],i[0],i[1]);else if(this._type==="radial"){let o=this._r0,u=this._r1;if(t){const d=new Float32Array(2);_e.singularValueDecompose2dScale(t,d),o*=d[0],u*=d[0]}n=e.createRadialGradient(r[0],r[1],o,i[0],i[1],u)}for(const o of this._colorStops)n.addColorStop(o[0],o[1]);return n}getPattern(e,t,n,r){let i;if(r===fr.STROKE||r===fr.FILL){if(this.isOriginBased()){let w=_e.transform(n,t.baseTransform);this.matrix&&(w=_e.transform(w,this.matrix));const A=.001,F=Math.hypot(w[0],w[1]),C=Math.hypot(w[2],w[3]),S=(w[0]*w[2]+w[1]*w[3])/(F*C);if(Math.abs(S)<A)if(this.isRadial()){if(Math.abs(F-C)<A)return this._createGradient(e,w)}else return this._createGradient(e,w)}const o=t.current.getClippedPathBoundingBox(r,sn(e))||[0,0,0,0],u=Math.ceil(o[2]-o[0])||1,d=Math.ceil(o[3]-o[1])||1,h=t.cachedCanvases.getCanvas("pattern",u,d),f=h.context;f.clearRect(0,0,f.canvas.width,f.canvas.height),f.beginPath(),f.rect(0,0,f.canvas.width,f.canvas.height),f.translate(-o[0],-o[1]),n=_e.transform(n,[1,0,0,1,o[0],o[1]]),f.transform(...t.baseTransform),this.matrix&&f.transform(...this.matrix),rC(f,this._bbox),f.fillStyle=this._createGradient(f),f.fill(),i=e.createPattern(h.canvas,"no-repeat");const g=new DOMMatrix(n);i.setTransform(g)}else rC(e,this._bbox),i=this._createGradient(e);return i}}function qE(s,e,t,n,r,i,o,u){const d=e.coords,h=e.colors,f=s.data,g=s.width*4;let w;d[t+1]>d[n+1]&&(w=t,t=n,n=w,w=i,i=o,o=w),d[n+1]>d[r+1]&&(w=n,n=r,r=w,w=o,o=u,u=w),d[t+1]>d[n+1]&&(w=t,t=n,n=w,w=i,i=o,o=w);const A=(d[t]+e.offsetX)*e.scaleX,F=(d[t+1]+e.offsetY)*e.scaleY,C=(d[n]+e.offsetX)*e.scaleX,S=(d[n+1]+e.offsetY)*e.scaleY,P=(d[r]+e.offsetX)*e.scaleX,O=(d[r+1]+e.offsetY)*e.scaleY;if(F>=O)return;const N=h[i],V=h[i+1],z=h[i+2],H=h[o],R=h[o+1],D=h[o+2],L=h[u],U=h[u+1],j=h[u+2],G=Math.round(F),$=Math.round(O);let ge,xe,ye,pe,ie,we,de,K;for(let Y=G;Y<=$;Y++){if(Y<S){const Me=Y<F?0:(F-Y)/(F-S);ge=A-(A-C)*Me,xe=N-(N-H)*Me,ye=V-(V-R)*Me,pe=z-(z-D)*Me}else{let Me;Y>O?Me=1:S===O?Me=0:Me=(S-Y)/(S-O),ge=C-(C-P)*Me,xe=H-(H-L)*Me,ye=R-(R-U)*Me,pe=D-(D-j)*Me}let fe;Y<F?fe=0:Y>O?fe=1:fe=(F-Y)/(F-O),ie=A-(A-P)*fe,we=N-(N-L)*fe,de=V-(V-U)*fe,K=z-(z-j)*fe;const De=Math.round(Math.min(ge,ie)),ke=Math.round(Math.max(ge,ie));let Ne=g*Y+De*4;for(let Me=De;Me<=ke;Me++)fe=(ge-Me)/(ge-ie),fe<0?fe=0:fe>1&&(fe=1),f[Ne++]=xe-(xe-we)*fe|0,f[Ne++]=ye-(ye-de)*fe|0,f[Ne++]=pe-(pe-K)*fe|0,f[Ne++]=255}}function XW(s,e,t){const n=e.coords,r=e.colors;let i,o;switch(e.type){case Tb.LATTICE:const u=e.verticesPerRow,d=Math.floor(n.length/u)-1,h=u-1;for(i=0;i<d;i++){let f=i*u;for(let g=0;g<h;g++,f++)qE(s,t,n[f],n[f+1],n[f+u],r[f],r[f+1],r[f+u]),qE(s,t,n[f+u+1],n[f+1],n[f+u],r[f+u+1],r[f+1],r[f+u])}break;case Tb.TRIANGLES:for(i=0,o=n.length;i<o;i+=3)qE(s,t,n[i],n[i+1],n[i+2],r[i],r[i+1],r[i+2]);break;default:throw new Error("illegal figure")}}class YW extends bS{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const u=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),h=Math.ceil(this._bounds[2])-u,f=Math.ceil(this._bounds[3])-d,g=Math.min(Math.ceil(Math.abs(h*e[0]*1.1)),3e3),w=Math.min(Math.ceil(Math.abs(f*e[1]*1.1)),3e3),A=h/g,F=f/w,C={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-d,scaleX:1/A,scaleY:1/F},S=g+4,P=w+4,O=n.getCanvas("mesh",S,P),N=O.context,V=N.createImageData(g,w);if(t){const H=V.data;for(let R=0,D=H.length;R<D;R+=4)H[R]=t[0],H[R+1]=t[1],H[R+2]=t[2],H[R+3]=255}for(const H of this._figures)XW(V,H,C);return N.putImageData(V,2,2),{canvas:O.canvas,offsetX:u-2*A,offsetY:d-2*F,scaleX:A,scaleY:F}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,r){rC(e,this._bbox);const i=new Float32Array(2);if(r===fr.SHADING)_e.singularValueDecompose2dScale(sn(e),i);else if(this.matrix){_e.singularValueDecompose2dScale(this.matrix,i);const[u,d]=i;_e.singularValueDecompose2dScale(t.baseTransform,i),i[0]*=u,i[1]*=d}else _e.singularValueDecompose2dScale(t.baseTransform,i);const o=this._createMeshCanvas(i,r===fr.SHADING?null:this._background,t.cachedCanvases);return r!==fr.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class JW extends bS{getPattern(){return"hotpink"}}function ZW(s){switch(s[0]){case"RadialAxial":return new KW(s);case"Mesh":return new YW(s);case"Dummy":return new JW}throw new Error(`Unknown IR type: ${s[0]}`)}const hR={COLORED:1,UNCOLORED:2},Q_=class Q_{constructor(e,t,n,r){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=r}createPatternCanvas(e,t){var we,de;const{bbox:n,operatorList:r,paintType:i,tilingType:o,color:u,canvasGraphicsFactory:d}=this;let{xstep:h,ystep:f}=this;h=Math.abs(h),f=Math.abs(f),Bx("TilingType: "+o);const g=n[0],w=n[1],A=n[2],F=n[3],C=A-g,S=F-w,P=new Float32Array(2);_e.singularValueDecompose2dScale(this.matrix,P);const[O,N]=P;_e.singularValueDecompose2dScale(this.baseTransform,P);const V=O*P[0],z=N*P[1];let H=C,R=S,D=!1,L=!1;const U=Math.ceil(h*V),j=Math.ceil(f*z),G=Math.ceil(C*V),$=Math.ceil(S*z);U>=G?H=h:D=!0,j>=$?R=f:L=!0;const ge=this.getSizeAndScale(H,this.ctx.canvas.width,V),xe=this.getSizeAndScale(R,this.ctx.canvas.height,z),ye=e.cachedCanvases.getCanvas("pattern",ge.size,xe.size),pe=ye.context,ie=d.createCanvasGraphics(pe,t);if(ie.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(ie,i,u),pe.translate(-ge.scale*g,-xe.scale*w),ie.transform(0,ge.scale,0,0,xe.scale,0,0),pe.save(),(we=ie.dependencyTracker)==null||we.save(),this.clipBbox(ie,g,w,A,F),ie.baseTransform=sn(ie.ctx),ie.executeOperatorList(r),ie.endDrawing(),(de=ie.dependencyTracker)==null||de.restore(),pe.restore(),D||L){const K=ye.canvas;D&&(H=h),L&&(R=f);const Y=this.getSizeAndScale(H,this.ctx.canvas.width,V),fe=this.getSizeAndScale(R,this.ctx.canvas.height,z),De=Y.size,ke=fe.size,Ne=e.cachedCanvases.getCanvas("pattern-workaround",De,ke),Me=Ne.context,et=D?Math.floor(C/h):0,dt=L?Math.floor(S/f):0;for(let Gt=0;Gt<=et;Gt++)for(let vr=0;vr<=dt;vr++)Me.drawImage(K,De*Gt,ke*vr,De,ke,0,0,De,ke);return{canvas:Ne.canvas,scaleX:Y.scale,scaleY:fe.scale,offsetX:g,offsetY:w}}return{canvas:ye.canvas,scaleX:ge.scale,scaleY:xe.scale,offsetX:g,offsetY:w}}getSizeAndScale(e,t,n){const r=Math.max(Q_.MAX_PATTERN_SIZE,t);let i=Math.ceil(e*n);return i>=r?i=r:n=i/e,{scale:n,size:i}}clipBbox(e,t,n,r,i){const o=r-t,u=i-n;e.ctx.rect(t,n,o,u),_e.axialAlignedBoundingBox([t,n,r,i],sn(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const r=e.ctx,i=e.current;switch(t){case hR.COLORED:const{fillStyle:o,strokeStyle:u}=this.ctx;r.fillStyle=i.fillColor=o,r.strokeStyle=i.strokeColor=u;break;case hR.UNCOLORED:r.fillStyle=r.strokeStyle=n,i.fillColor=i.strokeColor=n;break;default:throw new dW(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,r,i){let o=n;r!==fr.SHADING&&(o=_e.transform(o,t.baseTransform),this.matrix&&(o=_e.transform(o,this.matrix)));const u=this.createPatternCanvas(t,i);let d=new DOMMatrix(o);d=d.translate(u.offsetX,u.offsetY),d=d.scale(1/u.scaleX,1/u.scaleY);const h=e.createPattern(u.canvas,"repeat");return h.setTransform(d),h}};re(Q_,"MAX_PATTERN_SIZE",3e3);let sC=Q_;function eG({src:s,srcPos:e=0,dest:t,width:n,height:r,nonBlackColor:i=4294967295,inverseDecode:o=!1}){const u=Hn.isLittleEndian?4278190080:255,[d,h]=o?[i,u]:[u,i],f=n>>3,g=n&7,w=s.length;t=new Uint32Array(t.buffer);let A=0;for(let F=0;F<r;F++){for(const S=e+f;e<S;e++){const P=e<w?s[e]:255;t[A++]=P&128?h:d,t[A++]=P&64?h:d,t[A++]=P&32?h:d,t[A++]=P&16?h:d,t[A++]=P&8?h:d,t[A++]=P&4?h:d,t[A++]=P&2?h:d,t[A++]=P&1?h:d}if(g===0)continue;const C=e<w?s[e++]:255;for(let S=0;S<g;S++)t[A++]=C&1<<7-S?h:d}return{srcPos:e,destPos:A}}const pR=16,fR=100,tG=15,mR=10,us=16,QE=new DOMMatrix,Hs=new Float32Array(2),af=new Float32Array([1/0,1/0,-1/0,-1/0]);function nG(s,e){if(s._removeMirroring)throw new Error("Context is already forwarding operations.");s.__originalSave=s.save,s.__originalRestore=s.restore,s.__originalRotate=s.rotate,s.__originalScale=s.scale,s.__originalTranslate=s.translate,s.__originalTransform=s.transform,s.__originalSetTransform=s.setTransform,s.__originalResetTransform=s.resetTransform,s.__originalClip=s.clip,s.__originalMoveTo=s.moveTo,s.__originalLineTo=s.lineTo,s.__originalBezierCurveTo=s.bezierCurveTo,s.__originalRect=s.rect,s.__originalClosePath=s.closePath,s.__originalBeginPath=s.beginPath,s._removeMirroring=()=>{s.save=s.__originalSave,s.restore=s.__originalRestore,s.rotate=s.__originalRotate,s.scale=s.__originalScale,s.translate=s.__originalTranslate,s.transform=s.__originalTransform,s.setTransform=s.__originalSetTransform,s.resetTransform=s.__originalResetTransform,s.clip=s.__originalClip,s.moveTo=s.__originalMoveTo,s.lineTo=s.__originalLineTo,s.bezierCurveTo=s.__originalBezierCurveTo,s.rect=s.__originalRect,s.closePath=s.__originalClosePath,s.beginPath=s.__originalBeginPath,delete s._removeMirroring},s.save=function(){e.save(),this.__originalSave()},s.restore=function(){e.restore(),this.__originalRestore()},s.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},s.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},s.transform=function(t,n,r,i,o,u){e.transform(t,n,r,i,o,u),this.__originalTransform(t,n,r,i,o,u)},s.setTransform=function(t,n,r,i,o,u){e.setTransform(t,n,r,i,o,u),this.__originalSetTransform(t,n,r,i,o,u)},s.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},s.rotate=function(t){e.rotate(t),this.__originalRotate(t)},s.clip=function(t){e.clip(t),this.__originalClip(t)},s.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},s.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},s.bezierCurveTo=function(t,n,r,i,o,u){e.bezierCurveTo(t,n,r,i,o,u),this.__originalBezierCurveTo(t,n,r,i,o,u)},s.rect=function(t,n,r,i){e.rect(t,n,r,i),this.__originalRect(t,n,r,i)},s.closePath=function(){e.closePath(),this.__originalClosePath()},s.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class rG{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let r;return this.cache[e]!==void 0?(r=this.cache[e],this.canvasFactory.reset(r,t,n)):(r=this.canvasFactory.create(t,n),this.cache[e]=r),r}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function lA(s,e,t,n,r,i,o,u,d,h){const[f,g,w,A,F,C]=sn(s);if(g===0&&w===0){const O=o*f+F,N=Math.round(O),V=u*A+C,z=Math.round(V),H=(o+d)*f+F,R=Math.abs(Math.round(H)-N)||1,D=(u+h)*A+C,L=Math.abs(Math.round(D)-z)||1;return s.setTransform(Math.sign(f),0,0,Math.sign(A),N,z),s.drawImage(e,t,n,r,i,0,0,R,L),s.setTransform(f,g,w,A,F,C),[R,L]}if(f===0&&A===0){const O=u*w+F,N=Math.round(O),V=o*g+C,z=Math.round(V),H=(u+h)*w+F,R=Math.abs(Math.round(H)-N)||1,D=(o+d)*g+C,L=Math.abs(Math.round(D)-z)||1;return s.setTransform(0,Math.sign(g),Math.sign(w),0,N,z),s.drawImage(e,t,n,r,i,0,0,L,R),s.setTransform(f,g,w,A,F,C),[L,R]}s.drawImage(e,t,n,r,i,o,u,d,h);const S=Math.hypot(f,g),P=Math.hypot(w,A);return[S*d,P*h]}class gR{constructor(e,t,n){re(this,"alphaIsShape",!1);re(this,"fontSize",0);re(this,"fontSizeScale",1);re(this,"textMatrix",null);re(this,"textMatrixScale",1);re(this,"fontMatrix",Sb);re(this,"leading",0);re(this,"x",0);re(this,"y",0);re(this,"lineX",0);re(this,"lineY",0);re(this,"charSpacing",0);re(this,"wordSpacing",0);re(this,"textHScale",1);re(this,"textRenderingMode",Vn.FILL);re(this,"textRise",0);re(this,"fillColor","#000000");re(this,"strokeColor","#000000");re(this,"patternFill",!1);re(this,"patternStroke",!1);re(this,"fillAlpha",1);re(this,"strokeAlpha",1);re(this,"lineWidth",1);re(this,"activeSMask",null);re(this,"transferMaps","none");n==null||n(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=af.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=fr.FILL,t=null){const n=this.minMax.slice();if(e===fr.STROKE){t||At("Stroke bounding box must include transform."),_e.singularValueDecompose2dScale(t,Hs);const r=Hs[0]*this.lineWidth/2,i=Hs[1]*this.lineWidth/2;n[0]-=r,n[1]-=i,n[2]+=r,n[3]+=i}return n}updateClipFromPath(){const e=_e.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(af,0)}getClippedPathBoundingBox(e=fr.FILL,t=null){return _e.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function yR(s,e){if(e instanceof ImageData){s.putImageData(e,0,0);return}const t=e.height,n=e.width,r=t%us,i=(t-r)/us,o=r===0?i:i+1,u=s.createImageData(n,us);let d=0,h;const f=e.data,g=u.data;let w,A,F,C;if(e.kind===CA.GRAYSCALE_1BPP){const S=f.byteLength,P=new Uint32Array(g.buffer,0,g.byteLength>>2),O=P.length,N=n+7>>3,V=4294967295,z=Hn.isLittleEndian?4278190080:255;for(w=0;w<o;w++){for(F=w<i?us:r,h=0,A=0;A<F;A++){const H=S-d;let R=0;const D=H>N?n:H*8-7,L=D&-8;let U=0,j=0;for(;R<L;R+=8)j=f[d++],P[h++]=j&128?V:z,P[h++]=j&64?V:z,P[h++]=j&32?V:z,P[h++]=j&16?V:z,P[h++]=j&8?V:z,P[h++]=j&4?V:z,P[h++]=j&2?V:z,P[h++]=j&1?V:z;for(;R<D;R++)U===0&&(j=f[d++],U=128),P[h++]=j&U?V:z,U>>=1}for(;h<O;)P[h++]=0;s.putImageData(u,0,w*us)}}else if(e.kind===CA.RGBA_32BPP){for(A=0,C=n*us*4,w=0;w<i;w++)g.set(f.subarray(d,d+C)),d+=C,s.putImageData(u,0,A),A+=us;w<o&&(C=n*r*4,g.set(f.subarray(d,d+C)),s.putImageData(u,0,A))}else if(e.kind===CA.RGB_24BPP)for(F=us,C=n*F,w=0;w<o;w++){for(w>=i&&(F=r,C=n*F),h=0,A=C;A--;)g[h++]=f[d++],g[h++]=f[d++],g[h++]=f[d++],g[h++]=255;s.putImageData(u,0,w*us)}else throw new Error(`bad image kind: ${e.kind}`)}function wR(s,e){if(e.bitmap){s.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,r=t%us,i=(t-r)/us,o=r===0?i:i+1,u=s.createImageData(n,us);let d=0;const h=e.data,f=u.data;for(let g=0;g<o;g++){const w=g<i?us:r;({srcPos:d}=eG({src:h,srcPos:d,dest:f,width:n,height:w,nonBlackColor:0})),s.putImageData(u,0,g*us)}}function cg(s,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)s[n]!==void 0&&(e[n]=s[n]);s.setLineDash!==void 0&&(e.setLineDash(s.getLineDash()),e.lineDashOffset=s.lineDashOffset)}function cA(s){s.strokeStyle=s.fillStyle="#000000",s.fillRule="nonzero",s.globalAlpha=1,s.lineWidth=1,s.lineCap="butt",s.lineJoin="miter",s.miterLimit=10,s.globalCompositeOperation="source-over",s.font="10px sans-serif",s.setLineDash!==void 0&&(s.setLineDash([]),s.lineDashOffset=0);const{filter:e}=s;e!=="none"&&e!==""&&(s.filter="none")}function vR(s,e){if(e)return!0;_e.singularValueDecompose2dScale(s,Hs);const t=Math.fround(ho.pixelRatio*Nu.PDF_TO_CSS_UNITS);return Hs[0]<=t&&Hs[1]<=t}const sG=["butt","round","square"],iG=["miter","round","bevel"],aG={},AR={};var sa,iC,aC,oC;const DS=class DS{constructor(e,t,n,r,i,{optionalContentConfig:o,markedContentStack:u=null},d,h,f){T(this,sa);this.ctx=e,this.current=new gR(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=r,this.filterFactory=i,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=o,this.cachedCanvases=new rG(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=h,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=f??null}getObject(e,t,n=null){var r;return typeof t=="string"?((r=this.dependencyTracker)==null||r.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):n}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:r=null}){const i=this.ctx.canvas.width,o=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,i,o),this.ctx.fillStyle=u,n){const d=this.cachedCanvases.getCanvas("transparent",i,o);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...sn(this.compositeCtx))}this.ctx.save(),cA(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=sn(this.ctx)}executeOperatorList(e,t,n,r,i){var P;const o=e.argsArray,u=e.fnArray;let d=t||0;const h=o.length;if(h===d)return d;const f=h-d>mR&&typeof n=="function",g=f?Date.now()+tG:0;let w=0;const A=this.commonObjs,F=this.objs;let C,S;for(;;){if(r!==void 0&&d===r.nextBreakPoint)return r.breakIt(d,n),d;if(!i||i(d))if(C=u[d],S=o[d]??null,C!==oy.dependency)S===null?this[C](d):this[C](d,...S);else for(const O of S){(P=this.dependencyTracker)==null||P.recordNamedData(O,d);const N=O.startsWith("g_")?A:F;if(!N.has(O))return N.get(O,n),d}if(d++,d===h)return d;if(f&&++w>mR){if(Date.now()>g)return n(),d;w=0}}}endDrawing(){I(this,sa,iC).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),I(this,sa,aC).call(this)}_scaleImage(e,t){const n=e.width??e.displayWidth,r=e.height??e.displayHeight;let i=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),u=n,d=r,h="prescale1",f,g;for(;i>2&&u>1||o>2&&d>1;){let w=u,A=d;i>2&&u>1&&(w=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),i/=u/w),o>2&&d>1&&(A=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,o/=d/A),f=this.cachedCanvases.getCanvas(h,w,A),g=f.context,g.clearRect(0,0,w,A),g.drawImage(e,0,0,u,d,0,0,w,A),e=f.canvas,u=w,d=A,h=h==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:u,paintHeight:d}}_createMaskCanvas(e,t){var U,j;const n=this.ctx,{width:r,height:i}=t,o=this.current.fillColor,u=this.current.patternFill,d=sn(n);let h,f,g,w;if((t.bitmap||t.data)&&t.count>1){const G=t.bitmap||t.data.buffer;f=JSON.stringify(u?d:[d.slice(0,4),o]),h=this._cachedBitmapsMap.get(G),h||(h=new Map,this._cachedBitmapsMap.set(G,h));const $=h.get(f);if($&&!u){const ge=Math.round(Math.min(d[0],d[2])+d[4]),xe=Math.round(Math.min(d[1],d[3])+d[5]);return(U=this.dependencyTracker)==null||U.recordDependencies(e,ai.transformAndFill),{canvas:$,offsetX:ge,offsetY:xe}}g=$}g||(w=this.cachedCanvases.getCanvas("maskCanvas",r,i),wR(w.context,t));let A=_e.transform(d,[1/r,0,0,-1/i,0,0]);A=_e.transform(A,[1,0,0,1,0,-i]);const F=af.slice();_e.axialAlignedBoundingBox([0,0,r,i],A,F);const[C,S,P,O]=F,N=Math.round(P-C)||1,V=Math.round(O-S)||1,z=this.cachedCanvases.getCanvas("fillCanvas",N,V),H=z.context,R=C,D=S;H.translate(-R,-D),H.transform(...A),g||(g=this._scaleImage(w.canvas,Fa(H)),g=g.img,h&&u&&h.set(f,g)),H.imageSmoothingEnabled=vR(sn(H),t.interpolate),lA(H,g,0,0,g.width,g.height,0,0,r,i),H.globalCompositeOperation="source-in";const L=_e.transform(Fa(H),[1,0,0,1,-R,-D]);return H.fillStyle=u?o.getPattern(n,this,L,fr.FILL,e):o,H.fillRect(0,0,r,i),h&&!u&&(this.cachedCanvases.delete("fillCanvas"),h.set(f,z.canvas)),(j=this.dependencyTracker)==null||j.recordDependencies(e,ai.transformAndFill),{canvas:z.canvas,offsetX:Math.round(R),offsetY:Math.round(D)}}setLineWidth(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineCap",e),this.ctx.lineCap=sG[t]}setLineJoin(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineJoin",e),this.ctx.lineJoin=iG[t]}setMiterLimit(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,n){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("dash",e);const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(t),r.lineDashOffset=n)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var n,r,i,o,u;for(const[d,h]of t)switch(d){case"LW":this.setLineWidth(e,h);break;case"LC":this.setLineCap(e,h);break;case"LJ":this.setLineJoin(e,h);break;case"ML":this.setMiterLimit(e,h);break;case"D":this.setDash(e,h[0],h[1]);break;case"RI":this.setRenderingIntent(e,h);break;case"FL":this.setFlatness(e,h);break;case"Font":this.setFont(e,h[0],h[1]);break;case"CA":(n=this.dependencyTracker)==null||n.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=h;break;case"ca":(r=this.dependencyTracker)==null||r.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=h;break;case"BM":(i=this.dependencyTracker)==null||i.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=h;break;case"SMask":(o=this.dependencyTracker)==null||o.recordSimpleData("SMask",e),this.current.activeSMask=h?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(u=this.dependencyTracker)==null||u.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(h);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,n=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(r,t,n);this.suspendedCtx=this.ctx;const o=this.ctx=i.context;o.setTransform(this.suspendedCtx.getTransform()),cg(this.suspendedCtx,o),nG(o,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),cg(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,r){const i=r[0],o=r[1],u=r[2]-i,d=r[3]-o;u===0||d===0||(this.genericComposeSMask(t.context,n,u,d,t.subtype,t.backdrop,t.transferMap,i,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,r,i,o,u,d,h,f,g){let w=e.canvas,A=d-f,F=h-g;if(o)if(A<0||F<0||A+n>w.width||F+r>w.height){const S=this.cachedCanvases.getCanvas("maskExtension",n,r),P=S.context;P.drawImage(w,-A,-F),P.globalCompositeOperation="destination-atop",P.fillStyle=o,P.fillRect(0,0,n,r),P.globalCompositeOperation="source-over",w=S.canvas,A=F=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const S=new Path2D;S.rect(A,F,n,r),e.clip(S),e.globalCompositeOperation="destination-atop",e.fillStyle=o,e.fillRect(A,F,n,r),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),i==="Alpha"&&u?t.filter=this.filterFactory.addAlphaFilter(u):i==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(u));const C=new Path2D;C.rect(d,h,n,r),t.clip(C),t.globalCompositeOperation="destination-in",t.drawImage(w,A,F,n,r,d,h,n,r),t.restore()}save(e){var n;this.inSMaskMode&&cg(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(n=this.dependencyTracker)==null||n.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&cg(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,n,r,i,o,u){var d;(d=this.dependencyTracker)==null||d.recordIncrementalData("transform",e),this.ctx.transform(t,n,r,i,o,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n,r){let[i]=n;if(!r){i||(i=n[0]=new Path2D),this[t](e,i);return}if(this.dependencyTracker!==null){const o=t===oy.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,r[0]-o,r[2]+o,r[1]-o,r[3]+o).recordDependencies(e,["transform"])}i instanceof Path2D||(i=n[0]=qN(i)),_e.axialAlignedBoundingBox(r,sn(this.ctx),this.current.minMax),this[t](e,i),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,n=!0){var o;const r=this.ctx,i=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof i=="object"&&(i!=null&&i.getPattern)){const u=i.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=i.getPattern(r,this,Fa(r),fr.STROKE,e),u){const d=new Path2D;d.addPath(t,r.getTransform().invertSelf().multiplySelf(u)),t=d}this.rescaleAndStroke(t,!1),r.restore()}else this.rescaleAndStroke(t,!0);(o=this.dependencyTracker)==null||o.recordDependencies(e,ai.stroke),n&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(fr.STROKE,sn(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,n=!0){var h,f,g;const r=this.ctx,i=this.current.fillColor,o=this.current.patternFill;let u=!1;if(o){const w=i.isModifyingCurrentTransform()?r.getTransform():null;if((h=this.dependencyTracker)==null||h.save(e),r.save(),r.fillStyle=i.getPattern(r,this,Fa(r),fr.FILL,e),w){const A=new Path2D;A.addPath(t,r.getTransform().invertSelf().multiplySelf(w)),t=A}u=!0}const d=this.current.getClippedPathBoundingBox();this.contentVisible&&d!==null&&(this.pendingEOFill?(r.fill(t,"evenodd"),this.pendingEOFill=!1):r.fill(t)),(f=this.dependencyTracker)==null||f.recordDependencies(e,ai.fill),u&&(r.restore(),(g=this.dependencyTracker)==null||g.restore(e)),n&&this.consumePath(e,t,d)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var n;this.ctx.fill(t),(n=this.dependencyTracker)==null||n.recordDependencies(e,ai.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=aG}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=AR}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:r}=this;t!==void 0&&r.recordFutureForcedDependency("textClip",r.getOpenMarker()).recordFutureForcedDependency("textClip",e),r.recordCloseMarker(e)}if(t!==void 0){const r=new Path2D,i=n.getTransform().invertSelf();for(const{transform:o,x:u,y:d,fontSize:h,path:f}of t)f&&r.addPath(f,new DOMMatrix(o).preMultiplySelf(i).translate(u,d).scale(h,-h));n.clip(r)}delete this.pendingTextPaths}setCharSpacing(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,n){var g,w;(g=this.dependencyTracker)==null||g.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const r=this.commonObjs.get(t),i=this.current;if(!r)throw new Error(`Can't find font for ${t}`);if(i.fontMatrix=r.fontMatrix||Sb,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&Ge("Invalid font matrix for font "+t),n<0?(n=-n,i.fontDirection=-1):i.fontDirection=1,this.current.font=r,this.current.fontSize=n,r.isType3Font)return;const o=r.loadedName||"sans-serif",u=((w=r.systemFontInfo)==null?void 0:w.css)||`"${o}", ${r.fallbackName}`;let d="normal";r.black?d="900":r.bold&&(d="bold");const h=r.italic?"italic":"normal";let f=n;n<pR?f=pR:n>fR&&(f=fR),this.current.fontSizeScale=n/f,this.ctx.font=`${h} ${d} ${f}px ${u}`}setTextRenderingMode(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,n){var r;(r=this.dependencyTracker)==null||r.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n}setLeadingMoveText(e,t,n){this.setLeading(e,-n),this.moveText(e,t,n)}setTextMatrix(e,t){var r;(r=this.dependencyTracker)==null||r.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:n}=this;n.textMatrix=t,n.textMatrixScale=Math.hypot(t[0],t[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,n,r,i,o){var P,O,N,V;const u=this.ctx,d=this.current,h=d.font,f=d.textRenderingMode,g=d.fontSize/d.fontSizeScale,w=f&Vn.FILL_STROKE_MASK,A=!!(f&Vn.ADD_TO_PATH_FLAG),F=d.patternFill&&!h.missingFile,C=d.patternStroke&&!h.missingFile;let S;if((h.disableFontFace||A||F||C)&&!h.missingFile&&(S=h.getPathGenerator(this.commonObjs,t)),S&&(h.disableFontFace||F||C)){u.save(),u.translate(n,r),u.scale(g,-g),(P=this.dependencyTracker)==null||P.recordCharacterBBox(e,u,h);let z;if(w===Vn.FILL||w===Vn.FILL_STROKE)if(i){z=u.getTransform(),u.setTransform(...i);const H=I(this,sa,oC).call(this,S,z,i);u.fill(H)}else u.fill(S);if(w===Vn.STROKE||w===Vn.FILL_STROKE)if(o){z||(z=u.getTransform()),u.setTransform(...o);const{a:H,b:R,c:D,d:L}=z,U=_e.inverseTransform(o),j=_e.transform([H,R,D,L,0,0],U);_e.singularValueDecompose2dScale(j,Hs),u.lineWidth*=Math.max(Hs[0],Hs[1])/g,u.stroke(I(this,sa,oC).call(this,S,z,o))}else u.lineWidth/=g,u.stroke(S);u.restore()}else(w===Vn.FILL||w===Vn.FILL_STROKE)&&(u.fillText(t,n,r),(O=this.dependencyTracker)==null||O.recordCharacterBBox(e,u,h,g,n,r,()=>u.measureText(t))),(w===Vn.STROKE||w===Vn.FILL_STROKE)&&(this.dependencyTracker&&((N=this.dependencyTracker)==null||N.recordCharacterBBox(e,u,h,g,n,r,()=>u.measureText(t)).recordDependencies(e,ai.stroke)),u.strokeText(t,n,r));A&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:sn(u),x:n,y:r,fontSize:g,path:S}),(V=this.dependencyTracker)==null||V.recordCharacterBBox(e,u,h,g,n,r))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){n=!0;break}return qe(this,"isFontSubpixelAAEnabled",n)}showText(e,t){var j,G,$,ge;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,ai.showText).resetBBox(e),this.current.textRenderingMode&Vn.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,r=n.font;if(r.isType3Font){this.showType3Text(e,t),(j=this.dependencyTracker)==null||j.recordShowTextOperation(e);return}const i=n.fontSize;if(i===0){(G=this.dependencyTracker)==null||G.recordOperation(e);return}const o=this.ctx,u=n.fontSizeScale,d=n.charSpacing,h=n.wordSpacing,f=n.fontDirection,g=n.textHScale*f,w=t.length,A=r.vertical,F=A?1:-1,C=r.defaultVMetrics,S=i*n.fontMatrix[0],P=n.textRenderingMode===Vn.FILL&&!r.disableFontFace&&!n.patternFill;o.save(),n.textMatrix&&o.transform(...n.textMatrix),o.translate(n.x,n.y+n.textRise),f>0?o.scale(g,-1):o.scale(g,1);let O,N;const V=n.textRenderingMode&Vn.FILL_STROKE_MASK,z=V===Vn.FILL||V===Vn.FILL_STROKE,H=V===Vn.STROKE||V===Vn.FILL_STROKE;if(z&&n.patternFill){o.save();const xe=n.fillColor.getPattern(o,this,Fa(o),fr.FILL,e);O=sn(o),o.restore(),o.fillStyle=xe}if(H&&n.patternStroke){o.save();const xe=n.strokeColor.getPattern(o,this,Fa(o),fr.STROKE,e);N=sn(o),o.restore(),o.strokeStyle=xe}let R=n.lineWidth;const D=n.textMatrixScale;if(D===0||R===0?H&&(R=this.getSinglePixelWidth()):R/=D,u!==1&&(o.scale(u,u),R/=u),o.lineWidth=R,r.isInvalidPDFjsFont){const xe=[];let ye=0;for(const ie of t)xe.push(ie.unicode),ye+=ie.width;const pe=xe.join("");if(o.fillText(pe,0,0),this.dependencyTracker!==null){const ie=o.measureText(pe);this.dependencyTracker.recordBBox(e,this.ctx,-ie.actualBoundingBoxLeft,ie.actualBoundingBoxRight,-ie.actualBoundingBoxAscent,ie.actualBoundingBoxDescent).recordShowTextOperation(e)}n.x+=ye*S*g,o.restore(),this.compose();return}let L=0,U;for(U=0;U<w;++U){const xe=t[U];if(typeof xe=="number"){L+=F*xe*i/1e3;continue}let ye=!1;const pe=(xe.isSpace?h:0)+d,ie=xe.fontChar,we=xe.accent;let de,K,Y=xe.width;if(A){const ke=xe.vmetric||C,Ne=-(xe.vmetric?ke[1]:Y*.5)*S,Me=ke[2]*S;Y=ke?-ke[0]:Y,de=Ne/u,K=(L+Me)/u}else de=L/u,K=0;let fe;if(r.remeasure&&Y>0){fe=o.measureText(ie);const ke=fe.width*1e3/i*u;if(Y<ke&&this.isFontSubpixelAAEnabled){const Ne=Y/ke;ye=!0,o.save(),o.scale(Ne,1),de/=Ne}else Y!==ke&&(de+=(Y-ke)/2e3*i/u)}if(this.contentVisible&&(xe.isInFont||r.missingFile)){if(P&&!we)o.fillText(ie,de,K),($=this.dependencyTracker)==null||$.recordCharacterBBox(e,o,fe?{bbox:null}:r,i/u,de,K,()=>fe??o.measureText(ie));else if(this.paintChar(e,ie,de,K,O,N),we){const ke=de+i*we.offset.x/u,Ne=K-i*we.offset.y/u;this.paintChar(e,we.fontChar,ke,Ne,O,N)}}const De=A?Y*S-pe*f:Y*S+pe*f;L+=De,ye&&o.restore()}A?n.y-=L:n.x+=L*g,o.restore(),this.compose(),(ge=this.dependencyTracker)==null||ge.recordShowTextOperation(e)}showType3Text(e,t){const n=this.ctx,r=this.current,i=r.font,o=r.fontSize,u=r.fontDirection,d=i.vertical?1:-1,h=r.charSpacing,f=r.wordSpacing,g=r.textHScale*u,w=r.fontMatrix||Sb,A=t.length,F=r.textRenderingMode===Vn.INVISIBLE;let C,S,P,O;if(F||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),r.textMatrix&&n.transform(...r.textMatrix),n.translate(r.x,r.y+r.textRise),n.scale(g,u);const N=this.dependencyTracker;for(this.dependencyTracker=N?new D_(N,e):null,C=0;C<A;++C){if(S=t[C],typeof S=="number"){O=d*S*o/1e3,this.ctx.translate(O,0),r.x+=O*g;continue}const V=(S.isSpace?f:0)+h,z=i.charProcOperatorList[S.operatorListId];z?this.contentVisible&&(this.save(),n.scale(o,o),n.transform(...w),this.executeOperatorList(z),this.restore()):Ge(`Type3 character "${S.operatorListId}" is not available.`);const H=[S.width,0];_e.applyTransform(H,w),P=H[0]*o+V,n.translate(P,0),r.x+=P*g}n.restore(),N&&(this.dependencyTracker=N)}setCharWidth(e,t,n){}setCharWidthAndBounds(e,t,n,r,i,o,u){var h;const d=new Path2D;d.rect(r,i,o-r,u-i),this.ctx.clip(d),(h=this.dependencyTracker)==null||h.recordBBox(e,this.ctx,r,o,i,u).recordClipBox(e,this.ctx,r,o,i,u),this.endPath(e)}getColorN_Pattern(e,t){let n;if(t[0]==="TilingPattern"){const r=this.baseTransform||sn(this.ctx),i={createCanvasGraphics:(o,u)=>new DS(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new D_(this.dependencyTracker,u,!0):null)};n=new sC(t,this.ctx,i,r)}else n=this._getPattern(e,t[1],t[2]);return n}setStrokeColorN(e,...t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,n=null){let r;return this.cachedPatterns.has(t)?r=this.cachedPatterns.get(t):(r=ZW(this.getObject(e,t)),this.cachedPatterns.set(t,r)),n&&(r.matrix=n),r}shadingFill(e,t){var o;if(!this.contentVisible)return;const n=this.ctx;this.save(e);const r=this._getPattern(e,t);n.fillStyle=r.getPattern(n,this,Fa(n),fr.SHADING,e);const i=Fa(n);if(i){const{width:u,height:d}=n.canvas,h=af.slice();_e.axialAlignedBoundingBox([0,0,u,d],i,h);const[f,g,w,A]=h;this.ctx.fillRect(f,g,w-f,A-g)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(o=this.dependencyTracker)==null||o.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,ai.transform).recordDependencies(e,ai.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){At("Should not call beginInlineImage")}beginImageData(){At("Should not call beginImageData")}paintFormXObjectBegin(e,t,n){var r;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=sn(this.ctx),n)){_e.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[i,o,u,d]=n,h=new Path2D;h.rect(i,o,u-i,d-o),this.ctx.clip(h),(r=this.dependencyTracker)==null||r.recordClipBox(e,this.ctx,i,u,o,d),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var N;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;t.isolated||Bx("TODO: Support non-isolated groups."),t.knockout&&Ge("Knockout groups not supported.");const r=sn(n);if(t.matrix&&n.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=af.slice();_e.axialAlignedBoundingBox(t.bbox,sn(n),i);const o=[0,0,n.canvas.width,n.canvas.height];i=_e.intersect(i,o)||[0,0,0,0];const u=Math.floor(i[0]),d=Math.floor(i[1]),h=Math.max(Math.ceil(i[2])-u,1),f=Math.max(Math.ceil(i[3])-d,1);this.current.startNewPathAndClipBox([0,0,h,f]);let g="groupAt"+this.groupLevel;t.smask&&(g+="_smask_"+this.smaskCounter++%2);const w=this.cachedCanvases.getCanvas(g,h,f),A=w.context;A.translate(-u,-d),A.transform(...r);let F=new Path2D;const[C,S,P,O]=t.bbox;if(F.rect(C,S,P-C,O-S),t.matrix){const V=new Path2D;V.addPath(F,new DOMMatrix(t.matrix)),F=V}A.clip(F),t.smask&&this.smaskStack.push({canvas:w.canvas,context:A,offsetX:u,offsetY:d,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(u,d),n.save()),cg(n,A),this.ctx=A,(N=this.dependencyTracker)==null||N.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(e,t){var i;if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,(i=this.dependencyTracker)==null||i.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=sn(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...o);const u=af.slice();_e.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],o,u),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(u)}}beginAnnotation(e,t,n,r,i,o){if(I(this,sa,iC).call(this),cA(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const u=n[2]-n[0],d=n[3]-n[1];if(o&&this.annotationCanvasMap){r=r.slice(),r[4]-=n[0],r[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=u,n[3]=d,_e.singularValueDecompose2dScale(sn(this.ctx),Hs);const{viewportScale:h}=this,f=Math.ceil(u*this.outputScaleX*h),g=Math.ceil(d*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(f,g);const{canvas:w,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(t,w),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(Hs[0],0,0,-Hs[1],0,d*Hs[1]),cA(this.ctx)}else{cA(this.ctx),this.endPath(e);const h=new Path2D;h.rect(n[0],n[1],u,d),this.ctx.clip(h)}}this.current=new gR(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...r),this.transform(e,...i)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),I(this,sa,aC).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var u;if(!this.contentVisible)return;const n=t.count;t=this.getObject(e,t.data,t),t.count=n;const r=this.ctx,i=this._createMaskCanvas(e,t),o=i.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(o,i.offsetX,i.offsetY),(u=this.dependencyTracker)==null||u.resetBBox(e).recordBBox(e,this.ctx,i.offsetX,i.offsetX+o.width,i.offsetY,i.offsetY+o.height).recordOperation(e),r.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n,r=0,i=0,o,u){var g,w,A;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const d=this.ctx;d.save();const h=sn(d);d.transform(n,r,i,o,0,0);const f=this._createMaskCanvas(e,t);d.setTransform(1,0,0,1,f.offsetX-h[4],f.offsetY-h[5]),(g=this.dependencyTracker)==null||g.resetBBox(e);for(let F=0,C=u.length;F<C;F+=2){const S=_e.transform(h,[n,r,i,o,u[F],u[F+1]]);d.drawImage(f.canvas,S[4],S[5]),(w=this.dependencyTracker)==null||w.recordBBox(e,this.ctx,S[4],S[4]+f.canvas.width,S[5],S[5]+f.canvas.height)}d.restore(),this.compose(),(A=this.dependencyTracker)==null||A.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var o,u,d;if(!this.contentVisible)return;const n=this.ctx,r=this.current.fillColor,i=this.current.patternFill;(o=this.dependencyTracker)==null||o.resetBBox(e).recordDependencies(e,ai.transformAndFill);for(const h of t){const{data:f,width:g,height:w,transform:A}=h,F=this.cachedCanvases.getCanvas("maskCanvas",g,w),C=F.context;C.save();const S=this.getObject(e,f,h);wR(C,S),C.globalCompositeOperation="source-in",C.fillStyle=i?r.getPattern(C,this,Fa(n),fr.FILL,e):r,C.fillRect(0,0,g,w),C.restore(),n.save(),n.transform(...A),n.scale(1,-1),lA(n,F.canvas,0,0,g,w,0,-1,1,1),(u=this.dependencyTracker)==null||u.recordBBox(e,n,0,g,0,w),n.restore()}this.compose(),(d=this.dependencyTracker)==null||d.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const n=this.getObject(e,t);if(!n){Ge("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,n)}paintImageXObjectRepeat(e,t,n,r,i){if(!this.contentVisible)return;const o=this.getObject(e,t);if(!o){Ge("Dependent image isn't ready yet");return}const u=o.width,d=o.height,h=[];for(let f=0,g=i.length;f<g;f+=2)h.push({transform:[n,0,0,r,i[f],i[f+1]],x:0,y:0,w:u,h:d});this.paintInlineImageXObjectGroup(e,o,h)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:r}=e,i=this.cachedCanvases.getCanvas("inlineImage",n,r),o=i.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",i.canvas}paintInlineImageXObject(e,t){var h;if(!this.contentVisible)return;const n=t.width,r=t.height,i=this.ctx;this.save(e);const{filter:o}=i;o!=="none"&&o!==""&&(i.filter="none"),i.scale(1/n,-1/r);let u;if(t.bitmap)u=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)u=t;else{const g=this.cachedCanvases.getCanvas("inlineImage",n,r).context;yR(g,t),u=this.applyTransferMapsToCanvas(g)}const d=this._scaleImage(u,Fa(i));i.imageSmoothingEnabled=vR(sn(i),t.interpolate),(h=this.dependencyTracker)==null||h.resetBBox(e).recordBBox(e,i,0,n,-r,0).recordDependencies(e,ai.imageXObject).recordOperation(e),lA(i,d.img,0,0,d.paintWidth,d.paintHeight,0,-r,n,r),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,n){var o,u,d;if(!this.contentVisible)return;const r=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const h=t.width,f=t.height,w=this.cachedCanvases.getCanvas("inlineImage",h,f).context;yR(w,t),i=this.applyTransferMapsToCanvas(w)}(o=this.dependencyTracker)==null||o.resetBBox(e);for(const h of n)r.save(),r.transform(...h.transform),r.scale(1,-1),lA(r,i,h.x,h.y,h.w,h.h,0,-1,1,1),(u=this.dependencyTracker)==null||u.recordBBox(e,r,0,1,-1,0),r.restore();(d=this.dependencyTracker)==null||d.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,ai.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,n){}beginMarkedContent(e,t){var n;(n=this.dependencyTracker)==null||n.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,n){var r;(r=this.dependencyTracker)==null||r.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,n){var o,u;const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const i=this.ctx;this.pendingClip?(r||(this.pendingClip===AR?i.clip(t,"evenodd"):i.clip(t)),this.pendingClip=null,(o=this.dependencyTracker)==null||o.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(u=this.dependencyTracker)==null||u.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=sn(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:r,d:i}=this.ctx.getTransform();let o,u;if(n===0&&r===0){const d=Math.abs(t),h=Math.abs(i);if(d===h)if(e===0)o=u=1/d;else{const f=d*e;o=u=f<1?1/f:1}else if(e===0)o=1/d,u=1/h;else{const f=d*e,g=h*e;o=f<1?1/f:1,u=g<1?1/g:1}}else{const d=Math.abs(t*i-n*r),h=Math.hypot(t,n),f=Math.hypot(r,i);if(e===0)o=f/d,u=h/d;else{const g=e*d;o=f>g?f/g:1,u=h>g?h/g:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:r}}=this,[i,o]=this.getScaleForStroking();if(i===o){n.lineWidth=(r||1)*i,n.stroke(e);return}const u=n.getLineDash();t&&n.save(),n.scale(i,o),QE.a=1/i,QE.d=1/o;const d=new Path2D;if(d.addPath(e,QE),u.length>0){const h=Math.max(i,o);n.setLineDash(u.map(f=>f/h)),n.lineDashOffset/=h}n.lineWidth=r||1,n.stroke(d),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};sa=new WeakSet,iC=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},aC=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},oC=function(e,t,n){const r=new Path2D;return r.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),r};let yf=DS;for(const s in oy)yf.prototype[s]!==void 0&&(yf.prototype[oy[s]]=yf.prototype[s]);var Zy,ew;class Ja{static get workerPort(){return c(this,Zy)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");x(this,Zy,e)}static get workerSrc(){return c(this,ew)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");x(this,ew,e)}}Zy=new WeakMap,ew=new WeakMap,T(Ja,Zy,null),T(Ja,ew,"");var tm,tw;class oG{constructor({parsedData:e,rawData:t}){T(this,tm);T(this,tw);x(this,tm,e),x(this,tw,t)}getRaw(){return c(this,tw)}get(e){return c(this,tm).get(e)??null}[Symbol.iterator](){return c(this,tm).entries()}}tm=new WeakMap,tw=new WeakMap;const ef=Symbol("INTERNAL");var nw,rw,sw,nm;class lG{constructor(e,{name:t,intent:n,usage:r,rbGroups:i}){T(this,nw,!1);T(this,rw,!1);T(this,sw,!1);T(this,nm,!0);x(this,nw,!!(e&zs.DISPLAY)),x(this,rw,!!(e&zs.PRINT)),this.name=t,this.intent=n,this.usage=r,this.rbGroups=i}get visible(){if(c(this,sw))return c(this,nm);if(!c(this,nm))return!1;const{print:e,view:t}=this.usage;return c(this,nw)?(t==null?void 0:t.viewState)!=="OFF":c(this,rw)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,n=!1){e!==ef&&At("Internal method `_setVisible` called."),x(this,sw,n),x(this,nm,t)}}nw=new WeakMap,rw=new WeakMap,sw=new WeakMap,nm=new WeakMap;var qc,Pt,rm,sm,iw,lC;class cG{constructor(e,t=zs.DISPLAY){T(this,iw);T(this,qc,null);T(this,Pt,new Map);T(this,rm,null);T(this,sm,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,x(this,sm,e.order);for(const n of e.groups)c(this,Pt).set(n.id,new lG(t,n));if(e.baseState==="OFF")for(const n of c(this,Pt).values())n._setVisible(ef,!1);for(const n of e.on)c(this,Pt).get(n)._setVisible(ef,!0);for(const n of e.off)c(this,Pt).get(n)._setVisible(ef,!1);x(this,rm,this.getHash())}}isVisible(e){if(c(this,Pt).size===0)return!0;if(!e)return Bx("Optional content group not defined."),!0;if(e.type==="OCG")return c(this,Pt).has(e.id)?c(this,Pt).get(e.id).visible:(Ge(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return I(this,iw,lC).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!c(this,Pt).has(t))return Ge(`Optional content group not found: ${t}`),!0;if(c(this,Pt).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!c(this,Pt).has(t))return Ge(`Optional content group not found: ${t}`),!0;if(!c(this,Pt).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!c(this,Pt).has(t))return Ge(`Optional content group not found: ${t}`),!0;if(!c(this,Pt).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!c(this,Pt).has(t))return Ge(`Optional content group not found: ${t}`),!0;if(c(this,Pt).get(t).visible)return!1}return!0}return Ge(`Unknown optional content policy ${e.policy}.`),!0}return Ge(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){var i;const r=c(this,Pt).get(e);if(!r){Ge(`Optional content group not found: ${e}`);return}if(n&&t&&r.rbGroups.length)for(const o of r.rbGroups)for(const u of o)u!==e&&((i=c(this,Pt).get(u))==null||i._setVisible(ef,!1,!0));r._setVisible(ef,!!t,!0),x(this,qc,null)}setOCGState({state:e,preserveRB:t}){let n;for(const r of e){switch(r){case"ON":case"OFF":case"Toggle":n=r;continue}const i=c(this,Pt).get(r);if(i)switch(n){case"ON":this.setVisibility(r,!0,t);break;case"OFF":this.setVisibility(r,!1,t);break;case"Toggle":this.setVisibility(r,!i.visible,t);break}}x(this,qc,null)}get hasInitialVisibility(){return c(this,rm)===null||this.getHash()===c(this,rm)}getOrder(){return c(this,Pt).size?c(this,sm)?c(this,sm).slice():[...c(this,Pt).keys()]:null}getGroup(e){return c(this,Pt).get(e)||null}getHash(){if(c(this,qc)!==null)return c(this,qc);const e=new SM;for(const[t,n]of c(this,Pt))e.update(`${t}:${n.visible}`);return x(this,qc,e.hexdigest())}[Symbol.iterator](){return c(this,Pt).entries()}}qc=new WeakMap,Pt=new WeakMap,rm=new WeakMap,sm=new WeakMap,iw=new WeakSet,lC=function(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let r=1;r<t;r++){const i=e[r];let o;if(Array.isArray(i))o=I(this,iw,lC).call(this,i);else if(c(this,Pt).has(i))o=c(this,Pt).get(i).visible;else return Ge(`Optional content group not found: ${i}`),!0;switch(n){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return n==="And"};var aw,ow;class jx{constructor(e,t,n){T(this,aw,null);T(this,ow,null);re(this,"_fullReader",null);re(this,"_rangeReaders",new Set);re(this,"_source",null);this._source=e,x(this,aw,t),x(this,ow,n)}get _progressiveDataLength(){var e;return((e=this._fullReader)==null?void 0:e._loaded)??0}getFullReader(){return vt(!this._fullReader,"BasePDFStream.getFullReader can only be called once."),this._fullReader=new(c(this,aw))(this)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new(c(this,ow))(this,e,t);return this._rangeReaders.add(n),n}cancelAllRequests(e){var t;(t=this._fullReader)==null||t.cancel(e);for(const n of new Set(this._rangeReaders))n.cancel(e)}}aw=new WeakMap,ow=new WeakMap;class $x{constructor(e){re(this,"onProgress",null);re(this,"_contentLength",0);re(this,"_filename",null);re(this,"_headersCapability",Promise.withResolvers());re(this,"_isRangeSupported",!1);re(this,"_isStreamingSupported",!1);re(this,"_loaded",0);re(this,"_stream",null);this._stream=e}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){At("Abstract method `read` called")}cancel(e){At("Abstract method `cancel` called")}}class zx{constructor(e,t,n){re(this,"_stream",null);this._stream=e}async read(){At("Abstract method `read` called")}cancel(e){At("Abstract method `cancel` called")}}function _R(s){return s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer}var lw,cC;class uG extends jx{constructor(t){super(t,dG,hG);T(this,lw);re(this,"_progressiveDone",!1);re(this,"_queuedChunks",[]);const{pdfDataRangeTransport:n}=t,{initialData:r,progressiveDone:i}=n;if((r==null?void 0:r.length)>0){const o=_R(r);this._queuedChunks.push(o)}this._progressiveDone=i,n.addRangeListener((o,u)=>{I(this,lw,cC).call(this,o,u)}),n.addProgressListener((o,u)=>{var d,h;u!==void 0&&((h=(d=this._fullReader)==null?void 0:d.onProgress)==null||h.call(d,{loaded:o,total:u}))}),n.addProgressiveReadListener(o=>{I(this,lw,cC).call(this,void 0,o)}),n.addProgressiveDoneListener(()=>{var o;(o=this._fullReader)==null||o.progressiveDone(),this._progressiveDone=!0}),n.transportReady()}getFullReader(){const t=super.getFullReader();return this._queuedChunks=null,t}getRangeReader(t,n){const r=super.getRangeReader(t,n);return r&&(r.onDone=()=>this._rangeReaders.delete(r),this._source.pdfDataRangeTransport.requestDataRange(t,n)),r}cancelAllRequests(t){super.cancelAllRequests(t),this._source.pdfDataRangeTransport.abort()}}lw=new WeakSet,cC=function(t,n){const r=_R(n);if(t===void 0)this._fullReader?this._fullReader._enqueue(r):this._queuedChunks.push(r);else{const i=this._rangeReaders.keys().find(o=>o._begin===t);vt(i,"#onReceiveData - no `PDFDataTransportStreamRangeReader` instance found."),i._enqueue(r)}};class dG extends $x{constructor(t){super(t);re(this,"_done",!1);re(this,"_queuedChunks",null);re(this,"_requests",[]);const{pdfDataRangeTransport:n,disableRange:r,disableStream:i}=t._source,{length:o,contentDispositionFilename:u}=n;this._queuedChunks=t._queuedChunks||[];for(const d of this._queuedChunks)this._loaded+=d.byteLength;this._done=t._progressiveDone,this._contentLength=o,this._isStreamingSupported=!i,this._isRangeSupported=!r,_S(u)&&(this._filename=u),this._headersCapability.resolve()}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class hG extends zx{constructor(t,n,r){super(t,n,r);re(this,"onDone",null);re(this,"_begin",-1);re(this,"_done",!1);re(this,"_queuedChunk",null);re(this,"_requests",[]);this._begin=n}_enqueue(t){var n;if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,(n=this.onDone)==null||n.call(this)}}async read(){if(this._queuedChunk){const n=this._queuedChunk;return this._queuedChunk=null,{value:n,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){var n;this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,(n=this.onDone)==null||n.call(this)}}function pG(s){let e=!0,t=n("filename\\*","i").exec(s);if(t){t=t[1];let f=u(t);return f=unescape(f),f=d(f),f=h(f),i(f)}if(t=o(s),t){const f=h(t);return i(f)}if(t=n("filename","i").exec(s),t){t=t[1];let f=u(t);return f=h(f),i(f)}function n(f,g){return new RegExp("(?:^|;)\\s*"+f+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function r(f,g){if(f){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const w=new TextDecoder(f,{fatal:!0}),A=Vx(g);g=w.decode(A),e=!1}catch{}}return g}function i(f){return e&&/[\x80-\xff]/.test(f)&&(f=r("utf-8",f),e&&(f=r("iso-8859-1",f))),f}function o(f){const g=[];let w;const A=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(w=A.exec(f))!==null;){let[,C,S,P]=w;if(C=parseInt(C,10),C in g){if(C===0)break;continue}g[C]=[S,P]}const F=[];for(let C=0;C<g.length&&C in g;++C){let[S,P]=g[C];P=u(P),S&&(P=unescape(P),C===0&&(P=d(P))),F.push(P)}return F.join("")}function u(f){if(f.startsWith('"')){const g=f.slice(1).split('\\"');for(let w=0;w<g.length;++w){const A=g[w].indexOf('"');A!==-1&&(g[w]=g[w].slice(0,A),g.length=w+1),g[w]=g[w].replaceAll(/\\(.)/g,"$1")}f=g.join('"')}return f}function d(f){const g=f.indexOf("'");if(g===-1)return f;const w=f.slice(0,g),F=f.slice(g+1).replace(/^[^']*'/,"");return r(w,F)}function h(f){return!f.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(f)?f:f.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,w,A,F){if(A==="q"||A==="Q")return F=F.replaceAll("_"," "),F=F.replaceAll(/=([0-9a-fA-F]{2})/g,function(C,S){return String.fromCharCode(parseInt(S,16))}),r(w,F);try{F=atob(F)}catch{}return r(w,F)})}return""}function VM(s,e){const t=new Headers;if(!s||!e||typeof e!="object")return t;for(const n in e){const r=e[n];r!==void 0&&t.append(n,r)}return t}function Hx(s){var e;return((e=URL.parse(s))==null?void 0:e.origin)??null}function UM({responseHeaders:s,isHttp:e,rangeChunkSize:t,disableRange:n}){const r={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(s.get("Content-Length"),10);return!Number.isInteger(i)||(r.suggestedLength=i,i<=2*t)||n||!e||s.get("Accept-Ranges")!=="bytes"||(s.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function jM(s){const e=s.get("Content-Disposition");if(e){let t=pG(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(_S(t))return t}return null}function Wx(s,e){return new S_(`Unexpected server response (${s}) while retrieving PDF "${e}".`,s,s===404||s===0&&e.startsWith("file:"))}function $M(s,e){if(s!==e)throw new Error(`Expected range response-origin "${s}" to match "${e}".`)}function zM(s,e,t,n){return fetch(s,{method:"GET",headers:e,signal:n.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"})}function HM(s,e){if(s!==200&&s!==206)throw Wx(s,e)}function WM(s){return s instanceof Uint8Array?s.buffer:s instanceof ArrayBuffer?s:(Ge(`getArrayBuffer - unexpected data format: ${s}`),new Uint8Array(s).buffer)}class fG extends jx{constructor(t){super(t,mG,gG);re(this,"_responseOrigin",null);this.isHttp=/^https?:/i.test(t.url),this.headers=VM(this.isHttp,t.httpHeaders)}}class mG extends $x{constructor(t){super(t);re(this,"_abortController",new AbortController);re(this,"_reader",null);const{disableRange:n,disableStream:r,length:i,rangeChunkSize:o,url:u,withCredentials:d}=t._source;this._contentLength=i,this._isStreamingSupported=!r,this._isRangeSupported=!n;const h=new Headers(t.headers);zM(u,h,d,this._abortController).then(f=>{t._responseOrigin=Hx(f.url),HM(f.status,u),this._reader=f.body.getReader();const g=f.headers,{allowRangeRequests:w,suggestedLength:A}=UM({responseHeaders:g,isHttp:t.isHttp,rangeChunkSize:o,disableRange:n});this._isRangeSupported=w,this._contentLength=A||this._contentLength,this._filename=jM(g),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Du("Streaming is disabled.")),this._headersCapability.resolve()}).catch(this._headersCapability.reject)}async read(){var r;await this._headersCapability.promise;const{value:t,done:n}=await this._reader.read();return n?{value:t,done:n}:(this._loaded+=t.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:WM(t),done:!1})}cancel(t){var n;(n=this._reader)==null||n.cancel(t),this._abortController.abort()}}class gG extends zx{constructor(t,n,r){super(t,n,r);re(this,"_abortController",new AbortController);re(this,"_readCapability",Promise.withResolvers());re(this,"_reader",null);const{url:i,withCredentials:o}=t._source,u=new Headers(t.headers);u.append("Range",`bytes=${n}-${r-1}`),zM(i,u,o,this._abortController).then(d=>{const h=Hx(d.url);$M(h,t._responseOrigin),HM(d.status,i),this._reader=d.body.getReader(),this._readCapability.resolve()}).catch(this._readCapability.reject)}async read(){await this._readCapability.promise;const{value:t,done:n}=await this._reader.read();return n?{value:t,done:n}:{value:WM(t),done:!1}}cancel(t){var n;(n=this._reader)==null||n.cancel(t),this._abortController.abort()}}const KE=200,xR=206;function yG(s){return typeof s!="string"?s:Vx(s).buffer}var $a,Jm,GM,qM;class wG extends jx{constructor(t){super(t,vG,AG);T(this,Jm);T(this,$a,new WeakMap);re(this,"_responseOrigin",null);this.url=t.url,this.isHttp=/^https?:/i.test(this.url),this.headers=VM(this.isHttp,t.httpHeaders)}_request(t){const n=new XMLHttpRequest,r={validateStatus:null,onHeadersReceived:t.onHeadersReceived,onDone:t.onDone,onError:t.onError,onProgress:t.onProgress};c(this,$a).set(n,r),n.open("GET",this.url),n.withCredentials=this._source.withCredentials;for(const[i,o]of this.headers)n.setRequestHeader(i,o);return this.isHttp&&"begin"in t&&"end"in t?(n.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),r.validateStatus=i=>i===xR||i===KE):r.validateStatus=i=>i===KE,n.responseType="arraybuffer",vt(t.onError,"Expected `onError` callback to be provided."),n.onerror=()=>t.onError(n.status),n.onreadystatechange=I(this,Jm,qM).bind(this,n),n.onprogress=I(this,Jm,GM).bind(this,n),n.send(null),n}_abortRequest(t){c(this,$a).has(t)&&(c(this,$a).delete(t),t.abort())}getRangeReader(t,n){const r=super.getRangeReader(t,n);return r&&(r.onClosed=()=>this._rangeReaders.delete(r)),r}}$a=new WeakMap,Jm=new WeakSet,GM=function(t,n){var i;const r=c(this,$a).get(t);(i=r==null?void 0:r.onProgress)==null||i.call(r,n)},qM=function(t,n){const r=c(this,$a).get(t);if(!r||(t.readyState>=2&&r.onHeadersReceived&&(r.onHeadersReceived(),delete r.onHeadersReceived),t.readyState!==4)||!c(this,$a).has(t))return;if(c(this,$a).delete(t),t.status===0&&this.isHttp){r.onError(t.status);return}const i=t.status||KE;if(!r.validateStatus(i)){r.onError(t.status);return}const o=yG(t.response);if(i===xR){const u=t.getResponseHeader("Content-Range");/bytes (\d+)-(\d+)\/(\d+)/.test(u)?r.onDone(o):(Ge('Missing or invalid "Content-Range" header.'),r.onError(0))}else o?r.onDone(o):r.onError(t.status)};var po,QM,KM,XM,YM;class vG extends $x{constructor(t){super(t);T(this,po);re(this,"_cachedChunks",[]);re(this,"_done",!1);re(this,"_requests",[]);re(this,"_storedError",null);const{length:n}=t._source;this._contentLength=n,this._fullRequestXhr=t._request({onHeadersReceived:I(this,po,QM).bind(this),onDone:I(this,po,KM).bind(this),onError:I(this,po,XM).bind(this),onProgress:I(this,po,YM).bind(this)})}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._fullRequestXhr),this._fullRequestXhr=null}}po=new WeakSet,QM=function(){const t=this._stream,{disableRange:n,rangeChunkSize:r}=t._source,i=this._fullRequestXhr;t._responseOrigin=Hx(i.responseURL);const o=i.getAllResponseHeaders(),u=new Headers(o?o.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(f=>{const[g,...w]=f.split(": ");return[g,w.join(": ")]}):[]),{allowRangeRequests:d,suggestedLength:h}=UM({responseHeaders:u,isHttp:t.isHttp,rangeChunkSize:r,disableRange:n});d&&(this._isRangeSupported=!0),this._contentLength=h||this._contentLength,this._filename=jM(u),this._isRangeSupported&&t._abortRequest(i),this._headersCapability.resolve()},KM=function(t){if(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._cachedChunks.push(t),this._done=!0,!(this._cachedChunks.length>0)){for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}},XM=function(t){this._storedError=Wx(t,this._stream.url),this._headersCapability.reject(this._storedError);for(const n of this._requests)n.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0},YM=function(t){var n;(n=this.onProgress)==null||n.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})};var Ml,JM,ZM,uC;class AG extends zx{constructor(t,n,r){super(t,n,r);T(this,Ml);re(this,"onClosed",null);re(this,"_done",!1);re(this,"_queuedChunk",null);re(this,"_requests",[]);re(this,"_storedError",null);this._requestXhr=t._request({begin:n,end:r,onHeadersReceived:I(this,Ml,JM).bind(this),onDone:I(this,Ml,ZM).bind(this),onError:I(this,Ml,uC).bind(this),onProgress:null})}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const n=this._queuedChunk;return this._queuedChunk=null,{value:n,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){var n;this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._requestXhr),(n=this.onClosed)==null||n.call(this)}}Ml=new WeakSet,JM=function(){var n;const t=Hx((n=this._requestXhr)==null?void 0:n.responseURL);try{$M(t,this._stream._responseOrigin)}catch(r){this._storedError=r,I(this,Ml,uC).call(this,0)}},ZM=function(t){var n;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,(n=this.onClosed)==null||n.call(this)},uC=function(t){this._storedError??(this._storedError=Wx(t,this._stream.url));for(const n of this._requests)n.reject(this._storedError);this._requests.length=0,this._queuedChunk=null};const _G=/^[a-z][a-z0-9\-+.]+:/i;function xG(s){if(_G.test(s))return new URL(s);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(s))}function eL(s){const{Readable:e}=process.getBuiltinModule("stream");return typeof e.toWeb=="function"?e.toWeb(s):process.getBuiltinModule("module").createRequire(import.meta.url)("node-readable-to-web-readable-stream").makeDefaultReadableStreamFromNodeReadable(s)}function tL(s){return s instanceof Uint8Array?s.buffer:s instanceof ArrayBuffer?s:(Ge(`getArrayBuffer - unexpected data format: ${s}`),new Uint8Array(s).buffer)}class EG extends jx{constructor(e){super(e,bG,CG),this.url=xG(e.url),vt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs.")}}class bG extends $x{constructor(t){super(t);re(this,"_reader",null);const{disableRange:n,disableStream:r,length:i,rangeChunkSize:o}=t._source;this._contentLength=i,this._isStreamingSupported=!r,this._isRangeSupported=!n;const u=t.url,d=process.getBuiltinModule("fs");d.promises.lstat(u).then(h=>{const f=d.createReadStream(u),g=eL(f);this._reader=g.getReader();const{size:w}=h;w<=2*o&&(this._isRangeSupported=!1),this._contentLength=w,!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Du("Streaming is disabled.")),this._headersCapability.resolve()}).catch(h=>{h.code==="ENOENT"&&(h=Wx(0,u.href)),this._headersCapability.reject(h)})}async read(){var r;await this._headersCapability.promise;const{value:t,done:n}=await this._reader.read();return n?{value:t,done:n}:(this._loaded+=t.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:tL(t),done:!1})}cancel(t){var n;(n=this._reader)==null||n.cancel(t)}}class CG extends zx{constructor(t,n,r){super(t,n,r);re(this,"_readCapability",Promise.withResolvers());re(this,"_reader",null);const i=t.url,o=process.getBuiltinModule("fs");try{const u=o.createReadStream(i,{start:n,end:r-1}),d=eL(u);this._reader=d.getReader(),this._readCapability.resolve()}catch(u){this._readCapability.reject(u)}}async read(){await this._readCapability.promise;const{value:t,done:n}=await this._reader.read();return n?{value:t,done:n}:{value:tL(t),done:!1}}cancel(t){var n;(n=this._reader)==null||n.cancel(t)}}const ug=Symbol("INITIAL_DATA");var Ts,cw,dC;class nL{constructor(){T(this,cw);T(this,Ts,Object.create(null))}get(e,t=null){if(t){const r=I(this,cw,dC).call(this,e);return r.promise.then(()=>t(r.data)),null}const n=c(this,Ts)[e];if(!n||n.data===ug)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=c(this,Ts)[e];return!!t&&t.data!==ug}delete(e){const t=c(this,Ts)[e];return!t||t.data===ug?!1:(delete c(this,Ts)[e],!0)}resolve(e,t=null){const n=I(this,cw,dC).call(this,e);n.data=t,n.resolve()}clear(){var e;for(const t in c(this,Ts)){const{data:n}=c(this,Ts)[t];(e=n==null?void 0:n.bitmap)==null||e.close()}x(this,Ts,Object.create(null))}*[Symbol.iterator](){for(const e in c(this,Ts)){const{data:t}=c(this,Ts)[e];t!==ug&&(yield[e,t])}}}Ts=new WeakMap,cw=new WeakSet,dC=function(e){var t;return(t=c(this,Ts))[e]||(t[e]={...Promise.withResolvers(),data:ug})};const FG=1e5,ER=30;var kR,Qc,as,uw,dw,Jd,sl,hw,pw,Zd,fw,im,Kc,am,mw,om,eh,gw,yw,lm,th,ww,cm,um,Ll,rL,sL,hC,Ks,LA,pC,iL,aL;const ar=class ar{constructor({textContentSource:e,container:t,viewport:n}){T(this,Ll);T(this,Qc,Promise.withResolvers());T(this,as,null);T(this,uw,!1);T(this,dw,!!((kR=globalThis.FontInspector)!=null&&kR.enabled));T(this,Jd,null);T(this,sl,null);T(this,hw,0);T(this,pw,0);T(this,Zd,null);T(this,fw,null);T(this,im,0);T(this,Kc,0);T(this,am,Object.create(null));T(this,mw,[]);T(this,om,null);T(this,eh,[]);T(this,gw,new WeakMap);T(this,yw,null);var d;if(e instanceof ReadableStream)x(this,om,e);else if(typeof e=="object")x(this,om,new ReadableStream({start(h){h.enqueue(e),h.close()}}));else throw new Error('No "textContentSource" parameter specified.');x(this,as,x(this,fw,t)),x(this,Kc,n.scale*ho.pixelRatio),x(this,im,n.rotation),x(this,sl,{div:null,properties:null,ctx:null});const{pageWidth:r,pageHeight:i,pageX:o,pageY:u}=n.rawDims;x(this,yw,[1,0,0,-1,-o,u+i]),x(this,pw,r),x(this,hw,i),I(d=ar,Ks,iL).call(d),t.style.setProperty("--min-font-size",c(ar,cm)),qh(t,n),c(this,Qc).promise.finally(()=>{c(ar,um).delete(this),x(this,sl,null),x(this,am,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Hn.platform;return qe(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{c(this,Zd).read().then(({value:t,done:n})=>{if(n){c(this,Qc).resolve();return}c(this,Jd)??x(this,Jd,t.lang),Object.assign(c(this,am),t.styles),I(this,Ll,rL).call(this,t.items),e()},c(this,Qc).reject)};return x(this,Zd,c(this,om).getReader()),c(ar,um).add(this),e(),c(this,Qc).promise}update({viewport:e,onBefore:t=null}){var i;const n=e.scale*ho.pixelRatio,r=e.rotation;if(r!==c(this,im)&&(t==null||t(),x(this,im,r),qh(c(this,fw),{rotation:r})),n!==c(this,Kc)){t==null||t(),x(this,Kc,n);const o={div:null,properties:null,ctx:I(i=ar,Ks,LA).call(i,c(this,Jd))};for(const u of c(this,eh))o.properties=c(this,gw).get(u),o.div=u,I(this,Ll,hC).call(this,o)}}cancel(){var t;const e=new Du("TextLayer task cancelled.");(t=c(this,Zd))==null||t.cancel(e).catch(()=>{}),x(this,Zd,null),c(this,Qc).reject(e)}get textDivs(){return c(this,eh)}get textContentItemsStr(){return c(this,mw)}static cleanup(){if(!(c(this,um).size>0)){c(this,lm).clear();for(const{canvas:e}of c(this,th).values())e.remove();c(this,th).clear()}}};Qc=new WeakMap,as=new WeakMap,uw=new WeakMap,dw=new WeakMap,Jd=new WeakMap,sl=new WeakMap,hw=new WeakMap,pw=new WeakMap,Zd=new WeakMap,fw=new WeakMap,im=new WeakMap,Kc=new WeakMap,am=new WeakMap,mw=new WeakMap,om=new WeakMap,eh=new WeakMap,gw=new WeakMap,yw=new WeakMap,lm=new WeakMap,th=new WeakMap,ww=new WeakMap,cm=new WeakMap,um=new WeakMap,Ll=new WeakSet,rL=function(e){var r,i;if(c(this,uw))return;(i=c(this,sl)).ctx??(i.ctx=I(r=ar,Ks,LA).call(r,c(this,Jd)));const t=c(this,eh),n=c(this,mw);for(const o of e){if(t.length>FG){Ge("Ignoring additional textDivs for performance reasons."),x(this,uw,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const u=c(this,as);x(this,as,document.createElement("span")),c(this,as).classList.add("markedContent"),o.id&&c(this,as).setAttribute("id",`${o.id}`),o.tag==="Artifact"&&(c(this,as).ariaHidden=!0),u.append(c(this,as))}else o.type==="endMarkedContent"&&x(this,as,c(this,as).parentNode);continue}n.push(o.str),I(this,Ll,sL).call(this,o)}},sL=function(e){var F;const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};c(this,eh).push(t);const r=_e.transform(c(this,yw),e.transform);let i=Math.atan2(r[1],r[0]);const o=c(this,am)[e.fontName];o.vertical&&(i+=Math.PI/2);let u=c(this,dw)&&o.fontSubstitution||o.fontFamily;u=ar.fontFamilyMap.get(u)||u;const d=Math.hypot(r[2],r[3]),h=d*I(F=ar,Ks,aL).call(F,u,o,c(this,Jd));let f,g;i===0?(f=r[4],g=r[5]-h):(f=r[4]+h*Math.sin(i),g=r[5]-h*Math.cos(i));const w=t.style;w.left=`${(100*f/c(this,pw)).toFixed(2)}%`,w.top=`${(100*g/c(this,hw)).toFixed(2)}%`,w.setProperty("--font-height",`${d.toFixed(2)}px`),w.fontFamily=u,n.fontSize=d,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,c(this,dw)&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),i!==0&&(n.angle=i*(180/Math.PI));let A=!1;if(e.str.length>1)A=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const C=Math.abs(e.transform[0]),S=Math.abs(e.transform[3]);C!==S&&Math.max(C,S)/Math.min(C,S)>1.5&&(A=!0)}if(A&&(n.canvasWidth=o.vertical?e.height:e.width),c(this,gw).set(t,n),c(this,sl).div=t,c(this,sl).properties=n,I(this,Ll,hC).call(this,c(this,sl)),n.hasText&&c(this,as).append(t),n.hasEOL){const C=document.createElement("br");C.setAttribute("role","presentation"),c(this,as).append(C)}},hC=function(e){var o;const{div:t,properties:n,ctx:r}=e,{style:i}=t;if(n.canvasWidth!==0&&n.hasText){const{fontFamily:u}=i,{canvasWidth:d,fontSize:h}=n;I(o=ar,Ks,pC).call(o,r,h*c(this,Kc),u);const{width:f}=r.measureText(t.textContent);f>0&&i.setProperty("--scale-x",d*c(this,Kc)/f)}n.angle!==0&&i.setProperty("--rotate",`${n.angle}deg`)},Ks=new WeakSet,LA=function(e=null){let t=c(this,th).get(e||(e=""));if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),c(this,th).set(e,t),c(this,ww).set(t,{size:0,family:""})}return t},pC=function(e,t,n){const r=c(this,ww).get(e);t===r.size&&n===r.family||(e.font=`${t}px ${n}`,r.size=t,r.family=n)},iL=function(){if(c(this,cm)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),x(this,cm,e.getBoundingClientRect().height),e.remove()},aL=function(e,t,n){const r=c(this,lm).get(e);if(r)return r;const i=I(this,Ks,LA).call(this,n);i.canvas.width=i.canvas.height=ER,I(this,Ks,pC).call(this,i,ER,e);const o=i.measureText(""),u=o.fontBoundingBoxAscent,d=Math.abs(o.fontBoundingBoxDescent);i.canvas.width=i.canvas.height=0;let h=.8;return u?h=u/(u+d):(Hn.platform.isFirefox&&Ge("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?h=t.ascent:t.descent&&(h=1+t.descent)),c(this,lm).set(e,h),h},T(ar,Ks),T(ar,lm,new Map),T(ar,th,new Map),T(ar,ww,new WeakMap),T(ar,cm,null),T(ar,um,new Set);let uy=ar;const SG=100;function oL(s={}){typeof s=="string"||s instanceof URL?s={url:s}:(s instanceof ArrayBuffer||ArrayBuffer.isView(s))&&(s={data:s});const e=new fC,{docId:t}=e,n=s.url?MW(s.url):null,r=s.data?LW(s.data):null,i=s.httpHeaders||null,o=s.withCredentials===!0,u=s.password??null,d=s.range instanceof lL?s.range:null,h=Number.isInteger(s.rangeChunkSize)&&s.rangeChunkSize>0?s.rangeChunkSize:2**16;let f=s.worker instanceof dy?s.worker:null;const g=s.verbosity,w=typeof s.docBaseUrl=="string"&&!Ux(s.docBaseUrl)?s.docBaseUrl:null,A=sA(s.cMapUrl),F=s.cMapPacked!==!1,C=s.CMapReaderFactory||(Hr?HW:oR),S=sA(s.iccUrl),P=sA(s.standardFontDataUrl),O=s.StandardFontDataFactory||(Hr?WW:lR),N=sA(s.wasmUrl),V=s.WasmFactory||(Hr?GW:cR),z=s.stopAtErrors!==!0,H=Number.isInteger(s.maxImageSize)&&s.maxImageSize>-1?s.maxImageSize:-1,R=s.isEvalSupported!==!1,D=typeof s.isOffscreenCanvasSupported=="boolean"?s.isOffscreenCanvasSupported:!Hr,L=typeof s.isImageDecoderSupported=="boolean"?s.isImageDecoderSupported:!Hr&&(Hn.platform.isFirefox||!globalThis.chrome),U=Number.isInteger(s.canvasMaxAreaInBytes)?s.canvasMaxAreaInBytes:-1,j=typeof s.disableFontFace=="boolean"?s.disableFontFace:Hr,G=s.fontExtraProperties===!0,$=s.enableXfa===!0,ge=s.ownerDocument||globalThis.document,xe=s.disableRange===!0,ye=s.disableStream===!0,pe=s.disableAutoFetch===!0,ie=s.pdfBug===!0,we=s.CanvasFactory||(Hr?zW:UW),de=s.FilterFactory||(Hr?$W:jW),K=s.enableHWA===!0,Y=s.useWasm!==!1,fe=d?d.length:s.length??NaN,De=typeof s.useSystemFonts=="boolean"?s.useSystemFonts:!Hr&&!j,ke=typeof s.useWorkerFetch=="boolean"?s.useWorkerFetch:!!(C===oR&&O===lR&&V===cR&&A&&P&&N&&Ag(A,document.baseURI)&&Ag(P,document.baseURI)&&Ag(N,document.baseURI)),Ne=null;lW(g);const Me={canvasFactory:new we({ownerDocument:ge,enableHWA:K}),filterFactory:new de({docId:t,ownerDocument:ge}),cMapReaderFactory:ke?null:new C({baseUrl:A,isCompressed:F}),standardFontDataFactory:ke?null:new O({baseUrl:P}),wasmFactory:ke?null:new V({baseUrl:N})};f||(f=dy.create({verbosity:g,port:Ja.workerPort}),e._worker=f);const et={docId:t,apiVersion:"5.4.624",data:r,password:u,disableAutoFetch:pe,rangeChunkSize:h,length:fe,docBaseUrl:w,enableXfa:$,evaluatorOptions:{maxImageSize:H,disableFontFace:j,ignoreErrors:z,isEvalSupported:R,isOffscreenCanvasSupported:D,isImageDecoderSupported:L,canvasMaxAreaInBytes:U,fontExtraProperties:G,useSystemFonts:De,useWasm:Y,useWorkerFetch:ke,cMapUrl:A,iccUrl:S,standardFontDataUrl:P,wasmUrl:N}},dt={ownerDocument:ge,pdfBug:ie,styleElement:Ne,enableHWA:K,loadingParams:{disableAutoFetch:pe,enableXfa:$}};return f.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(f.destroyed)throw new Error("Worker was destroyed");const Gt=f.messageHandler.sendWithPromise("GetDocRequest",et,r?[r.buffer]:null);let vr;if(d)vr=new uG({pdfDataRangeTransport:d,disableRange:xe,disableStream:ye});else if(!r){if(!n)throw new Error("getDocument - no `url` parameter provided.");const ce=Ag(n)?fG:Hr?EG:wG;vr=new ce({url:n,length:fe,httpHeaders:i,withCredentials:o,rangeChunkSize:h,disableRange:xe,disableStream:ye})}return Gt.then(ce=>{if(e.destroyed)throw new Error("Loading aborted");if(f.destroyed)throw new Error("Worker was destroyed");const Oe=new Tg(t,ce,f.port),Zt=new IG(Oe,e,vr,dt,Me);e._transport=Zt,Oe.send("Ready",null)})}).catch(e._capability.reject),e}var K_;const X_=class X_{constructor(){re(this,"_capability",Promise.withResolvers());re(this,"_transport",null);re(this,"_worker",null);re(this,"docId",`d${Bn(X_,K_)._++}`);re(this,"destroyed",!1);re(this,"onPassword",null);re(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,n,r;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(i){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,i}this._transport=null,(r=this._worker)==null||r.destroy(),this._worker=null}async getData(){return this._transport.getData()}};K_=new WeakMap,T(X_,K_,0);let fC=X_;var nh,vw,Aw,_w,xw;class lL{constructor(e,t,n=!1,r=null){T(this,nh,Promise.withResolvers());T(this,vw,[]);T(this,Aw,[]);T(this,_w,[]);T(this,xw,[]);this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=r}addRangeListener(e){c(this,xw).push(e)}addProgressListener(e){c(this,_w).push(e)}addProgressiveReadListener(e){c(this,Aw).push(e)}addProgressiveDoneListener(e){c(this,vw).push(e)}onDataRange(e,t){for(const n of c(this,xw))n(e,t)}onDataProgress(e,t){c(this,nh).promise.then(()=>{for(const n of c(this,_w))n(e,t)})}onDataProgressiveRead(e){c(this,nh).promise.then(()=>{for(const t of c(this,Aw))t(e)})}onDataProgressiveDone(){c(this,nh).promise.then(()=>{for(const e of c(this,vw))e()})}transportReady(){c(this,nh).resolve()}requestDataRange(e,t){At("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}nh=new WeakMap,vw=new WeakMap,Aw=new WeakMap,_w=new WeakMap,xw=new WeakMap;class TG{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return qe(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var il,Ew,rh,Dg;class kG{constructor(e,t,n,r=!1){T(this,rh);T(this,il,!1);T(this,Ew,cy.instance);this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=r?new eR:null,this._pdfBug=r,this.commonObjs=n.commonObjs,this.objs=new nL,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}set pageNumber(e){this._pageIndex=e-1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:r=0,dontFlip:i=!1}={}){return new S0({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:r,dontFlip:i})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return qe(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:n,intent:r="display",annotationMode:i=xc.ENABLE,transform:o=null,background:u=null,optionalContentConfigPromise:d=null,annotationCanvasMap:h=null,pageColors:f=null,printAnnotationStorage:g=null,isEditing:w=!1,recordOperations:A=!1,operationsFilter:F=null}){var L,U,j;(L=this._stats)==null||L.time("Overall");const C=this._transport.getRenderingIntent(r,i,g,w),{renderingIntent:S,cacheKey:P}=C;x(this,il,!1),d||(d=this._transport.getOptionalContentConfig(S));let O=this._intentStates.get(P);O||(O=Object.create(null),this._intentStates.set(P,O)),O.streamReaderCancelTimeout&&(clearTimeout(O.streamReaderCancelTimeout),O.streamReaderCancelTimeout=null);const N=!!(S&zs.PRINT);O.displayReadyCapability||(O.displayReadyCapability=Promise.withResolvers(),O.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(U=this._stats)==null||U.time("Page Request"),this._pumpOperatorList(C));const V=!!(this._pdfBug&&((j=globalThis.StepperManager)!=null&&j.enabled)),z=!this.recordedBBoxes&&(A||V),H=G=>{var $,ge;if(O.renderTasks.delete(R),z){const xe=($=R.gfx)==null?void 0:$.dependencyTracker.take();xe&&(R.stepper&&R.stepper.setOperatorBBoxes(xe,R.gfx.dependencyTracker.takeDebugMetadata()),A&&(this.recordedBBoxes=xe))}N&&x(this,il,!0),I(this,rh,Dg).call(this),G?(R.capability.reject(G),this._abortOperatorList({intentState:O,reason:G instanceof Error?G:new Error(G)})):R.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(ge=globalThis.Stats)!=null&&ge.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},R=new mC({callback:H,params:{canvas:t,canvasContext:e,dependencyTracker:z?new QW(t,O.operatorList.length,V):null,viewport:n,transform:o,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:O.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!N,pdfBug:this._pdfBug,pageColors:f,enableHWA:this._transport.enableHWA,operationsFilter:F});(O.renderTasks||(O.renderTasks=new Set)).add(R);const D=R.task;return Promise.all([O.displayReadyCapability.promise,d]).then(([G,$])=>{var ge;if(this.destroyed){H();return}if((ge=this._stats)==null||ge.time("Rendering"),!($.renderingIntent&S))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");R.initializeGraphics({transparency:G,optionalContentConfig:$}),R.operatorListChanged()}).catch(H),D}getOperatorList({intent:e="display",annotationMode:t=xc.ENABLE,printAnnotationStorage:n=null,isEditing:r=!1}={}){var h;function i(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(d))}const o=this._transport.getRenderingIntent(e,t,n,r,!0);let u=this._intentStates.get(o.cacheKey);u||(u=Object.create(null),this._intentStates.set(o.cacheKey,u));let d;return u.opListReadCapability||(d=Object.create(null),d.operatorListChanged=i,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||(u.renderTasks=new Set)).add(d),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(h=this._stats)==null||h.time("Page Request"),this._pumpOperatorList(o)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageId:c(this,Ew).getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>ly.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,r){function i(){o.read().then(function({value:d,done:h}){if(h){n(u);return}u.lang??(u.lang=d.lang),Object.assign(u.styles,d.styles),u.items.push(...d.items),i()},r)}const o=t.getReader(),u={items:[],styles:Object.create(null),lang:null};i()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),x(this,il,!1),Promise.all(e)}cleanup(e=!1){x(this,il,!0);const t=I(this,rh,Dg).call(this);return e&&t&&this._stats&&(this._stats=new eR),t}_startRenderPage(e,t){var r,i;const n=this._intentStates.get(t);n&&((r=this._stats)==null||r.timeEnd("Page Request"),(i=n.displayReadyCapability)==null||i.resolve(e))}_renderPageChunk(e,t){for(let n=0,r=e.length;n<r;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&I(this,rh,Dg).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:r}){const{map:i,transfer:o}=n,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageId:c(this,Ew).getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:i,modifiedIds:r},o).getReader(),h=this._intentStates.get(t);h.streamReader=d;const f=()=>{d.read().then(({value:g,done:w})=>{if(w){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(g,h),f())},g=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const w of h.renderTasks)w.operatorListChanged();I(this,rh,Dg).call(this)}if(h.displayReadyCapability)h.displayReadyCapability.reject(g);else if(h.opListReadCapability)h.opListReadCapability.reject(g);else throw g}})};f()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof AS){let r=SG;t.extraDelay>0&&t.extraDelay<1e3&&(r+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},r);return}}if(e.streamReader.cancel(new Du(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[r,i]of this._intentStates)if(i===e){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}il=new WeakMap,Ew=new WeakMap,rh=new WeakSet,Dg=function(){if(!c(this,il)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),x(this,il,!1),!0};var Xc,Hi,al,sh,Y_,ih,ah,Gr,OA,cL,uL,Ng,dm,BA;const Qt=class Qt{constructor({name:e=null,port:t=null,verbosity:n=cW()}={}){T(this,Gr);T(this,Xc,Promise.withResolvers());T(this,Hi,null);T(this,al,null);T(this,sh,null);if(this.name=e,this.destroyed=!1,this.verbosity=n,t){if(c(Qt,ah).has(t))throw new Error("Cannot use more than one PDFWorker per port.");c(Qt,ah).set(t,this),I(this,Gr,cL).call(this,t)}else I(this,Gr,uL).call(this)}get promise(){return c(this,Xc).promise}get port(){return c(this,al)}get messageHandler(){return c(this,Hi)}destroy(){var e,t;this.destroyed=!0,(e=c(this,sh))==null||e.terminate(),x(this,sh,null),c(Qt,ah).delete(c(this,al)),x(this,al,null),(t=c(this,Hi))==null||t.destroy(),x(this,Hi,null)}static create(e){const t=c(this,ah).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Qt(e)}static get workerSrc(){if(Ja.workerSrc)return Ja.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return qe(this,"_setupFakeWorkerGlobal",(async()=>c(this,dm,BA)?c(this,dm,BA):(await import(this.workerSrc)).WorkerMessageHandler)())}};Xc=new WeakMap,Hi=new WeakMap,al=new WeakMap,sh=new WeakMap,Y_=new WeakMap,ih=new WeakMap,ah=new WeakMap,Gr=new WeakSet,OA=function(){c(this,Xc).resolve(),c(this,Hi).send("configure",{verbosity:this.verbosity})},cL=function(e){x(this,al,e),x(this,Hi,new Tg("main","worker",e)),c(this,Hi).on("ready",()=>{}),I(this,Gr,OA).call(this)},uL=function(){if(c(Qt,ih)||c(Qt,dm,BA)){I(this,Gr,Ng).call(this);return}let{workerSrc:e}=Qt;try{Qt._isSameOrigin(window.location,e)||(e=Qt._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new Tg("main","worker",t),r=()=>{i.abort(),n.destroy(),t.terminate(),this.destroyed?c(this,Xc).reject(new Error("Worker was destroyed")):I(this,Gr,Ng).call(this)},i=new AbortController;t.addEventListener("error",()=>{c(this,sh)||r()},{signal:i.signal}),n.on("test",u=>{if(i.abort(),this.destroyed||!u){r();return}x(this,Hi,n),x(this,al,t),x(this,sh,t),I(this,Gr,OA).call(this)}),n.on("ready",u=>{if(i.abort(),this.destroyed){r();return}try{o()}catch{I(this,Gr,Ng).call(this)}});const o=()=>{const u=new Uint8Array;n.send("test",u,[u.buffer])};o();return}catch{Bx("The worker has been disabled.")}I(this,Gr,Ng).call(this)},Ng=function(){c(Qt,ih)||(Ge("Setting up fake worker."),x(Qt,ih,!0)),Qt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){c(this,Xc).reject(new Error("Worker was destroyed"));return}const t=new VW;x(this,al,t);const n=`fake${Bn(Qt,Y_)._++}`,r=new Tg(n+"_worker",n,t);e.setup(r,t),x(this,Hi,new Tg(n,n+"_worker",t)),I(this,Gr,OA).call(this)}).catch(e=>{c(this,Xc).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},dm=new WeakSet,BA=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},T(Qt,dm),T(Qt,Y_,0),T(Qt,ih,!1),T(Qt,ah,new WeakMap),Hr&&(x(Qt,ih,!0),Ja.workerSrc||(Ja.workerSrc="./pdf.worker.mjs")),Qt._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(!(n!=null&&n.origin)||n.origin==="null")return!1;const r=new URL(t,n);return n.origin===r.origin},Qt._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Qt.fromPort=e=>{if(_W("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Qt.create(e)};let dy=Qt;var ks,ol,ll,yi,Yc,hm,cl,os,Qs,dL,Mg,VA;class IG{constructor(e,t,n,r,i){T(this,Qs);re(this,"downloadInfoCapability",Promise.withResolvers());T(this,ks,null);T(this,ol,new Map);T(this,ll,null);T(this,yi,new Map);T(this,Yc,new Map);T(this,hm,new Map);T(this,cl,null);T(this,os,cy.instance);this.messageHandler=e,this.loadingTask=t,x(this,ll,n),this.commonObjs=new nL,this.fontLoader=new RW({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.enableHWA=r.enableHWA,this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.wasmFactory=i.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this.setupMessageHandler(),c(this,os).addListener(I(this,Qs,dL).bind(this))}get annotationStorage(){return qe(this,"annotationStorage",new xS)}getRenderingIntent(e,t=xc.ENABLE,n=null,r=!1,i=!1){let o=zs.DISPLAY,u=Kb;switch(e){case"any":o=zs.ANY;break;case"display":break;case"print":o=zs.PRINT;break;default:Ge(`getRenderingIntent - invalid intent: ${e}`)}const d=o&zs.PRINT&&n instanceof kM?n:this.annotationStorage;switch(t){case xc.DISABLE:o+=zs.ANNOTATIONS_DISABLE;break;case xc.ENABLE:break;case xc.ENABLE_FORMS:o+=zs.ANNOTATIONS_FORMS;break;case xc.ENABLE_STORAGE:o+=zs.ANNOTATIONS_STORAGE,u=d.serializable;break;default:Ge(`getRenderingIntent - invalid annotationMode: ${t}`)}r&&(o+=zs.IS_EDITING),i&&(o+=zs.OPLIST);const{ids:h,hash:f}=d.modifiedIds,g=[o,u.hash,f];return{renderingIntent:o,cacheKey:g.join("_"),annotationStorageSerializable:u,modifiedIds:h}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=c(this,cl))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const r of c(this,yi).values())e.push(r._destroy());c(this,yi).clear(),c(this,Yc).clear(),c(this,hm).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var r,i;this.commonObjs.clear(),this.fontLoader.clear(),c(this,ol).clear(),this.filterFactory.destroy(),uy.cleanup(),(r=c(this,ll))==null||r.cancelAllRequests(new Du("Worker was terminated.")),(i=this.messageHandler)==null||i.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,r)=>{vt(c(this,ll),"GetReader - no `BasePDFStream` instance available."),x(this,ks,c(this,ll).getFullReader()),c(this,ks).onProgress=i=>I(this,Qs,VA).call(this,i),r.onPull=()=>{c(this,ks).read().then(function({value:i,done:o}){if(o){r.close();return}vt(i instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{r.error(i)})},r.onCancel=i=>{c(this,ks).cancel(i),r.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async n=>{await c(this,ks).headersReady;const{isStreamingSupported:r,isRangeSupported:i,contentLength:o}=c(this,ks);return r&&i&&(c(this,ks).onProgress=null),{isStreamingSupported:r,isRangeSupported:i,contentLength:o}}),e.on("GetRangeReader",(n,r)=>{vt(c(this,ll),"GetRangeReader - no `BasePDFStream` instance available.");const i=c(this,ll).getRangeReader(n.begin,n.end);if(!i){r.close();return}r.onPull=()=>{i.read().then(function({value:o,done:u}){if(u){r.close();return}vt(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{r.error(o)})},r.onCancel=o=>{i.cancel(o),r.ready.catch(u=>{if(!this.destroyed)throw u})}}),e.on("GetDoc",({pdfInfo:n})=>{c(this,os).pagesNumber=n.numPages,this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new TG(n,this))}),e.on("DocException",n=>{t._capability.reject(es(n))}),e.on("PasswordRequest",n=>{x(this,cl,Promise.withResolvers());try{if(!t.onPassword)throw es(n);const r=i=>{i instanceof Error?c(this,cl).reject(i):c(this,cl).resolve({password:i})};t.onPassword(r,n.code)}catch(r){c(this,cl).reject(r)}return c(this,cl).promise}),e.on("DataLoaded",n=>{I(this,Qs,VA).call(this,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;c(this,yi).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,r,i])=>{var o;if(this.destroyed||this.commonObjs.has(n))return null;switch(r){case"Font":if("error"in i){const w=i.error;Ge(`Error during font loading: ${w}`),this.commonObjs.resolve(n,w);break}const u=new Xb(i),d=this._params.pdfBug&&((o=globalThis.FontInspector)!=null&&o.enabled)?(w,A)=>globalThis.FontInspector.fontAdded(w,A):null,h=new DW(u,d,i.extra,i.charProcOperatorList);this.fontLoader.bind(h).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(n,h)});break;case"CopyLocalImage":const{imageRef:f}=i;vt(f,"The imageRef must be defined.");for(const w of c(this,yi).values())for(const[,A]of w.objs)if((A==null?void 0:A.ref)===f)return A.dataLen?(this.commonObjs.resolve(n,structuredClone(A)),A.dataLen):null;break;case"FontPath":this.commonObjs.resolve(n,new NW(i));break;case"Image":this.commonObjs.resolve(n,i);break;case"Pattern":const g=new Yb(i);this.commonObjs.resolve(n,g.getIR());break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),e.on("obj",([n,r,i,o])=>{var d;if(this.destroyed)return;const u=c(this,yi).get(r);if(!u.objs.has(n)){if(u._intentStates.size===0){(d=o==null?void 0:o.bitmap)==null||d.close();return}switch(i){case"Image":case"Pattern":u.objs.resolve(n,o);break;default:throw new Error(`Got unknown object type ${i}`)}}}),e.on("DocProgress",n=>{this.destroyed||I(this,Qs,VA).call(this,n)}),e.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[n.type];if(!r)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&Ge("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((n=c(this,ks))==null?void 0:n.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>c(this,os).pagesNumber)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=c(this,os).getPageId(e)-1,r=c(this,Yc).get(t);if(r)return r;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:n}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&c(this,hm).set(o.refStr,n);const u=new kG(t,o,this,this._params.pdfBug);return c(this,yi).set(t,u),u});return c(this,Yc).set(t,i),i}async getPageIndex(e){if(!Jb(e))throw new Error("Invalid pageIndex request.");const t=await this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen});return c(this,os).getPageNumber(t+1)-1}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:c(this,os).getPageId(e+1)-1,intent:t})}getFieldObjects(){return I(this,Qs,Mg).call(this,"GetFieldObjects")}hasJSActions(){return I(this,Qs,Mg).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return I(this,Qs,Mg).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:c(this,os).getPageId(e+1)-1})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:c(this,os).getPageId(e+1)-1})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return I(this,Qs,Mg).call(this,"GetOptionalContentConfig").then(t=>new cG(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=c(this,ol).get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(r=>{var i,o;return{info:r[0],metadata:r[1]?new oG(r[1]):null,contentDispositionFilename:((i=c(this,ks))==null?void 0:i.filename)??null,contentLength:((o=c(this,ks))==null?void 0:o.contentLength)??null,hasStructTree:r[2]}});return c(this,ol).set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of c(this,yi).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),c(this,ol).clear(),this.filterFactory.destroy(!0),uy.cleanup()}}cachedPageNumber(e){if(!Jb(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`,n=c(this,hm).get(t);return n>=0?c(this,os).getPageNumber(n+1):null}}ks=new WeakMap,ol=new WeakMap,ll=new WeakMap,yi=new WeakMap,Yc=new WeakMap,hm=new WeakMap,cl=new WeakMap,os=new WeakMap,Qs=new WeakSet,dL=function(){const e=new Map,t=new Map;for(let n=0,r=c(this,os).pagesNumber;n<r;n++){const i=c(this,os).getPrevPageNumber(n+1)-1,o=c(this,yi).get(i);o&&e.set(n,o);const u=c(this,Yc).get(i);u&&t.set(n,u)}x(this,yi,e),x(this,Yc,t)},Mg=function(e,t=null){const n=c(this,ol).get(e);if(n)return n;const r=this.messageHandler.sendWithPromise(e,t);return c(this,ol).set(e,r),r},VA=function({loaded:e,total:t}){var n,r;(r=(n=this.loadingTask).onProgress)==null||r.call(n,{loaded:e,total:t,percent:hr(Math.round(e/t*100),0,100)})};class PG{constructor(e){re(this,"_internalRenderTask",null);re(this,"onContinue",null);re(this,"onError",null);this._internalRenderTask=e}get promise(){return this._internalRenderTask.capability.promise}cancel(e=0){this._internalRenderTask.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this._internalRenderTask.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this._internalRenderTask;return e.form||e.canvas&&(t==null?void 0:t.size)>0}}var Jc,oh;const Ad=class Ad{constructor({callback:e,params:t,objs:n,commonObjs:r,annotationCanvasMap:i,operatorList:o,pageIndex:u,canvasFactory:d,filterFactory:h,useRequestAnimationFrame:f=!1,pdfBug:g=!1,pageColors:w=null,enableHWA:A=!1,operationsFilter:F=null}){T(this,Jc,null);this.callback=e,this.params=t,this.objs=n,this.commonObjs=r,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=u,this.canvasFactory=d,this.filterFactory=h,this._pdfBug=g,this.pageColors=w,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=f===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new PG(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=A,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=F}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var d,h;if(this.cancelled)return;if(this._canvas){if(c(Ad,oh).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");c(Ad,oh).add(this._canvas)}this._pdfBug&&((d=globalThis.StepperManager)!=null&&d.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:r,background:i,dependencyTracker:o}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new yf(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:r,viewport:n,transparency:e,background:i}),this.operatorListIdx=0,this.graphicsReady=!0,(h=this.graphicsReadyCallback)==null||h.call(this)}cancel(e=null,t=0){var n,r,i;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),c(this,Jc)&&(window.cancelAnimationFrame(c(this,Jc)),x(this,Jc,null)),c(Ad,oh).delete(this._canvas),e||(e=new AS(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(i=(r=this.task).onError)==null||i.call(r,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?x(this,Jc,window.requestAnimationFrame(()=>{x(this,Jc,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),c(Ad,oh).delete(this._canvas),this.callback())))}};Jc=new WeakMap,oh=new WeakMap,T(Ad,oh,new WeakSet);let mC=Ad;const RG="5.4.624",DG="384c6208b";var Is,lh,pm,jn,bw,fm,ul,Cw,Zc,Wi,Fw,Rt,gC,yC,wC,gd,hL,mc;const ts=class ts{constructor({editor:e=null,uiManager:t=null}){T(this,Rt);T(this,Is,null);T(this,lh,null);T(this,pm);T(this,jn,null);T(this,bw,!1);T(this,fm,!1);T(this,ul,null);T(this,Cw);T(this,Zc,null);T(this,Wi,null);var n,r;e?(x(this,fm,!1),x(this,ul,e)):x(this,fm,!0),x(this,Wi,(e==null?void 0:e._uiManager)||t),x(this,Cw,c(this,Wi)._eventBus),x(this,pm,((n=e==null?void 0:e.color)==null?void 0:n.toUpperCase())||((r=c(this,Wi))==null?void 0:r.highlightColors.values().next().value)||"#FFFF98"),c(ts,Fw)||x(ts,Fw,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return qe(this,"_keyboardManager",new k0([[["Escape","mac+Escape"],ts.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ts.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ts.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ts.prototype._moveToPrevious],[["Home","mac+Home"],ts.prototype._moveToBeginning],[["End","mac+End"],ts.prototype._moveToEnd]]))}renderButton(){const e=x(this,Is,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",c(this,ul)&&(e.ariaControls=`${c(this,ul).id}_colorpicker_dropdown`);const t=c(this,Wi)._signal;e.addEventListener("click",I(this,Rt,gd).bind(this),{signal:t}),e.addEventListener("keydown",I(this,Rt,wC).bind(this),{signal:t});const n=x(this,lh,document.createElement("span"));return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=c(this,pm),e.append(n),e}renderMainDropdown(){const e=x(this,jn,I(this,Rt,gC).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===c(this,Is)){I(this,Rt,gd).call(this,e);return}const t=e.target.getAttribute("data-color");t&&I(this,Rt,yC).call(this,t,e)}_moveToNext(e){var t,n;if(!c(this,Rt,mc)){I(this,Rt,gd).call(this,e);return}if(e.target===c(this,Is)){(t=c(this,jn).firstElementChild)==null||t.focus();return}(n=e.target.nextSibling)==null||n.focus()}_moveToPrevious(e){var t,n;if(e.target===((t=c(this,jn))==null?void 0:t.firstElementChild)||e.target===c(this,Is)){c(this,Rt,mc)&&this._hideDropdownFromKeyboard();return}c(this,Rt,mc)||I(this,Rt,gd).call(this,e),(n=e.target.previousSibling)==null||n.focus()}_moveToBeginning(e){var t;if(!c(this,Rt,mc)){I(this,Rt,gd).call(this,e);return}(t=c(this,jn).firstElementChild)==null||t.focus()}_moveToEnd(e){var t;if(!c(this,Rt,mc)){I(this,Rt,gd).call(this,e);return}(t=c(this,jn).lastElementChild)==null||t.focus()}hideDropdown(){var e,t;(e=c(this,jn))==null||e.classList.add("hidden"),c(this,Is).ariaExpanded="false",(t=c(this,Zc))==null||t.abort(),x(this,Zc,null)}_hideDropdownFromKeyboard(){var e;if(!c(this,fm)){if(!c(this,Rt,mc)){(e=c(this,ul))==null||e.unselect();return}this.hideDropdown(),c(this,Is).focus({preventScroll:!0,focusVisible:c(this,bw)})}}updateColor(e){if(c(this,lh)&&(c(this,lh).style.backgroundColor=e),!c(this,jn))return;const t=c(this,Wi).highlightColors.values();for(const n of c(this,jn).children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=c(this,Is))==null||e.remove(),x(this,Is,null),x(this,lh,null),(t=c(this,jn))==null||t.remove(),x(this,jn,null)}};Is=new WeakMap,lh=new WeakMap,pm=new WeakMap,jn=new WeakMap,bw=new WeakMap,fm=new WeakMap,ul=new WeakMap,Cw=new WeakMap,Zc=new WeakMap,Wi=new WeakMap,Fw=new WeakMap,Rt=new WeakSet,gC=function(){const e=document.createElement("div"),t=c(this,Wi)._signal;e.addEventListener("contextmenu",Fi,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),c(this,ul)&&(e.id=`${c(this,ul).id}_colorpicker_dropdown`);for(const[n,r]of c(this,Wi).highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",r),i.title=n,i.setAttribute("data-l10n-id",c(ts,Fw)[n]);const o=document.createElement("span");i.append(o),o.className="swatch",o.style.backgroundColor=r,i.ariaSelected=r===c(this,pm),i.addEventListener("click",I(this,Rt,yC).bind(this,r),{signal:t}),e.append(i)}return e.addEventListener("keydown",I(this,Rt,wC).bind(this),{signal:t}),e},yC=function(e,t){t.stopPropagation(),c(this,Cw).dispatch("switchannotationeditorparams",{source:this,type:lt.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},wC=function(e){ts._keyboardManager.exec(this,e)},gd=function(e){if(c(this,Rt,mc)){this.hideDropdown();return}if(x(this,bw,e.detail===0),c(this,Zc)||(x(this,Zc,new AbortController),window.addEventListener("pointerdown",I(this,Rt,hL).bind(this),{signal:c(this,Wi).combinedSignal(c(this,Zc))})),c(this,Is).ariaExpanded="true",c(this,jn)){c(this,jn).classList.remove("hidden");return}const t=x(this,jn,I(this,Rt,gC).call(this));c(this,Is).append(t)},hL=function(e){var t;(t=c(this,jn))!=null&&t.contains(e.target)||this.hideDropdown()},mc=function(){return c(this,jn)&&!c(this,jn).classList.contains("hidden")},T(ts,Fw,null);let N_=ts;var za,Sw,mm,Tw;const _d=class _d{constructor(e){T(this,za,null);T(this,Sw,null);T(this,mm,null);x(this,Sw,e),x(this,mm,e._uiManager),c(_d,Tw)||x(_d,Tw,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(c(this,za))return c(this,za);const{editorType:e,colorType:t,color:n}=c(this,Sw),r=x(this,za,document.createElement("input"));return r.type="color",r.value=n||"#000000",r.className="basicColorPicker",r.tabIndex=0,r.setAttribute("data-l10n-id",c(_d,Tw)[e]),r.addEventListener("input",()=>{c(this,mm).updateParams(t,r.value)},{signal:c(this,mm)._signal}),r}update(e){c(this,za)&&(c(this,za).value=e)}destroy(){var e;(e=c(this,za))==null||e.remove(),x(this,za,null)}hideDropdown(){}};za=new WeakMap,Sw=new WeakMap,mm=new WeakMap,Tw=new WeakMap,T(_d,Tw,null);let M_=_d;function bR(s){return Math.floor(Math.max(0,Math.min(1,s))*255).toString(16).padStart(2,"0")}function dg(s){return Math.max(0,Math.min(255,255*s))}class CR{static CMYK_G([e,t,n,r]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+r)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=dg(e),[e,e,e]}static G_HTML([e]){const t=bR(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(dg)}static RGB_HTML(e){return`#${e.map(bR).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,r]){return["RGB",1-Math.min(1,e+r),1-Math.min(1,n+r),1-Math.min(1,t+r)]}static CMYK_rgb([e,t,n,r]){return[dg(1-Math.min(1,e+r)),dg(1-Math.min(1,n+r)),dg(1-Math.min(1,t+r))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const r=1-e,i=1-t,o=1-n,u=Math.min(r,i,o);return["CMYK",r,i,o,u]}}class NG{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),n||(r.setAttribute("width",`${e}px`),r.setAttribute("height",`${t}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${e} ${t}`),r}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){At("Abstract method `_createSVG` called.")}}class L_ extends NG{_createSVG(e){return document.createElementNS(Mo,e)}}const MG=9,Kh=new WeakSet,LG=new Date().getTimezoneOffset()*60*1e3;class XE{static create(e){switch(e.data.annotationType){case kn.LINK:return new CS(e);case kn.TEXT:return new BG(e);case kn.WIDGET:switch(e.data.fieldType){case"Tx":return new VG(e);case"Btn":return e.data.radioButton?new mL(e):e.data.checkBox?new jG(e):new $G(e);case"Ch":return new zG(e);case"Sig":return new UG(e)}return new sp(e);case kn.POPUP:return new AC(e);case kn.FREETEXT:return new AL(e);case kn.LINE:return new WG(e);case kn.SQUARE:return new GG(e);case kn.CIRCLE:return new qG(e);case kn.POLYLINE:return new _L(e);case kn.CARET:return new KG(e);case kn.INK:return new FS(e);case kn.POLYGON:return new QG(e);case kn.HIGHLIGHT:return new xL(e);case kn.UNDERLINE:return new XG(e);case kn.SQUIGGLY:return new YG(e);case kn.STRIKEOUT:return new JG(e);case kn.STAMP:return new EL(e);case kn.FILEATTACHMENT:return new ZG(e);default:return new an(e)}}}var ch,gm,wi,kw,vC;const NS=class NS{constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:r=!1}={}){T(this,kw);T(this,ch,null);T(this,gm,!1);T(this,wi,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(n)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return NS._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var n;const{data:e}=this,t=(n=this.annotationStorage)==null?void 0:n.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var u;const e=(u=this.annotationStorage)==null?void 0:u.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:n,rect:r}=this.data;let i=-1/0,o=-1/0;if((t==null?void 0:t.length)>=8){for(let d=0;d<t.length;d+=8)t[d+1]>o?(o=t[d+1],i=t[d+2]):t[d+1]===o&&(i=Math.max(i,t[d+2]));return[i,o]}if((n==null?void 0:n.length)>=1){for(const d of n)for(let h=0,f=d.length;h<f;h+=2)d[h+1]>o?(o=d[h+1],i=d[h]):d[h+1]===o&&(i=Math.max(i,d[h]));if(i!==1/0)return[i,o]}return r?[r[2],r[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:n,pageHeight:r,pageX:i,pageY:o}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-i)/n,e[1]=100*(e[1]-o)/r,e}get commentText(){var t,n,r;const{data:e}=this;return((n=(t=this.annotationStorage.getRawValue(`${ay}${e.id}`))==null?void 0:t.popup)==null?void 0:n.contents)||((r=e.contentsObj)==null?void 0:r.str)||""}set commentText(e){const{data:t}=this,n={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:n})||this.annotationStorage.setValue(`${ay}${t.id}`,{id:t.id,annotationType:t.annotationType,page:this.parent.page,popup:n,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=c(this,wi))==null?void 0:e.popup)||this.popup)==null||t.remove(),x(this,wi,this.popup=null)}updateEdited(e){var i;if(!this.container)return;e.rect&&(c(this,ch)||x(this,ch,{rect:this.data.rect.slice(0)}));const{rect:t,popup:n}=e;t&&I(this,kw,vC).call(this,t);let r=((i=c(this,wi))==null?void 0:i.popup)||this.popup;!r&&(n!=null&&n.text)&&(this._createPopup(n),r=c(this,wi).popup),r&&(r.updateEdited(e),n!=null&&n.deleted&&(r.remove(),x(this,wi,null),this.popup=null))}resetEdited(){var e;c(this,ch)&&(I(this,kw,vC).call(this,c(this,ch).rect),(e=c(this,wi))==null||e.popup.resetEdited(),x(this,ch,null))}_createContainer(e){const{data:t,parent:{page:n,viewport:r}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),!(this instanceof sp)&&!(this instanceof CS)&&(i.tabIndex=0);const{style:o}=i;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(i.title=t.alternativeText),t.noRotate&&i.classList.add("norotate"),!t.rect||this instanceof AC){const{rotation:C}=t;return!t.hasOwnCanvas&&C!==0&&this.setRotation(C,i),i}const{width:u,height:d}=this;if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const C=t.borderStyle.horizontalCornerRadius,S=t.borderStyle.verticalCornerRadius;if(C>0||S>0){const O=`calc(${C}px * var(--total-scale-factor)) / calc(${S}px * var(--total-scale-factor))`;o.borderRadius=O}else if(this instanceof mL){const O=`calc(${u}px * var(--total-scale-factor)) / calc(${d}px * var(--total-scale-factor))`;o.borderRadius=O}switch(t.borderStyle.style){case Kp.SOLID:o.borderStyle="solid";break;case Kp.DASHED:o.borderStyle="dashed";break;case Kp.BEVELED:Ge("Unimplemented border style: beveled");break;case Kp.INSET:Ge("Unimplemented border style: inset");break;case Kp.UNDERLINE:o.borderBottomStyle="solid";break}const P=t.borderColor||null;P?(x(this,gm,!0),o.borderColor=_e.makeHexColor(P[0]|0,P[1]|0,P[2]|0)):o.borderWidth=0}const h=_e.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:f,pageHeight:g,pageX:w,pageY:A}=r.rawDims;o.left=`${100*(h[0]-w)/f}%`,o.top=`${100*(h[1]-A)/g}%`;const{rotation:F}=t;return t.hasOwnCanvas||F===0?(o.width=`${100*u/f}%`,o.height=`${100*d/g}%`):this.setRotation(F,i),i}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:r}=this.parent.viewport.rawDims;let{width:i,height:o}=this;e%180!==0&&([i,o]=[o,i]),t.style.width=`${100*i/n}%`,t.style.height=`${100*o/r}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,r)=>{const i=r.detail[t],o=i[0],u=i.slice(1);r.target.style[n]=CR[`${o}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[n]:CR[`${o}_rgb`](u)})};return qe(this,"_commonActions",{display:t=>{const{display:n}=t.detail,r=n%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const r of Object.keys(t.detail)){const i=e[r]||n[r];i==null||i(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[r,i]of Object.entries(t)){const o=n[r];if(o){const u={detail:{[r]:i},target:e};o(u),delete t[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,r,i]=this.data.rect.map(C=>Math.fround(C));if(e.length===8){const[C,S,P,O]=e.subarray(2,6);if(r===C&&i===S&&t===P&&n===O)return}const{style:o}=this.container;let u;if(c(this,gm)){const{borderColor:C,borderWidth:S}=o;o.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${C}" stroke-width="${S}">`],this.container.classList.add("hasBorder")}const d=r-t,h=i-n,{svgFactory:f}=this,g=f.createElement("svg");g.classList.add("quadrilateralsContainer"),g.setAttribute("width",0),g.setAttribute("height",0),g.role="none";const w=f.createElement("defs");g.append(w);const A=f.createElement("clipPath"),F=`clippath_${this.data.id}`;A.setAttribute("id",F),A.setAttribute("clipPathUnits","objectBoundingBox"),w.append(A);for(let C=2,S=e.length;C<S;C+=8){const P=e[C],O=e[C+1],N=e[C+2],V=e[C+3],z=f.createElement("rect"),H=(N-t)/d,R=(i-O)/h,D=(P-N)/d,L=(O-V)/h;z.setAttribute("x",H),z.setAttribute("y",R),z.setAttribute("width",D),z.setAttribute("height",L),A.append(z),u==null||u.push(`<rect vector-effect="non-scaling-stroke" x="${H}" y="${R}" width="${D}" height="${L}"/>`)}c(this,gm)&&(u.push("</g></svg>')"),o.backgroundImage=u.join("")),this.container.append(g),this.container.style.clipPath=`url(#${F})`}_createPopup(e=null){const{data:t}=this;let n,r;e?(n={str:e.text},r=e.date):(n=t.contentsObj,r=t.modificationDate),x(this,wi,new AC({data:{color:t.color,titleObj:t.titleObj,modificationDate:r,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}))}get hasPopupElement(){return!!(c(this,wi)||this.popup||this.data.popupRef)}get extraPopupElement(){return c(this,wi)}render(){At("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const r=this._fieldObjects[e];if(r)for(const{page:i,id:o,exportValues:u}of r){if(i===-1||o===t)continue;const d=typeof u=="string"?u:null,h=document.querySelector(`[data-element-id="${o}"]`);if(h&&!Kh.has(h)){Ge(`_getElementsByName - element not allowed: ${o}`);continue}n.push({id:o,exportValue:d,domElement:h})}return n}for(const r of document.getElementsByName(e)){const{exportValue:i}=r,o=r.getAttribute("data-element-id");o!==t&&Kh.has(r)&&n.push({id:o,exportValue:i,domElement:r})}return n}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};ch=new WeakMap,gm=new WeakMap,wi=new WeakMap,kw=new WeakSet,vC=function(e){const{container:{style:t},data:{rect:n,rotation:r},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:o,pageX:u,pageY:d}}}}=this;n==null||n.splice(0,4,...e),t.left=`${100*(e[0]-u)/i}%`,t.top=`${100*(o-e[3]+d)/o}%`,r===0?(t.width=`${100*(e[2]-e[0])/i}%`,t.height=`${100*(e[3]-e[1])/o}%`):this.setRotation(r)};let an=NS;class OG extends an{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}var Ws,yd,pL,fL;class CS extends an{constructor(t,n=null){super(t,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});T(this,Ws);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:n}=this,r=document.createElement("a");r.setAttribute("data-element-id",t.id);let i=!1;return t.url?(n.addLinkAttributes(r,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(r,t.action,t.overlaidText),i=!0):t.attachment?(I(this,Ws,pL).call(this,r,t.attachment,t.overlaidText,t.attachmentDest),i=!0):t.setOCGState?(I(this,Ws,fL).call(this,r,t.setOCGState,t.overlaidText),i=!0):t.dest?(this._bindLink(r,t.dest,t.overlaidText),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(r,t),i=!0),t.resetForm?(this._bindResetFormAction(r,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(r,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&(this.contentElement=r,this.container.append(r)),this.container}_bindLink(t,n,r=""){t.href=this.linkService.getDestinationHash(n),t.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&I(this,Ws,yd).call(this),r&&(t.title=r)}_bindNamedAction(t,n,r=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(n),!1),r&&(t.title=r),I(this,Ws,yd).call(this)}_bindJSAction(t,n){t.href=this.linkService.getAnchorUrl("");const r=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(n.actions)){const o=r.get(i);o&&(t[o]=()=>{var u;return(u=this.linkService.eventBus)==null||u.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:i}}),!1})}n.overlaidText&&(t.title=n.overlaidText),t.onclick||(t.onclick=()=>!1),I(this,Ws,yd).call(this)}_bindResetFormAction(t,n){const r=t.onclick;if(r||(t.href=this.linkService.getAnchorUrl("")),I(this,Ws,yd).call(this),!this._fieldObjects){Ge('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),r||(t.onclick=()=>!1);return}t.onclick=()=>{var g;r==null||r();const{fields:i,refs:o,include:u}=n,d=[];if(i.length!==0||o.length!==0){const w=new Set(o);for(const A of i){const F=this._fieldObjects[A]||[];for(const{id:C}of F)w.add(C)}for(const A of Object.values(this._fieldObjects))for(const F of A)w.has(F.id)===u&&d.push(F)}else for(const w of Object.values(this._fieldObjects))d.push(...w);const h=this.annotationStorage,f=[];for(const w of d){const{id:A}=w;switch(f.push(A),w.type){case"text":{const C=w.defaultValue||"";h.setValue(A,{value:C});break}case"checkbox":case"radiobutton":{const C=w.defaultValue===w.exportValues;h.setValue(A,{value:C});break}case"combobox":case"listbox":{const C=w.defaultValue||"";h.setValue(A,{value:C});break}default:continue}const F=document.querySelector(`[data-element-id="${A}"]`);if(F){if(!Kh.has(F)){Ge(`_bindResetFormAction - element not allowed: ${A}`);continue}}else continue;F.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}})),!1}}}Ws=new WeakSet,yd=function(){this.container.setAttribute("data-internal-link","")},pL=function(t,n,r="",i=null){t.href=this.linkService.getAnchorUrl(""),n.description?t.title=n.description:r&&(t.title=r),t.onclick=()=>{var o;return(o=this.downloadManager)==null||o.openOrDownloadData(n.content,n.filename,i),!1},I(this,Ws,yd).call(this)},fL=function(t,n,r=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(n),!1),r&&(t.title=r),I(this,Ws,yd).call(this)};class BG extends an{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class sp extends an{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Hn.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,r,i){n.includes("mouse")?e.addEventListener(n,o=>{var u;(u=this.linkService.eventBus)==null||u.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:i(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(n,o=>{var u;if(n==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}i&&((u=this.linkService.eventBus)==null||u.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:i(o)}}))})}_setEventListeners(e,t,n,r){var i,o,u;for(const[d,h]of n)(h==="Action"||(i=this.data.actions)!=null&&i[h])&&((h==="Focus"||h==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,d,h,r),h==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(e,t,"blur","Blur",null):h==="Blur"&&!((u=this.data.actions)!=null&&u.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":_e.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||MG,i=e.style;let o;const u=2,d=h=>Math.round(10*h)/10;if(this.data.multiLine){const h=Math.abs(this.data.rect[3]-this.data.rect[1]-u),f=Math.round(h/(zE*r))||1,g=h/f;o=Math.min(r,d(g/zE))}else{const h=Math.abs(this.data.rect[3]-this.data.rect[1]-u);o=Math.min(r,d(h/zE))}i.fontSize=`calc(${o}px * var(--total-scale-factor))`,i.color=_e.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class VG extends sp{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,r){const i=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=n),i.setValue(o.id,{[r]:n})}render(){var r,i;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const o=e.getValue(t,{value:this.data.fieldValue});let u=o.value||"";const d=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;d&&u.length>d&&(u=u.slice(0,d));let h=o.formattedValue||((r=this.data.textContent)==null?void 0:r.join(`
`))||null;h&&this.data.comb&&(h=h.replaceAll(/\s+/g,""));const f={userValue:u,formattedValue:h,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=h??u,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",h??u),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),Kh.add(n),this.contentElement=n,n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:g,datetimeType:w,timeStep:A}=this.data,F=!!w&&this.enableScripting;g&&(n.title=g),this._setRequired(n,this.data.required),d&&(n.maxLength=d),n.addEventListener("input",S=>{e.setValue(t,{value:S.target.value}),this.setPropertyOnSiblings(n,"value",S.target.value,"value"),f.formattedValue=null}),n.addEventListener("resetform",S=>{const P=this.data.defaultFieldValue??"";n.value=f.userValue=P,f.formattedValue=null});let C=S=>{const{formattedValue:P}=f;P!=null&&(S.target.value=P),S.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",P=>{var N;if(f.focused)return;const{target:O}=P;if(F&&(O.type=w,A&&(O.step=A)),f.userValue){const V=f.userValue;if(F)if(w==="time"){const z=new Date(V),H=[z.getHours(),z.getMinutes(),z.getSeconds()];O.value=H.map(R=>R.toString().padStart(2,"0")).join(":")}else O.value=new Date(V-LG).toISOString().split(w==="date"?"T":".",1)[0];else O.value=V}f.lastCommittedValue=O.value,f.commitKey=1,(N=this.data.actions)!=null&&N.Focus||(f.focused=!0)}),n.addEventListener("updatefromsandbox",P=>{this.showElementAndHideCanvas(P.target);const O={value(N){f.userValue=N.detail.value??"",F||e.setValue(t,{value:f.userValue.toString()}),N.target.value=f.userValue},formattedValue(N){const{formattedValue:V}=N.detail;f.formattedValue=V,V!=null&&N.target!==document.activeElement&&(N.target.value=V);const z={formattedValue:V};F&&(z.value=V),e.setValue(t,z)},selRange(N){N.target.setSelectionRange(...N.detail.selRange)},charLimit:N=>{var R;const{charLimit:V}=N.detail,{target:z}=N;if(V===0){z.removeAttribute("maxLength");return}z.setAttribute("maxLength",V);let H=f.userValue;!H||H.length<=V||(H=H.slice(0,V),z.value=f.userValue=H,e.setValue(t,{value:H}),(R=this.linkService.eventBus)==null||R.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:H,willCommit:!0,commitKey:1,selStart:z.selectionStart,selEnd:z.selectionEnd}}))}};this._dispatchEventFromSandbox(O,P)}),n.addEventListener("keydown",P=>{var V;f.commitKey=1;let O=-1;if(P.key==="Escape"?O=0:P.key==="Enter"&&!this.data.multiLine?O=2:P.key==="Tab"&&(f.commitKey=3),O===-1)return;const{value:N}=P.target;f.lastCommittedValue!==N&&(f.lastCommittedValue=N,f.userValue=N,(V=this.linkService.eventBus)==null||V.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:N,willCommit:!0,commitKey:O,selStart:P.target.selectionStart,selEnd:P.target.selectionEnd}}))});const S=C;C=null,n.addEventListener("blur",P=>{var V,z;if(!f.focused||!P.relatedTarget)return;(V=this.data.actions)!=null&&V.Blur||(f.focused=!1);const{target:O}=P;let{value:N}=O;if(F){if(N&&w==="time"){const H=N.split(":").map(R=>parseInt(R,10));N=new Date(2e3,0,1,H[0],H[1],H[2]||0).valueOf(),O.step=""}else N.includes("T")||(N=`${N}T00:00`),N=new Date(N).valueOf();O.type="text"}f.userValue=N,f.lastCommittedValue!==N&&((z=this.linkService.eventBus)==null||z.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:N,willCommit:!0,commitKey:f.commitKey,selStart:P.target.selectionStart,selEnd:P.target.selectionEnd}})),S(P)}),(i=this.data.actions)!=null&&i.Keystroke&&n.addEventListener("beforeinput",P=>{var L;f.lastCommittedValue=null;const{data:O,target:N}=P,{value:V,selectionStart:z,selectionEnd:H}=N;let R=z,D=H;switch(P.inputType){case"deleteWordBackward":{const U=V.substring(0,z).match(/\w*[^\w]*$/);U&&(R-=U[0].length);break}case"deleteWordForward":{const U=V.substring(z).match(/^[^\w]*\w*/);U&&(D+=U[0].length);break}case"deleteContentBackward":z===H&&(R-=1);break;case"deleteContentForward":z===H&&(D+=1);break}P.preventDefault(),(L=this.linkService.eventBus)==null||L.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:V,change:O||"",willCommit:!1,selStart:R,selEnd:D}})}),this._setEventListeners(n,f,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],P=>P.target.value)}if(C&&n.addEventListener("blur",C),this.data.comb){const P=(this.data.rect[2]-this.data.rect[0])/d;n.classList.add("comb"),n.style.letterSpacing=`calc(${P}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class UG extends sp{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class jG extends sp{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let r=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",e.setValue(n,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return Kh.add(i),i.setAttribute("data-element-id",n),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=t.fieldName,r&&i.setAttribute("checked",!0),i.setAttribute("exportValue",t.exportValue),i.tabIndex=0,i.addEventListener("change",o=>{const{name:u,checked:d}=o.target;for(const h of this._getElementsByName(u,n)){const f=d&&h.exportValue===t.exportValue;h.domElement&&(h.domElement.checked=f),e.setValue(h.id,{value:f})}e.setValue(n,{value:d})}),i.addEventListener("resetform",o=>{const u=t.defaultFieldValue||"Off";o.target.checked=u===t.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",o=>{const u={value(d){d.target.checked=d.detail.value!=="Off",e.setValue(n,{value:d.target.checked})}};this._dispatchEventFromSandbox(u,o)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class mL extends sp{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let r=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof r=="string"&&(r=r!==t.buttonValue,e.setValue(n,{value:r})),r)for(const o of this._getElementsByName(t.fieldName,n))e.setValue(o.id,{value:!1});const i=document.createElement("input");if(Kh.add(i),i.setAttribute("data-element-id",n),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=t.fieldName,r&&i.setAttribute("checked",!0),i.tabIndex=0,i.addEventListener("change",o=>{const{name:u,checked:d}=o.target;for(const h of this._getElementsByName(u,n))e.setValue(h.id,{value:!1});e.setValue(n,{value:d})}),i.addEventListener("resetform",o=>{const u=t.defaultFieldValue;o.target.checked=u!=null&&u===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;i.addEventListener("updatefromsandbox",u=>{const d={value:h=>{const f=o===h.detail.value;for(const g of this._getElementsByName(h.target.name)){const w=f&&g.id===n;g.domElement&&(g.domElement.checked=w),e.setValue(g.id,{value:w})}}};this._dispatchEventFromSandbox(d,u)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class $G extends CS{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class zG extends sp{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement("select");Kh.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",f=>{const g=this.data.defaultFieldValue;for(const w of r.options)w.selected=w.value===g});for(const f of this.data.options){const g=document.createElement("option");g.textContent=f.displayValue,g.value=f.exportValue,n.value.includes(f.exportValue)&&(g.setAttribute("selected",!0),i=!1),r.append(g)}let o=null;if(i){const f=document.createElement("option");f.value=" ",f.setAttribute("hidden",!0),f.setAttribute("selected",!0),r.prepend(f),o=()=>{f.remove(),r.removeEventListener("input",o),o=null},r.addEventListener("input",o)}const u=f=>{const g=f?"value":"textContent",{options:w,multiple:A}=r;return A?Array.prototype.filter.call(w,F=>F.selected).map(F=>F[g]):w.selectedIndex===-1?null:w[w.selectedIndex][g]};let d=u(!1);const h=f=>{const g=f.target.options;return Array.prototype.map.call(g,w=>({displayValue:w.textContent,exportValue:w.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",f=>{const g={value(w){o==null||o();const A=w.detail.value,F=new Set(Array.isArray(A)?A:[A]);for(const C of r.options)C.selected=F.has(C.value);e.setValue(t,{value:u(!0)}),d=u(!1)},multipleSelection(w){r.multiple=!0},remove(w){const A=r.options,F=w.detail.remove;A[F].selected=!1,r.remove(F),A.length>0&&Array.prototype.findIndex.call(A,S=>S.selected)===-1&&(A[0].selected=!0),e.setValue(t,{value:u(!0),items:h(w)}),d=u(!1)},clear(w){for(;r.length!==0;)r.remove(0);e.setValue(t,{value:null,items:[]}),d=u(!1)},insert(w){const{index:A,displayValue:F,exportValue:C}=w.detail.insert,S=r.children[A],P=document.createElement("option");P.textContent=F,P.value=C,S?S.before(P):r.append(P),e.setValue(t,{value:u(!0),items:h(w)}),d=u(!1)},items(w){const{items:A}=w.detail;for(;r.length!==0;)r.remove(0);for(const F of A){const{displayValue:C,exportValue:S}=F,P=document.createElement("option");P.textContent=C,P.value=S,r.append(P)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:u(!0),items:h(w)}),d=u(!1)},indices(w){const A=new Set(w.detail.indices);for(const F of w.target.options)F.selected=A.has(F.index);e.setValue(t,{value:u(!0)}),d=u(!1)},editable(w){w.target.disabled=!w.detail.editable}};this._dispatchEventFromSandbox(g,f)}),r.addEventListener("input",f=>{var A;const g=u(!0),w=u(!1);e.setValue(t,{value:g}),f.preventDefault(),(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:d,change:w,changeEx:g,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],f=>f.target.value)):r.addEventListener("input",function(f){e.setValue(t,{value:u(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}var Iw,_C;class AC extends an{constructor(t){const{data:n,elements:r,parent:i}=t,o=!!i._commentManager;super(t,{isRenderable:!o&&an._hasPopupData(n)});T(this,Iw);if(this.elements=r,o&&an._hasPopupData(n)){const u=this.popup=I(this,Iw,_C).call(this);for(const d of r)d.popup=u}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const n=this.popup=I(this,Iw,_C).call(this),r=[];for(const i of this.elements)i.popup=n,i.container.ariaHasPopup="dialog",r.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",r.map(i=>`${sf}${i}`).join(",")),this.container}}Iw=new WeakSet,_C=function(){return new HG({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var Ps,eu,J_,Z_,ym,wm,dn,Ha,tu,uh,vm,Am,Wa,Rs,dl,hl,hn,pl,nu,Pw,fl,_m,dh,ru,Kn,su,Ze,UA,xC,EC,bC,jA,CC,gL,yL,wL,vL,$A,zA,FC;class HG{constructor({container:e,color:t,elements:n,titleObj:r,modificationDate:i,contentsObj:o,richText:u,parent:d,rect:h,parentRect:f,open:g,commentManager:w=null}){T(this,Ze);T(this,Ps,null);T(this,eu,I(this,Ze,wL).bind(this));T(this,J_,I(this,Ze,FC).bind(this));T(this,Z_,I(this,Ze,zA).bind(this));T(this,ym,I(this,Ze,$A).bind(this));T(this,wm,null);T(this,dn,null);T(this,Ha,null);T(this,tu,null);T(this,uh,null);T(this,vm,null);T(this,Am,null);T(this,Wa,!1);T(this,Rs,null);T(this,dl,null);T(this,hl,null);T(this,hn,null);T(this,pl,null);T(this,nu,null);T(this,Pw,null);T(this,fl,null);T(this,_m,null);T(this,dh,null);T(this,ru,!1);T(this,Kn,null);T(this,su,null);x(this,dn,e),x(this,_m,r),x(this,Ha,o),x(this,fl,u),x(this,vm,d),x(this,wm,t),x(this,Pw,h),x(this,Am,f),x(this,uh,n),x(this,Ps,w),x(this,Kn,n[0]),x(this,tu,T_.toDateObject(i)),this.trigger=n.flatMap(A=>A.getElementsToTriggerPopup()),w||(I(this,Ze,UA).call(this),c(this,dn).hidden=!0,g&&I(this,Ze,$A).call(this))}renderCommentButton(){if(c(this,hn)){c(this,hn).parentNode||c(this,Kn).container.after(c(this,hn));return}if(c(this,pl)||I(this,Ze,xC).call(this),!c(this,pl))return;const{signal:e}=x(this,dl,new AbortController),t=c(this,Kn).hasOwnCommentButton,n=()=>{c(this,Ps).toggleCommentPopup(this,!0,void 0,!t)},r=()=>{c(this,Ps).toggleCommentPopup(this,!1,!0,!t)},i=()=>{c(this,Ps).toggleCommentPopup(this,!1,!1)};if(t){x(this,hn,c(this,Kn).container);for(const o of this.trigger)o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.addEventListener("keydown",c(this,eu),{signal:e}),o.addEventListener("click",n,{signal:e}),o.addEventListener("pointerenter",r,{signal:e}),o.addEventListener("pointerleave",i,{signal:e}),o.classList.add("popupTriggerArea")}else{const o=x(this,hn,document.createElement("button"));o.className="annotationCommentButton";const u=c(this,Kn).container;o.style.zIndex=u.style.zIndex+1,o.tabIndex=0,o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.setAttribute("data-l10n-id","pdfjs-show-comment-button"),I(this,Ze,bC).call(this),I(this,Ze,EC).call(this),o.addEventListener("keydown",c(this,eu),{signal:e}),o.addEventListener("click",n,{signal:e}),o.addEventListener("pointerenter",r,{signal:e}),o.addEventListener("pointerleave",i,{signal:e}),u.after(o)}}get commentButtonColor(){const{color:e,opacity:t}=c(this,Kn).commentData;return e?c(this,vm)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=c(this,hn))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:n,creationDate:r,modificationDate:i}=c(this,Kn).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:n,creationDate:r,modificationDate:i}}get elementBeforePopup(){return c(this,hn)}get comment(){return c(this,su)||x(this,su,c(this,Kn).commentText),c(this,su)}set comment(e){e!==this.comment&&(c(this,Kn).commentText=x(this,su,e))}focus(){var e;(e=c(this,Kn).container)==null||e.focus()}get parentBoundingClientRect(){return c(this,Kn).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){c(this,hn)&&(c(this,hn).classList.toggle("selected",e),c(this,hn).ariaExpanded=t)}setSelectedCommentButton(e){c(this,hn).classList.toggle("selected",e)}get commentPopupPosition(){if(c(this,nu))return c(this,nu);const{x:e,y:t,height:n}=c(this,hn).getBoundingClientRect(),{x:r,y:i,width:o,height:u}=c(this,Kn).layer.getBoundingClientRect();return[(e-r)/o,(t+n-i)/u]}set commentPopupPosition(e){x(this,nu,e)}hasDefaultPopupPosition(){return c(this,nu)===null}get commentButtonPosition(){return c(this,pl)}get commentButtonWidth(){return c(this,hn).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,n]=c(this,nu)||this.commentButtonPosition.map(h=>h/100),r=this.parentBoundingClientRect,{x:i,y:o,width:u,height:d}=r;c(this,Ps).showDialog(null,this,i+t*u,o+n*d,{...e,parentDimensions:r})}render(){var n,r;if(c(this,Rs))return;const e=x(this,Rs,document.createElement("div"));if(e.className="popup",c(this,wm)){const i=e.style.outlineColor=_e.makeHexColor(...c(this,wm));e.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const t=document.createElement("span");if(t.className="header",(n=c(this,_m))!=null&&n.str){const i=document.createElement("span");i.className="title",t.append(i),{dir:i.dir,str:i.textContent}=c(this,_m)}if(e.append(t),c(this,tu)){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:c(this,tu).valueOf()})),i.dateTime=c(this,tu).toISOString(),t.append(i)}GN({html:c(this,Ze,jA)||c(this,Ha).str,dir:(r=c(this,Ha))==null?void 0:r.dir,className:"popupContent"},e),c(this,dn).append(e)}updateEdited({rect:e,popup:t,deleted:n}){var r;if(c(this,Ps)){n?(this.remove(),x(this,su,null)):t&&(t.deleted?this.remove():(I(this,Ze,bC).call(this),x(this,su,t.text))),e&&(x(this,pl,null),I(this,Ze,xC).call(this),I(this,Ze,EC).call(this));return}if(n||t!=null&&t.deleted){this.remove();return}I(this,Ze,UA).call(this),c(this,dh)||x(this,dh,{contentsObj:c(this,Ha),richText:c(this,fl)}),e&&x(this,hl,null),t&&t.text&&(x(this,fl,I(this,Ze,yL).call(this,t.text)),x(this,tu,T_.toDateObject(t.date)),x(this,Ha,null)),(r=c(this,Rs))==null||r.remove(),x(this,Rs,null)}resetEdited(){var e;c(this,dh)&&({contentsObj:Bn(this,Ha)._,richText:Bn(this,fl)._}=c(this,dh),x(this,dh,null),(e=c(this,Rs))==null||e.remove(),x(this,Rs,null),x(this,hl,null))}remove(){var e,t,n;if((e=c(this,dl))==null||e.abort(),x(this,dl,null),(t=c(this,Rs))==null||t.remove(),x(this,Rs,null),x(this,ru,!1),x(this,Wa,!1),(n=c(this,hn))==null||n.remove(),x(this,hn,null),this.trigger)for(const r of this.trigger)r.classList.remove("popupTriggerArea")}forceHide(){x(this,ru,this.isVisible),c(this,ru)&&(c(this,dn).hidden=!0)}maybeShow(){c(this,Ps)||(I(this,Ze,UA).call(this),c(this,ru)&&(c(this,Rs)||I(this,Ze,zA).call(this),x(this,ru,!1),c(this,dn).hidden=!1))}get isVisible(){return c(this,Ps)?!1:c(this,dn).hidden===!1}}Ps=new WeakMap,eu=new WeakMap,J_=new WeakMap,Z_=new WeakMap,ym=new WeakMap,wm=new WeakMap,dn=new WeakMap,Ha=new WeakMap,tu=new WeakMap,uh=new WeakMap,vm=new WeakMap,Am=new WeakMap,Wa=new WeakMap,Rs=new WeakMap,dl=new WeakMap,hl=new WeakMap,hn=new WeakMap,pl=new WeakMap,nu=new WeakMap,Pw=new WeakMap,fl=new WeakMap,_m=new WeakMap,dh=new WeakMap,ru=new WeakMap,Kn=new WeakMap,su=new WeakMap,Ze=new WeakSet,UA=function(){var t;if(c(this,dl))return;x(this,dl,new AbortController);const{signal:e}=c(this,dl);for(const n of this.trigger)n.addEventListener("click",c(this,ym),{signal:e}),n.addEventListener("pointerenter",c(this,Z_),{signal:e}),n.addEventListener("pointerleave",c(this,J_),{signal:e}),n.classList.add("popupTriggerArea");for(const n of c(this,uh))(t=n.container)==null||t.addEventListener("keydown",c(this,eu),{signal:e})},xC=function(){const e=c(this,uh).find(t=>t.hasCommentButton);e&&x(this,pl,e._normalizePoint(e.commentButtonPosition))},EC=function(){if(c(this,Kn).extraPopupElement&&!c(this,Kn).editor)return;c(this,hn)||this.renderCommentButton();const[e,t]=c(this,pl),{style:n}=c(this,hn);n.left=`calc(${e}%)`,n.top=`calc(${t}% - var(--comment-button-dim))`},bC=function(){c(this,Kn).extraPopupElement||(c(this,hn)||this.renderCommentButton(),c(this,hn).style.backgroundColor=this.commentButtonColor||"")},jA=function(){const e=c(this,fl),t=c(this,Ha);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&c(this,fl).html||null},CC=function(){var e,t,n;return((n=(t=(e=c(this,Ze,jA))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.fontSize)||0},gL=function(){var e,t,n;return((n=(t=(e=c(this,Ze,jA))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.color)||null},yL=function(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},r={style:{color:c(this,Ze,gL),fontSize:c(this,Ze,CC)?`calc(${c(this,Ze,CC)}px * var(--total-scale-factor))`:""}};for(const i of e.split(`
`))t.push({name:"span",value:i,attributes:r});return n},wL=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&c(this,Wa))&&I(this,Ze,$A).call(this)},vL=function(){if(c(this,hl)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:r,pageY:i}}}=c(this,vm);let o=!!c(this,Am),u=o?c(this,Am):c(this,Pw);for(const F of c(this,uh))if(!u||_e.intersect(F.data.rect,u)!==null){u=F.data.rect,o=!0;break}const d=_e.normalizeRect([u[0],e[3]-u[1]+e[1],u[2],e[3]-u[3]+e[1]]),f=o?u[2]-u[0]+5:0,g=d[0]+f,w=d[1];x(this,hl,[100*(g-r)/t,100*(w-i)/n]);const{style:A}=c(this,dn);A.left=`${c(this,hl)[0]}%`,A.top=`${c(this,hl)[1]}%`},$A=function(){if(c(this,Ps)){c(this,Ps).toggleCommentPopup(this,!1);return}x(this,Wa,!c(this,Wa)),c(this,Wa)?(I(this,Ze,zA).call(this),c(this,dn).addEventListener("click",c(this,ym)),c(this,dn).addEventListener("keydown",c(this,eu))):(I(this,Ze,FC).call(this),c(this,dn).removeEventListener("click",c(this,ym)),c(this,dn).removeEventListener("keydown",c(this,eu)))},zA=function(){c(this,Rs)||this.render(),this.isVisible?c(this,Wa)&&c(this,dn).classList.add("focused"):(I(this,Ze,vL).call(this),c(this,dn).hidden=!1,c(this,dn).style.zIndex=parseInt(c(this,dn).style.zIndex)+1e3)},FC=function(){c(this,dn).classList.remove("focused"),!(c(this,Wa)||!this.isVisible)&&(c(this,dn).hidden=!0,c(this,dn).style.zIndex=parseInt(c(this,dn).style.zIndex)-1e3)};class AL extends an{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Xe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var Rw;class WG extends an{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});T(this,Rw,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:n,height:r}=this,i=this.svgFactory.create(n,r,!0),o=x(this,Rw,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return c(this,Rw)}addHighlightArea(){this.container.classList.add("highlightArea")}}Rw=new WeakMap;var Dw;class GG extends an{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});T(this,Dw,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:n,height:r}=this,i=this.svgFactory.create(n,r,!0),o=t.borderStyle.width,u=x(this,Dw,this.svgFactory.createElement("svg:rect"));return u.setAttribute("x",o/2),u.setAttribute("y",o/2),u.setAttribute("width",n-o),u.setAttribute("height",r-o),u.setAttribute("stroke-width",o||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),i.append(u),this.container.append(i),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return c(this,Dw)}addHighlightArea(){this.container.classList.add("highlightArea")}}Dw=new WeakMap;var Nw;class qG extends an{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});T(this,Nw,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:n,height:r}=this,i=this.svgFactory.create(n,r,!0),o=t.borderStyle.width,u=x(this,Nw,this.svgFactory.createElement("svg:ellipse"));return u.setAttribute("cx",n/2),u.setAttribute("cy",r/2),u.setAttribute("rx",n/2-o/2),u.setAttribute("ry",r/2-o/2),u.setAttribute("stroke-width",o||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),i.append(u),this.container.append(i),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return c(this,Nw)}addHighlightArea(){this.container.classList.add("highlightArea")}}Nw=new WeakMap;var Mw;class _L extends an{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});T(this,Mw,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:n,borderStyle:r,popupRef:i},width:o,height:u}=this;if(!n)return this.container;const d=this.svgFactory.create(o,u,!0);let h=[];for(let g=0,w=n.length;g<w;g+=2){const A=n[g]-t[0],F=t[3]-n[g+1];h.push(`${A},${F}`)}h=h.join(" ");const f=x(this,Mw,this.svgFactory.createElement(this.svgElementName));return f.setAttribute("points",h),f.setAttribute("stroke-width",r.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),d.append(f),this.container.append(d),!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return c(this,Mw)}addHighlightArea(){this.container.classList.add("highlightArea")}}Mw=new WeakMap;class QG extends _L{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class KG extends an{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}var Lw,hh,Ow,SC;class FS extends an{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});T(this,Ow);T(this,Lw,null);T(this,hh,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Xe.HIGHLIGHT:Xe.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:n,inkLists:r,borderStyle:i,popupRef:o}}=this,{transform:u,width:d,height:h}=I(this,Ow,SC).call(this,n,t),f=this.svgFactory.create(d,h,!0),g=x(this,Lw,this.svgFactory.createElement("svg:g"));f.append(g),g.setAttribute("stroke-width",i.width||1),g.setAttribute("stroke-linecap","round"),g.setAttribute("stroke-linejoin","round"),g.setAttribute("stroke-miterlimit",10),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),g.setAttribute("transform",u);for(let w=0,A=r.length;w<A;w++){const F=this.svgFactory.createElement(this.svgElementName);c(this,hh).push(F),F.setAttribute("points",r[w].join(",")),g.append(F)}return!o&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:n,points:r,rect:i}=t,o=c(this,Lw);if(n>=0&&o.setAttribute("stroke-width",n||1),r)for(let u=0,d=c(this,hh).length;u<d;u++)c(this,hh)[u].setAttribute("points",r[u].join(","));if(i){const{transform:u,width:d,height:h}=I(this,Ow,SC).call(this,this.data.rotation,i);o.parentElement.setAttribute("viewBox",`0 0 ${d} ${h}`),o.setAttribute("transform",u)}}getElementsToTriggerPopup(){return c(this,hh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Lw=new WeakMap,hh=new WeakMap,Ow=new WeakSet,SC=function(t,n){switch(t){case 90:return{transform:`rotate(90) translate(${-n[0]},${n[1]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};case 180:return{transform:`rotate(180) translate(${-n[2]},${n[1]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]};case 270:return{transform:`rotate(270) translate(${-n[2]},${n[3]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};default:return{transform:`translate(${-n[0]},${n[3]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]}}};class xL extends an{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Xe.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class XG extends an{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class YG extends an{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class JG extends an{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class EL extends an{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Xe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var Bw,Vw,TC;class ZG extends an{constructor(t){var r;super(t,{isRenderable:!0});T(this,Vw);T(this,Bw,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(r=this.linkService.eventBus)==null||r.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:n}=this;let r;n.hasAppearance||n.fillAlpha===0?r=document.createElement("div"):(r=document.createElement("img"),r.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(r.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),r.addEventListener("dblclick",I(this,Vw,TC).bind(this)),x(this,Bw,r);const{isMac:i}=Hn.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(i?o.metaKey:o.ctrlKey)&&I(this,Vw,TC).call(this)}),!n.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):r.classList.add("popupTriggerArea"),t.append(r),t}getElementsToTriggerPopup(){return c(this,Bw)}addHighlightArea(){this.container.classList.add("highlightArea")}}Bw=new WeakMap,Vw=new WeakSet,TC=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var ph,fh,xm,iu,Uw,mh,Ds,jw,Sl,HA,IC;const MS=class MS{constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:r,page:i,viewport:o,structTreeLayer:u,commentManager:d,linkService:h,annotationStorage:f}){T(this,Sl);T(this,ph,null);T(this,fh,null);T(this,xm,null);T(this,iu,new Map);T(this,Uw,null);T(this,mh,null);T(this,Ds,[]);T(this,jw,!1);this.div=e,x(this,ph,t),x(this,fh,n),x(this,Uw,u||null),x(this,mh,h||null),x(this,xm,f||new xS),this.page=i,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=r,this._commentManager=d||null}hasEditableAnnotations(){return c(this,iu).size>0}async render(e){var u;const{annotations:t}=e,n=this.div;qh(n,this.viewport);const r=new Map,i=[],o={data:null,layer:n,linkService:c(this,mh),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new L_,annotationStorage:c(this,xm),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const d of t){if(d.noHTML)continue;const h=d.annotationType===kn.POPUP;if(h){const w=r.get(d.id);if(!w)continue;if(!this._commentManager){i.push(d);continue}o.elements=w}else if(d.rect[2]===d.rect[0]||d.rect[3]===d.rect[1])continue;o.data=d;const f=XE.create(o);if(!f.isRenderable)continue;if(!h&&(c(this,Ds).push(f),d.popupRef)){const w=r.get(d.popupRef);w?w.push(f):r.set(d.popupRef,[f])}const g=f.render();d.hidden&&(g.style.visibility="hidden"),f._isEditable&&(c(this,iu).set(f.data.id,f),(u=this._annotationEditorUIManager)==null||u.renderAnnotationElement(f))}await I(this,Sl,HA).call(this);for(const d of i){const h=o.elements=r.get(d.id);o.data=d;const f=XE.create(o);if(!f.isRenderable)continue;const g=f.render();f.contentElement.id=`${sf}${d.id}`,d.hidden&&(g.style.visibility="hidden"),h.at(-1).container.after(g)}I(this,Sl,IC).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:c(this,mh),svgFactory:new L_,parent:this};for(const n of e){n.borderStyle||(n.borderStyle=MS._defaultBorderStyle),t.data=n;const r=XE.create(t);r.isRenderable&&(r.render(),r.contentElement.id=`${sf}${n.id}`,c(this,Ds).push(r))}await I(this,Sl,HA).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,qh(t,{rotation:e.rotation}),I(this,Sl,IC).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(c(this,iu).values())}getEditableAnnotation(e){return c(this,iu).get(e)}addFakeAnnotation(e){const{div:t}=this,{id:n,rotation:r}=e,i=new OG({data:{id:n,rect:e.getPDFRect(),rotation:r},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:c(this,mh),annotationStorage:c(this,xm)});return i.render(),i.contentElement.id=`${sf}${n}`,i.createOrUpdatePopup(),c(this,Ds).push(i),i}removeAnnotation(e){var r;const t=c(this,Ds).findIndex(i=>i.data.id===e);if(t<0)return;const[n]=c(this,Ds).splice(t,1);(r=c(this,ph))==null||r.removePointerInTextLayer(n.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);I(this,Sl,HA).call(this)}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return qe(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Kp.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};ph=new WeakMap,fh=new WeakMap,xm=new WeakMap,iu=new WeakMap,Uw=new WeakMap,mh=new WeakMap,Ds=new WeakMap,jw=new WeakMap,Sl=new WeakSet,HA=async function(){var n,r,i;if(c(this,Ds).length===0)return;this.div.replaceChildren();const e=[];if(!c(this,jw)){x(this,jw,!0);for(const{contentElement:o,data:{id:u}}of c(this,Ds)){const d=o.id=`${sf}${u}`;e.push((n=c(this,Uw))==null?void 0:n.getAriaAttributes(d).then(h=>{if(h)for(const[f,g]of h)o.setAttribute(f,g)}))}}c(this,Ds).sort(({data:{rect:[o,u,d,h]}},{data:{rect:[f,g,w,A]}})=>{if(o===d&&u===h)return 1;if(f===w&&g===A)return-1;const F=h,C=u,S=(u+h)/2,P=A,O=g,N=(g+A)/2;if(S>=P&&N<=C)return-1;if(N>=F&&S<=O)return 1;const V=(o+d)/2,z=(f+w)/2;return V-z});const t=document.createDocumentFragment();for(const o of c(this,Ds))t.append(o.container),this._commentManager?(i=((r=o.extraPopupElement)==null?void 0:r.popup)||o.popup)==null||i.renderCommentButton():o.extraPopupElement&&t.append(o.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),c(this,ph))for(const o of c(this,Ds))c(this,ph).addPointerInTextLayer(o.contentElement,!1)},IC=function(){var t;if(!c(this,fh))return;const e=this.div;for(const[n,r]of c(this,fh)){const i=e.querySelector(`[data-annotation-id="${n}"]`);if(!i)continue;r.className="annotationContent";const{firstChild:o}=i;o?o.nodeName==="CANVAS"?o.replaceWith(r):o.classList.contains("annotationContent")?o.after(r):o.before(r):i.append(r);const u=c(this,iu).get(n);u&&(u._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(n,i.id,r),u._hasNoCanvas=!1):u.canvas=r)}c(this,fh).clear()};let kC=MS;const uA=/\r\n?|\n/g;var Ns,$w,gh,Ms,Mn,bL,CL,FL,WA,Tl,GA,qA,SL,RC,TL;const Ht=class Ht extends Ut{constructor(t){super({...t,name:"freeTextEditor"});T(this,Mn);T(this,Ns,"");T(this,$w,`${this.id}-editor`);T(this,gh,null);T(this,Ms);re(this,"_colorPicker",null);this.color=t.color||Ht._defaultColor||Ut._defaultLineColor,x(this,Ms,t.fontSize||Ht._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static get _keyboardManager(){const t=Ht.prototype,n=o=>o.isEmpty(),r=Qh.TRANSLATE_SMALL,i=Qh.TRANSLATE_BIG;return qe(this,"_keyboardManager",new k0([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:n}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[r,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[i,0],checker:n}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:n}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,r],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,i],checker:n}]]))}static initialize(t,n){Ut.initialize(t,n);const r=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(r.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,n){switch(t){case lt.FREETEXT_SIZE:Ht._defaultFontSize=n;break;case lt.FREETEXT_COLOR:Ht._defaultColor=n;break}}updateParams(t,n){switch(t){case lt.FREETEXT_SIZE:I(this,Mn,bL).call(this,n);break;case lt.FREETEXT_COLOR:I(this,Mn,CL).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[lt.FREETEXT_SIZE,Ht._defaultFontSize],[lt.FREETEXT_COLOR,Ht._defaultColor||Ut._defaultLineColor]]}get propertiesToUpdate(){return[[lt.FREETEXT_SIZE,c(this,Ms)],[lt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new M_(this)),[["colorPicker",this._colorPicker]]}get colorType(){return lt.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,n){this._uiManager.translateSelectedEditors(t,n,!0)}getInitialTranslation(){const t=this.parentScale;return[-Ht._internalPadding*t,-(Ht._internalPadding+c(this,Ms))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),x(this,gh,new AbortController);const t=this._uiManager.combinedSignal(c(this,gh));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",c(this,$w)),this._isDraggable=!0,(t=c(this,gh))==null||t.abort(),x(this,gh,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var n;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=c(this,Ns),n=x(this,Ns,I(this,Mn,FL).call(this).trimEnd());if(t===n)return;const r=i=>{if(x(this,Ns,i),!i){this.remove();return}I(this,Mn,qA).call(this),this._uiManager.rebuild(this),I(this,Mn,WA).call(this)};this.addCommands({cmd:()=>{r(n)},undo:()=>{r(t)},mustExec:!1}),I(this,Mn,WA).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Ht._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,n;(this._isCopy||this.annotationElementId)&&(t=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",c(this,$w)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:r}=this.editorDiv;if(r.fontSize=`calc(${c(this,Ms)}px * var(--total-scale-factor))`,r.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,o]=this.parentDimensions;if(this.annotationElementId){const{position:u}=this._initialData;let[d,h]=this.getInitialTranslation();[d,h]=this.pageTranslationToScreen(d,h);const[f,g]=this.pageDimensions,[w,A]=this.pageTranslation;let F,C;switch(this.rotation){case 0:F=t+(u[0]-w)/f,C=n+this.height-(u[1]-A)/g;break;case 90:F=t+(u[0]-w)/f,C=n-(u[1]-A)/g,[d,h]=[h,-d];break;case 180:F=t-this.width+(u[0]-w)/f,C=n-(u[1]-A)/g,[d,h]=[-d,-h];break;case 270:F=t+(u[0]-w-this.height*g)/f,C=n+(u[1]-A-this.width*f)/g,[d,h]=[-h,d];break}this.setAt(F*i,C*o,d,h)}else this._moveAfterPaste(t,n);I(this,Mn,qA).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var F,C,S;const n=t.clipboardData||window.clipboardData,{types:r}=n;if(r.length===1&&r[0]==="text/plain")return;t.preventDefault();const i=I(F=Ht,Tl,RC).call(F,n.getData("text")||"").replaceAll(uA,`
`);if(!i)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const u=o.getRangeAt(0);if(!i.includes(`
`)){u.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:d,startOffset:h}=u,f=[],g=[];if(d.nodeType===Node.TEXT_NODE){const P=d.parentElement;if(g.push(d.nodeValue.slice(h).replaceAll(uA,"")),P!==this.editorDiv){let O=f;for(const N of this.editorDiv.childNodes){if(N===P){O=g;continue}O.push(I(C=Ht,Tl,GA).call(C,N))}}f.push(d.nodeValue.slice(0,h).replaceAll(uA,""))}else if(d===this.editorDiv){let P=f,O=0;for(const N of this.editorDiv.childNodes)O++===h&&(P=g),P.push(I(S=Ht,Tl,GA).call(S,N))}x(this,Ns,`${f.join(`
`)}${i}${g.join(`
`)}`),I(this,Mn,qA).call(this);const w=new Range;let A=Math.sumPrecise(f.map(P=>P.length));for(const{firstChild:P}of this.editorDiv.childNodes)if(P.nodeType===Node.TEXT_NODE){const O=P.nodeValue.length;if(A<=O){w.setStart(P,A),w.setEnd(P,A);break}A-=O}o.removeAllRanges(),o.addRange(w)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Ht._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,n,r){var u;let i=null;if(t instanceof AL){const{data:{defaultAppearanceData:{fontSize:d,fontColor:h},rect:f,rotation:g,id:w,popupRef:A,richText:F,contentsObj:C,creationDate:S,modificationDate:P},textContent:O,textPosition:N,parent:{page:{pageNumber:V}}}=t;if(!O||O.length===0)return null;i=t={annotationType:Xe.FREETEXT,color:Array.from(h),fontSize:d,value:O.join(`
`),position:N,pageIndex:V-1,rect:f.slice(0),rotation:g,annotationElementId:w,id:w,deleted:!1,popupRef:A,comment:(C==null?void 0:C.str)||null,richText:F,creationDate:S,modificationDate:P}}const o=await super.deserialize(t,n,r);return x(o,Ms,t.fontSize),o.color=_e.makeHexColor(...t.color),x(o,Ns,I(u=Ht,Tl,RC).call(u,t.value)),o._initialData=i,t.comment&&o.setCommentData(t),o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Ut._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),r=Object.assign(super.serialize(t),{color:n,fontSize:c(this,Ms),value:I(this,Mn,SL).call(this)});return this.addComment(r),t?(r.isCopy=!0,r):this.annotationElementId&&!I(this,Mn,TL).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){const n=super.renderAnnotationElement(t);if(!n)return null;const{style:r}=n;r.fontSize=`calc(${c(this,Ms)}px * var(--total-scale-factor))`,r.color=this.color,n.replaceChildren();for(const i of c(this,Ns).split(`
`)){const o=document.createElement("div");o.append(i?document.createTextNode(i):document.createElement("br")),n.append(o)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:c(this,Ns)}}),n}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Ns=new WeakMap,$w=new WeakMap,gh=new WeakMap,Ms=new WeakMap,Mn=new WeakSet,bL=function(t){const n=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--total-scale-factor))`,this.translate(0,-(i-c(this,Ms))*this.parentScale),x(this,Ms,i),I(this,Mn,WA).call(this)},r=c(this,Ms);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:lt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},CL=function(t){const n=i=>{this.color=i,this.onUpdatedColor()},r=this.color;this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:lt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},FL=function(){var r;const t=[];this.editorDiv.normalize();let n=null;for(const i of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(I(r=Ht,Tl,GA).call(r,i)),n=i);return t.join(`
`)},WA=function(){const[t,n]=this.parentDimensions;let r;if(this.isAttachedToDOM)r=this.div.getBoundingClientRect();else{const{currentLayer:i,div:o}=this,u=o.style.display,d=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",i.div.append(this.div),r=o.getBoundingClientRect(),o.remove(),o.style.display=u,o.classList.toggle("hidden",d)}this.rotation%180===this.parentRotation%180?(this.width=r.width/t,this.height=r.height/n):(this.width=r.height/t,this.height=r.width/n),this.fixAndSetPosition()},Tl=new WeakSet,GA=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(uA,"")},qA=function(){if(this.editorDiv.replaceChildren(),!!c(this,Ns))for(const t of c(this,Ns).split(`
`)){const n=document.createElement("div");n.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(n)}},SL=function(){return c(this,Ns).replaceAll(""," ")},RC=function(t){return t.replaceAll(" ","")},TL=function(t){const{value:n,fontSize:r,color:i,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==n||t.fontSize!==r||t.color.some((u,d)=>u!==i[d])||t.pageIndex!==o},T(Ht,Tl),re(Ht,"_freeTextDefaultContent",""),re(Ht,"_internalPadding",0),re(Ht,"_defaultColor",null),re(Ht,"_defaultFontSize",10),re(Ht,"_type","freetext"),re(Ht,"_editorType",Xe.FREETEXT);let PC=Ht;class Fe{toSVGPath(){At("Abstract method `toSVGPath` must be implemented.")}get box(){At("Abstract getter `box` must be implemented.")}serialize(e,t){At("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,r,i,o){o||(o=new Float32Array(e.length));for(let u=0,d=e.length;u<d;u+=2)o[u]=t+e[u]*r,o[u+1]=n+e[u+1]*i;return o}static _rescaleAndSwap(e,t,n,r,i,o){o||(o=new Float32Array(e.length));for(let u=0,d=e.length;u<d;u+=2)o[u]=t+e[u+1]*r,o[u+1]=n+e[u]*i;return o}static _translate(e,t,n,r){r||(r=new Float32Array(e.length));for(let i=0,o=e.length;i<o;i+=2)r[i]=t+e[i],r[i+1]=n+e[i+1];return r}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,r,i){switch(i){case 90:return[1-t/n,e/r];case 180:return[1-e/n,1-t/r];case 270:return[t/n,1-e/r];default:return[e/n,t/r]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,r,i,o){return[(e+5*n)/6,(t+5*r)/6,(5*n+i)/6,(5*r+o)/6,(n+i)/2,(r+o)/2]}}re(Fe,"PRECISION",1e-4);var Ls,Gi,Em,bm,Ga,nt,yh,wh,zw,Hw,Cm,Fm,au,Ww,ex,tx,$n,Lg,kL,IL,PL,RL,DL,NL;const Vo=class Vo{constructor({x:e,y:t},n,r,i,o,u=0){T(this,$n);T(this,Ls);T(this,Gi,[]);T(this,Em);T(this,bm);T(this,Ga,[]);T(this,nt,new Float32Array(18));T(this,yh);T(this,wh);T(this,zw);T(this,Hw);T(this,Cm);T(this,Fm);T(this,au,[]);x(this,Ls,n),x(this,Fm,i*r),x(this,bm,o),c(this,nt).set([NaN,NaN,NaN,NaN,e,t],6),x(this,Em,u),x(this,Hw,c(Vo,Ww)*r),x(this,zw,c(Vo,tx)*r),x(this,Cm,r),c(this,au).push(e,t)}isEmpty(){return isNaN(c(this,nt)[8])}add({x:e,y:t}){var L;x(this,yh,e),x(this,wh,t);const[n,r,i,o]=c(this,Ls);let[u,d,h,f]=c(this,nt).subarray(8,12);const g=e-h,w=t-f,A=Math.hypot(g,w);if(A<c(this,zw))return!1;const F=A-c(this,Hw),C=F/A,S=C*g,P=C*w;let O=u,N=d;u=h,d=f,h+=S,f+=P,(L=c(this,au))==null||L.push(e,t);const V=-P/F,z=S/F,H=V*c(this,Fm),R=z*c(this,Fm);return c(this,nt).set(c(this,nt).subarray(2,8),0),c(this,nt).set([h+H,f+R],4),c(this,nt).set(c(this,nt).subarray(14,18),12),c(this,nt).set([h-H,f-R],16),isNaN(c(this,nt)[6])?(c(this,Ga).length===0&&(c(this,nt).set([u+H,d+R],2),c(this,Ga).push(NaN,NaN,NaN,NaN,(u+H-n)/i,(d+R-r)/o),c(this,nt).set([u-H,d-R],14),c(this,Gi).push(NaN,NaN,NaN,NaN,(u-H-n)/i,(d-R-r)/o)),c(this,nt).set([O,N,u,d,h,f],6),!this.isEmpty()):(c(this,nt).set([O,N,u,d,h,f],6),Math.abs(Math.atan2(N-d,O-u)-Math.atan2(P,S))<Math.PI/2?([u,d,h,f]=c(this,nt).subarray(2,6),c(this,Ga).push(NaN,NaN,NaN,NaN,((u+h)/2-n)/i,((d+f)/2-r)/o),[u,d,O,N]=c(this,nt).subarray(14,18),c(this,Gi).push(NaN,NaN,NaN,NaN,((O+u)/2-n)/i,((N+d)/2-r)/o),!0):([O,N,u,d,h,f]=c(this,nt).subarray(0,6),c(this,Ga).push(((O+5*u)/6-n)/i,((N+5*d)/6-r)/o,((5*u+h)/6-n)/i,((5*d+f)/6-r)/o,((u+h)/2-n)/i,((d+f)/2-r)/o),[h,f,u,d,O,N]=c(this,nt).subarray(12,18),c(this,Gi).push(((O+5*u)/6-n)/i,((N+5*d)/6-r)/o,((5*u+h)/6-n)/i,((5*d+f)/6-r)/o,((u+h)/2-n)/i,((d+f)/2-r)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=c(this,Ga),t=c(this,Gi);if(isNaN(c(this,nt)[6])&&!this.isEmpty())return I(this,$n,kL).call(this);const n=[];n.push(`M${e[4]} ${e[5]}`);for(let r=6;r<e.length;r+=6)isNaN(e[r])?n.push(`L${e[r+4]} ${e[r+5]}`):n.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);I(this,$n,PL).call(this,n);for(let r=t.length-6;r>=6;r-=6)isNaN(t[r])?n.push(`L${t[r+4]} ${t[r+5]}`):n.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);return I(this,$n,IL).call(this,n),n.join(" ")}newFreeDrawOutline(e,t,n,r,i,o){return new ML(e,t,n,r,i,o)}getOutlines(){var g;const e=c(this,Ga),t=c(this,Gi),n=c(this,nt),[r,i,o,u]=c(this,Ls),d=new Float32Array((((g=c(this,au))==null?void 0:g.length)??0)+2);for(let w=0,A=d.length-2;w<A;w+=2)d[w]=(c(this,au)[w]-r)/o,d[w+1]=(c(this,au)[w+1]-i)/u;if(d[d.length-2]=(c(this,yh)-r)/o,d[d.length-1]=(c(this,wh)-i)/u,isNaN(n[6])&&!this.isEmpty())return I(this,$n,RL).call(this,d);const h=new Float32Array(c(this,Ga).length+24+c(this,Gi).length);let f=e.length;for(let w=0;w<f;w+=2){if(isNaN(e[w])){h[w]=h[w+1]=NaN;continue}h[w]=e[w],h[w+1]=e[w+1]}f=I(this,$n,NL).call(this,h,f);for(let w=t.length-6;w>=6;w-=6)for(let A=0;A<6;A+=2){if(isNaN(t[w+A])){h[f]=h[f+1]=NaN,f+=2;continue}h[f]=t[w+A],h[f+1]=t[w+A+1],f+=2}return I(this,$n,DL).call(this,h,f),this.newFreeDrawOutline(h,d,c(this,Ls),c(this,Cm),c(this,Em),c(this,bm))}};Ls=new WeakMap,Gi=new WeakMap,Em=new WeakMap,bm=new WeakMap,Ga=new WeakMap,nt=new WeakMap,yh=new WeakMap,wh=new WeakMap,zw=new WeakMap,Hw=new WeakMap,Cm=new WeakMap,Fm=new WeakMap,au=new WeakMap,Ww=new WeakMap,ex=new WeakMap,tx=new WeakMap,$n=new WeakSet,Lg=function(){const e=c(this,nt).subarray(4,6),t=c(this,nt).subarray(16,18),[n,r,i,o]=c(this,Ls);return[(c(this,yh)+(e[0]-t[0])/2-n)/i,(c(this,wh)+(e[1]-t[1])/2-r)/o,(c(this,yh)+(t[0]-e[0])/2-n)/i,(c(this,wh)+(t[1]-e[1])/2-r)/o]},kL=function(){const[e,t,n,r]=c(this,Ls),[i,o,u,d]=I(this,$n,Lg).call(this);return`M${(c(this,nt)[2]-e)/n} ${(c(this,nt)[3]-t)/r} L${(c(this,nt)[4]-e)/n} ${(c(this,nt)[5]-t)/r} L${i} ${o} L${u} ${d} L${(c(this,nt)[16]-e)/n} ${(c(this,nt)[17]-t)/r} L${(c(this,nt)[14]-e)/n} ${(c(this,nt)[15]-t)/r} Z`},IL=function(e){const t=c(this,Gi);e.push(`L${t[4]} ${t[5]} Z`)},PL=function(e){const[t,n,r,i]=c(this,Ls),o=c(this,nt).subarray(4,6),u=c(this,nt).subarray(16,18),[d,h,f,g]=I(this,$n,Lg).call(this);e.push(`L${(o[0]-t)/r} ${(o[1]-n)/i} L${d} ${h} L${f} ${g} L${(u[0]-t)/r} ${(u[1]-n)/i}`)},RL=function(e){const t=c(this,nt),[n,r,i,o]=c(this,Ls),[u,d,h,f]=I(this,$n,Lg).call(this),g=new Float32Array(36);return g.set([NaN,NaN,NaN,NaN,(t[2]-n)/i,(t[3]-r)/o,NaN,NaN,NaN,NaN,(t[4]-n)/i,(t[5]-r)/o,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,h,f,NaN,NaN,NaN,NaN,(t[16]-n)/i,(t[17]-r)/o,NaN,NaN,NaN,NaN,(t[14]-n)/i,(t[15]-r)/o],0),this.newFreeDrawOutline(g,e,c(this,Ls),c(this,Cm),c(this,Em),c(this,bm))},DL=function(e,t){const n=c(this,Gi);return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6},NL=function(e,t){const n=c(this,nt).subarray(4,6),r=c(this,nt).subarray(16,18),[i,o,u,d]=c(this,Ls),[h,f,g,w]=I(this,$n,Lg).call(this);return e.set([NaN,NaN,NaN,NaN,(n[0]-i)/u,(n[1]-o)/d,NaN,NaN,NaN,NaN,h,f,NaN,NaN,NaN,NaN,g,w,NaN,NaN,NaN,NaN,(r[0]-i)/u,(r[1]-o)/d],t),t+=24},T(Vo,Ww,8),T(Vo,ex,2),T(Vo,tx,c(Vo,Ww)+c(Vo,ex));let O_=Vo;var Sm,vh,ml,Gw,Os,qw,En,nx,LL;class ML extends Fe{constructor(t,n,r,i,o,u){super();T(this,nx);T(this,Sm);T(this,vh,new Float32Array(4));T(this,ml);T(this,Gw);T(this,Os);T(this,qw);T(this,En);x(this,En,t),x(this,Os,n),x(this,Sm,r),x(this,qw,i),x(this,ml,o),x(this,Gw,u),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],I(this,nx,LL).call(this,u);const[d,h,f,g]=c(this,vh);for(let w=0,A=t.length;w<A;w+=2)t[w]=(t[w]-d)/f,t[w+1]=(t[w+1]-h)/g;for(let w=0,A=n.length;w<A;w+=2)n[w]=(n[w]-d)/f,n[w+1]=(n[w+1]-h)/g}toSVGPath(){const t=[`M${c(this,En)[4]} ${c(this,En)[5]}`];for(let n=6,r=c(this,En).length;n<r;n+=6){if(isNaN(c(this,En)[n])){t.push(`L${c(this,En)[n+4]} ${c(this,En)[n+5]}`);continue}t.push(`C${c(this,En)[n]} ${c(this,En)[n+1]} ${c(this,En)[n+2]} ${c(this,En)[n+3]} ${c(this,En)[n+4]} ${c(this,En)[n+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,n,r,i],o){const u=r-t,d=i-n;let h,f;switch(o){case 0:h=Fe._rescale(c(this,En),t,i,u,-d),f=Fe._rescale(c(this,Os),t,i,u,-d);break;case 90:h=Fe._rescaleAndSwap(c(this,En),t,n,u,d),f=Fe._rescaleAndSwap(c(this,Os),t,n,u,d);break;case 180:h=Fe._rescale(c(this,En),r,n,-u,d),f=Fe._rescale(c(this,Os),r,n,-u,d);break;case 270:h=Fe._rescaleAndSwap(c(this,En),r,i,-u,-d),f=Fe._rescaleAndSwap(c(this,Os),r,i,-u,-d);break}return{outline:Array.from(h),points:[Array.from(f)]}}get box(){return c(this,vh)}newOutliner(t,n,r,i,o,u=0){return new O_(t,n,r,i,o,u)}getNewOutline(t,n){const[r,i,o,u]=c(this,vh),[d,h,f,g]=c(this,Sm),w=o*f,A=u*g,F=r*f+d,C=i*g+h,S=this.newOutliner({x:c(this,Os)[0]*w+F,y:c(this,Os)[1]*A+C},c(this,Sm),c(this,qw),t,c(this,Gw),n??c(this,ml));for(let P=2;P<c(this,Os).length;P+=2)S.add({x:c(this,Os)[P]*w+F,y:c(this,Os)[P+1]*A+C});return S.getOutlines()}}Sm=new WeakMap,vh=new WeakMap,ml=new WeakMap,Gw=new WeakMap,Os=new WeakMap,qw=new WeakMap,En=new WeakMap,nx=new WeakSet,LL=function(t){const n=c(this,En);let r=n[4],i=n[5];const o=[r,i,r,i];let u=r,d=i,h=r,f=i;const g=t?Math.max:Math.min,w=new Float32Array(4);for(let F=6,C=n.length;F<C;F+=6){const S=n[F+4],P=n[F+5];isNaN(n[F])?(_e.pointBoundingBox(S,P,o),d>P?(u=S,d=P):d===P&&(u=g(u,S)),f<P?(h=S,f=P):f===P&&(h=g(h,S))):(w[0]=w[1]=1/0,w[2]=w[3]=-1/0,_e.bezierBoundingBox(r,i,...n.slice(F,F+6),w),_e.rectBoundingBox(w[0],w[1],w[2],w[3],o),d>w[1]?(u=w[0],d=w[1]):d===w[1]&&(u=g(u,w[0])),f<w[3]?(h=w[2],f=w[3]):f===w[3]&&(h=g(h,w[2]))),r=S,i=P}const A=c(this,vh);A[0]=o[0]-c(this,ml),A[1]=o[1]-c(this,ml),A[2]=o[2]-o[0]+2*c(this,ml),A[3]=o[3]-o[1]+2*c(this,ml),this.firstPoint=[u,d],this.lastPoint=[h,f]};var Qw,Kw,Xw,ou,qi,qr,OL,QA,BL,VL,NC;class DC{constructor(e,t=0,n=0,r=!0){T(this,qr);T(this,Qw);T(this,Kw);T(this,Xw);T(this,ou,[]);T(this,qi,[]);const i=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:C,y:S,width:P,height:O}of e){const N=Math.floor((C-t)/o)*o,V=Math.ceil((C+P+t)/o)*o,z=Math.floor((S-t)/o)*o,H=Math.ceil((S+O+t)/o)*o,R=[N,z,H,!0],D=[V,z,H,!1];c(this,ou).push(R,D),_e.rectBoundingBox(N,z,V,H,i)}const u=i[2]-i[0]+2*n,d=i[3]-i[1]+2*n,h=i[0]-n,f=i[1]-n;let g=r?-1/0:1/0,w=1/0;const A=c(this,ou).at(r?-1:-2),F=[A[0],A[2]];for(const C of c(this,ou)){const[S,P,O,N]=C;!N&&r?P<w?(w=P,g=S):P===w&&(g=Math.max(g,S)):N&&!r&&(P<w?(w=P,g=S):P===w&&(g=Math.min(g,S))),C[0]=(S-h)/u,C[1]=(P-f)/d,C[2]=(O-f)/d}x(this,Qw,new Float32Array([h,f,u,d])),x(this,Kw,[g,w]),x(this,Xw,F)}getOutlines(){c(this,ou).sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of c(this,ou))t[3]?(e.push(...I(this,qr,NC).call(this,t)),I(this,qr,BL).call(this,t)):(I(this,qr,VL).call(this,t),e.push(...I(this,qr,NC).call(this,t)));return I(this,qr,OL).call(this,e)}}Qw=new WeakMap,Kw=new WeakMap,Xw=new WeakMap,ou=new WeakMap,qi=new WeakMap,qr=new WeakSet,OL=function(e){const t=[],n=new Set;for(const o of e){const[u,d,h]=o;t.push([u,d,o],[u,h,o])}t.sort((o,u)=>o[1]-u[1]||o[0]-u[0]);for(let o=0,u=t.length;o<u;o+=2){const d=t[o][2],h=t[o+1][2];d.push(h),h.push(d),n.add(d),n.add(h)}const r=[];let i;for(;n.size>0;){const o=n.values().next().value;let[u,d,h,f,g]=o;n.delete(o);let w=u,A=d;for(i=[u,h],r.push(i);;){let F;if(n.has(f))F=f;else if(n.has(g))F=g;else break;n.delete(F),[u,d,h,f,g]=F,w!==u&&(i.push(w,A,u,A===d?d:h),w=u),A=A===d?h:d}i.push(w,A)}return new eq(r,c(this,Qw),c(this,Kw),c(this,Xw))},QA=function(e){const t=c(this,qi);let n=0,r=t.length-1;for(;n<=r;){const i=n+r>>1,o=t[i][0];if(o===e)return i;o<e?n=i+1:r=i-1}return r+1},BL=function([,e,t]){const n=I(this,qr,QA).call(this,e);c(this,qi).splice(n,0,[e,t])},VL=function([,e,t]){const n=I(this,qr,QA).call(this,e);for(let r=n;r<c(this,qi).length;r++){const[i,o]=c(this,qi)[r];if(i!==e)break;if(i===e&&o===t){c(this,qi).splice(r,1);return}}for(let r=n-1;r>=0;r--){const[i,o]=c(this,qi)[r];if(i!==e)break;if(i===e&&o===t){c(this,qi).splice(r,1);return}}},NC=function(e){const[t,n,r]=e,i=[[t,n,r]],o=I(this,qr,QA).call(this,r);for(let u=0;u<o;u++){const[d,h]=c(this,qi)[u];for(let f=0,g=i.length;f<g;f++){const[,w,A]=i[f];if(!(h<=w||A<=d)){if(w>=d){if(A>h)i[f][1]=h;else{if(g===1)return[];i.splice(f,1),f--,g--}continue}i[f][2]=d,A>h&&i.push([t,h,A])}}}return i};var Yw,Tm;class eq extends Fe{constructor(t,n,r,i){super();T(this,Yw);T(this,Tm);x(this,Tm,t),x(this,Yw,n),this.firstPoint=r,this.lastPoint=i}toSVGPath(){const t=[];for(const n of c(this,Tm)){let[r,i]=n;t.push(`M${r} ${i}`);for(let o=2;o<n.length;o+=2){const u=n[o],d=n[o+1];u===r?(t.push(`V${d}`),i=d):d===i&&(t.push(`H${u}`),r=u)}t.push("Z")}return t.join(" ")}serialize([t,n,r,i],o){const u=[],d=r-t,h=i-n;for(const f of c(this,Tm)){const g=new Array(f.length);for(let w=0;w<f.length;w+=2)g[w]=t+f[w]*d,g[w+1]=i-f[w+1]*h;u.push(g)}return u}get box(){return c(this,Yw)}get classNamesForOutlining(){return["highlightOutline"]}}Yw=new WeakMap,Tm=new WeakMap;class MC extends O_{newFreeDrawOutline(e,t,n,r,i,o){return new tq(e,t,n,r,i,o)}}class tq extends ML{newOutliner(e,t,n,r,i,o=0){return new MC(e,t,n,r,i,o)}}var km,Jw,gl,Ah,Zw,ls,e0,t0,_h,Bs,Vs,ur,Im,Pm,Rr,Rm,vi,n0,Je,LC,KA,UL,jL,$L,OC,wd,Ei,tf,zL,XA,YA,HL,WL,GL,qL,QL;const wt=class wt extends Ut{constructor(t){super({...t,name:"highlightEditor"});T(this,Je);T(this,km,null);T(this,Jw,0);T(this,gl);T(this,Ah,null);T(this,Zw,null);T(this,ls,null);T(this,e0,null);T(this,t0,0);T(this,_h,null);T(this,Bs,null);T(this,Vs,null);T(this,ur,!1);T(this,Im,null);T(this,Pm,null);T(this,Rr,null);T(this,Rm,"");T(this,vi);T(this,n0,"");this.color=t.color||wt._defaultColor,x(this,vi,t.thickness||wt._defaultThickness),this.opacity=t.opacity||wt._defaultOpacity,x(this,gl,t.boxes||null),x(this,n0,t.methodOfCreation||""),x(this,Rm,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(x(this,ur,!0),I(this,Je,KA).call(this,t),I(this,Je,wd).call(this)):c(this,gl)&&(x(this,km,t.anchorNode),x(this,Jw,t.anchorOffset),x(this,e0,t.focusNode),x(this,t0,t.focusOffset),I(this,Je,LC).call(this),I(this,Je,wd).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=wt.prototype;return qe(this,"_keyboardManager",new k0([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:c(this,ur)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:c(this,vi),methodOfCreation:c(this,n0)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,n){var r;Ut.initialize(t,n),wt._defaultColor||(wt._defaultColor=((r=n.highlightColors)==null?void 0:r.values().next().value)||"#fff066")}static updateDefaultParams(t,n){switch(t){case lt.HIGHLIGHT_COLOR:wt._defaultColor=n;break;case lt.HIGHLIGHT_THICKNESS:wt._defaultThickness=n;break}}translateInPage(t,n){}get toolbarPosition(){return c(this,Pm)}get commentButtonPosition(){return c(this,Im)}updateParams(t,n){switch(t){case lt.HIGHLIGHT_COLOR:I(this,Je,UL).call(this,n);break;case lt.HIGHLIGHT_THICKNESS:I(this,Je,jL).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[lt.HIGHLIGHT_COLOR,wt._defaultColor],[lt.HIGHLIGHT_THICKNESS,wt._defaultThickness]]}get propertiesToUpdate(){return[[lt.HIGHLIGHT_COLOR,this.color||wt._defaultColor],[lt.HIGHLIGHT_THICKNESS,c(this,vi)||wt._defaultThickness],[lt.HIGHLIGHT_FREE,c(this,ur)]]}onUpdatedColor(){var t,n;(t=this.parent)==null||t.drawLayer.updateProperties(c(this,Vs),{root:{fill:this.color,"fill-opacity":this.opacity}}),(n=c(this,Zw))==null||n.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",x(this,Zw,new N_({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(I(this,Je,YA).call(this))}getBaseTranslation(){return[0,0]}getRect(t,n){return super.getRect(t,n,I(this,Je,YA).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){I(this,Je,OC).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(I(this,Je,wd).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var r;let n=!1;this.parent&&!t?I(this,Je,OC).call(this):t&&(I(this,Je,wd).call(this,t),n=!this.parent&&((r=this.div)==null?void 0:r.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),n&&this.select()}rotate(t){var i,o,u;const{drawLayer:n}=this.parent;let r;c(this,ur)?(t=(t-this.rotation+360)%360,r=I(i=wt,Ei,tf).call(i,c(this,Bs).box,t)):r=I(o=wt,Ei,tf).call(o,[this.x,this.y,this.width,this.height],t),n.updateProperties(c(this,Vs),{bbox:r,root:{"data-main-rotation":t}}),n.updateProperties(c(this,Rr),{bbox:I(u=wt,Ei,tf).call(u,c(this,ls).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();c(this,Rm)&&(t.setAttribute("aria-label",c(this,Rm)),t.setAttribute("role","mark")),c(this,ur)?t.classList.add("free"):this.div.addEventListener("keydown",I(this,Je,zL).bind(this),{signal:this._uiManager._signal});const n=x(this,_h,document.createElement("div"));return t.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=c(this,Ah),this.setDims(),tM(this,c(this,_h),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(c(this,Rr),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(c(this,Rr),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:I(this,Je,XA).call(this,!0);break;case 1:case 3:I(this,Je,XA).call(this,!1);break}}select(){var t;super.select(),c(this,Rr)&&((t=this.parent)==null||t.drawLayer.updateProperties(c(this,Rr),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),c(this,Rr)&&((t=this.parent)==null||t.drawLayer.updateProperties(c(this,Rr),{rootClass:{selected:!1}}),c(this,ur)||I(this,Je,XA).call(this,!1))}get _mustFixPosition(){return!c(this,ur)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(c(this,Vs),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(c(this,Rr),{rootClass:{hidden:!t}}))}static startHighlighting(t,n,{target:r,x:i,y:o}){const{x:u,y:d,width:h,height:f}=r.getBoundingClientRect(),g=new AbortController,w=t.combinedSignal(g),A=F=>{g.abort(),I(this,Ei,qL).call(this,t,F)};window.addEventListener("blur",A,{signal:w}),window.addEventListener("pointerup",A,{signal:w}),window.addEventListener("pointerdown",fn,{capture:!0,passive:!1,signal:w}),window.addEventListener("contextmenu",Fi,{signal:w}),r.addEventListener("pointermove",I(this,Ei,GL).bind(this,t),{signal:w}),this._freeHighlight=new MC({x:i,y:o},[u,d,h,f],t.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,n,r){var C,S,P,O;let i=null;if(t instanceof xL){const{data:{quadPoints:N,rect:V,rotation:z,id:H,color:R,opacity:D,popupRef:L,richText:U,contentsObj:j,creationDate:G,modificationDate:$},parent:{page:{pageNumber:ge}}}=t;i=t={annotationType:Xe.HIGHLIGHT,color:Array.from(R),opacity:D,quadPoints:N,boxes:null,pageIndex:ge-1,rect:V.slice(0),rotation:z,annotationElementId:H,id:H,deleted:!1,popupRef:L,richText:U,comment:(j==null?void 0:j.str)||null,creationDate:G,modificationDate:$}}else if(t instanceof FS){const{data:{inkLists:N,rect:V,rotation:z,id:H,color:R,borderStyle:{rawWidth:D},popupRef:L,richText:U,contentsObj:j,creationDate:G,modificationDate:$},parent:{page:{pageNumber:ge}}}=t;i=t={annotationType:Xe.HIGHLIGHT,color:Array.from(R),thickness:D,inkLists:N,boxes:null,pageIndex:ge-1,rect:V.slice(0),rotation:z,annotationElementId:H,id:H,deleted:!1,popupRef:L,richText:U,comment:(j==null?void 0:j.str)||null,creationDate:G,modificationDate:$}}const{color:o,quadPoints:u,inkLists:d,opacity:h}=t,f=await super.deserialize(t,n,r);f.color=_e.makeHexColor(...o),f.opacity=h||1,d&&x(f,vi,t.thickness),f._initialData=i,t.comment&&f.setCommentData(t);const[g,w]=f.pageDimensions,[A,F]=f.pageTranslation;if(u){const N=x(f,gl,[]);for(let V=0;V<u.length;V+=8)N.push({x:(u[V]-A)/g,y:1-(u[V+1]-F)/w,width:(u[V+2]-u[V])/g,height:(u[V+1]-u[V+5])/w});I(C=f,Je,LC).call(C),I(S=f,Je,wd).call(S),f.rotate(f.rotation)}else if(d){x(f,ur,!0);const N=d[0],V={x:N[0]-A,y:w-(N[1]-F)},z=new MC(V,[0,0,g,w],1,c(f,vi)/2,!0,.001);for(let D=0,L=N.length;D<L;D+=2)V.x=N[D]-A,V.y=w-(N[D+1]-F),z.add(V);const{id:H,clipPathId:R}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:z.toSVGPath()}},!0,!0);I(P=f,Je,KA).call(P,{highlightOutlines:z.getOutlines(),highlightId:H,clipPathId:R}),I(O=f,Je,wd).call(O),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const n=Ut._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),r=super.serialize(t);return Object.assign(r,{color:n,opacity:this.opacity,thickness:c(this,vi),quadPoints:I(this,Je,HL).call(this),outlines:I(this,Je,WL).call(this,r.rect)}),this.addComment(r),this.annotationElementId&&!I(this,Je,QL).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};km=new WeakMap,Jw=new WeakMap,gl=new WeakMap,Ah=new WeakMap,Zw=new WeakMap,ls=new WeakMap,e0=new WeakMap,t0=new WeakMap,_h=new WeakMap,Bs=new WeakMap,Vs=new WeakMap,ur=new WeakMap,Im=new WeakMap,Pm=new WeakMap,Rr=new WeakMap,Rm=new WeakMap,vi=new WeakMap,n0=new WeakMap,Je=new WeakSet,LC=function(){const t=new DC(c(this,gl),.001);x(this,Bs,t.getOutlines()),[this.x,this.y,this.width,this.height]=c(this,Bs).box;const n=new DC(c(this,gl),.0025,.001,this._uiManager.direction==="ltr");x(this,ls,n.getOutlines());const{firstPoint:r}=c(this,Bs);x(this,Im,[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]);const{lastPoint:i}=c(this,ls);x(this,Pm,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},KA=function({highlightOutlines:t,highlightId:n,clipPathId:r}){var w,A;if(x(this,Bs,t),x(this,ls,t.getNewOutline(c(this,vi)/2+1.5,.0025)),n>=0)x(this,Vs,n),x(this,Ah,r),this.parent.drawLayer.finalizeDraw(n,{bbox:t.box,path:{d:t.toSVGPath()}}),x(this,Rr,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:c(this,ls).box,path:{d:c(this,ls).toSVGPath()}},!0));else if(this.parent){const F=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(c(this,Vs),{bbox:I(w=wt,Ei,tf).call(w,c(this,Bs).box,(F-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(c(this,Rr),{bbox:I(A=wt,Ei,tf).call(A,c(this,ls).box,F),path:{d:c(this,ls).toSVGPath()}})}const[o,u,d,h]=t.box;switch(this.rotation){case 0:this.x=o,this.y=u,this.width=d,this.height=h;break;case 90:{const[F,C]=this.parentDimensions;this.x=u,this.y=1-o,this.width=d*C/F,this.height=h*F/C;break}case 180:this.x=1-o,this.y=1-u,this.width=d,this.height=h;break;case 270:{const[F,C]=this.parentDimensions;this.x=1-u,this.y=o,this.width=d*C/F,this.height=h*F/C;break}}const{firstPoint:f}=t;x(this,Im,[(f[0]-o)/d,(f[1]-u)/h]);const{lastPoint:g}=c(this,ls);x(this,Pm,[(g[0]-o)/d,(g[1]-u)/h])},UL=function(t){const n=(o,u)=>{this.color=o,this.opacity=u,this.onUpdatedColor()},r=this.color,i=this.opacity;this.addCommands({cmd:n.bind(this,t,wt._defaultOpacity),undo:n.bind(this,r,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:lt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},jL=function(t){const n=c(this,vi),r=i=>{x(this,vi,i),I(this,Je,$L).call(this,i)};this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:lt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},$L=function(t){c(this,ur)&&(I(this,Je,KA).call(this,{highlightOutlines:c(this,Bs).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())},OC=function(){c(this,Vs)===null||!this.parent||(this.parent.drawLayer.remove(c(this,Vs)),x(this,Vs,null),this.parent.drawLayer.remove(c(this,Rr)),x(this,Rr,null))},wd=function(t=this.parent){c(this,Vs)===null&&({id:Bn(this,Vs)._,clipPathId:Bn(this,Ah)._}=t.drawLayer.draw({bbox:c(this,Bs).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:c(this,ur)},path:{d:c(this,Bs).toSVGPath()}},!1,!0),x(this,Rr,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:c(this,ur)},bbox:c(this,ls).box,path:{d:c(this,ls).toSVGPath()}},c(this,ur))),c(this,_h)&&(c(this,_h).style.clipPath=c(this,Ah)))},Ei=new WeakSet,tf=function([t,n,r,i],o){switch(o){case 90:return[1-n-i,t,i,r];case 180:return[1-t-r,1-n-i,r,i];case 270:return[n,1-t-r,i,r]}return[t,n,r,i]},zL=function(t){wt._keyboardManager.exec(this,t)},XA=function(t){if(!c(this,km))return;const n=window.getSelection();t?n.setPosition(c(this,km),c(this,Jw)):n.setPosition(c(this,e0),c(this,t0))},YA=function(){return c(this,ur)?this.rotation:0},HL=function(){if(c(this,ur))return null;const[t,n]=this.pageDimensions,[r,i]=this.pageTranslation,o=c(this,gl),u=new Float32Array(o.length*8);let d=0;for(const{x:h,y:f,width:g,height:w}of o){const A=h*t+r,F=(1-f)*n+i;u[d]=u[d+4]=A,u[d+1]=u[d+3]=F,u[d+2]=u[d+6]=A+g*t,u[d+5]=u[d+7]=F-w*n,d+=8}return u},WL=function(t){return c(this,Bs).serialize(t,I(this,Je,YA).call(this))},GL=function(t,n){this._freeHighlight.add(n)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},qL=function(t,n){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},QL=function(t){const{color:n}=this._initialData;return this.hasEditedComment||t.color.some((r,i)=>r!==n[i])},T(wt,Ei),re(wt,"_defaultColor",null),re(wt,"_defaultOpacity",1),re(wt,"_defaultThickness",12),re(wt,"_type","highlight"),re(wt,"_editorType",Xe.HIGHLIGHT),re(wt,"_freeHighlightId",-1),re(wt,"_freeHighlight",null),re(wt,"_freeHighlightClipId","");let B_=wt;var xh;class KL{constructor(){T(this,xh,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){c(this,xh)[e]=t}toSVGProperties(){const e=c(this,xh);return x(this,xh,Object.create(null)),{root:e}}reset(){x(this,xh,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){At("Not implemented")}}xh=new WeakMap;var Us,Dm,Xn,Eh,bh,pt,BC,VC,UC,Og,XL,JA,Bg,nf;const rt=class rt extends Ut{constructor(t){super(t);T(this,pt);T(this,Us,null);T(this,Dm);re(this,"_colorPicker",null);re(this,"_drawId",null);x(this,Dm,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(I(this,pt,BC).call(this,t),I(this,pt,Og).call(this))}static _mergeSVGProperties(t,n){const r=new Set(Object.keys(t));for(const[i,o]of Object.entries(n))r.has(i)?Object.assign(t[i],o):t[i]=o;return t}static getDefaultDrawingOptions(t){At("Not implemented")}static get typesMap(){At("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,n){const r=this.typesMap.get(t);r&&this._defaultDrawingOptions.updateProperty(r,n),this._currentParent&&(c(rt,Xn).updateProperty(r,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,n){const r=this.constructor.typesMap.get(t);r&&this._updateProperty(t,r,n)}static get defaultPropertiesToUpdate(){const t=[],n=this._defaultDrawingOptions;for(const[r,i]of this.typesMap)t.push([r,n[i]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:n}=this;for(const[r,i]of this.constructor.typesMap)t.push([r,n[i]]);return t}_updateProperty(t,n,r){const i=this._drawingOptions,o=i[n],u=d=>{var f;i.updateProperty(n,d);const h=c(this,Us).updateProperty(n,d);h&&I(this,pt,Bg).call(this,h),(f=this.parent)==null||f.drawLayer.updateProperties(this._drawId,i.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:u.bind(this,r),undo:u.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,rt._mergeSVGProperties(c(this,Us).getPathResizingSVGProperties(I(this,pt,JA).call(this)),{bbox:I(this,pt,nf).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,rt._mergeSVGProperties(c(this,Us).getPathResizedSVGProperties(I(this,pt,JA).call(this)),{bbox:I(this,pt,nf).call(this)}))}_onTranslating(t,n){var r;(r=this.parent)==null||r.drawLayer.updateProperties(this._drawId,{bbox:I(this,pt,nf).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,rt._mergeSVGProperties(c(this,Us).getPathTranslatedSVGProperties(I(this,pt,JA).call(this),this.parentDimensions),{bbox:I(this,pt,nf).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,c(this,Dm)&&(x(this,Dm,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){I(this,pt,UC).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(I(this,pt,Og).call(this),I(this,pt,Bg).call(this,c(this,Us).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var r;let n=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),I(this,pt,UC).call(this)):t&&(this._uiManager.addShouldRescale(this),I(this,pt,Og).call(this,t),n=!this.parent&&((r=this.div)==null?void 0:r.classList.contains("selectedEditor"))),super.setParent(t),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,rt._mergeSVGProperties({bbox:I(this,pt,nf).call(this)},c(this,Us).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&I(this,pt,Bg).call(this,c(this,Us).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,n;this._isCopy&&(t=this.x,n=this.y);const r=super.render();r.classList.add("draw");const i=document.createElement("div");return r.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,n),r}static createDrawerInstance(t,n,r,i,o){At("Not implemented")}static startDrawing(t,n,r,i){var S;const{target:o,offsetX:u,offsetY:d,pointerId:h,pointerType:f}=i;if(Sr.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:g}}=t,{width:w,height:A}=o.getBoundingClientRect(),F=x(rt,Eh,new AbortController),C=t.combinedSignal(F);if(Sr.setPointer(f,h),window.addEventListener("pointerup",P=>{Sr.isSamePointerIdOrRemove(P.pointerId)&&this._endDraw(P)},{signal:C}),window.addEventListener("pointercancel",P=>{Sr.isSamePointerIdOrRemove(P.pointerId)&&this._currentParent.endDrawingSession()},{signal:C}),window.addEventListener("pointerdown",P=>{Sr.isSamePointerType(P.pointerType)&&(Sr.initializeAndAddPointerId(P.pointerId),c(rt,Xn).isCancellable()&&(c(rt,Xn).removeLastElement(),c(rt,Xn).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:C}),window.addEventListener("contextmenu",Fi,{signal:C}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:C}),o.addEventListener("touchmove",P=>{Sr.isSameTimeStamp(P.timeStamp)&&fn(P)},{signal:C}),t.toggleDrawing(),(S=n._editorUndoBar)==null||S.hide(),c(rt,Xn)){t.drawLayer.updateProperties(this._currentDrawId,c(rt,Xn).startNew(u,d,w,A,g));return}n.updateUIForDefaultProperties(this),x(rt,Xn,this.createDrawerInstance(u,d,w,A,g)),x(rt,bh,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(c(rt,bh).toSVGProperties(),c(rt,Xn).defaultSVGProperties),!0,!1)}static _drawMove(t){if(Sr.isSameTimeStamp(t.timeStamp),!c(rt,Xn))return;const{offsetX:n,offsetY:r,pointerId:i}=t;if(Sr.isSamePointerId(i)){if(Sr.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,c(rt,Xn).add(n,r)),Sr.setTimeStamp(t.timeStamp),fn(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,x(rt,Xn,null),x(rt,bh,null),Sr.clearTimeStamp()),c(rt,Eh)&&(c(rt,Eh).abort(),x(rt,Eh,null),Sr.clearPointerIds())}static _endDraw(t){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===n.div&&n.drawLayer.updateProperties(this._currentDrawId,c(rt,Xn).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const r=c(rt,Xn),i=this._currentDrawId,o=r.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(i,r.setLastElement(o))},undo:()=>{n.drawLayer.updateProperties(i,r.removeLastElement())},mustExec:!1,type:lt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(lt.DRAW_STEP),!c(rt,Xn).isEmpty()){const{pageDimensions:[r,i],scale:o}=n,u=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:c(rt,Xn).getOutlines(r*o,i*o,o,this._INNER_MARGIN),drawingOptions:c(rt,bh),mustBeCommitted:!t});return this._cleanup(!0),u}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,n,r,i,o,u){At("Not implemented")}static async deserialize(t,n,r){var g,w;const{rawDims:{pageWidth:i,pageHeight:o,pageX:u,pageY:d}}=n.viewport,h=this.deserializeDraw(u,d,i,o,this._INNER_MARGIN,t),f=await super.deserialize(t,n,r);return f.createDrawingOptions(t),I(g=f,pt,BC).call(g,{drawOutlines:h}),I(w=f,pt,Og).call(w),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[n,r]=this.pageTranslation,[i,o]=this.pageDimensions;return c(this,Us).serialize([n,r,i,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};Us=new WeakMap,Dm=new WeakMap,Xn=new WeakMap,Eh=new WeakMap,bh=new WeakMap,pt=new WeakSet,BC=function({drawOutlines:t,drawId:n,drawingOptions:r}){x(this,Us,t),this._drawingOptions||(this._drawingOptions=r),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,t.defaultProperties)):this._drawId=I(this,pt,VC).call(this,t,this.parent),I(this,pt,Bg).call(this,t.box)},VC=function(t,n){const{id:r}=n.drawLayer.draw(rt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return r},UC=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Og=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=I(this,pt,VC).call(this,c(this,Us),t)}},XL=function([t,n,r,i]){const{parentDimensions:[o,u],rotation:d}=this;switch(d){case 90:return[n,1-t,r*(u/o),i*(o/u)];case 180:return[1-t,1-n,r,i];case 270:return[1-n,t,r*(u/o),i*(o/u)];default:return[t,n,r,i]}},JA=function(){const{x:t,y:n,width:r,height:i,parentDimensions:[o,u],rotation:d}=this;switch(d){case 90:return[1-n,t,r*(o/u),i*(u/o)];case 180:return[1-t,1-n,r,i];case 270:return[n,1-t,r*(o/u),i*(u/o)];default:return[t,n,r,i]}},Bg=function(t){[this.x,this.y,this.width,this.height]=I(this,pt,XL).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},nf=function(){const{x:t,y:n,width:r,height:i,rotation:o,parentRotation:u,parentDimensions:[d,h]}=this;switch((o*4+u)/90){case 1:return[1-n-i,t,i,r];case 2:return[1-t-r,1-n-i,r,i];case 3:return[n,1-t-r,i,r];case 4:return[t,n-r*(d/h),i*(h/d),r*(d/h)];case 5:return[1-n,t,r*(d/h),i*(h/d)];case 6:return[1-t-i*(h/d),1-n,i*(h/d),r*(d/h)];case 7:return[n-r*(d/h),1-t-i*(h/d),r*(d/h),i*(h/d)];case 8:return[t-r,n-i,r,i];case 9:return[1-n,t-r,i,r];case 10:return[1-t,1-n,r,i];case 11:return[n-i,1-t,i,r];case 12:return[t-i*(h/d),n,i*(h/d),r*(d/h)];case 13:return[1-n-r*(d/h),t-i*(h/d),r*(d/h),i*(h/d)];case 14:return[1-t,1-n-r*(d/h),i*(h/d),r*(d/h)];case 15:return[n,1-t,r*(d/h),i*(h/d)];default:return[t,n,r,i]}},re(rt,"_currentDrawId",-1),re(rt,"_currentParent",null),T(rt,Xn,null),T(rt,Eh,null),T(rt,bh,null),re(rt,"_INNER_MARGIN",3);let V_=rt;var qa,Yn,Jn,Ch,Nm,jr,dr,Ai,Fh,Sh,Th,Mm,ZA;class nq{constructor(e,t,n,r,i,o){T(this,Mm);T(this,qa,new Float64Array(6));T(this,Yn);T(this,Jn);T(this,Ch);T(this,Nm);T(this,jr);T(this,dr,"");T(this,Ai,0);T(this,Fh,new I0);T(this,Sh);T(this,Th);x(this,Sh,n),x(this,Th,r),x(this,Ch,i),x(this,Nm,o),[e,t]=I(this,Mm,ZA).call(this,e,t);const u=x(this,Yn,[NaN,NaN,NaN,NaN,e,t]);x(this,jr,[e,t]),x(this,Jn,[{line:u,points:c(this,jr)}]),c(this,qa).set(u,0)}updateProperty(e,t){e==="stroke-width"&&x(this,Nm,t)}isEmpty(){return!c(this,Jn)||c(this,Jn).length===0}isCancellable(){return c(this,jr).length<=10}add(e,t){[e,t]=I(this,Mm,ZA).call(this,e,t);const[n,r,i,o]=c(this,qa).subarray(2,6),u=e-i,d=t-o;return Math.hypot(c(this,Sh)*u,c(this,Th)*d)<=2?null:(c(this,jr).push(e,t),isNaN(n)?(c(this,qa).set([i,o,e,t],2),c(this,Yn).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(c(this,qa)[0])&&c(this,Yn).splice(6,6),c(this,qa).set([n,r,i,o,e,t],0),c(this,Yn).push(...Fe.createBezierPoints(n,r,i,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(c(this,jr).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,r,i){x(this,Sh,n),x(this,Th,r),x(this,Ch,i),[e,t]=I(this,Mm,ZA).call(this,e,t);const o=x(this,Yn,[NaN,NaN,NaN,NaN,e,t]);x(this,jr,[e,t]);const u=c(this,Jn).at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),c(this,Jn).push({line:o,points:c(this,jr)}),c(this,qa).set(o,0),x(this,Ai,0),this.toSVGPath(),null}getLastElement(){return c(this,Jn).at(-1)}setLastElement(e){return c(this,Jn)?(c(this,Jn).push(e),x(this,Yn,e.line),x(this,jr,e.points),x(this,Ai,0),{path:{d:this.toSVGPath()}}):c(this,Fh).setLastElement(e)}removeLastElement(){if(!c(this,Jn))return c(this,Fh).removeLastElement();c(this,Jn).pop(),x(this,dr,"");for(let e=0,t=c(this,Jn).length;e<t;e++){const{line:n,points:r}=c(this,Jn)[e];x(this,Yn,n),x(this,jr,r),x(this,Ai,0),this.toSVGPath()}return{path:{d:c(this,dr)}}}toSVGPath(){const e=Fe.svgRound(c(this,Yn)[4]),t=Fe.svgRound(c(this,Yn)[5]);if(c(this,jr).length===2)return x(this,dr,`${c(this,dr)} M ${e} ${t} Z`),c(this,dr);if(c(this,jr).length<=6){const r=c(this,dr).lastIndexOf("M");x(this,dr,`${c(this,dr).slice(0,r)} M ${e} ${t}`),x(this,Ai,6)}if(c(this,jr).length===4){const r=Fe.svgRound(c(this,Yn)[10]),i=Fe.svgRound(c(this,Yn)[11]);return x(this,dr,`${c(this,dr)} L ${r} ${i}`),x(this,Ai,12),c(this,dr)}const n=[];c(this,Ai)===0&&(n.push(`M ${e} ${t}`),x(this,Ai,6));for(let r=c(this,Ai),i=c(this,Yn).length;r<i;r+=6){const[o,u,d,h,f,g]=c(this,Yn).slice(r,r+6).map(Fe.svgRound);n.push(`C${o} ${u} ${d} ${h} ${f} ${g}`)}return x(this,dr,c(this,dr)+n.join(" ")),x(this,Ai,c(this,Yn).length),c(this,dr)}getOutlines(e,t,n,r){const i=c(this,Jn).at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),c(this,Fh).build(c(this,Jn),e,t,n,c(this,Ch),c(this,Nm),r),x(this,qa,null),x(this,Yn,null),x(this,Jn,null),x(this,dr,null),c(this,Fh)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}qa=new WeakMap,Yn=new WeakMap,Jn=new WeakMap,Ch=new WeakMap,Nm=new WeakMap,jr=new WeakMap,dr=new WeakMap,Ai=new WeakMap,Fh=new WeakMap,Sh=new WeakMap,Th=new WeakMap,Mm=new WeakSet,ZA=function(e,t){return Fe._normalizePoint(e,t,c(this,Sh),c(this,Th),c(this,Ch))};var $r,r0,s0,js,Qa,Ka,Lm,Om,kh,mr,Oo,YL,JL,ZL;class I0 extends Fe{constructor(){super(...arguments);T(this,mr);T(this,$r);T(this,r0,0);T(this,s0);T(this,js);T(this,Qa);T(this,Ka);T(this,Lm);T(this,Om);T(this,kh)}build(t,n,r,i,o,u,d){x(this,Qa,n),x(this,Ka,r),x(this,Lm,i),x(this,Om,o),x(this,kh,u),x(this,s0,d??0),x(this,js,t),I(this,mr,JL).call(this)}get thickness(){return c(this,kh)}setLastElement(t){return c(this,js).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return c(this,js).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:n}of c(this,js)){if(t.push(`M${Fe.svgRound(n[4])} ${Fe.svgRound(n[5])}`),n.length===6){t.push("Z");continue}if(n.length===12&&isNaN(n[6])){t.push(`L${Fe.svgRound(n[10])} ${Fe.svgRound(n[11])}`);continue}for(let r=6,i=n.length;r<i;r+=6){const[o,u,d,h,f,g]=n.subarray(r,r+6).map(Fe.svgRound);t.push(`C${o} ${u} ${d} ${h} ${f} ${g}`)}}return t.join("")}serialize([t,n,r,i],o){const u=[],d=[],[h,f,g,w]=I(this,mr,YL).call(this);let A,F,C,S,P,O,N,V,z;switch(c(this,Om)){case 0:z=Fe._rescale,A=t,F=n+i,C=r,S=-i,P=t+h*r,O=n+(1-f-w)*i,N=t+(h+g)*r,V=n+(1-f)*i;break;case 90:z=Fe._rescaleAndSwap,A=t,F=n,C=r,S=i,P=t+f*r,O=n+h*i,N=t+(f+w)*r,V=n+(h+g)*i;break;case 180:z=Fe._rescale,A=t+r,F=n,C=-r,S=i,P=t+(1-h-g)*r,O=n+f*i,N=t+(1-h)*r,V=n+(f+w)*i;break;case 270:z=Fe._rescaleAndSwap,A=t+r,F=n+i,C=-r,S=-i,P=t+(1-f-w)*r,O=n+(1-h-g)*i,N=t+(1-f)*r,V=n+(1-h)*i;break}for(const{line:H,points:R}of c(this,js))u.push(z(H,A,F,C,S,o?new Array(H.length):null)),d.push(z(R,A,F,C,S,o?new Array(R.length):null));return{lines:u,points:d,rect:[P,O,N,V]}}static deserialize(t,n,r,i,o,{paths:{lines:u,points:d},rotation:h,thickness:f}){const g=[];let w,A,F,C,S;switch(h){case 0:S=Fe._rescale,w=-t/r,A=n/i+1,F=1/r,C=-1/i;break;case 90:S=Fe._rescaleAndSwap,w=-n/i,A=-t/r,F=1/i,C=1/r;break;case 180:S=Fe._rescale,w=t/r+1,A=-n/i,F=-1/r,C=1/i;break;case 270:S=Fe._rescaleAndSwap,w=n/i+1,A=t/r+1,F=-1/i,C=-1/r;break}if(!u){u=[];for(const O of d){const N=O.length;if(N===2){u.push(new Float32Array([NaN,NaN,NaN,NaN,O[0],O[1]]));continue}if(N===4){u.push(new Float32Array([NaN,NaN,NaN,NaN,O[0],O[1],NaN,NaN,NaN,NaN,O[2],O[3]]));continue}const V=new Float32Array(3*(N-2));u.push(V);let[z,H,R,D]=O.subarray(0,4);V.set([NaN,NaN,NaN,NaN,z,H],0);for(let L=4;L<N;L+=2){const U=O[L],j=O[L+1];V.set(Fe.createBezierPoints(z,H,R,D,U,j),(L-2)*3),[z,H,R,D]=[R,D,U,j]}}}for(let O=0,N=u.length;O<N;O++)g.push({line:S(u[O].map(V=>V??NaN),w,A,F,C),points:S(d[O].map(V=>V??NaN),w,A,F,C)});const P=new this.prototype.constructor;return P.build(g,r,i,1,h,f,o),P}get box(){return c(this,$r)}updateProperty(t,n){return t==="stroke-width"?I(this,mr,ZL).call(this,n):null}updateParentDimensions([t,n],r){const[i,o]=I(this,mr,Oo).call(this);x(this,Qa,t),x(this,Ka,n),x(this,Lm,r);const[u,d]=I(this,mr,Oo).call(this),h=u-i,f=d-o,g=c(this,$r);return g[0]-=h,g[1]-=f,g[2]+=2*h,g[3]+=2*f,g}updateRotation(t){return x(this,r0,t),{path:{transform:this.rotationTransform}}}get viewBox(){return c(this,$r).map(Fe.svgRound).join(" ")}get defaultProperties(){const[t,n]=c(this,$r);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Fe.svgRound(t)} ${Fe.svgRound(n)}`}}}get rotationTransform(){const[,,t,n]=c(this,$r);let r=0,i=0,o=0,u=0,d=0,h=0;switch(c(this,r0)){case 90:i=n/t,o=-t/n,d=t;break;case 180:r=-1,u=-1,d=t,h=n;break;case 270:i=-n/t,o=t/n,h=n;break;default:return""}return`matrix(${r} ${i} ${o} ${u} ${Fe.svgRound(d)} ${Fe.svgRound(h)})`}getPathResizingSVGProperties([t,n,r,i]){const[o,u]=I(this,mr,Oo).call(this),[d,h,f,g]=c(this,$r);if(Math.abs(f-o)<=Fe.PRECISION||Math.abs(g-u)<=Fe.PRECISION){const S=t+r/2-(d+f/2),P=n+i/2-(h+g/2);return{path:{"transform-origin":`${Fe.svgRound(t)} ${Fe.svgRound(n)}`,transform:`${this.rotationTransform} translate(${S} ${P})`}}}const w=(r-2*o)/(f-2*o),A=(i-2*u)/(g-2*u),F=f/r,C=g/i;return{path:{"transform-origin":`${Fe.svgRound(d)} ${Fe.svgRound(h)}`,transform:`${this.rotationTransform} scale(${F} ${C}) translate(${Fe.svgRound(o)} ${Fe.svgRound(u)}) scale(${w} ${A}) translate(${Fe.svgRound(-o)} ${Fe.svgRound(-u)})`}}}getPathResizedSVGProperties([t,n,r,i]){const[o,u]=I(this,mr,Oo).call(this),d=c(this,$r),[h,f,g,w]=d;if(d[0]=t,d[1]=n,d[2]=r,d[3]=i,Math.abs(g-o)<=Fe.PRECISION||Math.abs(w-u)<=Fe.PRECISION){const P=t+r/2-(h+g/2),O=n+i/2-(f+w/2);for(const{line:N,points:V}of c(this,js))Fe._translate(N,P,O,N),Fe._translate(V,P,O,V);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Fe.svgRound(t)} ${Fe.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const A=(r-2*o)/(g-2*o),F=(i-2*u)/(w-2*u),C=-A*(h+o)+t+o,S=-F*(f+u)+n+u;if(A!==1||F!==1||C!==0||S!==0)for(const{line:P,points:O}of c(this,js))Fe._rescale(P,C,S,A,F,P),Fe._rescale(O,C,S,A,F,O);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Fe.svgRound(t)} ${Fe.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,n],r){const[i,o]=r,u=c(this,$r),d=t-u[0],h=n-u[1];if(c(this,Qa)===i&&c(this,Ka)===o)for(const{line:f,points:g}of c(this,js))Fe._translate(f,d,h,f),Fe._translate(g,d,h,g);else{const f=c(this,Qa)/i,g=c(this,Ka)/o;x(this,Qa,i),x(this,Ka,o);for(const{line:w,points:A}of c(this,js))Fe._rescale(w,d,h,f,g,w),Fe._rescale(A,d,h,f,g,A);u[2]*=f,u[3]*=g}return u[0]=t,u[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Fe.svgRound(t)} ${Fe.svgRound(n)}`}}}get defaultSVGProperties(){const t=c(this,$r);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Fe.svgRound(t[0])} ${Fe.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}$r=new WeakMap,r0=new WeakMap,s0=new WeakMap,js=new WeakMap,Qa=new WeakMap,Ka=new WeakMap,Lm=new WeakMap,Om=new WeakMap,kh=new WeakMap,mr=new WeakSet,Oo=function(t=c(this,kh)){const n=c(this,s0)+t/2*c(this,Lm);return c(this,Om)%180===0?[n/c(this,Qa),n/c(this,Ka)]:[n/c(this,Ka),n/c(this,Qa)]},YL=function(){const[t,n,r,i]=c(this,$r),[o,u]=I(this,mr,Oo).call(this,0);return[t+o,n+u,r-2*o,i-2*u]},JL=function(){const t=x(this,$r,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:i}of c(this,js)){if(i.length<=12){for(let d=4,h=i.length;d<h;d+=6)_e.pointBoundingBox(i[d],i[d+1],t);continue}let o=i[4],u=i[5];for(let d=6,h=i.length;d<h;d+=6){const[f,g,w,A,F,C]=i.subarray(d,d+6);_e.bezierBoundingBox(o,u,f,g,w,A,F,C,t),o=F,u=C}}const[n,r]=I(this,mr,Oo).call(this);t[0]=hr(t[0]-n,0,1),t[1]=hr(t[1]-r,0,1),t[2]=hr(t[2]+n,0,1),t[3]=hr(t[3]+r,0,1),t[2]-=t[0],t[3]-=t[1]},ZL=function(t){const[n,r]=I(this,mr,Oo).call(this);x(this,kh,t);const[i,o]=I(this,mr,Oo).call(this),[u,d]=[i-n,o-r],h=c(this,$r);return h[0]-=u,h[1]-=d,h[2]+=2*u,h[3]+=2*d,h};class Gx extends KL{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Ut._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Gx(this._viewParameters);return e.updateAll(this),e}}var rx,eO;const uf=class uf extends V_{constructor(t){super({...t,name:"inkEditor"});T(this,rx);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,n){Ut.initialize(t,n),this._defaultDrawingOptions=new Gx(n.viewParameters)}static getDefaultDrawingOptions(t){const n=this._defaultDrawingOptions.clone();return n.updateProperties(t),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return qe(this,"typesMap",new Map([[lt.INK_THICKNESS,"stroke-width"],[lt.INK_COLOR,"stroke"],[lt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,n,r,i,o){return new nq(t,n,r,i,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,n,r,i,o,u){return I0.deserialize(t,n,r,i,o,u)}static async deserialize(t,n,r){let i=null;if(t instanceof FS){const{data:{inkLists:u,rect:d,rotation:h,id:f,color:g,opacity:w,borderStyle:{rawWidth:A},popupRef:F,richText:C,contentsObj:S,creationDate:P,modificationDate:O},parent:{page:{pageNumber:N}}}=t;i=t={annotationType:Xe.INK,color:Array.from(g),thickness:A,opacity:w,paths:{points:u},boxes:null,pageIndex:N-1,rect:d.slice(0),rotation:h,annotationElementId:f,id:f,deleted:!1,popupRef:F,richText:C,comment:(S==null?void 0:S.str)||null,creationDate:P,modificationDate:O}}const o=await super.deserialize(t,n,r);return o._initialData=i,t.comment&&o.setCommentData(t),o}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new M_(this)),[["colorPicker",this._colorPicker]]}get colorType(){return lt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:n,parent:r}=this;n.updateSVGProperty("stroke-width"),r.drawLayer.updateProperties(t,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:n,opacity:r}){this._drawingOptions=uf.getDefaultDrawingOptions({stroke:_e.makeHexColor(...t),"stroke-width":n,"stroke-opacity":r})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:r}=this.serializeDraw(t),{_drawingOptions:{stroke:i,"stroke-opacity":o,"stroke-width":u}}=this,d=Object.assign(super.serialize(t),{color:Ut._colorManager.convert(i),opacity:o,thickness:u,paths:{lines:n,points:r}});return this.addComment(d),t?(d.isCopy=!0,d):this.annotationElementId&&!I(this,rx,eO).call(this,d)?null:(d.id=this.annotationElementId,d)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:n,rect:r}=this.serializeDraw(!1);return t.updateEdited({rect:r,thickness:this._drawingOptions["stroke-width"],points:n,popup:this.comment}),null}};rx=new WeakSet,eO=function(t){const{color:n,thickness:r,opacity:i,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((u,d)=>u!==n[d])||t.thickness!==r||t.opacity!==i||t.pageIndex!==o},re(uf,"_type","ink"),re(uf,"_editorType",Xe.INK),re(uf,"_defaultDrawingOptions",null);let jC=uf;class $C extends I0{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const dA=8,hg=3;var Ih,xt,zC,Qi,tO,nO,HC,e_,rO,sO,iO,WC,GC,aO;class xl{static extractContoursFromText(e,{fontFamily:t,fontStyle:n,fontWeight:r},i,o,u,d){let h=new OffscreenCanvas(1,1),f=h.getContext("2d",{alpha:!1});const g=200,w=f.font=`${n} ${r} ${g}px ${t}`,{actualBoundingBoxLeft:A,actualBoundingBoxRight:F,actualBoundingBoxAscent:C,actualBoundingBoxDescent:S,fontBoundingBoxAscent:P,fontBoundingBoxDescent:O,width:N}=f.measureText(e),V=1.5,z=Math.ceil(Math.max(Math.abs(A)+Math.abs(F)||0,N)*V),H=Math.ceil(Math.max(Math.abs(C)+Math.abs(S)||g,Math.abs(P)+Math.abs(O)||g)*V);h=new OffscreenCanvas(z,H),f=h.getContext("2d",{alpha:!0,willReadFrequently:!0}),f.font=w,f.filter="grayscale(1)",f.fillStyle="white",f.fillRect(0,0,z,H),f.fillStyle="black",f.fillText(e,z*(V-1)/2,H*(3-V)/2);const R=I(this,xt,WC).call(this,f.getImageData(0,0,z,H).data),D=I(this,xt,iO).call(this,R),L=I(this,xt,GC).call(this,D),U=I(this,xt,HC).call(this,R,z,H,L);return this.processDrawnLines({lines:{curves:U,width:z,height:H},pageWidth:i,pageHeight:o,rotation:u,innerMargin:d,mustSmooth:!0,areContours:!0})}static process(e,t,n,r,i){const[o,u,d]=I(this,xt,aO).call(this,e),[h,f]=I(this,xt,sO).call(this,o,u,d,Math.hypot(u,d)*c(this,Ih).sigmaSFactor,c(this,Ih).sigmaR,c(this,Ih).kernelSize),g=I(this,xt,GC).call(this,f),w=I(this,xt,HC).call(this,h,u,d,g);return this.processDrawnLines({lines:{curves:w,width:u,height:d},pageWidth:t,pageHeight:n,rotation:r,innerMargin:i,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:r,innerMargin:i,mustSmooth:o,areContours:u}){r%180!==0&&([t,n]=[n,t]);const{curves:d,width:h,height:f}=e,g=e.thickness??0,w=[],A=Math.min(t/h,n/f),F=A/t,C=A/n,S=[];for(const{points:O}of d){const N=o?I(this,xt,rO).call(this,O):O;if(!N)continue;S.push(N);const V=N.length,z=new Float32Array(V),H=new Float32Array(3*(V===2?2:V-2));if(w.push({line:H,points:z}),V===2){z[0]=N[0]*F,z[1]=N[1]*C,H.set([NaN,NaN,NaN,NaN,z[0],z[1]],0);continue}let[R,D,L,U]=N;R*=F,D*=C,L*=F,U*=C,z.set([R,D,L,U],0),H.set([NaN,NaN,NaN,NaN,R,D],0);for(let j=4;j<V;j+=2){const G=z[j]=N[j]*F,$=z[j+1]=N[j+1]*C;H.set(Fe.createBezierPoints(R,D,L,U,G,$),(j-2)*3),[R,D,L,U]=[L,U,G,$]}}if(w.length===0)return null;const P=u?new $C:new I0;return P.build(w,t,n,1,r,u?0:g,i),{outline:P,newCurves:S,areContours:u,thickness:g,width:h,height:f}}static async compressSignature({outlines:e,areContours:t,thickness:n,width:r,height:i}){let o=1/0,u=-1/0,d=0;for(const N of e){d+=N.length;for(let V=2,z=N.length;V<z;V++){const H=N[V]-N[V-2];o=Math.min(o,H),u=Math.max(u,H)}}let h;o>=-128&&u<=127?h=Int8Array:o>=-32768&&u<=32767?h=Int16Array:h=Int32Array;const f=e.length,g=dA+hg*f,w=new Uint32Array(g);let A=0;w[A++]=g*Uint32Array.BYTES_PER_ELEMENT+(d-2*f)*h.BYTES_PER_ELEMENT,w[A++]=0,w[A++]=r,w[A++]=i,w[A++]=t?0:1,w[A++]=Math.max(0,Math.floor(n??0)),w[A++]=f,w[A++]=h.BYTES_PER_ELEMENT;for(const N of e)w[A++]=N.length-2,w[A++]=N[0],w[A++]=N[1];const F=new CompressionStream("deflate-raw"),C=F.writable.getWriter();await C.ready,C.write(w);const S=h.prototype.constructor;for(const N of e){const V=new S(N.length-2);for(let z=2,H=N.length;z<H;z++)V[z-2]=N[z]-N[z-2];C.write(V)}C.close();const P=await new Response(F.readable).arrayBuffer();return new Uint8Array(P).toBase64()}static async decompressSignature(e){try{const t=Uint8Array.fromBase64(e),{readable:n,writable:r}=new DecompressionStream("deflate-raw"),i=r.getWriter();await i.ready,i.write(t).then(async()=>{await i.ready,await i.close()}).catch(()=>{});let o=null,u=0;for await(const N of n)o||(o=new Uint8Array(new Uint32Array(N.buffer,0,4)[0])),o.set(N,u),u+=N.length;const d=new Uint32Array(o.buffer,0,o.length>>2),h=d[1];if(h!==0)throw new Error(`Invalid version: ${h}`);const f=d[2],g=d[3],w=d[4]===0,A=d[5],F=d[6],C=d[7],S=[],P=(dA+hg*F)*Uint32Array.BYTES_PER_ELEMENT;let O;switch(C){case Int8Array.BYTES_PER_ELEMENT:O=new Int8Array(o.buffer,P);break;case Int16Array.BYTES_PER_ELEMENT:O=new Int16Array(o.buffer,P);break;case Int32Array.BYTES_PER_ELEMENT:O=new Int32Array(o.buffer,P);break}u=0;for(let N=0;N<F;N++){const V=d[hg*N+dA],z=new Float32Array(V+2);S.push(z);for(let H=0;H<hg-1;H++)z[H]=d[hg*N+dA+H+1];for(let H=0;H<V;H++)z[H+2]=z[H]+O[u++]}return{areContours:w,thickness:A,outlines:S,width:f,height:g}}catch(t){return Ge(`decompressSignature: ${t}`),null}}}Ih=new WeakMap,xt=new WeakSet,zC=function(e,t,n,r){return n-=e,r-=t,n===0?r>0?0:4:n===1?r+6:2-r},Qi=new WeakMap,tO=function(e,t,n,r,i,o,u){const d=I(this,xt,zC).call(this,n,r,i,o);for(let h=0;h<8;h++){const f=(-h+d-u+16)%8,g=c(this,Qi)[2*f],w=c(this,Qi)[2*f+1];if(e[(n+g)*t+(r+w)]!==0)return f}return-1},nO=function(e,t,n,r,i,o,u){const d=I(this,xt,zC).call(this,n,r,i,o);for(let h=0;h<8;h++){const f=(h+d+u+16)%8,g=c(this,Qi)[2*f],w=c(this,Qi)[2*f+1];if(e[(n+g)*t+(r+w)]!==0)return f}return-1},HC=function(e,t,n,r){const i=e.length,o=new Int32Array(i);for(let f=0;f<i;f++)o[f]=e[f]<=r?1:0;for(let f=1;f<n-1;f++)o[f*t]=o[f*t+t-1]=0;for(let f=0;f<t;f++)o[f]=o[t*n-1-f]=0;let u=1,d;const h=[];for(let f=1;f<n-1;f++){d=1;for(let g=1;g<t-1;g++){const w=f*t+g,A=o[w];if(A===0)continue;let F=f,C=g;if(A===1&&o[w-1]===0)u+=1,C-=1;else if(A>=1&&o[w+1]===0)u+=1,C+=1,A>1&&(d=A);else{A!==1&&(d=Math.abs(A));continue}const S=[g,f],P=C===g+1,O={isHole:P,points:S,id:u,parent:0};h.push(O);let N;for(const j of h)if(j.id===d){N=j;break}N?N.isHole?O.parent=P?N.parent:d:O.parent=P?d:N.parent:O.parent=P?d:0;const V=I(this,xt,tO).call(this,o,t,f,g,F,C,0);if(V===-1){o[w]=-u,o[w]!==1&&(d=Math.abs(o[w]));continue}let z=c(this,Qi)[2*V],H=c(this,Qi)[2*V+1];const R=f+z,D=g+H;F=R,C=D;let L=f,U=g;for(;;){const j=I(this,xt,nO).call(this,o,t,L,U,F,C,1);z=c(this,Qi)[2*j],H=c(this,Qi)[2*j+1];const G=L+z,$=U+H;S.push($,G);const ge=L*t+U;if(o[ge+1]===0?o[ge]=-u:o[ge]===1&&(o[ge]=u),G===f&&$===g&&L===R&&U===D){o[w]!==1&&(d=Math.abs(o[w]));break}else F=L,C=U,L=G,U=$}}}return h},e_=function(e,t,n,r){if(n-t<=4){for(let R=t;R<n-2;R+=2)r.push(e[R],e[R+1]);return}const i=e[t],o=e[t+1],u=e[n-4]-i,d=e[n-3]-o,h=Math.hypot(u,d),f=u/h,g=d/h,w=f*o-g*i,A=d/u,F=1/h,C=Math.atan(A),S=Math.cos(C),P=Math.sin(C),O=F*(Math.abs(S)+Math.abs(P)),N=F*(1-O+O**2),V=Math.max(Math.atan(Math.abs(P+S)*N),Math.atan(Math.abs(P-S)*N));let z=0,H=t;for(let R=t+2;R<n-2;R+=2){const D=Math.abs(w-f*e[R+1]+g*e[R]);D>z&&(H=R,z=D)}z>(h*V)**2?(I(this,xt,e_).call(this,e,t,H+2,r),I(this,xt,e_).call(this,e,H,n,r)):r.push(i,o)},rO=function(e){const t=[],n=e.length;return I(this,xt,e_).call(this,e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t},sO=function(e,t,n,r,i,o){const u=new Float32Array(o**2),d=-2*r**2,h=o>>1;for(let C=0;C<o;C++){const S=(C-h)**2;for(let P=0;P<o;P++)u[C*o+P]=Math.exp((S+(P-h)**2)/d)}const f=new Float32Array(256),g=-2*i**2;for(let C=0;C<256;C++)f[C]=Math.exp(C**2/g);const w=e.length,A=new Uint8Array(w),F=new Uint32Array(256);for(let C=0;C<n;C++)for(let S=0;S<t;S++){const P=C*t+S,O=e[P];let N=0,V=0;for(let H=0;H<o;H++){const R=C+H-h;if(!(R<0||R>=n))for(let D=0;D<o;D++){const L=S+D-h;if(L<0||L>=t)continue;const U=e[R*t+L],j=u[H*o+D]*f[Math.abs(U-O)];N+=U*j,V+=j}}const z=A[P]=Math.round(N/V);F[z]++}return[A,F]},iO=function(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t},WC=function(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let r=-1/0,i=1/0;for(let u=0,d=n.length;u<d;u++){const h=n[u]=e[u<<2];r=Math.max(r,h),i=Math.min(i,h)}const o=255/(r-i);for(let u=0,d=n.length;u<d;u++)n[u]=(n[u]-i)*o;return n},GC=function(e){let t,n=-1/0,r=-1/0;const i=e.findIndex(d=>d!==0);let o=i,u=i;for(t=i;t<256;t++){const d=e[t];d>n&&(t-o>r&&(r=t-o,u=t-1),n=d,o=t)}for(t=u-1;t>=0&&!(e[t]>e[t+1]);t--);return t},aO=function(e){const t=e,{width:n,height:r}=e,{maxDim:i}=c(this,Ih);let o=n,u=r;if(n>i||r>i){let w=n,A=r,F=Math.log2(Math.max(n,r)/i);const C=Math.floor(F);F=F===C?C-1:C;for(let P=0;P<F;P++){o=Math.ceil(w/2),u=Math.ceil(A/2);const O=new OffscreenCanvas(o,u);O.getContext("2d").drawImage(e,0,0,w,A,0,0,o,u),w=o,A=u,e!==t&&e.close(),e=O.transferToImageBitmap()}const S=Math.min(i/o,i/u);o=Math.round(o*S),u=Math.round(u*S)}const h=new OffscreenCanvas(o,u).getContext("2d",{willReadFrequently:!0});h.fillStyle="white",h.fillRect(0,0,o,u),h.filter="grayscale(1)",h.drawImage(e,0,0,e.width,e.height,0,0,o,u);const f=h.getImageData(0,0,o,u).data;return[I(this,xt,WC).call(this,f),o,u]},T(xl,xt),T(xl,Ih,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),T(xl,Qi,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class SS extends KL{constructor(){super(),super.updateProperties({fill:Ut._defaultLineColor,"stroke-width":0})}clone(){const e=new SS;return e.updateAll(this),e}}class TS extends Gx{constructor(e){super(e),super.updateProperties({stroke:Ut._defaultLineColor,"stroke-width":1})}clone(){const e=new TS(this._viewParameters);return e.updateAll(this),e}}var lu,Xa,cu,Ph;const Es=class Es extends V_{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});T(this,lu,!1);T(this,Xa,null);T(this,cu,null);T(this,Ph,null);this._willKeepAspectRatio=!0,x(this,cu,t.signatureData||null),x(this,Xa,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,n){Ut.initialize(t,n),this._defaultDrawingOptions=new SS,this._defaultDrawnSignatureOptions=new TS(n.viewParameters)}static getDefaultDrawingOptions(t){const n=this._defaultDrawingOptions.clone();return n.updateProperties(t),n}static get supportMultipleDrawings(){return!1}static get typesMap(){return qe(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!c(this,Xa)}}static computeTelemetryFinalData(t){const n=t.get("hasDescription");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,n;const{_isCopy:r}=this;if(r&&(this._isCopy=!1,t=this.x,n=this.y),super.render(),this._drawId===null)if(c(this,cu)){const{lines:i,mustSmooth:o,areContours:u,description:d,uuid:h,heightInPage:f}=c(this,cu),{rawDims:{pageWidth:g,pageHeight:w},rotation:A}=this.parent.viewport,F=xl.processDrawnLines({lines:i,pageWidth:g,pageHeight:w,rotation:A,innerMargin:Es._INNER_MARGIN,mustSmooth:o,areContours:u});this.addSignature(F,f,d,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:c(this,Xa)||""}));return r&&(this._isCopy=!0,this._moveAfterPaste(t,n)),this.div}setUuid(t){x(this,Ph,t),this.addEditToolbar()}getUuid(){return c(this,Ph)}get description(){return c(this,Xa)}set description(t){x(this,Xa,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(n=>{n==null||n.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:n,thickness:r,width:i,height:o}=c(this,cu),u=Math.max(i,o),d=xl.processDrawnLines({lines:{curves:t.map(h=>({points:h})),thickness:r,width:i,height:o},pageWidth:u,pageHeight:u,rotation:0,innerMargin:0,mustSmooth:!1,areContours:n});return{areContours:n,outline:d.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,n,r,i){const{x:o,y:u}=this,{outline:d}=x(this,cu,t);x(this,lu,d instanceof $C),this.description=r;let h;c(this,lu)?h=Es.getDefaultDrawingOptions():(h=Es._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":d.thickness})),this._addOutlines({drawOutlines:d,drawingOptions:h});const[,f]=this.pageDimensions;let g=n/f;g=g>=1?.5:g,this.width*=g/this.height,this.width>=1&&(g*=.9/this.width,this.width=.9),this.height=g,this.setDims(),this.x=o,this.y=u,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!r}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:n,pageHeight:r},rotation:i}=this.parent.viewport;return xl.process(t,n,r,i,Es._INNER_MARGIN)}getFromText(t,n){const{rawDims:{pageWidth:r,pageHeight:i},rotation:o}=this.parent.viewport;return xl.extractContoursFromText(t,n,r,i,o,Es._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:n,pageHeight:r},rotation:i}=this.parent.viewport;return xl.processDrawnLines({lines:t,pageWidth:n,pageHeight:r,rotation:i,innerMargin:Es._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:n}){t?this._drawingOptions=Es.getDefaultDrawingOptions():(this._drawingOptions=Es._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":n}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:n,points:r}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":i}}=this,o=Object.assign(super.serialize(t),{isSignature:!0,areContours:c(this,lu),color:[0,0,0],thickness:c(this,lu)?0:i});return this.addComment(o),t?(o.paths={lines:n,points:r},o.uuid=c(this,Ph),o.isCopy=!0):o.lines=n,c(this,Xa)&&(o.accessibilityData={type:"Figure",alt:c(this,Xa)}),o}static deserializeDraw(t,n,r,i,o,u){return u.areContours?$C.deserialize(t,n,r,i,o,u):I0.deserialize(t,n,r,i,o,u)}static async deserialize(t,n,r){var o;const i=await super.deserialize(t,n,r);return x(i,lu,t.areContours),i.description=((o=t.accessibilityData)==null?void 0:o.alt)||"",x(i,Ph,t.uuid),i}};lu=new WeakMap,Xa=new WeakMap,cu=new WeakMap,Ph=new WeakMap,re(Es,"_type","signature"),re(Es,"_editorType",Xe.SIGNATURE),re(Es,"_defaultDrawingOptions",null);let qC=Es;var Xt,Zn,uu,yl,du,Bm,wl,Rh,Ya,$s,Vm,ft,Vg,Ug,t_,n_,r_,KC,s_,oO;class QC extends Ut{constructor(t){super({...t,name:"stampEditor"});T(this,ft);T(this,Xt,null);T(this,Zn,null);T(this,uu,null);T(this,yl,null);T(this,du,null);T(this,Bm,"");T(this,wl,null);T(this,Rh,!1);T(this,Ya,null);T(this,$s,!1);T(this,Vm,!1);x(this,yl,t.bitmapUrl),x(this,du,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,n){Ut.initialize(t,n)}static isHandlingMimeForPasting(t){return Pb.includes(t)}static paste(t,n){n.pasteEditor({mode:Xe.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const n=t.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(t=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:r}=this._uiManager;if(!r)throw new Error("No ML.");if(!await r.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:o,height:u}=t||this.copyCanvas(null,null,!0).imageData,d=await r.guess({name:"altText",request:{data:i,width:o,height:u,channels:i.length/(o*u)}});if(!d)throw new Error("No response from the AI service.");if(d.error)throw new Error("Error from the AI service.");if(d.cancel)return null;if(!d.output)throw new Error("No valid response from the AI service.");const h=d.output;return await this.setGuessedAltText(h),n&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}remove(){var t;c(this,Zn)&&(x(this,Xt,null),this._uiManager.imageManager.deleteId(c(this,Zn)),(t=c(this,wl))==null||t.remove(),x(this,wl,null),c(this,Ya)&&(clearTimeout(c(this,Ya)),x(this,Ya,null))),super.remove()}rebuild(){if(!this.parent){c(this,Zn)&&I(this,ft,t_).call(this);return}super.rebuild(),this.div!==null&&(c(this,Zn)&&c(this,wl)===null&&I(this,ft,t_).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(c(this,uu)||c(this,Xt)||c(this,yl)||c(this,du)||c(this,Zn)||c(this,Rh))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,n;return this._isCopy&&(t=this.x,n=this.y),super.render(),this.div.hidden=!0,this.createAltText(),c(this,Rh)||(c(this,Xt)?I(this,ft,n_).call(this):I(this,ft,t_).call(this)),this._isCopy&&this._moveAfterPaste(t,n),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,n){const{id:r,bitmap:i}=this._uiManager.imageManager.getFromCanvas(t,n);n.remove(),r&&this._uiManager.imageManager.isValidId(r)&&(x(this,Zn,r),i&&x(this,Xt,i),x(this,Rh,!1),I(this,ft,n_).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;c(this,Ya)!==null&&clearTimeout(c(this,Ya)),x(this,Ya,setTimeout(()=>{x(this,Ya,null),I(this,ft,KC).call(this)},200))}copyCanvas(t,n,r=!1){t||(t=224);const{width:i,height:o}=c(this,Xt),u=new ho;let d=c(this,Xt),h=i,f=o,g=null;if(n){if(i>n||o>n){const R=Math.min(n/i,n/o);h=Math.floor(i*R),f=Math.floor(o*R)}g=document.createElement("canvas");const A=g.width=Math.ceil(h*u.sx),F=g.height=Math.ceil(f*u.sy);c(this,$s)||(d=I(this,ft,r_).call(this,A,F));const C=g.getContext("2d");C.filter=this._uiManager.hcmFilter;let S="white",P="#cfcfd8";this._uiManager.hcmFilter!=="none"?P="black":bW.isDarkMode&&(S="#8f8f9d",P="#42414d");const O=15,N=O*u.sx,V=O*u.sy,z=new OffscreenCanvas(N*2,V*2),H=z.getContext("2d");H.fillStyle=S,H.fillRect(0,0,N*2,V*2),H.fillStyle=P,H.fillRect(0,0,N,V),H.fillRect(N,V,N,V),C.fillStyle=C.createPattern(z,"repeat"),C.fillRect(0,0,A,F),C.drawImage(d,0,0,d.width,d.height,0,0,A,F)}let w=null;if(r){let A,F;if(u.symmetric&&d.width<t&&d.height<t)A=d.width,F=d.height;else if(d=c(this,Xt),i>t||o>t){const P=Math.min(t/i,t/o);A=Math.floor(i*P),F=Math.floor(o*P),c(this,$s)||(d=I(this,ft,r_).call(this,A,F))}const S=new OffscreenCanvas(A,F).getContext("2d",{willReadFrequently:!0});S.drawImage(d,0,0,d.width,d.height,0,0,A,F),w={width:A,height:F,data:S.getImageData(0,0,A,F).data}}return{canvas:g,width:h,height:f,imageData:w}}static async deserialize(t,n,r){var S;let i=null,o=!1;if(t instanceof EL){const{data:{rect:P,rotation:O,id:N,structParent:V,popupRef:z,richText:H,contentsObj:R,creationDate:D,modificationDate:L},container:U,parent:{page:{pageNumber:j}},canvas:G}=t;let $,ge;G?(delete t.canvas,{id:$,bitmap:ge}=r.imageManager.getFromCanvas(U.id,G),G.remove()):(o=!0,t._hasNoCanvas=!0);const xe=((S=await n._structTree.getAriaAttributes(`${sf}${N}`))==null?void 0:S.get("aria-label"))||"";i=t={annotationType:Xe.STAMP,bitmapId:$,bitmap:ge,pageIndex:j-1,rect:P.slice(0),rotation:O,annotationElementId:N,id:N,deleted:!1,accessibilityData:{decorative:!1,altText:xe},isSvg:!1,structParent:V,popupRef:z,richText:H,comment:(R==null?void 0:R.str)||null,creationDate:D,modificationDate:L}}const u=await super.deserialize(t,n,r),{rect:d,bitmap:h,bitmapUrl:f,bitmapId:g,isSvg:w,accessibilityData:A}=t;o?(r.addMissingCanvas(t.id,u),x(u,Rh,!0)):g&&r.imageManager.isValidId(g)?(x(u,Zn,g),h&&x(u,Xt,h)):x(u,yl,f),x(u,$s,w);const[F,C]=u.pageDimensions;return u.width=(d[2]-d[0])/F,u.height=(d[3]-d[1])/C,A&&(u.altTextData=A),u._initialData=i,t.comment&&u.setCommentData(t),x(u,Vm,!!i),u}serialize(t=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r=Object.assign(super.serialize(t),{bitmapId:c(this,Zn),isSvg:c(this,$s)});if(this.addComment(r),t)return r.bitmapUrl=I(this,ft,s_).call(this,!0),r.accessibilityData=this.serializeAltText(!0),r.isCopy=!0,r;const{decorative:i,altText:o}=this.serializeAltText(!1);if(!i&&o&&(r.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const d=I(this,ft,oO).call(this,r);return d.isSame?null:(d.isSameAltText?delete r.accessibilityData:r.accessibilityData.structParent=this._initialData.structParent??-1,r.id=this.annotationElementId,delete r.bitmapId,r)}if(n===null)return r;n.stamps||(n.stamps=new Map);const u=c(this,$s)?(r.rect[2]-r.rect[0])*(r.rect[3]-r.rect[1]):null;if(!n.stamps.has(c(this,Zn)))n.stamps.set(c(this,Zn),{area:u,serialized:r}),r.bitmap=I(this,ft,s_).call(this,!1);else if(c(this,$s)){const d=n.stamps.get(c(this,Zn));u>d.area&&(d.area=u,d.serialized.bitmap.close(),d.serialized.bitmap=I(this,ft,s_).call(this,!1))}return r}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}Xt=new WeakMap,Zn=new WeakMap,uu=new WeakMap,yl=new WeakMap,du=new WeakMap,Bm=new WeakMap,wl=new WeakMap,Rh=new WeakMap,Ya=new WeakMap,$s=new WeakMap,Vm=new WeakMap,ft=new WeakSet,Vg=function(t,n=!1){if(!t){this.remove();return}x(this,Xt,t.bitmap),n||(x(this,Zn,t.id),x(this,$s,t.isSvg)),t.file&&x(this,Bm,t.file.name),I(this,ft,n_).call(this)},Ug=function(){if(x(this,uu,null),this._uiManager.enableWaiting(!1),!!c(this,wl)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&c(this,Xt)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&c(this,Xt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},t_=function(){if(c(this,Zn)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(c(this,Zn)).then(r=>I(this,ft,Vg).call(this,r,!0)).finally(()=>I(this,ft,Ug).call(this));return}if(c(this,yl)){const r=c(this,yl);x(this,yl,null),this._uiManager.enableWaiting(!0),x(this,uu,this._uiManager.imageManager.getFromUrl(r).then(i=>I(this,ft,Vg).call(this,i)).finally(()=>I(this,ft,Ug).call(this)));return}if(c(this,du)){const r=c(this,du);x(this,du,null),this._uiManager.enableWaiting(!0),x(this,uu,this._uiManager.imageManager.getFromFile(r).then(i=>I(this,ft,Vg).call(this,i)).finally(()=>I(this,ft,Ug).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=Pb.join(",");const n=this._uiManager._signal;x(this,uu,new Promise(r=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),I(this,ft,Vg).call(this,i)}r()},{signal:n}),t.addEventListener("cancel",()=>{this.remove(),r()},{signal:n})}).finally(()=>I(this,ft,Ug).call(this))),t.click()},n_=function(){var h;const{div:t}=this;let{width:n,height:r}=c(this,Xt);const[i,o]=this.pageDimensions,u=.75;if(this.width)n=this.width*i,r=this.height*o;else if(n>u*i||r>u*o){const f=Math.min(u*i/n,u*o/r);n*=f,r*=f}this._uiManager.enableWaiting(!1);const d=x(this,wl,document.createElement("canvas"));d.setAttribute("role","img"),this.addContainer(d),this.width=n/i,this.height=r/o,this.setDims(),(h=this._initialOptions)!=null&&h.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),I(this,ft,KC).call(this),c(this,Vm)||(this.parent.addUndoableEditor(this),x(this,Vm,!0)),this._reportTelemetry({action:"inserted_image"}),c(this,Bm)&&this.div.setAttribute("aria-description",c(this,Bm)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},r_=function(t,n){const{width:r,height:i}=c(this,Xt);let o=r,u=i,d=c(this,Xt);for(;o>2*t||u>2*n;){const h=o,f=u;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),u>2*n&&(u=u>=16384?Math.floor(u/2)-1:Math.ceil(u/2));const g=new OffscreenCanvas(o,u);g.getContext("2d").drawImage(d,0,0,h,f,0,0,o,u),d=g.transferToImageBitmap()}return d},KC=function(){const[t,n]=this.parentDimensions,{width:r,height:i}=this,o=new ho,u=Math.ceil(r*t*o.sx),d=Math.ceil(i*n*o.sy),h=c(this,wl);if(!h||h.width===u&&h.height===d)return;h.width=u,h.height=d;const f=c(this,$s)?c(this,Xt):I(this,ft,r_).call(this,u,d),g=h.getContext("2d");g.filter=this._uiManager.hcmFilter,g.drawImage(f,0,0,f.width,f.height,0,0,u,d)},s_=function(t){if(t){if(c(this,$s)){const i=this._uiManager.imageManager.getSvgUrl(c(this,Zn));if(i)return i}const n=document.createElement("canvas");return{width:n.width,height:n.height}=c(this,Xt),n.getContext("2d").drawImage(c(this,Xt),0,0),n.toDataURL()}if(c(this,$s)){const[n,r]=this.pageDimensions,i=Math.round(this.width*n*Nu.PDF_TO_CSS_UNITS),o=Math.round(this.height*r*Nu.PDF_TO_CSS_UNITS),u=new OffscreenCanvas(i,o);return u.getContext("2d").drawImage(c(this,Xt),0,0,c(this,Xt).width,c(this,Xt).height,0,0,i,o),u.transferToImageBitmap()}return structuredClone(c(this,Xt))},oO=function(t){var u;const{pageIndex:n,accessibilityData:{altText:r}}=this._initialData,i=t.pageIndex===n,o=(((u=t.accessibilityData)==null?void 0:u.alt)||"")===r;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&i&&o,isSameAltText:o}},re(QC,"_type","stamp"),re(QC,"_editorType",Xe.STAMP);var Dh,Um,hu,pu,vl,cs,fu,jm,$m,Ki,Al,er,_l,mu,zm,Pe,gu,Mt,YC,lO,Ta,JC,ZC,i_;const Bi=class Bi{constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:r,accessibilityManager:i,annotationLayer:o,drawLayer:u,textLayer:d,viewport:h,l10n:f}){T(this,Mt);T(this,Dh);T(this,Um,!1);T(this,hu,null);T(this,pu,null);T(this,vl,null);T(this,cs,new Map);T(this,fu,!1);T(this,jm,!1);T(this,$m,!1);T(this,Ki,null);T(this,Al,null);T(this,er,null);T(this,_l,null);T(this,mu,null);T(this,zm,-1);T(this,Pe);const g=[...c(Bi,gu).values()];if(!Bi._initialized){Bi._initialized=!0;for(const w of g)w.initialize(f,e)}e.registerEditorTypes(g),x(this,Pe,e),this.pageIndex=t,this.div=n,x(this,Dh,i),x(this,hu,o),this.viewport=h,x(this,er,d),this.drawLayer=u,this._structTree=r,c(this,Pe).addLayer(this)}updatePageIndex(e){this.pageIndex=e}get isEmpty(){return c(this,cs).size===0}get isInvisible(){return this.isEmpty&&c(this,Pe).getMode()===Xe.NONE}updateToolbar(e){c(this,Pe).updateToolbar(e)}updateMode(e=c(this,Pe).getMode()){switch(I(this,Mt,i_).call(this),e){case Xe.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Xe.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Xe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===Xe.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const n of c(Bi,gu).values())t.toggle(`${n._type}Editing`,e===n._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=c(this,er))==null?void 0:t.div)}setEditingState(e){c(this,Pe).setEditingState(e)}addCommands(e){c(this,Pe).addCommands(e)}cleanUndoStack(e){c(this,Pe).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=c(this,hu))==null||t.togglePointerEvents(e)}async enable(){var n;x(this,$m,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(n=c(this,mu))==null||n.abort(),x(this,mu,null);const e=new Set;for(const r of c(this,Mt,YC))r.enableEditing(),r.show(!0),r.annotationElementId&&(c(this,Pe).removeChangedExistingAnnotation(r),e.add(r.annotationElementId));const t=c(this,hu);if(t)for(const r of t.getEditableAnnotations()){if(r.hide(),c(this,Pe).isDeletedAnnotationElement(r.data.id)||e.has(r.data.id))continue;const i=await this.deserialize(r);i&&(this.addOrRebuild(i),i.enableEditing())}x(this,$m,!1),c(this,Pe)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var r;if(x(this,jm,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),c(this,er)&&!c(this,mu)){x(this,mu,new AbortController);const i=c(this,Pe).combinedSignal(c(this,mu));c(this,er).div.addEventListener("pointerdown",o=>{const{clientX:d,clientY:h,timeStamp:f}=o,g=c(this,zm);if(f-g>500){x(this,zm,f);return}x(this,zm,-1);const{classList:w}=this.div;w.toggle("getElements",!0);const A=document.elementsFromPoint(d,h);if(w.toggle("getElements",!1),!this.div.contains(A[0]))return;let F;const C=new RegExp(`^${ay}[0-9]+$`);for(const P of A)if(C.test(P.id)){F=P.id;break}if(!F)return;const S=c(this,cs).get(F);(S==null?void 0:S.annotationElementId)===null&&(o.stopPropagation(),o.preventDefault(),S.dblclick(o))},{signal:i,capture:!0})}const e=c(this,hu),t=[];if(e){const i=new Map,o=new Map;for(const d of c(this,Mt,YC)){if(d.disableEditing(),!d.annotationElementId){t.push(d);continue}if(d.serialize()!==null){i.set(d.annotationElementId,d);continue}else o.set(d.annotationElementId,d);(r=this.getEditableAnnotation(d.annotationElementId))==null||r.show(),d.remove()}const u=e.getEditableAnnotations();for(const d of u){const{id:h}=d.data;if(c(this,Pe).isDeletedAnnotationElement(h)){d.updateEdited({deleted:!0});continue}let f=o.get(h);if(f){f.resetAnnotationElement(d),f.show(!1),d.show();continue}f=i.get(h),f&&(c(this,Pe).addChangedExistingAnnotation(f),f.renderAnnotationElement(d)&&f.show(!1)),d.show()}}I(this,Mt,i_).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const i of c(Bi,gu).values())n.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e==null||e.updateFakeAnnotations(t),x(this,jm,!1)}getEditableAnnotation(e){var t;return((t=c(this,hu))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){c(this,Pe).getActive()!==e&&c(this,Pe).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=c(this,er))!=null&&e.div&&!c(this,_l)){x(this,_l,new AbortController);const t=c(this,Pe).combinedSignal(c(this,_l));c(this,er).div.addEventListener("pointerdown",I(this,Mt,lO).bind(this),{signal:t}),c(this,er).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=c(this,er))!=null&&e.div&&c(this,_l)&&(c(this,_l).abort(),x(this,_l,null),c(this,er).div.classList.remove("highlighting"))}enableClick(){if(c(this,pu))return;x(this,pu,new AbortController);const e=c(this,Pe).combinedSignal(c(this,pu));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=c(this,pu))==null||e.abort(),x(this,pu,null)}attach(e){c(this,cs).set(e.id,e);const{annotationElementId:t}=e;t&&c(this,Pe).isDeletedAnnotationElement(t)&&c(this,Pe).removeDeletedAnnotationElement(e)}detach(e){var t;c(this,cs).delete(e.id),(t=c(this,Dh))==null||t.removePointerInTextLayer(e.contentDiv),!c(this,jm)&&e.annotationElementId&&c(this,Pe).addDeletedAnnotationElement(e)}remove(e){this.detach(e),c(this,Pe).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(c(this,Pe).addDeletedAnnotationElement(e),Ut.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),c(this,Pe).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!c(this,$m)),c(this,Pe).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var n;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!c(this,vl)&&(e._focusEventsAllowed=!1,x(this,vl,setTimeout(()=>{x(this,vl,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:c(this,Pe)._signal}),t.focus())},0))),e._structTreeParentId=(n=c(this,Dh))==null?void 0:n.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getEditorByUID(e){for(const t of c(this,cs).values())if(t.uid===e)return t;return null}getNextId(){return c(this,Pe).getId()}combinedSignal(e){return c(this,Pe).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=c(this,Mt,Ta))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await c(this,Pe).updateMode(e.mode);const{offsetX:n,offsetY:r}=I(this,Mt,ZC).call(this),i=this.getNextId(),o=I(this,Mt,JC).call(this,{parent:this,id:i,x:n,y:r,uiManager:c(this,Pe),isCentered:!0,...t});o&&this.add(o)}async deserialize(e){var t;return await((t=c(Bi,gu).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,c(this,Pe)))||null}createAndAddNewEditor(e,t,n={}){const r=this.getNextId(),i=I(this,Mt,JC).call(this,{parent:this,id:r,x:e.offsetX,y:e.offsetY,uiManager:c(this,Pe),isCentered:t,...n});return i&&this.add(i),i}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(I(this,Mt,ZC).call(this),!0,e)}setSelected(e){c(this,Pe).setSelected(e)}toggleSelected(e){c(this,Pe).toggleSelected(e)}unselect(e){c(this,Pe).unselect(e)}pointerup(e){var r;const{isMac:t}=Hn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!c(this,fu)||(x(this,fu,!1),(r=c(this,Mt,Ta))!=null&&r.isDrawer&&c(this,Mt,Ta).supportMultipleDrawings))return;if(!c(this,Um)){x(this,Um,!0);return}const n=c(this,Pe).getMode();if(n===Xe.STAMP||n===Xe.SIGNATURE){c(this,Pe).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var r;if(c(this,Pe).getMode()===Xe.HIGHLIGHT&&this.enableTextSelection(),c(this,fu)){x(this,fu,!1);return}const{isMac:t}=Hn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(x(this,fu,!0),(r=c(this,Mt,Ta))!=null&&r.isDrawer){this.startDrawingSession(e);return}const n=c(this,Pe).getActive();x(this,Um,!n||n.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),c(this,Ki)){c(this,Mt,Ta).startDrawing(this,c(this,Pe),!1,e);return}c(this,Pe).setCurrentDrawingSession(this),x(this,Ki,new AbortController);const t=c(this,Pe).combinedSignal(c(this,Ki));this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(x(this,Al,null),this.commitOrRemove())},{signal:t}),c(this,Mt,Ta).startDrawing(this,c(this,Pe),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&x(this,Al,t);return}c(this,Al)&&setTimeout(()=>{var t;(t=c(this,Al))==null||t.focus(),x(this,Al,null)},0)}endDrawingSession(e=!1){return c(this,Ki)?(c(this,Pe).setCurrentDrawingSession(null),c(this,Ki).abort(),x(this,Ki,null),x(this,Al,null),c(this,Mt,Ta).endDrawing(e)):null}findNewParent(e,t,n){const r=c(this,Pe).findParent(t,n);return r===null||r===this?!1:(r.changeParent(e),!0)}commitOrRemove(){return c(this,Ki)?(this.endDrawingSession(),!0):!1}onScaleChanging(){c(this,Ki)&&c(this,Mt,Ta).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=c(this,Pe).getActive())==null?void 0:e.parent)===this&&(c(this,Pe).commitOrRemove(),c(this,Pe).setActiveEditor(null)),c(this,vl)&&(clearTimeout(c(this,vl)),x(this,vl,null));for(const n of c(this,cs).values())(t=c(this,Dh))==null||t.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,c(this,cs).clear(),c(this,Pe).removeLayer(this)}render({viewport:e}){this.viewport=e,qh(this.div,e);for(const t of c(this,Pe).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){c(this,Pe).commitOrRemove(),I(this,Mt,i_).call(this);const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,qh(this.div,{rotation:n}),t!==n)for(const r of c(this,cs).values())r.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return c(this,Pe).viewParameters.realScale}};Dh=new WeakMap,Um=new WeakMap,hu=new WeakMap,pu=new WeakMap,vl=new WeakMap,cs=new WeakMap,fu=new WeakMap,jm=new WeakMap,$m=new WeakMap,Ki=new WeakMap,Al=new WeakMap,er=new WeakMap,_l=new WeakMap,mu=new WeakMap,zm=new WeakMap,Pe=new WeakMap,gu=new WeakMap,Mt=new WeakSet,YC=function(){return c(this,cs).size!==0?c(this,cs).values():c(this,Pe).getEditors(this.pageIndex)},lO=function(e){c(this,Pe).unselectAll();const{target:t}=e;if(t===c(this,er).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&c(this,er).div.contains(t)){const{isMac:n}=Hn.platform;if(e.button!==0||e.ctrlKey&&n)return;c(this,Pe).showAllEditors("highlight",!0,!0),c(this,er).div.classList.add("free"),this.toggleDrawing(),B_.startHighlighting(this,c(this,Pe).direction==="ltr",{target:c(this,er).div,x:e.x,y:e.y}),c(this,er).div.addEventListener("pointerup",()=>{c(this,er).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:c(this,Pe)._signal}),e.preventDefault()}},Ta=function(){return c(Bi,gu).get(c(this,Pe).getMode())},JC=function(e){const t=c(this,Mt,Ta);return t?new t.prototype.constructor(e):null},ZC=function(){const{x:e,y:t,width:n,height:r}=this.boundingClientRect,i=Math.max(0,e),o=Math.max(0,t),u=Math.min(window.innerWidth,e+n),d=Math.min(window.innerHeight,t+r),h=(i+u)/2-e,f=(o+d)/2-t,[g,w]=this.viewport.rotation%180===0?[h,f]:[f,h];return{offsetX:g,offsetY:w}},i_=function(){for(const e of c(this,cs).values())e.isEmpty()&&e.remove()},re(Bi,"_initialized",!1),T(Bi,gu,new Map([PC,jC,QC,B_,qC].map(e=>[e._editorType,e])));let XC=Bi;var Xi,zr,Nh,i0,sx,cO,fo,tF,uO,nF;const Un=class Un{constructor(){T(this,fo);T(this,Xi,null);T(this,zr,new Map);T(this,Nh,new Map)}setParent(e){if(!c(this,Xi)){x(this,Xi,e);return}if(c(this,Xi)!==e){if(c(this,zr).size>0)for(const t of c(this,zr).values())t.remove(),e.append(t);x(this,Xi,e)}}static get _svgFactory(){return qe(this,"_svgFactory",new L_)}draw(e,t=!1,n=!1){const r=Bn(Un,i0)._++,i=I(this,fo,tF).call(this),o=Un._svgFactory.createElement("defs");i.append(o);const u=Un._svgFactory.createElement("path");o.append(u);const d=`path_${r}`;u.setAttribute("id",d),u.setAttribute("vector-effect","non-scaling-stroke"),t&&c(this,Nh).set(r,u);const h=n?I(this,fo,uO).call(this,o,d):null,f=Un._svgFactory.createElement("use");return i.append(f),f.setAttribute("href",`#${d}`),this.updateProperties(i,e),c(this,zr).set(r,i),{id:r,clipPathId:`url(#${h})`}}drawOutline(e,t){const n=Bn(Un,i0)._++,r=I(this,fo,tF).call(this),i=Un._svgFactory.createElement("defs");r.append(i);const o=Un._svgFactory.createElement("path");i.append(o);const u=`path_${n}`;o.setAttribute("id",u),o.setAttribute("vector-effect","non-scaling-stroke");let d;if(t){const g=Un._svgFactory.createElement("mask");i.append(g),d=`mask_${n}`,g.setAttribute("id",d),g.setAttribute("maskUnits","objectBoundingBox");const w=Un._svgFactory.createElement("rect");g.append(w),w.setAttribute("width","1"),w.setAttribute("height","1"),w.setAttribute("fill","white");const A=Un._svgFactory.createElement("use");g.append(A),A.setAttribute("href",`#${u}`),A.setAttribute("stroke","none"),A.setAttribute("fill","black"),A.setAttribute("fill-rule","nonzero"),A.classList.add("mask")}const h=Un._svgFactory.createElement("use");r.append(h),h.setAttribute("href",`#${u}`),d&&h.setAttribute("mask",`url(#${d})`);const f=h.cloneNode();return r.append(f),h.classList.add("mainOutline"),f.classList.add("secondaryOutline"),this.updateProperties(r,e),c(this,zr).set(n,r),n}finalizeDraw(e,t){c(this,Nh).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var d;if(!t)return;const{root:n,bbox:r,rootClass:i,path:o}=t,u=typeof e=="number"?c(this,zr).get(e):e;if(u){if(n&&I(this,fo,nF).call(this,u,n),r&&I(d=Un,sx,cO).call(d,u,r),i){const{classList:h}=u;for(const[f,g]of Object.entries(i))h.toggle(f,g)}if(o){const f=u.firstElementChild.firstElementChild;I(this,fo,nF).call(this,f,o)}}}updateParent(e,t){if(t===this)return;const n=c(this,zr).get(e);n&&(c(t,Xi).append(n),c(this,zr).delete(e),c(t,zr).set(e,n))}remove(e){c(this,Nh).delete(e),c(this,Xi)!==null&&(c(this,zr).get(e).remove(),c(this,zr).delete(e))}destroy(){x(this,Xi,null);for(const e of c(this,zr).values())e.remove();c(this,zr).clear(),c(this,Nh).clear()}};Xi=new WeakMap,zr=new WeakMap,Nh=new WeakMap,i0=new WeakMap,sx=new WeakSet,cO=function(e,[t,n,r,i]){const{style:o}=e;o.top=`${100*n}%`,o.left=`${100*t}%`,o.width=`${100*r}%`,o.height=`${100*i}%`},fo=new WeakSet,tF=function(){const e=Un._svgFactory.create(1,1,!0);return c(this,Xi).append(e),e.setAttribute("aria-hidden",!0),e},uO=function(e,t){const n=Un._svgFactory.createElement("clipPath");e.append(n);const r=`clip_${t}`;n.setAttribute("id",r),n.setAttribute("clipPathUnits","objectBoundingBox");const i=Un._svgFactory.createElement("use");return n.append(i),i.setAttribute("href",`#${t}`),i.classList.add("clip"),r},nF=function(e,t){for(const[n,r]of Object.entries(t))r===null?e.removeAttribute(n):e.setAttribute(n,r)},T(Un,sx),T(Un,i0,0);let eF=Un;globalThis._pdfjsTestingUtils={HighlightOutliner:DC};globalThis.pdfjsLib={AbortException:Du,AnnotationEditorLayer:XC,AnnotationEditorParamsType:lt,AnnotationEditorType:Xe,AnnotationEditorUIManager:Qh,AnnotationLayer:kC,AnnotationMode:xc,AnnotationType:kn,applyOpacity:FW,build:DG,ColorPicker:N_,createValidAbsoluteUrl:$N,CSSConstants:CW,DOMSVGFactory:L_,DrawLayer:eF,FeatureTest:Hn,fetchData:F0,findContrastColor:SW,getDocument:oL,getFilenameFromUrl:vW,getPdfFilenameFromUrl:AW,getRGB:T0,getUuid:HN,getXfaPageViewport:xW,GlobalWorkerOptions:Ja,ImageKind:CA,InvalidPDFException:kb,isDataScheme:Ux,isPdfFile:_S,isValidExplicitDest:BW,MathClamp:hr,noContextMenu:Fi,normalizeUnicode:yW,OPS:oy,OutputScale:ho,PagesMapper:cy,PasswordResponses:oW,PDFDataRangeTransport:lL,PDFDateString:T_,PDFWorker:dy,PermissionFlag:aW,PixelsPerInch:Nu,RenderingCancelledException:AS,renderRichText:GN,ResponseException:S_,setLayerDimensions:qh,shadow:qe,SignatureExtractor:xl,stopEvent:fn,SupportedImageMimeTypes:Pb,TextLayer:uy,TouchManager:I_,updateUrlHash:zN,Util:_e,VerbosityLevel:Lx,version:RG,XfaLayer:WN};Ja.workerSrc="/studentmate-admin-panel/pdf.worker.min.mjs";const FR=async s=>{const e=await s.arrayBuffer(),n=await oL({data:e}).promise,r=[];for(let i=1;i<=n.numPages;i++){const o=await n.getPage(i),u=o.getViewport({scale:2}),d=await o.getTextContent(),h=[],f=5;d.items.forEach(C=>{const S=C.transform[5],P=h.find(O=>Math.abs(O.y-S)<f);P?P.items.push(C):h.push({y:S,text:"",items:[C]})}),h.sort((C,S)=>S.y-C.y);const g=[];if(h.forEach(C=>{C.items.sort((O,N)=>O.transform[4]-N.transform[4]);const S=C.items.map(O=>O.str).join(" "),P=S.match(/^(?:Question|Q|Answer)\s*(\d+)/i)||S.match(/^(\d+)[\.:]\s+/);if(P){const O=C.y,N=u.height-O*u.scale;g.find(V=>V.number===parseInt(P[1]))||g.push({number:parseInt(P[1]),y:N})}}),g.sort((C,S)=>C.y-S.y),g.length===0)continue;const w=document.createElement("canvas"),A=w.getContext("2d");if(w.height=u.height,w.width=u.width,!A)continue;const F={canvasContext:A,viewport:u};await o.render(F).promise;for(let C=0;C<g.length;C++){const S=g[C],P=Math.max(0,S.y-50);let O=u.height;C<g.length-1&&(O=g[C+1].y-20);const N=O-P;if(N<=0)continue;const V=document.createElement("canvas");V.width=u.width,V.height=N;const z=V.getContext("2d");if(z){z.drawImage(w,0,P,u.width,N,0,0,u.width,N);const H=await new Promise(R=>V.toBlob(R,"image/jpeg",.85));H&&(r.push({number:S.number,text:`(Image Extracted from Page ${i})`,marks:0,imageBlob:H,page:i,coordinates:{yStart:P/2,yEnd:O/2}}),S.number)}}}return r},rq=({assessmentId:s,assessmentTitle:e,onClose:t})=>{const[n,r]=q.useState([]),[i,o]=q.useState(!1),[u,d]=q.useState(!1),[h,f]=q.useState(!1),[g,w]=q.useState(!1),[A,F]=q.useState(!1),[C,S]=q.useState(null),[P,O]=q.useState(""),[N,V]=q.useState(0),[z,H]=q.useState(1),[R,D]=q.useState(null),[L,U]=q.useState(null),[j,G]=q.useState(""),[$,ge]=q.useState(null),[xe,ye]=q.useState([]),[pe,ie]=q.useState([]),[we,de]=q.useState(!1);q.useEffect(()=>{K()},[s]);const K=async()=>{o(!0);try{const ce=await rH(s);r(ce),ce.length>0&&H(ce.length+1)}catch(ce){console.error("Error fetching questions:",ce)}finally{o(!1)}},Y=ce=>{ce?(S(ce.questionId),O(ce.title),V(ce.marks),H(ce.order),G(ce.videoUrl||""),D(null),U(null)):(S(null),O(`Question ${n.length+1}`),V(0),H(n.length+1),G(""),D(null),U(null)),d(!0)},fe=async ce=>{if(ce.preventDefault(),!(!C&&!R)){F(!0);try{C?await qP(s,C,{title:P,marks:N,order:z,videoUrl:j||void 0},R,L):await QP(s,P,N,z,R,void 0,L,void 0,j),d(!1),K()}catch(Oe){console.error("Error saving question:",Oe)}finally{F(!1)}}},De=async ce=>{if(ce.target.files&&ce.target.files[0]){ge(ce.target.files[0]),de(!0);try{const Oe=await FR(ce.target.files[0]);Oe.length===0&&alert('No questions detected in the PDF. Please ensure the file is text-based (not scanned) and uses standard headings like "Question 1", "Q1", or "1."'),ye(Oe)}catch(Oe){console.error("Error parsing PDF:",Oe),alert("Failed to parse PDF. Please ensure it is a valid PDF.")}finally{de(!1)}}},ke=async ce=>{if(ce.target.files&&ce.target.files[0]){ge(ce.target.files[0]),de(!0);try{const Oe=await FR(ce.target.files[0]);Oe.length===0&&alert('No answers detected in the Memo PDF. Please ensure the file uses "Question 1", "Answer 1", or "1." headings.'),ie(Oe)}catch(Oe){console.error("Error parsing Memo PDF:",Oe),alert("Failed to parse Memo PDF.")}finally{de(!1)}}},Ne=async()=>{if(pe.length!==0){F(!0);try{for(const ce of pe){const Oe=n.find(Zt=>Zt.title.toLowerCase().includes(`question ${ce.number}`)||Zt.title.toLowerCase()===`q${ce.number}`||Zt.order===ce.number);if(Oe&&ce.imageBlob){const Zt=new File([ce.imageBlob],`answer_${ce.number}.jpg`,{type:"image/jpeg"});await qP(s,Oe.questionId,{},null,Zt)}}w(!1),ie([]),ge(null),K(),alert("Memo answers uploaded and matched to questions!")}catch(ce){console.error("Error saving bulk memo:",ce),alert("Error saving memo. See console for details.")}finally{F(!1)}}},Me=async()=>{if(xe.length!==0){F(!0);try{let ce=n.length>0?n.length+1:1;for(const Oe of xe){let Zt;Oe.imageBlob&&(Zt=new File([Oe.imageBlob],`question_${Oe.number}.jpg`,{type:"image/jpeg"})),await QP(s,`Question ${Oe.number}`,Oe.marks,ce++,Zt,Oe.text,void 0,void 0,void 0,Oe.page,Oe.coordinates)}f(!1),ye([]),ge(null),K()}catch(ce){console.error("Error saving bulk questions:",ce),alert("Error saving questions. See console for details.")}finally{F(!1)}}},et=ce=>{const Oe=[...xe];Oe.splice(ce,1),ye(Oe)},dt=ce=>{const Oe=[...pe];Oe.splice(ce,1),ie(Oe)},Gt=(ce,Oe,Zt)=>{const Bl=[...xe];Bl[ce]={...Bl[ce],[Oe]:Zt},ye(Bl)},vr=async ce=>{if(window.confirm("Are you sure you want to delete this question?"))try{await sH(s,ce),K()}catch(Oe){console.error("Error deleting question:",Oe)}};return _.jsxs("div",{"trae-inspector-start-line":"271","trae-inspector-start-column":"4","trae-inspector-end-line":"723","trae-inspector-end-column":"10","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:[_.jsxs("div",{"trae-inspector-start-line":"272","trae-inspector-start-column":"6","trae-inspector-end-line":"409","trae-inspector-end-column":"12","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[_.jsx("div",{"trae-inspector-start-line":"273","trae-inspector-start-column":"8","trae-inspector-end-line":"273","trae-inspector-end-column":"127","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:t}),_.jsx("span",{"trae-inspector-start-line":"275","trae-inspector-start-column":"8","trae-inspector-end-line":"275","trae-inspector-end-column":"110","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22%E2%80%8B%22%2C%22textStartLine%22%3A%22275%22%2C%22textStartColumn%22%3A%2296%22%2C%22textEndLine%22%3A%22275%22%2C%22textEndColumn%22%3A%22103%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),_.jsx("div",{"trae-inspector-start-line":"277","trae-inspector-start-column":"8","trae-inspector-end-line":"408","trae-inspector-end-column":"14","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-5xl sm:w-full",children:_.jsxs("div",{"trae-inspector-start-line":"278","trae-inspector-start-column":"10","trae-inspector-end-line":"407","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[_.jsxs("div",{"trae-inspector-start-line":"279","trae-inspector-start-column":"12","trae-inspector-end-line":"317","trae-inspector-end-column":"18","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex justify-between items-center mb-6",children:[_.jsxs("div",{"trae-inspector-start-line":"280","trae-inspector-start-column":"14","trae-inspector-end-line":"287","trae-inspector-end-column":"20","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsxs("h3",{"trae-inspector-start-line":"281","trae-inspector-start-column":"16","trae-inspector-end-line":"283","trae-inspector-end-column":"21","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-lg leading-6 font-medium text-gray-900",id:"modal-title",children:["Manage Questions: ",e]}),_.jsx("p",{"trae-inspector-start-line":"284","trae-inspector-start-column":"16","trae-inspector-end-line":"286","trae-inspector-end-column":"20","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Add%20questions%20via%20image%20upload%20or%20auto-parse%20from%20PDF.%22%2C%22textStartLine%22%3A%22284%22%2C%22textStartColumn%22%3A%2258%22%2C%22textEndLine%22%3A%22286%22%2C%22textEndColumn%22%3A%2216%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"mt-1 text-sm text-gray-500",children:"Add questions via image upload or auto-parse from PDF."})]}),_.jsxs("div",{"trae-inspector-start-line":"288","trae-inspector-start-column":"14","trae-inspector-end-line":"316","trae-inspector-end-column":"20","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex space-x-3",children:[_.jsxs("button",{"trae-inspector-start-line":"289","trae-inspector-start-column":"16","trae-inspector-end-line":"295","trae-inspector-end-column":"25","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:()=>w(!0),className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2",children:[_.jsx(Hm,{className:"h-5 w-5"}),_.jsx("span",{"trae-inspector-start-line":"294","trae-inspector-start-column":"18","trae-inspector-end-line":"294","trae-inspector-end-column":"47","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Bulk%20Upload%20Memo%22%2C%22textStartLine%22%3A%22294%22%2C%22textStartColumn%22%3A%2224%22%2C%22textEndLine%22%3A%22294%22%2C%22textEndColumn%22%3A%2240%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:"Bulk Upload Memo"})]}),_.jsxs("button",{"trae-inspector-start-line":"296","trae-inspector-start-column":"16","trae-inspector-end-line":"302","trae-inspector-end-column":"25","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:()=>f(!0),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2",children:[_.jsx(Hm,{className:"h-5 w-5"}),_.jsx("span",{"trae-inspector-start-line":"301","trae-inspector-start-column":"18","trae-inspector-end-line":"301","trae-inspector-end-column":"46","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Bulk%20Upload%20PDF%22%2C%22textStartLine%22%3A%22301%22%2C%22textStartColumn%22%3A%2224%22%2C%22textEndLine%22%3A%22301%22%2C%22textEndColumn%22%3A%2239%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:"Bulk Upload PDF"})]}),_.jsxs("button",{"trae-inspector-start-line":"303","trae-inspector-start-column":"16","trae-inspector-end-line":"309","trae-inspector-end-column":"25","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:()=>Y(),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2",children:[_.jsx(l0,{className:"h-5 w-5"}),_.jsx("span",{"trae-inspector-start-line":"308","trae-inspector-start-column":"18","trae-inspector-end-line":"308","trae-inspector-end-column":"41","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Add%20Manual%22%2C%22textStartLine%22%3A%22308%22%2C%22textStartColumn%22%3A%2224%22%2C%22textEndLine%22%3A%22308%22%2C%22textEndColumn%22%3A%2234%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:"Add Manual"})]}),_.jsx("button",{"trae-inspector-start-line":"310","trae-inspector-start-column":"16","trae-inspector-end-line":"315","trae-inspector-end-column":"25","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Close%22%2C%22textStartLine%22%3A%22313%22%2C%22textStartColumn%22%3A%2217%22%2C%22textEndLine%22%3A%22315%22%2C%22textEndColumn%22%3A%2216%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:t,className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg",children:"Close"})]})]}),_.jsx("div",{"trae-inspector-start-line":"319","trae-inspector-start-column":"12","trae-inspector-end-line":"406","trae-inspector-end-column":"18","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-gray-50 rounded-lg min-h-[400px] p-4 max-h-[70vh] overflow-y-auto",children:i?_.jsx("div",{"trae-inspector-start-line":"321","trae-inspector-start-column":"16","trae-inspector-end-line":"321","trae-inspector-end-column":"77","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Loading%20questions...%22%2C%22textStartLine%22%3A%22321%22%2C%22textStartColumn%22%3A%2251%22%2C%22textEndLine%22%3A%22321%22%2C%22textEndColumn%22%3A%2271%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-center py-10",children:"Loading questions..."}):n.length===0?_.jsx("div",{"trae-inspector-start-line":"323","trae-inspector-start-column":"16","trae-inspector-end-line":"325","trae-inspector-end-column":"22","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22No%20questions%20added%20yet.%20Click%20%5C%22Add%20Manual%5C%22%20or%20%5C%22Bulk%20Upload%20PDF%5C%22%20to%20start.%22%2C%22textStartLine%22%3A%22323%22%2C%22textStartColumn%22%3A%2265%22%2C%22textEndLine%22%3A%22325%22%2C%22textEndColumn%22%3A%2216%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-center py-10 text-gray-500",children:'No questions added yet. Click "Add Manual" or "Bulk Upload PDF" to start.'}):_.jsx("div",{"trae-inspector-start-line":"327","trae-inspector-start-column":"16","trae-inspector-end-line":"404","trae-inspector-end-column":"22","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"space-y-6",children:n.map(ce=>_.jsxs("div",{"trae-inspector-start-line":"329","trae-inspector-start-column":"20","trae-inspector-end-line":"402","trae-inspector-end-column":"26","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[_.jsxs("div",{"trae-inspector-start-line":"331","trae-inspector-start-column":"22","trae-inspector-end-line":"355","trae-inspector-end-column":"28","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex justify-between items-center p-4 border-b border-gray-100 bg-gray-50",children:[_.jsxs("div",{"trae-inspector-start-line":"332","trae-inspector-start-column":"24","trae-inspector-end-line":"335","trae-inspector-end-column":"30","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-center space-x-3",children:[_.jsx("div",{"trae-inspector-start-line":"333","trae-inspector-start-column":"26","trae-inspector-end-line":"333","trae-inspector-end-column":"82","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"w-1 h-6 bg-blue-600 rounded-full"}),_.jsx("h4",{"trae-inspector-start-line":"334","trae-inspector-start-column":"26","trae-inspector-end-line":"334","trae-inspector-end-column":"80","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"font-bold text-blue-900",children:ce.title})]}),_.jsxs("div",{"trae-inspector-start-line":"336","trae-inspector-start-column":"24","trae-inspector-end-line":"354","trae-inspector-end-column":"30","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-center space-x-4",children:[_.jsxs("span",{"trae-inspector-start-line":"337","trae-inspector-start-column":"26","trae-inspector-end-line":"339","trae-inspector-end-column":"33","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-gray-200 text-gray-700 px-2 py-1 rounded-full text-xs font-bold",children:[ce.marks," Marks"]}),_.jsx("button",{"trae-inspector-start-line":"340","trae-inspector-start-column":"26","trae-inspector-end-line":"346","trae-inspector-end-column":"35","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:()=>Y(ce),className:"text-blue-500 hover:text-blue-700",title:"Edit Question",children:_.jsx(dF,{className:"h-5 w-5"})}),_.jsx("button",{"trae-inspector-start-line":"347","trae-inspector-start-column":"26","trae-inspector-end-line":"353","trae-inspector-end-column":"35","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:()=>vr(ce),className:"text-red-500 hover:text-red-700",title:"Delete Question",children:_.jsx(c0,{className:"h-5 w-5"})})]})]}),_.jsxs("div",{"trae-inspector-start-line":"358","trae-inspector-start-column":"22","trae-inspector-end-line":"401","trae-inspector-end-column":"28","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"p-4",children:[_.jsxs("div",{"trae-inspector-start-line":"359","trae-inspector-start-column":"24","trae-inspector-end-line":"370","trae-inspector-end-column":"30","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"mb-4",children:[_.jsx("p",{"trae-inspector-start-line":"360","trae-inspector-start-column":"26","trae-inspector-end-line":"360","trae-inspector-end-column":"112","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Question%20Content%22%2C%22textStartLine%22%3A%22360%22%2C%22textStartColumn%22%3A%2292%22%2C%22textEndLine%22%3A%22360%22%2C%22textEndColumn%22%3A%22108%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-xs text-gray-500 mb-1 uppercase font-semibold",children:"Question Content"}),_.jsx("div",{"trae-inspector-start-line":"361","trae-inspector-start-column":"26","trae-inspector-end-line":"369","trae-inspector-end-column":"32","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"border border-gray-100 rounded bg-gray-50 p-2",children:ce.contentUrl?_.jsx("img",{"trae-inspector-start-line":"363","trae-inspector-start-column":"30","trae-inspector-end-line":"363","trae-inspector-end-column":"124","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",src:ce.contentUrl,alt:ce.title,className:"max-w-full h-auto max-h-64 object-contain"}):ce.content?_.jsx("div",{"trae-inspector-start-line":"365","trae-inspector-start-column":"30","trae-inspector-end-line":"365","trae-inspector-end-column":"109","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"whitespace-pre-wrap text-gray-800 font-serif",children:ce.content}):_.jsx("span",{"trae-inspector-start-line":"367","trae-inspector-start-column":"30","trae-inspector-end-line":"367","trae-inspector-end-column":"96","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22No%20content%20available%22%2C%22textStartLine%22%3A%22367%22%2C%22textStartColumn%22%3A%2269%22%2C%22textEndLine%22%3A%22367%22%2C%22textEndColumn%22%3A%2289%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-gray-400 italic",children:"No content available"})})]}),_.jsxs("div",{"trae-inspector-start-line":"372","trae-inspector-start-column":"24","trae-inspector-end-line":"400","trae-inspector-end-column":"30","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"grid grid-cols-2 gap-4",children:[_.jsxs("div",{"trae-inspector-start-line":"373","trae-inspector-start-column":"26","trae-inspector-end-line":"386","trae-inspector-end-column":"32","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("p",{"trae-inspector-start-line":"374","trae-inspector-start-column":"28","trae-inspector-end-line":"374","trae-inspector-end-column":"104","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Answer%22%2C%22textStartLine%22%3A%22374%22%2C%22textStartColumn%22%3A%2294%22%2C%22textEndLine%22%3A%22374%22%2C%22textEndColumn%22%3A%22100%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-xs text-gray-500 mb-1 uppercase font-semibold",children:"Answer"}),ce.answerUrl?_.jsxs("div",{"trae-inspector-start-line":"376","trae-inspector-start-column":"30","trae-inspector-end-line":"380","trae-inspector-end-column":"36","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-center space-x-2 text-green-600",children:[_.jsx(_B,{className:"h-4 w-4"}),_.jsx("span",{"trae-inspector-start-line":"378","trae-inspector-start-column":"32","trae-inspector-end-line":"378","trae-inspector-end-column":"86","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Answer%20Image%20Uploaded%22%2C%22textStartLine%22%3A%22378%22%2C%22textStartColumn%22%3A%2258%22%2C%22textEndLine%22%3A%22378%22%2C%22textEndColumn%22%3A%2279%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-sm",children:"Answer Image Uploaded"}),_.jsx("a",{"trae-inspector-start-line":"379","trae-inspector-start-column":"32","trae-inspector-end-line":"379","trae-inspector-end-column":"147","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22(View)%22%2C%22textStartLine%22%3A%22379%22%2C%22textStartColumn%22%3A%22137%22%2C%22textEndLine%22%3A%22379%22%2C%22textEndColumn%22%3A%22143%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",href:ce.answerUrl,target:"_blank",rel:"noreferrer",className:"text-blue-500 text-xs hover:underline",children:"(View)"})]}):ce.answerText?_.jsx("div",{"trae-inspector-start-line":"382","trae-inspector-start-column":"32","trae-inspector-end-line":"382","trae-inspector-end-column":"91","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-sm text-gray-700",children:ce.answerText}):_.jsx("span",{"trae-inspector-start-line":"384","trae-inspector-start-column":"30","trae-inspector-end-line":"384","trae-inspector-end-column":"95","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22No%20answer%20provided%22%2C%22textStartLine%22%3A%22384%22%2C%22textStartColumn%22%3A%2270%22%2C%22textEndLine%22%3A%22384%22%2C%22textEndColumn%22%3A%2288%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-sm text-gray-400",children:"No answer provided"})]}),_.jsxs("div",{"trae-inspector-start-line":"387","trae-inspector-start-column":"26","trae-inspector-end-line":"399","trae-inspector-end-column":"32","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("p",{"trae-inspector-start-line":"388","trae-inspector-start-column":"28","trae-inspector-end-line":"388","trae-inspector-end-column":"112","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Video%20Solution%22%2C%22textStartLine%22%3A%22388%22%2C%22textStartColumn%22%3A%2294%22%2C%22textEndLine%22%3A%22388%22%2C%22textEndColumn%22%3A%22108%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-xs text-gray-500 mb-1 uppercase font-semibold",children:"Video Solution"}),ce.videoUrl?_.jsxs("div",{"trae-inspector-start-line":"390","trae-inspector-start-column":"30","trae-inspector-end-line":"395","trae-inspector-end-column":"36","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-center space-x-2 text-blue-600",children:[_.jsx(r6,{className:"h-4 w-4"}),_.jsx("a",{"trae-inspector-start-line":"392","trae-inspector-start-column":"32","trae-inspector-end-line":"394","trae-inspector-end-column":"36","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",href:ce.videoUrl,target:"_blank",rel:"noreferrer",className:"text-sm hover:underline truncate block max-w-[200px]",children:ce.videoUrl})]}):_.jsx("span",{"trae-inspector-start-line":"397","trae-inspector-start-column":"30","trae-inspector-end-line":"397","trae-inspector-end-column":"90","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22No%20video%20link%22%2C%22textStartLine%22%3A%22397%22%2C%22textStartColumn%22%3A%2270%22%2C%22textEndLine%22%3A%22397%22%2C%22textEndColumn%22%3A%2283%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-sm text-gray-400",children:"No video link"})]})]})]})]},ce.questionId))})})]})})]}),g&&_.jsx("div",{"trae-inspector-start-line":"413","trae-inspector-start-column":"8","trae-inspector-end-line":"511","trae-inspector-end-column":"14","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"fixed inset-0 z-[60] overflow-y-auto",children:_.jsxs("div",{"trae-inspector-start-line":"414","trae-inspector-start-column":"10","trae-inspector-end-line":"510","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[_.jsx("div",{"trae-inspector-start-line":"415","trae-inspector-start-column":"12","trae-inspector-end-line":"417","trae-inspector-end-column":"18","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:_.jsx("div",{"trae-inspector-start-line":"416","trae-inspector-start-column":"14","trae-inspector-end-line":"416","trae-inspector-end-column":"77","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"absolute inset-0 bg-gray-500 opacity-75"})}),_.jsx("span",{"trae-inspector-start-line":"418","trae-inspector-start-column":"12","trae-inspector-end-line":"418","trae-inspector-end-column":"114","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22%E2%80%8B%22%2C%22textStartLine%22%3A%22418%22%2C%22textStartColumn%22%3A%22100%22%2C%22textEndLine%22%3A%22418%22%2C%22textEndColumn%22%3A%22107%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),_.jsx("div",{"trae-inspector-start-line":"419","trae-inspector-start-column":"12","trae-inspector-end-line":"509","trae-inspector-end-column":"18","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:_.jsxs("div",{"trae-inspector-start-line":"420","trae-inspector-start-column":"14","trae-inspector-end-line":"508","trae-inspector-end-column":"20","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[_.jsxs("div",{"trae-inspector-start-line":"421","trae-inspector-start-column":"16","trae-inspector-end-line":"426","trae-inspector-end-column":"22","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex justify-between items-center mb-6",children:[_.jsx("h3",{"trae-inspector-start-line":"422","trae-inspector-start-column":"18","trae-inspector-end-line":"422","trae-inspector-end-column":"99","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Bulk%20Upload%20Memo%20(Answers)%22%2C%22textStartLine%22%3A%22422%22%2C%22textStartColumn%22%3A%2268%22%2C%22textEndLine%22%3A%22422%22%2C%22textEndColumn%22%3A%2294%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-lg font-medium text-gray-900",children:"Bulk Upload Memo (Answers)"}),_.jsx("button",{"trae-inspector-start-line":"423","trae-inspector-start-column":"18","trae-inspector-end-line":"425","trae-inspector-end-column":"27","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-500",children:_.jsx(pg,{className:"h-6 w-6"})})]}),_.jsxs("div",{"trae-inspector-start-line":"428","trae-inspector-start-column":"16","trae-inspector-end-line":"507","trae-inspector-end-column":"22","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"space-y-6",children:[_.jsx("p",{"trae-inspector-start-line":"429","trae-inspector-start-column":"18","trae-inspector-end-line":"431","trae-inspector-end-column":"22","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Upload%20a%20PDF%20containing%20the%20memorandum.%20The%20system%20will%20try%20to%20match%20%5C%22Question%201%5C%22%20in%20the%20memo%20to%20%5C%22Question%201%5C%22%20in%20your%20list.%22%2C%22textStartLine%22%3A%22429%22%2C%22textStartColumn%22%3A%2255%22%2C%22textEndLine%22%3A%22431%22%2C%22textEndColumn%22%3A%2218%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-sm text-gray-600",children:'Upload a PDF containing the memorandum. The system will try to match "Question 1" in the memo to "Question 1" in your list.'}),_.jsxs("div",{"trae-inspector-start-line":"434","trae-inspector-start-column":"18","trae-inspector-end-line":"449","trae-inspector-end-column":"24","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:bg-gray-50 transition-colors",children:[_.jsx("input",{"trae-inspector-start-line":"435","trae-inspector-start-column":"20","trae-inspector-end-line":"441","trae-inspector-end-column":"22","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"file",accept:".pdf",onChange:ke,className:"hidden",id:"bulk-memo-upload"}),_.jsxs("label",{"trae-inspector-start-line":"442","trae-inspector-start-column":"20","trae-inspector-end-line":"448","trae-inspector-end-column":"28","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",htmlFor:"bulk-memo-upload",className:"cursor-pointer block",children:[_.jsx(lI,{className:"mx-auto h-12 w-12 text-purple-400"}),_.jsx("p",{"trae-inspector-start-line":"444","trae-inspector-start-column":"22","trae-inspector-end-line":"446","trae-inspector-end-column":"26","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"mt-2 text-sm text-gray-600",children:$?$.name:"Click to upload Memo PDF"}),_.jsx("p",{"trae-inspector-start-line":"447","trae-inspector-start-column":"22","trae-inspector-end-line":"447","trae-inspector-end-column":"98","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22PDFs%20with%20selectable%20text%20only%22%2C%22textStartLine%22%3A%22447%22%2C%22textStartColumn%22%3A%2264%22%2C%22textEndLine%22%3A%22447%22%2C%22textEndColumn%22%3A%2294%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-xs text-gray-500 mt-1",children:"PDFs with selectable text only"})]})]}),we&&_.jsx("div",{"trae-inspector-start-line":"452","trae-inspector-start-column":"20","trae-inspector-end-line":"454","trae-inspector-end-column":"26","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Parsing%20Memo...%20Please%20wait.%22%2C%22textStartLine%22%3A%22452%22%2C%22textStartColumn%22%3A%2282%22%2C%22textEndLine%22%3A%22454%22%2C%22textEndColumn%22%3A%2220%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-center py-4 text-purple-600 font-medium",children:"Parsing Memo... Please wait."}),pe.length>0&&_.jsxs("div",{"trae-inspector-start-line":"459","trae-inspector-start-column":"20","trae-inspector-end-line":"505","trae-inspector-end-column":"26","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"mt-6",children:[_.jsxs("div",{"trae-inspector-start-line":"460","trae-inspector-start-column":"22","trae-inspector-end-line":"470","trae-inspector-end-column":"28","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex justify-between items-center mb-4",children:[_.jsxs("h4",{"trae-inspector-start-line":"461","trae-inspector-start-column":"24","trae-inspector-end-line":"461","trae-inspector-end-column":"116","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"font-medium text-gray-900",children:["Extracted Answers (",pe.length,")"]}),_.jsxs("button",{"trae-inspector-start-line":"462","trae-inspector-start-column":"24","trae-inspector-end-line":"469","trae-inspector-end-column":"33","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:Ne,disabled:A,className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 text-sm",children:[_.jsx(oI,{className:"h-4 w-4"}),_.jsx("span",{"trae-inspector-start-line":"468","trae-inspector-start-column":"26","trae-inspector-end-line":"468","trae-inspector-end-column":"101","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:A?"Matching & Saving...":"Match & Save Answers"})]})]}),_.jsx("div",{"trae-inspector-start-line":"472","trae-inspector-start-column":"22","trae-inspector-end-line":"504","trae-inspector-end-column":"28","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"space-y-4 max-h-[50vh] overflow-y-auto pr-2",children:pe.map((ce,Oe)=>_.jsxs("div",{"trae-inspector-start-line":"474","trae-inspector-start-column":"26","trae-inspector-end-line":"502","trae-inspector-end-column":"32","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[_.jsxs("div",{"trae-inspector-start-line":"475","trae-inspector-start-column":"28","trae-inspector-end-line":"488","trae-inspector-end-column":"34","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex justify-between items-start mb-2",children:[_.jsxs("div",{"trae-inspector-start-line":"476","trae-inspector-start-column":"30","trae-inspector-end-line":"481","trae-inspector-end-column":"36","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-center space-x-2",children:[_.jsxs("span",{"trae-inspector-start-line":"477","trae-inspector-start-column":"32","trae-inspector-end-line":"479","trae-inspector-end-column":"39","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-purple-100 text-purple-800 text-xs font-bold px-2 py-1 rounded",children:["#",ce.number]}),_.jsx("span",{"trae-inspector-start-line":"480","trae-inspector-start-column":"32","trae-inspector-end-line":"480","trae-inspector-end-column":"102","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Detected%20Answer%20Section%22%2C%22textStartLine%22%3A%22480%22%2C%22textStartColumn%22%3A%2272%22%2C%22textEndLine%22%3A%22480%22%2C%22textEndColumn%22%3A%2295%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-xs text-gray-500",children:"Detected Answer Section"})]}),_.jsx("button",{"trae-inspector-start-line":"482","trae-inspector-start-column":"30","trae-inspector-end-line":"487","trae-inspector-end-column":"39","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:()=>dt(Oe),className:"text-red-500 hover:text-red-700",children:_.jsx(pg,{className:"h-4 w-4"})})]}),ce.imageBlob?_.jsx("div",{"trae-inspector-start-line":"492","trae-inspector-start-column":"30","trae-inspector-end-line":"498","trae-inspector-end-column":"36","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"border border-purple-200 rounded p-2 bg-white flex justify-center",children:_.jsx("img",{"trae-inspector-start-line":"493","trae-inspector-start-column":"32","trae-inspector-end-line":"497","trae-inspector-end-column":"34","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",src:URL.createObjectURL(ce.imageBlob),alt:`Answer ${ce.number}`,className:"max-w-full max-h-64 object-contain"})}):_.jsx("div",{"trae-inspector-start-line":"500","trae-inspector-start-column":"31","trae-inspector-end-line":"500","trae-inspector-end-column":"101","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22No%20image%20extracted%22%2C%22textStartLine%22%3A%22500%22%2C%22textStartColumn%22%3A%2277%22%2C%22textEndLine%22%3A%22500%22%2C%22textEndColumn%22%3A%2295%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-sm text-gray-500 italic",children:"No image extracted"})]},Oe))})]})]})]})})]})}),_.jsx(C0,{isOpen:u,onClose:()=>d(!1),title:C?"Edit Question":"Add New Question (Manual)",children:_.jsxs("form",{"trae-inspector-start-line":"520","trae-inspector-start-column":"8","trae-inspector-end-line":"611","trae-inspector-end-column":"15","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onSubmit:fe,className:"space-y-4",children:[_.jsxs("div",{"trae-inspector-start-line":"521","trae-inspector-start-column":"10","trae-inspector-end-line":"544","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"grid grid-cols-2 gap-4",children:[_.jsxs("div",{"trae-inspector-start-line":"522","trae-inspector-start-column":"12","trae-inspector-end-line":"532","trae-inspector-end-column":"18","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("label",{"trae-inspector-start-line":"523","trae-inspector-start-column":"14","trae-inspector-end-line":"523","trae-inspector-end-column":"95","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Question%20Title%22%2C%22textStartLine%22%3A%22523%22%2C%22textStartColumn%22%3A%2273%22%2C%22textEndLine%22%3A%22523%22%2C%22textEndColumn%22%3A%2287%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700",children:"Question Title"}),_.jsx("input",{"trae-inspector-start-line":"524","trae-inspector-start-column":"14","trae-inspector-end-line":"531","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"text",required:!0,value:P,onChange:ce=>O(ce.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Question 1"})]}),_.jsxs("div",{"trae-inspector-start-line":"533","trae-inspector-start-column":"12","trae-inspector-end-line":"543","trae-inspector-end-column":"18","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("label",{"trae-inspector-start-line":"534","trae-inspector-start-column":"14","trae-inspector-end-line":"534","trae-inspector-end-column":"86","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Marks%22%2C%22textStartLine%22%3A%22534%22%2C%22textStartColumn%22%3A%2273%22%2C%22textEndLine%22%3A%22534%22%2C%22textEndColumn%22%3A%2278%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700",children:"Marks"}),_.jsx("input",{"trae-inspector-start-line":"535","trae-inspector-start-column":"14","trae-inspector-end-line":"542","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"number",required:!0,min:"0",value:N,onChange:ce=>V(parseInt(ce.target.value)),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]}),_.jsxs("div",{"trae-inspector-start-line":"546","trae-inspector-start-column":"10","trae-inspector-end-line":"556","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("label",{"trae-inspector-start-line":"547","trae-inspector-start-column":"12","trae-inspector-end-line":"547","trae-inspector-end-column":"84","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Order%22%2C%22textStartLine%22%3A%22547%22%2C%22textStartColumn%22%3A%2271%22%2C%22textEndLine%22%3A%22547%22%2C%22textEndColumn%22%3A%2276%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700",children:"Order"}),_.jsx("input",{"trae-inspector-start-line":"548","trae-inspector-start-column":"12","trae-inspector-end-line":"555","trae-inspector-end-column":"14","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"number",required:!0,min:"1",value:z,onChange:ce=>H(parseInt(ce.target.value)),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),_.jsxs("div",{"trae-inspector-start-line":"558","trae-inspector-start-column":"10","trae-inspector-end-line":"574","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsxs("label",{"trae-inspector-start-line":"559","trae-inspector-start-column":"12","trae-inspector-end-line":"559","trae-inspector-end-column":"174","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700",children:["Question Image ",C?"(Optional - Leave empty to keep existing)":"(Required)"]}),_.jsx("div",{"trae-inspector-start-line":"560","trae-inspector-start-column":"12","trae-inspector-end-line":"573","trae-inspector-end-column":"18","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md",children:_.jsxs("div",{"trae-inspector-start-line":"561","trae-inspector-start-column":"14","trae-inspector-end-line":"572","trae-inspector-end-column":"20","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"space-y-1 text-center",children:[_.jsx(LB,{className:"mx-auto h-12 w-12 text-gray-400"}),_.jsxs("div",{"trae-inspector-start-line":"563","trae-inspector-start-column":"16","trae-inspector-end-line":"569","trae-inspector-end-column":"22","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex text-sm text-gray-600",children:[_.jsxs("label",{"trae-inspector-start-line":"564","trae-inspector-start-column":"18","trae-inspector-end-line":"567","trae-inspector-end-column":"26","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",htmlFor:"content-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500",children:[_.jsx("span",{"trae-inspector-start-line":"565","trae-inspector-start-column":"20","trae-inspector-end-line":"565","trae-inspector-end-column":"46","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Upload%20a%20file%22%2C%22textStartLine%22%3A%22565%22%2C%22textStartColumn%22%3A%2226%22%2C%22textEndLine%22%3A%22565%22%2C%22textEndColumn%22%3A%2239%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:"Upload a file"}),_.jsx("input",{"trae-inspector-start-line":"566","trae-inspector-start-column":"20","trae-inspector-end-line":"566","trae-inspector-end-column":"226","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",id:"content-upload",name:"content-upload",type:"file",className:"sr-only",accept:"image/*",onChange:ce=>D(ce.target.files?ce.target.files[0]:null),required:!C})]}),_.jsx("p",{"trae-inspector-start-line":"568","trae-inspector-start-column":"18","trae-inspector-end-line":"568","trae-inspector-end-column":"58","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22or%20drag%20and%20drop%22%2C%22textStartLine%22%3A%22568%22%2C%22textStartColumn%22%3A%2238%22%2C%22textEndLine%22%3A%22568%22%2C%22textEndColumn%22%3A%2254%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"pl-1",children:"or drag and drop"})]}),_.jsx("p",{"trae-inspector-start-line":"570","trae-inspector-start-column":"16","trae-inspector-end-line":"570","trae-inspector-end-column":"75","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22PNG%2C%20JPG%20up%20to%205MB%22%2C%22textStartLine%22%3A%22570%22%2C%22textStartColumn%22%3A%2253%22%2C%22textEndLine%22%3A%22570%22%2C%22textEndColumn%22%3A%2271%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-xs text-gray-500",children:"PNG, JPG up to 5MB"}),R&&_.jsx("p",{"trae-inspector-start-line":"571","trae-inspector-start-column":"32","trae-inspector-end-line":"571","trae-inspector-end-column":"106","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-sm text-green-600 font-semibold",children:R.name})]})})]}),_.jsxs("div",{"trae-inspector-start-line":"576","trae-inspector-start-column":"10","trae-inspector-end-line":"584","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("label",{"trae-inspector-start-line":"577","trae-inspector-start-column":"12","trae-inspector-end-line":"577","trae-inspector-end-column":"102","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Answer%20Image%20(Optional)%22%2C%22textStartLine%22%3A%22577%22%2C%22textStartColumn%22%3A%2271%22%2C%22textEndLine%22%3A%22577%22%2C%22textEndColumn%22%3A%2294%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700",children:"Answer Image (Optional)"}),_.jsx("input",{"trae-inspector-start-line":"578","trae-inspector-start-column":"12","trae-inspector-end-line":"583","trae-inspector-end-column":"14","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"file",accept:"image/*",onChange:ce=>U(ce.target.files?ce.target.files[0]:null),className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]}),_.jsxs("div",{"trae-inspector-start-line":"586","trae-inspector-start-column":"10","trae-inspector-end-line":"600","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("label",{"trae-inspector-start-line":"587","trae-inspector-start-column":"12","trae-inspector-end-line":"587","trae-inspector-end-column":"108","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Video%20Solution%20URL%20(Optional)%22%2C%22textStartLine%22%3A%22587%22%2C%22textStartColumn%22%3A%2271%22%2C%22textEndLine%22%3A%22587%22%2C%22textEndColumn%22%3A%22100%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700",children:"Video Solution URL (Optional)"}),_.jsxs("div",{"trae-inspector-start-line":"588","trae-inspector-start-column":"12","trae-inspector-end-line":"599","trae-inspector-end-column":"18","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"mt-1 flex rounded-md shadow-sm",children:[_.jsx("span",{"trae-inspector-start-line":"589","trae-inspector-start-column":"14","trae-inspector-end-line":"591","trae-inspector-end-column":"21","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22https%3A%2F%2F%22%2C%22textStartLine%22%3A%22589%22%2C%22textStartColumn%22%3A%22142%22%2C%22textEndLine%22%3A%22591%22%2C%22textEndColumn%22%3A%2214%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm",children:"https://"}),_.jsx("input",{"trae-inspector-start-line":"592","trae-inspector-start-column":"14","trae-inspector-end-line":"598","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"url",value:j,onChange:ce=>G(ce.target.value),className:"focus:ring-blue-500 focus:border-blue-500 flex-1 block w-full rounded-none rounded-r-md sm:text-sm border-gray-300 py-2 px-3 border",placeholder:"youtube.com/watch?v=..."})]})]}),_.jsx("div",{"trae-inspector-start-line":"602","trae-inspector-start-column":"10","trae-inspector-end-line":"610","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"mt-5 sm:mt-6",children:_.jsx("button",{"trae-inspector-start-line":"603","trae-inspector-start-column":"12","trae-inspector-end-line":"609","trae-inspector-end-column":"21","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"submit",disabled:A,className:`w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:text-sm ${A?"opacity-75 cursor-not-allowed":""}`,children:A?"Saving Question...":"Save Question"})})]})}),h&&_.jsx("div",{"trae-inspector-start-line":"616","trae-inspector-start-column":"8","trae-inspector-end-line":"721","trae-inspector-end-column":"14","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"fixed inset-0 z-[60] overflow-y-auto",children:_.jsxs("div",{"trae-inspector-start-line":"617","trae-inspector-start-column":"10","trae-inspector-end-line":"720","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[_.jsx("div",{"trae-inspector-start-line":"618","trae-inspector-start-column":"12","trae-inspector-end-line":"620","trae-inspector-end-column":"18","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:_.jsx("div",{"trae-inspector-start-line":"619","trae-inspector-start-column":"14","trae-inspector-end-line":"619","trae-inspector-end-column":"77","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"absolute inset-0 bg-gray-500 opacity-75"})}),_.jsx("span",{"trae-inspector-start-line":"621","trae-inspector-start-column":"12","trae-inspector-end-line":"621","trae-inspector-end-column":"114","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22%E2%80%8B%22%2C%22textStartLine%22%3A%22621%22%2C%22textStartColumn%22%3A%22100%22%2C%22textEndLine%22%3A%22621%22%2C%22textEndColumn%22%3A%22107%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),_.jsx("div",{"trae-inspector-start-line":"622","trae-inspector-start-column":"12","trae-inspector-end-line":"719","trae-inspector-end-column":"18","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:_.jsxs("div",{"trae-inspector-start-line":"623","trae-inspector-start-column":"14","trae-inspector-end-line":"718","trae-inspector-end-column":"20","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[_.jsxs("div",{"trae-inspector-start-line":"624","trae-inspector-start-column":"16","trae-inspector-end-line":"629","trae-inspector-end-column":"22","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex justify-between items-center mb-6",children:[_.jsx("h3",{"trae-inspector-start-line":"625","trae-inspector-start-column":"18","trae-inspector-end-line":"625","trae-inspector-end-column":"93","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Bulk%20Upload%20from%20PDF%22%2C%22textStartLine%22%3A%22625%22%2C%22textStartColumn%22%3A%2268%22%2C%22textEndLine%22%3A%22625%22%2C%22textEndColumn%22%3A%2288%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-lg font-medium text-gray-900",children:"Bulk Upload from PDF"}),_.jsx("button",{"trae-inspector-start-line":"626","trae-inspector-start-column":"18","trae-inspector-end-line":"628","trae-inspector-end-column":"27","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-500",children:_.jsx(pg,{className:"h-6 w-6"})})]}),_.jsxs("div",{"trae-inspector-start-line":"631","trae-inspector-start-column":"16","trae-inspector-end-line":"717","trae-inspector-end-column":"22","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"space-y-6",children:[_.jsxs("div",{"trae-inspector-start-line":"633","trae-inspector-start-column":"18","trae-inspector-end-line":"648","trae-inspector-end-column":"24","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:bg-gray-50 transition-colors",children:[_.jsx("input",{"trae-inspector-start-line":"634","trae-inspector-start-column":"20","trae-inspector-end-line":"640","trae-inspector-end-column":"22","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"file",accept:".pdf",onChange:De,className:"hidden",id:"bulk-upload"}),_.jsxs("label",{"trae-inspector-start-line":"641","trae-inspector-start-column":"20","trae-inspector-end-line":"647","trae-inspector-end-column":"28","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",htmlFor:"bulk-upload",className:"cursor-pointer block",children:[_.jsx(lI,{className:"mx-auto h-12 w-12 text-gray-400"}),_.jsx("p",{"trae-inspector-start-line":"643","trae-inspector-start-column":"22","trae-inspector-end-line":"645","trae-inspector-end-column":"26","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"mt-2 text-sm text-gray-600",children:$?$.name:"Click to upload Exam PDF"}),_.jsx("p",{"trae-inspector-start-line":"646","trae-inspector-start-column":"22","trae-inspector-end-line":"646","trae-inspector-end-column":"98","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22PDFs%20with%20selectable%20text%20only%22%2C%22textStartLine%22%3A%22646%22%2C%22textStartColumn%22%3A%2264%22%2C%22textEndLine%22%3A%22646%22%2C%22textEndColumn%22%3A%2294%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-xs text-gray-500 mt-1",children:"PDFs with selectable text only"})]})]}),we&&_.jsx("div",{"trae-inspector-start-line":"651","trae-inspector-start-column":"20","trae-inspector-end-line":"653","trae-inspector-end-column":"26","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Parsing%20PDF...%20Please%20wait.%22%2C%22textStartLine%22%3A%22651%22%2C%22textStartColumn%22%3A%2280%22%2C%22textEndLine%22%3A%22653%22%2C%22textEndColumn%22%3A%2220%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-center py-4 text-blue-600 font-medium",children:"Parsing PDF... Please wait."}),xe.length>0&&_.jsxs("div",{"trae-inspector-start-line":"658","trae-inspector-start-column":"20","trae-inspector-end-line":"715","trae-inspector-end-column":"26","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"mt-6",children:[_.jsxs("div",{"trae-inspector-start-line":"659","trae-inspector-start-column":"22","trae-inspector-end-line":"669","trae-inspector-end-column":"28","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex justify-between items-center mb-4",children:[_.jsxs("h4",{"trae-inspector-start-line":"660","trae-inspector-start-column":"24","trae-inspector-end-line":"660","trae-inspector-end-column":"120","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"font-medium text-gray-900",children:["Extracted Questions (",xe.length,")"]}),_.jsxs("button",{"trae-inspector-start-line":"661","trae-inspector-start-column":"24","trae-inspector-end-line":"668","trae-inspector-end-column":"33","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:Me,disabled:A,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 text-sm",children:[_.jsx(oI,{className:"h-4 w-4"}),_.jsx("span",{"trae-inspector-start-line":"667","trae-inspector-start-column":"26","trae-inspector-end-line":"667","trae-inspector-end-column":"90","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:A?"Saving...":"Save All to Database"})]})]}),_.jsx("div",{"trae-inspector-start-line":"671","trae-inspector-start-column":"22","trae-inspector-end-line":"714","trae-inspector-end-column":"28","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"space-y-4 max-h-[50vh] overflow-y-auto pr-2",children:xe.map((ce,Oe)=>_.jsxs("div",{"trae-inspector-start-line":"673","trae-inspector-start-column":"26","trae-inspector-end-line":"712","trae-inspector-end-column":"32","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[_.jsxs("div",{"trae-inspector-start-line":"674","trae-inspector-start-column":"28","trae-inspector-end-line":"694","trae-inspector-end-column":"34","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex justify-between items-start mb-2",children:[_.jsxs("div",{"trae-inspector-start-line":"675","trae-inspector-start-column":"30","trae-inspector-end-line":"687","trae-inspector-end-column":"36","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-center space-x-2",children:[_.jsxs("span",{"trae-inspector-start-line":"676","trae-inspector-start-column":"32","trae-inspector-end-line":"678","trae-inspector-end-column":"39","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-blue-100 text-blue-800 text-xs font-bold px-2 py-1 rounded",children:["#",ce.number]}),_.jsx("input",{"trae-inspector-start-line":"679","trae-inspector-start-column":"32","trae-inspector-end-line":"685","trae-inspector-end-column":"34","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"number",value:ce.marks,onChange:Zt=>Gt(Oe,"marks",parseInt(Zt.target.value)),className:"w-20 text-xs border-gray-300 rounded p-1",placeholder:"Marks"}),_.jsx("span",{"trae-inspector-start-line":"686","trae-inspector-start-column":"32","trae-inspector-end-line":"686","trae-inspector-end-column":"84","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22marks%22%2C%22textStartLine%22%3A%22686%22%2C%22textStartColumn%22%3A%2272%22%2C%22textEndLine%22%3A%22686%22%2C%22textEndColumn%22%3A%2277%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-xs text-gray-500",children:"marks"})]}),_.jsx("button",{"trae-inspector-start-line":"688","trae-inspector-start-column":"30","trae-inspector-end-line":"693","trae-inspector-end-column":"39","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:()=>et(Oe),className:"text-red-500 hover:text-red-700",children:_.jsx(pg,{className:"h-4 w-4"})})]}),ce.imageBlob?_.jsx("div",{"trae-inspector-start-line":"698","trae-inspector-start-column":"30","trae-inspector-end-line":"704","trae-inspector-end-column":"36","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"border border-gray-300 rounded p-2 bg-white flex justify-center",children:_.jsx("img",{"trae-inspector-start-line":"699","trae-inspector-start-column":"32","trae-inspector-end-line":"703","trae-inspector-end-column":"34","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",src:URL.createObjectURL(ce.imageBlob),alt:`Question ${ce.number}`,className:"max-w-full max-h-64 object-contain"})}):_.jsx("textarea",{"trae-inspector-start-line":"706","trae-inspector-start-column":"31","trae-inspector-end-line":"710","trae-inspector-end-column":"32","trae-inspector-file-path":"src/components/QuestionManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",value:ce.text,onChange:Zt=>Gt(Oe,"text",Zt.target.value),className:"w-full text-sm border-gray-300 rounded p-2 h-24 font-serif"})]},Oe))})]})]})]})})]})})]})},kS=({type:s,title:e})=>{const{user:t}=b0(),[n,r]=q.useState([]),[i,o]=q.useState(""),[u,d]=q.useState([]),[h,f]=q.useState(""),[g,w]=q.useState(""),[A,F]=q.useState([]),[C,S]=q.useState(!1);q.useEffect(()=>{h&&S(!1)},[h]),q.useEffect(()=>{!g&&!h?S(!1):g&&!h&&S(!0)},[g,h]);const[P,O]=q.useState(!1),[N,V]=q.useState(!1),[z,H]=q.useState(!1),[R,D]=q.useState(null),[L,U]=q.useState(""),[j,G]=q.useState(new Date().getFullYear()),[$,ge]=q.useState(null);q.useEffect(()=>{(async()=>{try{const fe=await l2();r(fe),fe.length>0&&o(fe[0].universityId)}catch(fe){console.error("Error fetching universities:",fe)}})()},[]),q.useEffect(()=>{i&&(async()=>{try{const fe=await jN(i);d(fe),f(""),w(""),F([])}catch(fe){console.error("Error fetching modules:",fe)}})()},[i]),q.useEffect(()=>{i&&h&&xe()},[i,h,s]);const xe=async()=>{O(!0);try{const Y=await Jz(i,h,s);F(Y)}catch(Y){console.error("Error fetching assessments:",Y)}finally{O(!1)}},ye=()=>{U(""),G(new Date().getFullYear()),ge(null),V(!0)},pe=async Y=>{if(Y.preventDefault(),!(!i||!h||!t)){H(!0);try{await tH(i,h,s,L,j,t.email||"Admin",$),V(!1),xe()}catch(fe){console.error("Error saving assessment:",fe)}finally{H(!1)}}},ie=async Y=>{if(window.confirm("Are you sure you want to delete this assessment?"))try{await nH(Y),xe()}catch(fe){console.error("Error deleting assessment:",fe)}},we=g?u.filter(Y=>Y.code.toLowerCase().includes(g.toLowerCase())||Y.name.toLowerCase().includes(g.toLowerCase())):[],de=Y=>{f(Y),w(""),S(!1)},K=()=>{f(""),w(""),F([]),S(!1)};return _.jsxs("div",{"trae-inspector-start-line":"167","trae-inspector-start-column":"4","trae-inspector-end-line":"373","trae-inspector-end-column":"10","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[R?_.jsx(rq,{assessmentId:R.assessmentId,assessmentTitle:R.title,onClose:()=>D(null)}):null,_.jsxs("div",{"trae-inspector-start-line":"176","trae-inspector-start-column":"6","trae-inspector-end-line":"186","trae-inspector-end-column":"12","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex justify-between items-center mb-6",children:[_.jsx("h1",{"trae-inspector-start-line":"177","trae-inspector-start-column":"8","trae-inspector-end-line":"177","trae-inspector-end-column":"69","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-2xl font-bold text-gray-900",children:e}),_.jsxs("button",{"trae-inspector-start-line":"178","trae-inspector-start-column":"8","trae-inspector-end-line":"185","trae-inspector-end-column":"17","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:ye,disabled:!i||!h,className:`bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 ${!i||!h?"opacity-50 cursor-not-allowed":""}`,children:[_.jsx(l0,{className:"h-5 w-5"}),_.jsxs("span",{"trae-inspector-start-line":"184","trae-inspector-start-column":"10","trae-inspector-end-line":"184","trae-inspector-end-column":"50","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:["Create ",e.slice(0,-1)]})]})]}),_.jsx("div",{"trae-inspector-start-line":"188","trae-inspector-start-column":"6","trae-inspector-end-line":"252","trae-inspector-end-column":"12","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-white rounded-xl shadow-sm mb-6",children:_.jsxs("div",{"trae-inspector-start-line":"189","trae-inspector-start-column":"8","trae-inspector-end-line":"251","trae-inspector-end-column":"14","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"p-4 border-b border-gray-100 flex items-center space-x-4",children:[_.jsxs("div",{"trae-inspector-start-line":"190","trae-inspector-start-column":"10","trae-inspector-end-line":"203","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex-1",children:[_.jsx("label",{"trae-inspector-start-line":"191","trae-inspector-start-column":"12","trae-inspector-end-line":"191","trae-inspector-end-column":"101","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Select%20University%22%2C%22textStartLine%22%3A%22191%22%2C%22textStartColumn%22%3A%2276%22%2C%22textEndLine%22%3A%22191%22%2C%22textEndColumn%22%3A%2293%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select University"}),_.jsx("select",{"trae-inspector-start-line":"192","trae-inspector-start-column":"12","trae-inspector-end-line":"202","trae-inspector-end-column":"21","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",value:i,onChange:Y=>o(Y.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md border",children:n.map(Y=>_.jsxs("option",{"trae-inspector-start-line":"198","trae-inspector-start-column":"16","trae-inspector-end-line":"200","trae-inspector-end-column":"25","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",value:Y.universityId,children:[Y.name," (",Y.code,")"]},Y.universityId))})]}),_.jsxs("div",{"trae-inspector-start-line":"204","trae-inspector-start-column":"10","trae-inspector-end-line":"250","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex-1",children:[_.jsx("label",{"trae-inspector-start-line":"205","trae-inspector-start-column":"12","trae-inspector-end-line":"205","trae-inspector-end-column":"97","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Search%20Module%22%2C%22textStartLine%22%3A%22205%22%2C%22textStartColumn%22%3A%2276%22%2C%22textEndLine%22%3A%22205%22%2C%22textEndColumn%22%3A%2289%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Module"}),h?_.jsxs("div",{"trae-inspector-start-line":"207","trae-inspector-start-column":"17","trae-inspector-end-line":"210","trae-inspector-end-column":"23","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"p-2 bg-blue-50 text-blue-800 rounded text-sm flex justify-between items-center border border-blue-200",children:[_.jsxs("span",{"trae-inspector-start-line":"208","trae-inspector-start-column":"19","trae-inspector-end-line":"208","trae-inspector-end-column":"77","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:["Selected: ",_.jsx("strong",{"trae-inspector-start-line":"208","trae-inspector-start-column":"35","trae-inspector-end-line":"208","trae-inspector-end-column":"70","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:h})]}),_.jsx("button",{"trae-inspector-start-line":"209","trae-inspector-start-column":"19","trae-inspector-end-line":"209","trae-inspector-end-column":"131","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Change%22%2C%22textStartLine%22%3A%22209%22%2C%22textStartColumn%22%3A%22116%22%2C%22textEndLine%22%3A%22209%22%2C%22textEndColumn%22%3A%22122%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:K,className:"text-blue-500 hover:text-blue-700 font-medium",children:"Change"})]}):_.jsxs("div",{"trae-inspector-start-line":"212","trae-inspector-start-column":"16","trae-inspector-end-line":"248","trae-inspector-end-column":"22","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"relative",children:[_.jsx("input",{"trae-inspector-start-line":"213","trae-inspector-start-column":"18","trae-inspector-end-line":"227","trae-inspector-end-column":"20","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"text",placeholder:"Type to search (e.g. SMTH011)...",value:g,onChange:Y=>{w(Y.target.value),S(!0)},onFocus:()=>{we.length>0&&S(!0)},className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),C&&_.jsx("div",{"trae-inspector-start-line":"230","trae-inspector-start-column":"20","trae-inspector-end-line":"246","trae-inspector-end-column":"26","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm",children:we.length===0?_.jsx("div",{"trae-inspector-start-line":"232","trae-inspector-start-column":"24","trae-inspector-end-line":"234","trae-inspector-end-column":"30","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"cursor-default select-none relative py-2 px-4 text-gray-500 italic",children:g?"No matching modules found":"Type to search..."}):we.map(Y=>_.jsxs("div",{"trae-inspector-start-line":"237","trae-inspector-start-column":"26","trae-inspector-end-line":"243","trae-inspector-end-column":"32","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"cursor-pointer select-none relative py-2 px-4 hover:bg-blue-50 text-gray-900",onClick:()=>de(Y.code),children:[_.jsx("span",{"trae-inspector-start-line":"242","trae-inspector-start-column":"28","trae-inspector-end-line":"242","trae-inspector-end-column":"75","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"font-medium",children:Y.code})," - ",Y.name]},Y.moduleId))})]})]})]})}),_.jsx("div",{"trae-inspector-start-line":"254","trae-inspector-start-column":"6","trae-inspector-end-line":"323","trae-inspector-end-column":"12","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-white rounded-xl shadow-sm overflow-hidden",children:_.jsx("div",{"trae-inspector-start-line":"255","trae-inspector-start-column":"8","trae-inspector-end-line":"322","trae-inspector-end-column":"14","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"overflow-x-auto",children:_.jsxs("table",{"trae-inspector-start-line":"256","trae-inspector-start-column":"10","trae-inspector-end-line":"321","trae-inspector-end-column":"18","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"w-full",children:[_.jsx("thead",{"trae-inspector-start-line":"257","trae-inspector-start-column":"12","trae-inspector-end-line":"264","trae-inspector-end-column":"20","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-gray-50 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:_.jsxs("tr",{"trae-inspector-start-line":"258","trae-inspector-start-column":"14","trae-inspector-end-line":"263","trae-inspector-end-column":"19","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("th",{"trae-inspector-start-line":"259","trae-inspector-start-column":"16","trae-inspector-end-line":"259","trae-inspector-end-column":"51","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Year%22%2C%22textStartLine%22%3A%22259%22%2C%22textStartColumn%22%3A%2242%22%2C%22textEndLine%22%3A%22259%22%2C%22textEndColumn%22%3A%2246%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3",children:"Year"}),_.jsx("th",{"trae-inspector-start-line":"260","trae-inspector-start-column":"16","trae-inspector-end-line":"260","trae-inspector-end-column":"52","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Title%22%2C%22textStartLine%22%3A%22260%22%2C%22textStartColumn%22%3A%2242%22%2C%22textEndLine%22%3A%22260%22%2C%22textEndColumn%22%3A%2247%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3",children:"Title"}),_.jsx("th",{"trae-inspector-start-line":"261","trae-inspector-start-column":"16","trae-inspector-end-line":"261","trae-inspector-end-column":"54","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Content%22%2C%22textStartLine%22%3A%22261%22%2C%22textStartColumn%22%3A%2242%22%2C%22textEndLine%22%3A%22261%22%2C%22textEndColumn%22%3A%2249%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3",children:"Content"}),_.jsx("th",{"trae-inspector-start-line":"262","trae-inspector-start-column":"16","trae-inspector-end-line":"262","trae-inspector-end-column":"65","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Actions%22%2C%22textStartLine%22%3A%22262%22%2C%22textStartColumn%22%3A%2253%22%2C%22textEndLine%22%3A%22262%22%2C%22textEndColumn%22%3A%2260%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3 text-right",children:"Actions"})]})}),_.jsx("tbody",{"trae-inspector-start-line":"265","trae-inspector-start-column":"12","trae-inspector-end-line":"320","trae-inspector-end-column":"20","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"divide-y divide-gray-100",children:P?_.jsx("tr",{"trae-inspector-start-line":"267","trae-inspector-start-column":"16","trae-inspector-end-line":"269","trae-inspector-end-column":"21","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:_.jsx("td",{"trae-inspector-start-line":"268","trae-inspector-start-column":"18","trae-inspector-end-line":"268","trae-inspector-end-column":"97","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Loading...%22%2C%22textStartLine%22%3A%22268%22%2C%22textStartColumn%22%3A%2282%22%2C%22textEndLine%22%3A%22268%22%2C%22textEndColumn%22%3A%2292%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",colSpan:4,className:"px-6 py-4 text-center text-gray-500",children:"Loading..."})}):A.length===0?_.jsx("tr",{"trae-inspector-start-line":"271","trae-inspector-start-column":"16","trae-inspector-end-line":"275","trae-inspector-end-column":"21","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:_.jsx("td",{"trae-inspector-start-line":"272","trae-inspector-start-column":"18","trae-inspector-end-line":"274","trae-inspector-end-column":"23","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",colSpan:4,className:"px-6 py-4 text-center text-gray-500",children:h?"No assessments found":"Please select a module"})}):A.map(Y=>_.jsxs("tr",{"trae-inspector-start-line":"278","trae-inspector-start-column":"18","trae-inspector-end-line":"317","trae-inspector-end-column":"23","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"hover:bg-gray-50",children:[_.jsx("td",{"trae-inspector-start-line":"279","trae-inspector-start-column":"20","trae-inspector-end-line":"279","trae-inspector-end-column":"90","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4 text-sm text-gray-900",children:Y.year}),_.jsx("td",{"trae-inspector-start-line":"280","trae-inspector-start-column":"20","trae-inspector-end-line":"285","trae-inspector-end-column":"25","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4",children:_.jsxs("div",{"trae-inspector-start-line":"281","trae-inspector-start-column":"22","trae-inspector-end-line":"284","trae-inspector-end-column":"28","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-center space-x-2",children:[_.jsx(Hm,{className:"h-4 w-4 text-blue-500"}),_.jsx("span",{"trae-inspector-start-line":"283","trae-inspector-start-column":"24","trae-inspector-end-line":"283","trae-inspector-end-column":"101","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-sm font-medium text-gray-900",children:Y.title})]})}),_.jsx("td",{"trae-inspector-start-line":"286","trae-inspector-start-column":"20","trae-inspector-end-line":"307","trae-inspector-end-column":"25","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4 text-sm text-gray-500",children:_.jsxs("div",{"trae-inspector-start-line":"287","trae-inspector-start-column":"22","trae-inspector-end-line":"306","trae-inspector-end-column":"28","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex space-x-4",children:[Y.pdfUrl&&_.jsxs("a",{"trae-inspector-start-line":"289","trae-inspector-start-column":"26","trae-inspector-end-line":"297","trae-inspector-end-column":"30","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",href:Y.pdfUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-red-600 hover:text-red-900 text-xs",title:"Download PDF",children:[_.jsx(Hm,{className:"h-4 w-4 mr-1"})," PDF"]}),_.jsxs("button",{"trae-inspector-start-line":"299","trae-inspector-start-column":"24","trae-inspector-end-line":"305","trae-inspector-end-column":"33","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:()=>D(Y),className:"flex items-center text-blue-600 hover:text-blue-900 text-xs",title:"Manage Questions",children:[_.jsx(UB,{className:"h-4 w-4 mr-1"})," Questions"]})]})}),_.jsx("td",{"trae-inspector-start-line":"308","trae-inspector-start-column":"20","trae-inspector-end-line":"316","trae-inspector-end-column":"25","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4 text-right space-x-2",children:_.jsx("button",{"trae-inspector-start-line":"309","trae-inspector-start-column":"22","trae-inspector-end-line":"315","trae-inspector-end-column":"31","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:()=>ie(Y),className:"text-red-600 hover:text-red-900",title:"Delete Assessment",children:_.jsx(c0,{className:"h-5 w-5"})})})]},Y.assessmentId))})]})})}),_.jsx(C0,{isOpen:N,onClose:()=>V(!1),title:`Create ${e.slice(0,-1)}`,children:_.jsxs("form",{"trae-inspector-start-line":"330","trae-inspector-start-column":"8","trae-inspector-end-line":"371","trae-inspector-end-column":"15","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onSubmit:pe,className:"space-y-4",children:[_.jsxs("div",{"trae-inspector-start-line":"331","trae-inspector-start-column":"10","trae-inspector-end-line":"340","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("label",{"trae-inspector-start-line":"332","trae-inspector-start-column":"12","trae-inspector-end-line":"332","trae-inspector-end-column":"83","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Year%22%2C%22textStartLine%22%3A%22332%22%2C%22textStartColumn%22%3A%2271%22%2C%22textEndLine%22%3A%22332%22%2C%22textEndColumn%22%3A%2275%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700",children:"Year"}),_.jsx("input",{"trae-inspector-start-line":"333","trae-inspector-start-column":"12","trae-inspector-end-line":"339","trae-inspector-end-column":"14","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"number",required:!0,value:j,onChange:Y=>G(parseInt(Y.target.value)),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),_.jsxs("div",{"trae-inspector-start-line":"341","trae-inspector-start-column":"10","trae-inspector-end-line":"351","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("label",{"trae-inspector-start-line":"342","trae-inspector-start-column":"12","trae-inspector-end-line":"342","trae-inspector-end-column":"84","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Title%22%2C%22textStartLine%22%3A%22342%22%2C%22textStartColumn%22%3A%2271%22%2C%22textEndLine%22%3A%22342%22%2C%22textEndColumn%22%3A%2276%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700",children:"Title"}),_.jsx("input",{"trae-inspector-start-line":"343","trae-inspector-start-column":"12","trae-inspector-end-line":"350","trae-inspector-end-column":"14","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"text",required:!0,value:L,onChange:Y=>U(Y.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"e.g. Final Exam, Semester Test 1"})]}),_.jsxs("div",{"trae-inspector-start-line":"352","trae-inspector-start-column":"10","trae-inspector-end-line":"361","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("label",{"trae-inspector-start-line":"353","trae-inspector-start-column":"12","trae-inspector-end-line":"353","trae-inspector-end-column":"104","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Full%20Paper%20PDF%20(Optional)%22%2C%22textStartLine%22%3A%22353%22%2C%22textStartColumn%22%3A%2271%22%2C%22textEndLine%22%3A%22353%22%2C%22textEndColumn%22%3A%2296%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700",children:"Full Paper PDF (Optional)"}),_.jsx("p",{"trae-inspector-start-line":"354","trae-inspector-start-column":"12","trae-inspector-end-line":"354","trae-inspector-end-column":"147","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Upload%20the%20full%20paper%20if%20you%20have%20it%2C%20otherwise%20you%20can%20add%20questions%20individually%20later.%22%2C%22textStartLine%22%3A%22354%22%2C%22textStartColumn%22%3A%2254%22%2C%22textEndLine%22%3A%22354%22%2C%22textEndColumn%22%3A%22143%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-xs text-gray-500 mb-1",children:"Upload the full paper if you have it, otherwise you can add questions individually later."}),_.jsx("input",{"trae-inspector-start-line":"355","trae-inspector-start-column":"12","trae-inspector-end-line":"360","trae-inspector-end-column":"14","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"file",accept:".pdf",onChange:Y=>ge(Y.target.files?Y.target.files[0]:null),className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]}),_.jsx("div",{"trae-inspector-start-line":"362","trae-inspector-start-column":"10","trae-inspector-end-line":"370","trae-inspector-end-column":"16","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"mt-5 sm:mt-6",children:_.jsx("button",{"trae-inspector-start-line":"363","trae-inspector-start-column":"12","trae-inspector-end-line":"369","trae-inspector-end-column":"21","trae-inspector-file-path":"src/components/AssessmentManager.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"submit",disabled:z,className:`w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:text-sm ${z?"opacity-75 cursor-not-allowed":""}`,children:z?"Creating...":"Create Assessment"})})]})})]})},sq=()=>_.jsx(kS,{type:"exam",title:"Exams"}),iq=()=>_.jsx(kS,{type:"test",title:"Tests"}),aq=()=>_.jsx(kS,{type:"supplementary",title:"Supplementary Exams"}),SR="users",TR=async s=>{let e;return s?e=ta(hs(Jt,SR),Eu("universityId","==",s),Pu("createdAt","desc")):e=ta(hs(Jt,SR),Pu("createdAt","desc"),EN(50)),(await np(e)).docs.map(n=>({userId:n.id,...n.data()}))},oq=()=>{const[s,e]=q.useState([]),[t,n]=q.useState([]),[r,i]=q.useState(""),[o,u]=q.useState(!0),[d,h]=q.useState("");q.useEffect(()=>{(async()=>{try{const[A,F]=await Promise.all([l2(),TR()]);n(A),e(F)}catch(A){console.error("Error loading data:",A)}finally{u(!1)}})()},[]),q.useEffect(()=>{(async()=>{u(!0);try{const A=await TR(r||void 0);e(A)}catch(A){console.error("Error fetching users:",A)}finally{u(!1)}})()},[r]);const f=s.filter(w=>w.name.toLowerCase().includes(d.toLowerCase())||w.email.toLowerCase().includes(d.toLowerCase())),g=w=>{const A=t.find(F=>F.universityId===w);return A?A.code:"Unknown"};return _.jsxs("div",{"trae-inspector-start-line":"58","trae-inspector-start-column":"4","trae-inspector-end-line":"167","trae-inspector-end-column":"10","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("h1",{"trae-inspector-start-line":"59","trae-inspector-start-column":"6","trae-inspector-end-line":"59","trae-inspector-end-column":"77","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Manage%20Users%22%2C%22textStartLine%22%3A%2259%22%2C%22textStartColumn%22%3A%2260%22%2C%22textEndLine%22%3A%2259%22%2C%22textEndColumn%22%3A%2272%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-2xl font-bold text-gray-900 mb-6",children:"Manage Users"}),_.jsx("div",{"trae-inspector-start-line":"61","trae-inspector-start-column":"6","trae-inspector-end-line":"94","trae-inspector-end-column":"12","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-white rounded-xl shadow-sm overflow-hidden mb-6",children:_.jsxs("div",{"trae-inspector-start-line":"62","trae-inspector-start-column":"8","trae-inspector-end-line":"93","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"p-4 border-b border-gray-100 flex items-center space-x-4",children:[_.jsxs("div",{"trae-inspector-start-line":"63","trae-inspector-start-column":"10","trae-inspector-end-line":"77","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex-1",children:[_.jsx("label",{"trae-inspector-start-line":"64","trae-inspector-start-column":"12","trae-inspector-end-line":"64","trae-inspector-end-column":"104","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Filter%20by%20University%22%2C%22textStartLine%22%3A%2264%22%2C%22textStartColumn%22%3A%2276%22%2C%22textEndLine%22%3A%2264%22%2C%22textEndColumn%22%3A%2296%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by University"}),_.jsxs("select",{"trae-inspector-start-line":"65","trae-inspector-start-column":"12","trae-inspector-end-line":"76","trae-inspector-end-column":"21","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",value:r,onChange:w=>i(w.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md border",children:[_.jsx("option",{"trae-inspector-start-line":"70","trae-inspector-start-column":"14","trae-inspector-end-line":"70","trae-inspector-end-column":"56","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22All%20Universities%22%2C%22textStartLine%22%3A%2270%22%2C%22textStartColumn%22%3A%2231%22%2C%22textEndLine%22%3A%2270%22%2C%22textEndColumn%22%3A%2247%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",value:"",children:"All Universities"}),t.map(w=>_.jsxs("option",{"trae-inspector-start-line":"72","trae-inspector-start-column":"16","trae-inspector-end-line":"74","trae-inspector-end-column":"25","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",value:w.universityId,children:[w.name," (",w.code,")"]},w.universityId))]})]}),_.jsxs("div",{"trae-inspector-start-line":"78","trae-inspector-start-column":"10","trae-inspector-end-line":"92","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex-1",children:[_.jsx("label",{"trae-inspector-start-line":"79","trae-inspector-start-column":"12","trae-inspector-end-line":"79","trae-inspector-end-column":"96","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Search%20Users%22%2C%22textStartLine%22%3A%2279%22%2C%22textStartColumn%22%3A%2276%22%2C%22textEndLine%22%3A%2279%22%2C%22textEndColumn%22%3A%2288%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Users"}),_.jsxs("div",{"trae-inspector-start-line":"80","trae-inspector-start-column":"12","trae-inspector-end-line":"91","trae-inspector-end-column":"18","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"relative",children:[_.jsx("div",{"trae-inspector-start-line":"81","trae-inspector-start-column":"14","trae-inspector-end-line":"83","trae-inspector-end-column":"20","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:_.jsx(lx,{className:"h-5 w-5 text-gray-400"})}),_.jsx("input",{"trae-inspector-start-line":"84","trae-inspector-start-column":"14","trae-inspector-end-line":"90","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"text",placeholder:"Search by name or email...",value:d,onChange:w=>h(w.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg leading-5 bg-gray-50 placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]})]})}),_.jsx("div",{"trae-inspector-start-line":"96","trae-inspector-start-column":"6","trae-inspector-end-line":"166","trae-inspector-end-column":"12","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-white rounded-xl shadow-sm overflow-hidden",children:_.jsx("div",{"trae-inspector-start-line":"97","trae-inspector-start-column":"8","trae-inspector-end-line":"165","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"overflow-x-auto",children:_.jsxs("table",{"trae-inspector-start-line":"98","trae-inspector-start-column":"10","trae-inspector-end-line":"164","trae-inspector-end-column":"18","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"w-full",children:[_.jsx("thead",{"trae-inspector-start-line":"99","trae-inspector-start-column":"12","trae-inspector-end-line":"107","trae-inspector-end-column":"20","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-gray-50 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:_.jsxs("tr",{"trae-inspector-start-line":"100","trae-inspector-start-column":"14","trae-inspector-end-line":"106","trae-inspector-end-column":"19","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("th",{"trae-inspector-start-line":"101","trae-inspector-start-column":"16","trae-inspector-end-line":"101","trae-inspector-end-column":"51","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22User%22%2C%22textStartLine%22%3A%22101%22%2C%22textStartColumn%22%3A%2242%22%2C%22textEndLine%22%3A%22101%22%2C%22textEndColumn%22%3A%2246%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3",children:"User"}),_.jsx("th",{"trae-inspector-start-line":"102","trae-inspector-start-column":"16","trae-inspector-end-line":"102","trae-inspector-end-column":"57","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22University%22%2C%22textStartLine%22%3A%22102%22%2C%22textStartColumn%22%3A%2242%22%2C%22textEndLine%22%3A%22102%22%2C%22textEndColumn%22%3A%2252%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3",children:"University"}),_.jsx("th",{"trae-inspector-start-line":"103","trae-inspector-start-column":"16","trae-inspector-end-line":"103","trae-inspector-end-column":"53","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Points%22%2C%22textStartLine%22%3A%22103%22%2C%22textStartColumn%22%3A%2242%22%2C%22textEndLine%22%3A%22103%22%2C%22textEndColumn%22%3A%2248%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3",children:"Points"}),_.jsx("th",{"trae-inspector-start-line":"104","trae-inspector-start-column":"16","trae-inspector-end-line":"104","trae-inspector-end-column":"53","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Status%22%2C%22textStartLine%22%3A%22104%22%2C%22textStartColumn%22%3A%2242%22%2C%22textEndLine%22%3A%22104%22%2C%22textEndColumn%22%3A%2248%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3",children:"Status"}),_.jsx("th",{"trae-inspector-start-line":"105","trae-inspector-start-column":"16","trae-inspector-end-line":"105","trae-inspector-end-column":"53","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Joined%22%2C%22textStartLine%22%3A%22105%22%2C%22textStartColumn%22%3A%2242%22%2C%22textEndLine%22%3A%22105%22%2C%22textEndColumn%22%3A%2248%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-3",children:"Joined"})]})}),_.jsx("tbody",{"trae-inspector-start-line":"108","trae-inspector-start-column":"12","trae-inspector-end-line":"163","trae-inspector-end-column":"20","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"divide-y divide-gray-100",children:o?_.jsx("tr",{"trae-inspector-start-line":"110","trae-inspector-start-column":"16","trae-inspector-end-line":"112","trae-inspector-end-column":"21","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:_.jsx("td",{"trae-inspector-start-line":"111","trae-inspector-start-column":"18","trae-inspector-end-line":"111","trae-inspector-end-column":"97","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Loading...%22%2C%22textStartLine%22%3A%22111%22%2C%22textStartColumn%22%3A%2282%22%2C%22textEndLine%22%3A%22111%22%2C%22textEndColumn%22%3A%2292%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:"Loading..."})}):f.length===0?_.jsx("tr",{"trae-inspector-start-line":"114","trae-inspector-start-column":"16","trae-inspector-end-line":"116","trae-inspector-end-column":"21","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:_.jsx("td",{"trae-inspector-start-line":"115","trae-inspector-start-column":"18","trae-inspector-end-line":"115","trae-inspector-end-column":"101","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22No%20users%20found%22%2C%22textStartLine%22%3A%22115%22%2C%22textStartColumn%22%3A%2282%22%2C%22textEndLine%22%3A%22115%22%2C%22textEndColumn%22%3A%2296%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:"No users found"})}):f.map(w=>_.jsxs("tr",{"trae-inspector-start-line":"119","trae-inspector-start-column":"18","trae-inspector-end-line":"160","trae-inspector-end-column":"23","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"hover:bg-gray-50",children:[_.jsx("td",{"trae-inspector-start-line":"120","trae-inspector-start-column":"20","trae-inspector-end-line":"135","trae-inspector-end-column":"25","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4",children:_.jsxs("div",{"trae-inspector-start-line":"121","trae-inspector-start-column":"22","trae-inspector-end-line":"134","trae-inspector-end-column":"28","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-center",children:[_.jsx("div",{"trae-inspector-start-line":"122","trae-inspector-start-column":"24","trae-inspector-end-line":"126","trae-inspector-end-column":"30","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex-shrink-0 h-10 w-10",children:_.jsx("div",{"trae-inspector-start-line":"123","trae-inspector-start-column":"26","trae-inspector-end-line":"125","trae-inspector-end-column":"32","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:_.jsx(JR,{className:"h-6 w-6 text-blue-600"})})}),_.jsxs("div",{"trae-inspector-start-line":"127","trae-inspector-start-column":"24","trae-inspector-end-line":"133","trae-inspector-end-column":"30","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"ml-4",children:[_.jsx("div",{"trae-inspector-start-line":"128","trae-inspector-start-column":"26","trae-inspector-end-line":"128","trae-inspector-end-column":"94","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-sm font-medium text-gray-900",children:w.name}),_.jsxs("div",{"trae-inspector-start-line":"129","trae-inspector-start-column":"26","trae-inspector-end-line":"132","trae-inspector-end-column":"32","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-sm text-gray-500 flex items-center",children:[_.jsx(XR,{className:"h-3 w-3 mr-1"}),w.email]})]})]})}),_.jsx("td",{"trae-inspector-start-line":"136","trae-inspector-start-column":"20","trae-inspector-end-line":"141","trae-inspector-end-column":"25","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4",children:_.jsxs("div",{"trae-inspector-start-line":"137","trae-inspector-start-column":"22","trae-inspector-end-line":"140","trae-inspector-end-column":"28","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-center text-sm text-gray-900",children:[_.jsx(eb,{className:"h-4 w-4 mr-2 text-gray-400"}),g(w.universityId)]})}),_.jsx("td",{"trae-inspector-start-line":"142","trae-inspector-start-column":"20","trae-inspector-end-line":"147","trae-inspector-end-column":"25","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4",children:_.jsxs("div",{"trae-inspector-start-line":"143","trae-inspector-start-column":"22","trae-inspector-end-line":"146","trae-inspector-end-column":"28","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-center text-sm text-gray-900",children:[_.jsx(hB,{className:"h-4 w-4 mr-2 text-yellow-500"}),w.points]})}),_.jsx("td",{"trae-inspector-start-line":"148","trae-inspector-start-column":"20","trae-inspector-end-line":"156","trae-inspector-end-column":"25","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4",children:_.jsx("span",{"trae-inspector-start-line":"149","trae-inspector-start-column":"22","trae-inspector-end-line":"155","trae-inspector-end-column":"29","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${w.subscriptionActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:w.subscriptionActive?"Premium":"Free"})}),_.jsx("td",{"trae-inspector-start-line":"157","trae-inspector-start-column":"20","trae-inspector-end-line":"159","trae-inspector-end-column":"25","trae-inspector-file-path":"src/pages/Users.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"px-6 py-4 text-sm text-gray-500",children:w.createdAt?new Date(w.createdAt.seconds*1e3).toLocaleDateString():"N/A"})]},w.userId))})]})})})]})},lq=()=>_.jsxs("div",{"trae-inspector-start-line":"6","trae-inspector-start-column":"4","trae-inspector-end-line":"20","trae-inspector-end-column":"10","trae-inspector-file-path":"src/pages/Analytics.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"space-y-6",children:[_.jsx("h1",{"trae-inspector-start-line":"7","trae-inspector-start-column":"6","trae-inspector-end-line":"7","trae-inspector-end-column":"78","trae-inspector-file-path":"src/pages/Analytics.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Analytics%20Overview%22%2C%22textStartLine%22%3A%227%22%2C%22textStartColumn%22%3A%2255%22%2C%22textEndLine%22%3A%227%22%2C%22textEndColumn%22%3A%2273%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-2xl font-bold text-gray-900",children:"Analytics Overview"}),_.jsxs("div",{"trae-inspector-start-line":"9","trae-inspector-start-column":"6","trae-inspector-end-line":"19","trae-inspector-end-column":"12","trae-inspector-file-path":"src/pages/Analytics.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-white rounded-xl shadow-sm p-12 text-center",children:[_.jsx("div",{"trae-inspector-start-line":"10","trae-inspector-start-column":"8","trae-inspector-end-line":"14","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Analytics.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex justify-center mb-6",children:_.jsx("div",{"trae-inspector-start-line":"11","trae-inspector-start-column":"10","trae-inspector-end-line":"13","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Analytics.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-blue-100 p-4 rounded-full",children:_.jsx(KR,{className:"h-12 w-12 text-blue-600"})})}),_.jsx("h2",{"trae-inspector-start-line":"15","trae-inspector-start-column":"8","trae-inspector-end-line":"15","trae-inspector-end-column":"85","trae-inspector-file-path":"src/pages/Analytics.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Analytics%20Dashboard%22%2C%22textStartLine%22%3A%2215%22%2C%22textStartColumn%22%3A%2261%22%2C%22textEndLine%22%3A%2215%22%2C%22textEndColumn%22%3A%2280%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-xl font-bold text-gray-900 mb-2",children:"Analytics Dashboard"}),_.jsx("p",{"trae-inspector-start-line":"16","trae-inspector-start-column":"8","trae-inspector-end-line":"18","trae-inspector-end-column":"12","trae-inspector-file-path":"src/pages/Analytics.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Detailed%20usage%20statistics%20and%20engagement%20metrics%20will%20appear%20here%20once%20students%20start%20using%20the%20mobile%20application.%22%2C%22textStartLine%22%3A%2216%22%2C%22textStartColumn%22%3A%2254%22%2C%22textEndLine%22%3A%2218%22%2C%22textEndColumn%22%3A%228%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-gray-500 max-w-md mx-auto",children:"Detailed usage statistics and engagement metrics will appear here once students start using the mobile application."})]})]}),qx="announcements",cq=async()=>{const s=ta(hs(Jt,qx),Pu("createdAt","desc"));return(await np(s)).docs.map(t=>({announcementId:t.id,...t.data()}))},uq=async(s,e,t,n)=>(await E0(hs(Jt,qx),{title:s,message:e,universityId:t,active:n,createdAt:_0()})).id,dq=async(s,e)=>{await Rx(ia(Jt,qx,s),{active:e})},hq=async s=>{await x0(ia(Jt,qx,s))},pq=()=>{const[s,e]=q.useState([]),[t,n]=q.useState([]),[r,i]=q.useState(!0),[o,u]=q.useState(!1),[d,h]=q.useState(!1),[f,g]=q.useState(""),[w,A]=q.useState(""),[F,C]=q.useState(""),[S,P]=q.useState(!0);q.useEffect(()=>{O()},[]);const O=async()=>{try{const[D,L]=await Promise.all([cq(),l2()]);e(D),n(L)}catch(D){console.error("Error fetching data:",D)}finally{i(!1)}},N=()=>{g(""),A(""),C(""),P(!0),u(!0)},V=async D=>{D.preventDefault(),h(!0);try{await uq(f,w,F||"all",S),u(!1),O()}catch(L){console.error("Error creating announcement:",L)}finally{h(!1)}},z=async D=>{try{await dq(D.announcementId,!D.active),O()}catch(L){console.error("Error updating status:",L)}},H=async D=>{if(window.confirm("Are you sure you want to delete this announcement?"))try{await hq(D),O()}catch(L){console.error("Error deleting announcement:",L)}},R=D=>{if(D==="all")return"All Universities";const L=t.find(U=>U.universityId===D);return L?L.name:"Unknown"};return _.jsxs("div",{"trae-inspector-start-line":"89","trae-inspector-start-column":"4","trae-inspector-end-line":"229","trae-inspector-end-column":"10","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsxs("div",{"trae-inspector-start-line":"90","trae-inspector-start-column":"6","trae-inspector-end-line":"99","trae-inspector-end-column":"12","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex justify-between items-center mb-6",children:[_.jsx("h1",{"trae-inspector-start-line":"91","trae-inspector-start-column":"8","trae-inspector-end-line":"91","trae-inspector-end-column":"75","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Announcements%22%2C%22textStartLine%22%3A%2291%22%2C%22textStartColumn%22%3A%2257%22%2C%22textEndLine%22%3A%2291%22%2C%22textEndColumn%22%3A%2270%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-2xl font-bold text-gray-900",children:"Announcements"}),_.jsxs("button",{"trae-inspector-start-line":"92","trae-inspector-start-column":"8","trae-inspector-end-line":"98","trae-inspector-end-column":"17","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:N,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2",children:[_.jsx(l0,{className:"h-5 w-5"}),_.jsx("span",{"trae-inspector-start-line":"97","trae-inspector-start-column":"10","trae-inspector-end-line":"97","trae-inspector-end-column":"42","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Create%20Announcement%22%2C%22textStartLine%22%3A%2297%22%2C%22textStartColumn%22%3A%2216%22%2C%22textEndLine%22%3A%2297%22%2C%22textEndColumn%22%3A%2235%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:"Create Announcement"})]})]}),_.jsx("div",{"trae-inspector-start-line":"101","trae-inspector-start-column":"6","trae-inspector-end-line":"160","trae-inspector-end-column":"12","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"grid gap-6",children:r?_.jsx("div",{"trae-inspector-start-line":"103","trae-inspector-start-column":"10","trae-inspector-end-line":"103","trae-inspector-end-column":"75","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Loading...%22%2C%22textStartLine%22%3A%22103%22%2C%22textStartColumn%22%3A%2259%22%2C%22textEndLine%22%3A%22103%22%2C%22textEndColumn%22%3A%2269%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-center text-gray-500 py-10",children:"Loading..."}):s.length===0?_.jsx("div",{"trae-inspector-start-line":"105","trae-inspector-start-column":"10","trae-inspector-end-line":"107","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22No%20announcements%20found%22%2C%22textStartLine%22%3A%22105%22%2C%22textStartColumn%22%3A%2289%22%2C%22textEndLine%22%3A%22107%22%2C%22textEndColumn%22%3A%2210%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-center text-gray-500 py-10 bg-white rounded-xl shadow-sm",children:"No announcements found"}):s.map(D=>_.jsxs("div",{"trae-inspector-start-line":"110","trae-inspector-start-column":"12","trae-inspector-end-line":"157","trae-inspector-end-column":"18","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-white rounded-xl shadow-sm p-6 flex justify-between items-start",children:[_.jsxs("div",{"trae-inspector-start-line":"111","trae-inspector-start-column":"14","trae-inspector-end-line":"127","trae-inspector-end-column":"20","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-start space-x-4",children:[_.jsx("div",{"trae-inspector-start-line":"112","trae-inspector-start-column":"16","trae-inspector-end-line":"114","trae-inspector-end-column":"22","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:`p-3 rounded-lg ${D.active?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-500"}`,children:_.jsx(YR,{className:"h-6 w-6"})}),_.jsxs("div",{"trae-inspector-start-line":"115","trae-inspector-start-column":"16","trae-inspector-end-line":"126","trae-inspector-end-column":"22","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("h3",{"trae-inspector-start-line":"116","trae-inspector-start-column":"18","trae-inspector-end-line":"116","trae-inspector-end-column":"82","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-lg font-bold text-gray-900",children:D.title}),_.jsx("p",{"trae-inspector-start-line":"117","trae-inspector-start-column":"18","trae-inspector-end-line":"117","trae-inspector-end-column":"69","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"text-gray-600 mt-1",children:D.message}),_.jsxs("div",{"trae-inspector-start-line":"118","trae-inspector-start-column":"18","trae-inspector-end-line":"125","trae-inspector-end-column":"24","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-center space-x-4 mt-3 text-sm text-gray-500",children:[_.jsxs("span",{"trae-inspector-start-line":"119","trae-inspector-start-column":"20","trae-inspector-end-line":"121","trae-inspector-end-column":"27","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"bg-gray-100 px-2 py-1 rounded-md",children:["Target: ",R(D.universityId)]}),_.jsxs("span",{"trae-inspector-start-line":"122","trae-inspector-start-column":"20","trae-inspector-end-line":"124","trae-inspector-end-column":"27","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:["Created: ",D.createdAt?new Date(D.createdAt.seconds*1e3).toLocaleDateString():"Just now"]})]})]})]}),_.jsxs("div",{"trae-inspector-start-line":"129","trae-inspector-start-column":"14","trae-inspector-end-line":"156","trae-inspector-end-column":"20","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-center space-x-2",children:[_.jsx("button",{"trae-inspector-start-line":"130","trae-inspector-start-column":"16","trae-inspector-end-line":"149","trae-inspector-end-column":"25","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:()=>z(D),className:`flex items-center space-x-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${D.active?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:D.active?_.jsxs(_.Fragment,{children:[_.jsx(EB,{className:"h-4 w-4"}),_.jsx("span",{"trae-inspector-start-line":"141","trae-inspector-start-column":"22","trae-inspector-end-line":"141","trae-inspector-end-column":"41","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Active%22%2C%22textStartLine%22%3A%22141%22%2C%22textStartColumn%22%3A%2228%22%2C%22textEndLine%22%3A%22141%22%2C%22textEndColumn%22%3A%2234%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:"Active"})]}):_.jsxs(_.Fragment,{children:[_.jsx(CB,{className:"h-4 w-4"}),_.jsx("span",{"trae-inspector-start-line":"146","trae-inspector-start-column":"22","trae-inspector-end-line":"146","trae-inspector-end-column":"43","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Inactive%22%2C%22textStartLine%22%3A%22146%22%2C%22textStartColumn%22%3A%2228%22%2C%22textEndLine%22%3A%22146%22%2C%22textEndColumn%22%3A%2236%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:"Inactive"})]})}),_.jsx("button",{"trae-inspector-start-line":"150","trae-inspector-start-column":"16","trae-inspector-end-line":"155","trae-inspector-end-column":"25","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onClick:()=>H(D.announcementId),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:_.jsx(c0,{className:"h-5 w-5"})})]})]},D.announcementId))}),_.jsx(C0,{isOpen:o,onClose:()=>u(!1),title:"Create Announcement",children:_.jsxs("form",{"trae-inspector-start-line":"167","trae-inspector-start-column":"8","trae-inspector-end-line":"227","trae-inspector-end-column":"15","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",onSubmit:V,className:"space-y-4",children:[_.jsxs("div",{"trae-inspector-start-line":"168","trae-inspector-start-column":"10","trae-inspector-end-line":"178","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("label",{"trae-inspector-start-line":"169","trae-inspector-start-column":"12","trae-inspector-end-line":"169","trae-inspector-end-column":"84","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Title%22%2C%22textStartLine%22%3A%22169%22%2C%22textStartColumn%22%3A%2271%22%2C%22textEndLine%22%3A%22169%22%2C%22textEndColumn%22%3A%2276%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700",children:"Title"}),_.jsx("input",{"trae-inspector-start-line":"170","trae-inspector-start-column":"12","trae-inspector-end-line":"177","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"text",required:!0,value:f,onChange:D=>g(D.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"e.g. System Maintenance"})]}),_.jsxs("div",{"trae-inspector-start-line":"179","trae-inspector-start-column":"10","trae-inspector-end-line":"189","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("label",{"trae-inspector-start-line":"180","trae-inspector-start-column":"12","trae-inspector-end-line":"180","trae-inspector-end-column":"86","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Message%22%2C%22textStartLine%22%3A%22180%22%2C%22textStartColumn%22%3A%2271%22%2C%22textEndLine%22%3A%22180%22%2C%22textEndColumn%22%3A%2278%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700",children:"Message"}),_.jsx("textarea",{"trae-inspector-start-line":"181","trae-inspector-start-column":"12","trae-inspector-end-line":"188","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",required:!0,rows:3,value:w,onChange:D=>A(D.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter announcement details..."})]}),_.jsxs("div",{"trae-inspector-start-line":"190","trae-inspector-start-column":"10","trae-inspector-end-line":"205","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",children:[_.jsx("label",{"trae-inspector-start-line":"191","trae-inspector-start-column":"12","trae-inspector-end-line":"191","trae-inspector-end-column":"94","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Target%20Audience%22%2C%22textStartLine%22%3A%22191%22%2C%22textStartColumn%22%3A%2271%22%2C%22textEndLine%22%3A%22191%22%2C%22textEndColumn%22%3A%2286%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"block text-sm font-medium text-gray-700",children:"Target Audience"}),_.jsxs("select",{"trae-inspector-start-line":"192","trae-inspector-start-column":"12","trae-inspector-end-line":"204","trae-inspector-end-column":"21","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",value:F,onChange:D=>C(D.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[_.jsx("option",{"trae-inspector-start-line":"197","trae-inspector-start-column":"14","trae-inspector-end-line":"197","trae-inspector-end-column":"56","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Select%20Target...%22%2C%22textStartLine%22%3A%22197%22%2C%22textStartColumn%22%3A%2231%22%2C%22textEndLine%22%3A%22197%22%2C%22textEndColumn%22%3A%2247%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",value:"",children:"Select Target..."}),_.jsx("option",{"trae-inspector-start-line":"198","trae-inspector-start-column":"14","trae-inspector-end-line":"198","trae-inspector-end-column":"59","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22All%20Universities%22%2C%22textStartLine%22%3A%22198%22%2C%22textStartColumn%22%3A%2234%22%2C%22textEndLine%22%3A%22198%22%2C%22textEndColumn%22%3A%2250%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",value:"all",children:"All Universities"}),t.map(D=>_.jsx("option",{"trae-inspector-start-line":"200","trae-inspector-start-column":"16","trae-inspector-end-line":"202","trae-inspector-end-column":"25","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",value:D.universityId,children:D.name},D.universityId))]})]}),_.jsxs("div",{"trae-inspector-start-line":"206","trae-inspector-start-column":"10","trae-inspector-end-line":"217","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"flex items-center",children:[_.jsx("input",{"trae-inspector-start-line":"207","trae-inspector-start-column":"12","trae-inspector-end-line":"213","trae-inspector-end-column":"14","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",id:"active",type:"checkbox",checked:S,onChange:D=>P(D.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),_.jsx("label",{"trae-inspector-start-line":"214","trae-inspector-start-column":"12","trae-inspector-end-line":"216","trae-inspector-end-column":"20","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Set%20as%20Active%20immediately%22%2C%22textStartLine%22%3A%22214%22%2C%22textStartColumn%22%3A%2281%22%2C%22textEndLine%22%3A%22216%22%2C%22textEndColumn%22%3A%2212%22%2C%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",htmlFor:"active",className:"ml-2 block text-sm text-gray-900",children:"Set as Active immediately"})]}),_.jsx("div",{"trae-inspector-start-line":"218","trae-inspector-start-column":"10","trae-inspector-end-line":"226","trae-inspector-end-column":"16","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",className:"mt-5 sm:mt-6",children:_.jsx("button",{"trae-inspector-start-line":"219","trae-inspector-start-column":"12","trae-inspector-end-line":"225","trae-inspector-end-column":"21","trae-inspector-file-path":"src/pages/Announcements.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22%2Fhome%2Frunner%2Fwork%2Fstudentmate-admin-panel%2Fstudentmate-admin-panel%22%7D",type:"submit",disabled:d,className:`w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:text-sm ${d?"opacity-75 cursor-not-allowed":""}`,children:d?"Creating...":"Create Announcement"})})]})})]})};function fq(){return _.jsx(K7,{children:_.jsxs(C7,{children:[_.jsx(xs,{path:"/login",element:_.jsx(Yz,{})}),_.jsx(xs,{path:"/",element:_.jsx(Ca,{children:_.jsx(ba,{children:_.jsx(JE,{to:"/dashboard",replace:!0})})})}),_.jsx(xs,{path:"/dashboard",element:_.jsx(Ca,{children:_.jsx(ba,{children:_.jsx(eW,{})})})}),_.jsx(xs,{path:"/universities",element:_.jsx(Ca,{children:_.jsx(ba,{children:_.jsx(tW,{})})})}),_.jsx(xs,{path:"/modules",element:_.jsx(Ca,{children:_.jsx(ba,{children:_.jsx(iW,{})})})}),_.jsx(xs,{path:"/exams",element:_.jsx(Ca,{children:_.jsx(ba,{children:_.jsx(sq,{})})})}),_.jsx(xs,{path:"/tests",element:_.jsx(Ca,{children:_.jsx(ba,{children:_.jsx(iq,{})})})}),_.jsx(xs,{path:"/supplementary-exams",element:_.jsx(Ca,{children:_.jsx(ba,{children:_.jsx(aq,{})})})}),_.jsx(xs,{path:"/users",element:_.jsx(Ca,{children:_.jsx(ba,{children:_.jsx(oq,{})})})}),_.jsx(xs,{path:"/analytics",element:_.jsx(Ca,{children:_.jsx(ba,{children:_.jsx(lq,{})})})}),_.jsx(xs,{path:"/announcements",element:_.jsx(Ca,{children:_.jsx(ba,{children:_.jsx(pq,{})})})}),_.jsx(xs,{path:"*",element:_.jsx(JE,{to:"/",replace:!0})})]})})}T4.createRoot(document.getElementById("root")).render(_.jsx(q.StrictMode,{children:_.jsx(fq,{})}));
